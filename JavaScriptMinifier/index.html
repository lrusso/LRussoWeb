<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>JavaScript Minifier</title>
    <link
      rel="icon"
      sizes="16x16"
      type="image/png"
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB0ElEQVR4AYRTzS5DURD+zqk6VQuJBGtRNqIJb+BnZytWhISwEInN9RAsSEQiYuNnISzFEk8gohILrTcQiYVbVRzzTXurblJOzsyZ+WbON3Pmthax5R8XBnxhbscX5vMivipiCyaxWDp+EUjyGvxXDjCLADJItwFtXZAzA2IS0xz8rBqBz8+fChyI/OzwBSi/iZSAZIpEjAXVXNqVDvzN5CWK4YQicVUjESLG2JHBRNSJlcszKL0PI51m+G+JyEgCBJyXBcwykknEV7D5ilz+Q4X20XlJbZAk6aBP8p9LFgnbHb9Mf3rcIffwiWDjFbSnxCeuUpaZcMAwoxZhsV3BBmp6PKVE7Cbb21TJYhccLpCx2n65jPhidWJRZfp8BjH9MiQRx8KjKCdQJWEl9UXxMi/xzPYlcCszEbh+FziDe0XCUA9W4tB4QQFRJDmUIXIW4tZtf2EBv6UIOxASVltfaUX0XvqUekzzqUxi25rBk3245iv6EAIVdf5V66Zn9046AIRkBC51Ay6SPD2hIRE7Lb1fmMzeKtOVgIYZPB6qdUIgIiLZi/wnKLTfilem/2CMKZQaAR3tpKMzC+eukW55Jgb+SvmlnDuDa57VHA1U1DcAAAD//6Vv4MUAAAAGSURBVAMAVWfXSLFX0yEAAAAASUVORK5CYII="
    >
    <meta name="theme-color" content="#000">
    <meta name="keywords" content="javascript, minifier, compressor">
    <meta name="description" content="JavaScript Minifier.">
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0"
    >
    <style>
      html,body{background-color:#000;font-family:Arial;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;touch-action:none;margin:5px;padding:0}#content{display:none}.wrapper{display:flex;gap:7px}.column{display:block}.label{display:inline-block;width:100%;font-size:30px;margin-bottom:10px;color:#2d3748;cursor:default}.textarea{display:inline-block;background-color:#fff;box-sizing:border-box;border:1px solid #e2e8f0;width:100%;resize:none}.textarea:disabled{background-color:#cecece;border:1px solid #e2e8f0}.btnMinify{width:90px;background-color:#4299e1;border:1px solid #4299e1;border-radius:7px;font-size:15px;font-weight:700;color:#fff;line-height:2.5;margin-top:5px;margin-bottom:10px;cursor:pointer}.btnMinify:hover{background-color:#3182ce;border:1px solid #3182ce}.btnClear{width:90px;background-color:#38b2ac;border:1px solid #38b2ac;border-radius:7px;font-size:15px;font-weight:700;color:#fff;line-height:2.5;margin-top:5px;margin-bottom:10px;cursor:pointer}.btnClear:hover{background-color:#319795;border:1px solid #319795}.pleasewait{position:fixed;width:64px;height:64px;left:0;right:0;top:0;bottom:0;margin:auto auto;border:0;z-index:9}.lds-spinner{color:#fff;display:inline-block;position:relative;width:64px;height:64px}.lds-spinner div{transform-origin:32px 32px;animation:lds-spinner 1.2s linear infinite}.lds-spinner div:after{content:" ";display:block;position:absolute;top:3px;left:29px;width:5px;height:14px;border-radius:20%;background:#fff}.lds-spinner div:nth-child(1){transform:rotate(0deg);animation-delay:-1.1s}.lds-spinner div:nth-child(2){transform:rotate(30deg);animation-delay:-1s}.lds-spinner div:nth-child(3){transform:rotate(60deg);animation-delay:-.9s}.lds-spinner div:nth-child(4){transform:rotate(90deg);animation-delay:-.8s}.lds-spinner div:nth-child(5){transform:rotate(120deg);animation-delay:-.7s}.lds-spinner div:nth-child(6){transform:rotate(150deg);animation-delay:-.6s}.lds-spinner div:nth-child(7){transform:rotate(180deg);animation-delay:-.5s}.lds-spinner div:nth-child(8){transform:rotate(210deg);animation-delay:-.4s}.lds-spinner div:nth-child(9){transform:rotate(240deg);animation-delay:-.3s}.lds-spinner div:nth-child(10){transform:rotate(270deg);animation-delay:-.2s}.lds-spinner div:nth-child(11){transform:rotate(300deg);animation-delay:-.1s}.lds-spinner div:nth-child(12){transform:rotate(330deg);animation-delay:0s}@keyframes lds-spinner{0%{opacity:1}to{opacity:0}}
    </style>
  </head>
  <body>
    <div class="pleasewait">
      <div class="lds-spinner">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </div>
    </div>
    <div id="content">
      <div class="wrapper">
        <div class="column">
          <span class="label"></span>
          <textarea
            class="textarea"
            spellcheck="false"
            name="in"
            rows="25"
            cols="80"
          ></textarea>
        </div>
        <div class="column">
          <span class="label"></span>
          <textarea
            class="textarea"
            spellcheck="false"
            name="out"
            rows="25"
            cols="80"
            readonly
            disabled
          ></textarea>
        </div>
      </div>
      <div>
        <button class="btnMinify"></button>
        <button class="btnClear"></button>
      </div>
    </div>
    <script>
      var APP_STRINGS = {
        en: {
          minify: "Minify",
          clear: "Clear",
          input: "Input JavaScript",
          output: "Minified Output",
          please_wait: "Please wait...",
        },
        es: {
          minify: "Minificar",
          clear: "Limpiar",
          input: "C\xF3digo JavaScript",
          output: "Resultado minificado",
          please_wait: "Por favor, espere...",
        },
      }

      var USER_LANG = window.navigator.language.substring(0, 2).toLowerCase()
      var GET_APP_STRING = APP_STRINGS[USER_LANG] || APP_STRINGS["en"]

      function t(stringName) {
        return GET_APP_STRING[stringName] || ""
      }

      var content
      var labelIn
      var textIn
      var labelOut
      var textOut
      var btnMinify
      var btnClear

      var myWorker = new Worker(
        "data:text/javascript;base64,dmFyIG1pbmlmeUV4cG9zZWQgPSBudWxsCgovLyBwcmV0dGllci1pZ25vcmUKLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCjsoZnVuY3Rpb24gKCkgewogIC8vIG1pbmlmaXkuanMKICAvLyBwcmV0dGllci1pZ25vcmUKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAidXNlIHN0cmljdCI7dmFyIHRvX2FzY2lpLCB0b19iYXNlNjQ7ZnVuY3Rpb24gcmVhZF9zb3VyY2VfbWFwKGUsIGEpIHtmb3IgKHZhciByID0gYS5lbmQuY29tbWVudHNfYWZ0ZXIsIG4gPSByLmxlbmd0aDsgMCA8PSAtLW47KSB7dmFyIG8gPSByW25dO2lmICgiY29tbWVudDEiICE9IG8udHlwZSkgYnJlYWs7byA9IC9eIyAoW15ccz1dKyk9KFxTKylccyokLy5leGVjKG8udmFsdWUpO2lmICghbykgYnJlYWs7aWYgKCJzb3VyY2VNYXBwaW5nVVJMIiA9PSBvWzFdKSB7aWYgKG8gPSAvXmRhdGE6YXBwbGljYXRpb25cL2pzb24oOy4qPyk/O2Jhc2U2NCwoW14sXSspJC8uZXhlYyhvWzJdKSkgcmV0dXJuIHRvX2FzY2lpKG9bMl0pO2JyZWFrO319QVNUX05vZGUud2FybigiaW5saW5lIHNvdXJjZSBtYXAgbm90IGZvdW5kOiB7bmFtZX0iLCB7IG5hbWU6IGUgfSk7fWZ1bmN0aW9uIHBhcnNlX3NvdXJjZV9tYXAoYSkge3RyeSB7cmV0dXJuIEpTT04ucGFyc2UoYSk7fSBjYXRjaCAoZSkge3Rocm93IG5ldyBFcnJvcigiaW52YWxpZCBpbnB1dCBzb3VyY2UgbWFwOiAiICsgYSk7fX1mdW5jdGlvbiBzZXRfc2hvcnRoYW5kKGEsIHIsIGUpIHtlLmZvckVhY2goZnVuY3Rpb24gKGUpIHtyW2VdICYmICgib2JqZWN0IiAhPSB0eXBlb2YgcltlXSAmJiAocltlXSA9IHt9KSwgYSBpbiByW2VdIHx8IChyW2VdW2FdID0gclthXSkpO30pO31mdW5jdGlvbiBpbml0X2NhY2hlKGUpIHtlICYmICgicHJvcHMiIGluIGUgPyBlLnByb3BzIGluc3RhbmNlb2YgRGljdGlvbmFyeSB8fCAoZS5wcm9wcyA9IERpY3Rpb25hcnkuZnJvbU9iamVjdChlLnByb3BzKSkgOiBlLnByb3BzID0gbmV3IERpY3Rpb25hcnkoKSk7fWZ1bmN0aW9uIHRvX2pzb24oZSkge3JldHVybiB7IHByb3BzOiBlLnByb3BzLnRvT2JqZWN0KCkgfTt9ZnVuY3Rpb24gbWluaWZ5KG4sIG8pIHt0cnkgeyhvID0gZGVmYXVsdHMobywgeyBhbm5vdGF0aW9uczogdm9pZCAwLCBjb21wcmVzczoge30sIGVuY2xvc2U6ICExLCBleHByZXNzaW9uOiAhMSwgaWU6ICExLCBpZTg6ICExLCBrZWVwX2ZhcmdzOiAhMSwga2VlcF9mbmFtZXM6ICExLCBtYW5nbGU6IHt9LCBtb2R1bGU6IHZvaWQgMCwgbmFtZUNhY2hlOiBudWxsLCBvdXRwdXQ6IHt9LCBwYXJzZToge30sIHJlbmFtZTogdm9pZCAwLCBzb3VyY2VNYXA6ICExLCB0aW1pbmdzOiAhMSwgdG9wbGV2ZWw6ICEoIW8gfHwgby5leHByZXNzaW9uIHx8ICFvLm1vZHVsZSkgfHwgdm9pZCAwLCB2ODogITEsIHZhbGlkYXRlOiAhMSwgd2FybmluZ3M6ICExLCB3ZWJraXQ6ICExLCB3cmFwOiAhMSB9LCAhMCkpLnZhbGlkYXRlICYmIEFTVF9Ob2RlLmVuYWJsZV92YWxpZGF0aW9uKCk7dmFyIGUscyxhID0gby50aW1pbmdzICYmIHsgc3RhcnQ6IERhdGUubm93KCkgfSxyID0gKHZvaWQgMCAhPT0gby5hbm5vdGF0aW9ucyAmJiBzZXRfc2hvcnRoYW5kKCJhbm5vdGF0aW9ucyIsIG8sIFsiY29tcHJlc3MiLCAib3V0cHV0Il0pLCBvLmV4cHJlc3Npb24gJiYgc2V0X3Nob3J0aGFuZCgiZXhwcmVzc2lvbiIsIG8sIFsiY29tcHJlc3MiLCAicGFyc2UiXSksIG8uaWU4ICYmIChvLmllID0gby5pZSB8fCBvLmllOCksIG8uaWUgJiYgc2V0X3Nob3J0aGFuZCgiaWUiLCBvLCBbImNvbXByZXNzIiwgIm1hbmdsZSIsICJvdXRwdXQiLCAicmVuYW1lIl0pLCBvLmtlZXBfZmFyZ3MgJiYgc2V0X3Nob3J0aGFuZCgia2VlcF9mYXJncyIsIG8sIFsiY29tcHJlc3MiLCAibWFuZ2xlIiwgInJlbmFtZSJdKSwgby5rZWVwX2ZuYW1lcyAmJiBzZXRfc2hvcnRoYW5kKCJrZWVwX2ZuYW1lcyIsIG8sIFsiY29tcHJlc3MiLCAibWFuZ2xlIiwgInJlbmFtZSJdKSwgdm9pZCAwICE9PSBvLm1vZHVsZSB8fCBvLmllIHx8IChvLm1vZHVsZSA9ICEwKSwgby5tb2R1bGUgJiYgc2V0X3Nob3J0aGFuZCgibW9kdWxlIiwgbywgWyJjb21wcmVzcyIsICJwYXJzZSJdKSwgdm9pZCAwICE9PSBvLnRvcGxldmVsICYmIHNldF9zaG9ydGhhbmQoInRvcGxldmVsIiwgbywgWyJjb21wcmVzcyIsICJtYW5nbGUiLCAicmVuYW1lIl0pLCBvLnY4ICYmIHNldF9zaG9ydGhhbmQoInY4IiwgbywgWyJtYW5nbGUiLCAib3V0cHV0IiwgInJlbmFtZSJdKSwgby53ZWJraXQgJiYgc2V0X3Nob3J0aGFuZCgid2Via2l0IiwgbywgWyJjb21wcmVzcyIsICJtYW5nbGUiLCAib3V0cHV0IiwgInJlbmFtZSJdKSwgby5tYW5nbGUgJiYgKG8ubWFuZ2xlID0gZGVmYXVsdHMoby5tYW5nbGUsIHsgY2FjaGU6IG8ubmFtZUNhY2hlICYmIChvLm5hbWVDYWNoZS52YXJzIHx8IHt9KSwgZXZhbDogITEsIGllOiAhMSwga2VlcF9mYXJnczogITEsIGtlZXBfZm5hbWVzOiAhMSwgcHJvcGVydGllczogITEsIHJlc2VydmVkOiBbXSwgdG9wbGV2ZWw6ICExLCB2ODogITEsIHdlYmtpdDogITEgfSwgITApLCBvLm1hbmdsZS5wcm9wZXJ0aWVzICYmICgib2JqZWN0IiAhPSB0eXBlb2Ygby5tYW5nbGUucHJvcGVydGllcyAmJiAoby5tYW5nbGUucHJvcGVydGllcyA9IHt9KSwgby5tYW5nbGUucHJvcGVydGllcy5rZWVwX3F1b3RlZCAmJiAoZSA9IG8ubWFuZ2xlLnByb3BlcnRpZXMucmVzZXJ2ZWQsIEFycmF5LmlzQXJyYXkoZSkgfHwgKGUgPSBbXSksIG8ubWFuZ2xlLnByb3BlcnRpZXMucmVzZXJ2ZWQgPSBlKSwgIW8ubmFtZUNhY2hlIHx8ICJjYWNoZSIgaW4gby5tYW5nbGUucHJvcGVydGllcyB8fCAoby5tYW5nbGUucHJvcGVydGllcy5jYWNoZSA9IG8ubmFtZUNhY2hlLnByb3BzIHx8IHt9KSksIGluaXRfY2FjaGUoby5tYW5nbGUuY2FjaGUpLCBpbml0X2NhY2hlKG8ubWFuZ2xlLnByb3BlcnRpZXMuY2FjaGUpKSwgdm9pZCAwID09PSBvLnJlbmFtZSAmJiAoby5yZW5hbWUgPSBvLmNvbXByZXNzICYmIG8ubWFuZ2xlKSwgby5zb3VyY2VNYXAgJiYgKG8uc291cmNlTWFwID0gZGVmYXVsdHMoby5zb3VyY2VNYXAsIHsgY29udGVudDogbnVsbCwgZmlsZW5hbWU6IG51bGwsIGluY2x1ZGVTb3VyY2VzOiAhMSwgbmFtZXM6ICEwLCByb290OiBudWxsLCB1cmw6IG51bGwgfSwgITApKSwgW10pO2lmIChvLndhcm5pbmdzICYmIEFTVF9Ob2RlLmxvZ19mdW5jdGlvbihmdW5jdGlvbiAoZSkge3IucHVzaChlKTt9LCAidmVyYm9zZSIgPT0gby53YXJuaW5ncyksIGEgJiYgKGEucGFyc2UgPSBEYXRlLm5vdygpKSwgby5wYXJzZSA9IG8ucGFyc2UgfHwge30sIG4gaW5zdGFuY2VvZiBBU1RfTm9kZSkgcyA9IG47ZWxzZSB7InN0cmluZyIgPT0gdHlwZW9mIG4gJiYgKG4gPSBbbl0pLCBvLnBhcnNlLnRvcGxldmVsID0gbnVsbDt2YXIgdCxwID0gby5zb3VyY2VNYXAgJiYgby5zb3VyY2VNYXAuY29udGVudDtmb3IgKGwgaW4gKHAgPSAic3RyaW5nIiA9PSB0eXBlb2YgcCAmJiAiaW5saW5lIiAhPSBwID8gcGFyc2Vfc291cmNlX21hcChwKSA6IHApICYmIChvLnNvdXJjZU1hcC5vcmlnID0gT2JqZWN0LmNyZWF0ZShudWxsKSksIG4pIEhPUChuLCBsKSAmJiAoby5wYXJzZS5maWxlbmFtZSA9IGwsIG8ucGFyc2UudG9wbGV2ZWwgPSBzID0gcGFyc2UobltsXSwgby5wYXJzZSksICJpbmxpbmUiID09IHAgPyAodCA9IHJlYWRfc291cmNlX21hcChsLCBzKSkgJiYgKG8uc291cmNlTWFwLm9yaWdbbF0gPSBwYXJzZV9zb3VyY2VfbWFwKHQpKSA6IHAgJiYgKG8uc291cmNlTWFwLm9yaWdbbF0gPSBwKSk7fW8ucGFyc2UuZXhwcmVzc2lvbiAmJiAocyA9IHMud3JhcF9leHByZXNzaW9uKCkpLCBlICYmIHJlc2VydmVfcXVvdGVkX2tleXMocywgZSksIFsiZW5jbG9zZSIsICJ3cmFwIl0uZm9yRWFjaChmdW5jdGlvbiAoZSkge3ZhciBhLHIgPSBvW2VdO3IgJiYgKGEgPSBzLnByaW50X3RvX3N0cmluZygpLnNsaWNlKDAsIC0xKSwgcyA9IHNbZV0ociksIG5bcy5zdGFydC5maWxlXSA9IHMucHJpbnRfdG9fc3RyaW5nKCkucmVwbGFjZShhLCAiIikpO30pLCBvLnZhbGlkYXRlICYmIHMudmFsaWRhdGVfYXN0KCksIGEgJiYgKGEucmVuYW1lID0gRGF0ZS5ub3coKSksIG8ucmVuYW1lICYmIChzLmZpZ3VyZV9vdXRfc2NvcGUoby5yZW5hbWUpLCBzLmV4cGFuZF9uYW1lcyhvLnJlbmFtZSkpLCBhICYmIChhLmNvbXByZXNzID0gRGF0ZS5ub3coKSksIG8uY29tcHJlc3MgJiYgKHMgPSBuZXcgQ29tcHJlc3NvcihvLmNvbXByZXNzKS5jb21wcmVzcyhzKSwgby52YWxpZGF0ZSkgJiYgcy52YWxpZGF0ZV9hc3QoKSwgYSAmJiAoYS5zY29wZSA9IERhdGUubm93KCkpLCBvLm1hbmdsZSAmJiBzLmZpZ3VyZV9vdXRfc2NvcGUoby5tYW5nbGUpLCBhICYmIChhLm1hbmdsZSA9IERhdGUubm93KCkpLCBvLm1hbmdsZSAmJiAocy5jb21wdXRlX2NoYXJfZnJlcXVlbmN5KG8ubWFuZ2xlKSwgcy5tYW5nbGVfbmFtZXMoby5tYW5nbGUpKSwgYSAmJiAoYS5wcm9wZXJ0aWVzID0gRGF0ZS5ub3coKSksIGUgJiYgcmVzZXJ2ZV9xdW90ZWRfa2V5cyhzLCBlKSwgby5tYW5nbGUgJiYgby5tYW5nbGUucHJvcGVydGllcyAmJiBtYW5nbGVfcHJvcGVydGllcyhzLCBvLm1hbmdsZS5wcm9wZXJ0aWVzKSwgby5wYXJzZS5leHByZXNzaW9uICYmIChzID0gcy51bndyYXBfZXhwcmVzc2lvbigpKSwgYSAmJiAoYS5vdXRwdXQgPSBEYXRlLm5vdygpKTt2YXIgaSA9IHt9LGMgPSBkZWZhdWx0cyhvLm91dHB1dCwgeyBhc3Q6ICExLCBjb2RlOiAhMCB9KTtpZiAoYy5hc3QgJiYgKGkuYXN0ID0gcyksIGMuY29kZSkge2lmIChvLnNvdXJjZU1hcCAmJiAoYy5zb3VyY2VfbWFwID0gU291cmNlTWFwKG8uc291cmNlTWFwKSwgby5zb3VyY2VNYXAuaW5jbHVkZVNvdXJjZXMpKSB7aWYgKG4gaW5zdGFuY2VvZiBBU1RfVG9wbGV2ZWwpIHRocm93IG5ldyBFcnJvcigib3JpZ2luYWwgc291cmNlIGNvbnRlbnQgdW5hdmFpbGFibGUiKTtmb3IgKHZhciBsIGluIG4pIEhPUChuLCBsKSAmJiBjLnNvdXJjZV9tYXAuc2V0U291cmNlQ29udGVudChsLCBuW2xdKTt9ZGVsZXRlIGMuYXN0LCBkZWxldGUgYy5jb2RlO3ZhciBtLHUgPSBPdXRwdXRTdHJlYW0oYyk7cy5wcmludCh1KSwgaS5jb2RlID0gdS5nZXQoKSwgby5zb3VyY2VNYXAgJiYgKGkubWFwID0gYy5zb3VyY2VfbWFwLnRvU3RyaW5nKCksIG0gPSBvLnNvdXJjZU1hcC51cmwpICYmIChpLmNvZGUgPSBpLmNvZGUucmVwbGFjZSgvXG5cL1wvIyBzb3VyY2VNYXBwaW5nVVJMPVxTK1xzKiQvLCAiIiksIGkuY29kZSArPSAiaW5saW5lIiA9PSBtID8gIlxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTg7YmFzZTY0LCIgKyB0b19iYXNlNjQoaS5tYXApIDogIlxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9IiArIG0pO31yZXR1cm4gby5uYW1lQ2FjaGUgJiYgby5tYW5nbGUgJiYgKG8ubWFuZ2xlLmNhY2hlICYmIChvLm5hbWVDYWNoZS52YXJzID0gdG9fanNvbihvLm1hbmdsZS5jYWNoZSkpLCBvLm1hbmdsZS5wcm9wZXJ0aWVzKSAmJiBvLm1hbmdsZS5wcm9wZXJ0aWVzLmNhY2hlICYmIChvLm5hbWVDYWNoZS5wcm9wcyA9IHRvX2pzb24oby5tYW5nbGUucHJvcGVydGllcy5jYWNoZSkpLCBhICYmIChhLmVuZCA9IERhdGUubm93KCksIGkudGltaW5ncyA9IHsgcGFyc2U6IC4wMDEgKiAoYS5yZW5hbWUgLSBhLnBhcnNlKSwgcmVuYW1lOiAuMDAxICogKGEuY29tcHJlc3MgLSBhLnJlbmFtZSksIGNvbXByZXNzOiAuMDAxICogKGEuc2NvcGUgLSBhLmNvbXByZXNzKSwgc2NvcGU6IC4wMDEgKiAoYS5tYW5nbGUgLSBhLnNjb3BlKSwgbWFuZ2xlOiAuMDAxICogKGEucHJvcGVydGllcyAtIGEubWFuZ2xlKSwgcHJvcGVydGllczogLjAwMSAqIChhLm91dHB1dCAtIGEucHJvcGVydGllcyksIG91dHB1dDogLjAwMSAqIChhLmVuZCAtIGEub3V0cHV0KSwgdG90YWw6IC4wMDEgKiAoYS5lbmQgLSBhLnN0YXJ0KSB9KSwgci5sZW5ndGggJiYgKGkud2FybmluZ3MgPSByKSwgaTt9IGNhdGNoIChlKSB7cmV0dXJuIHsgZXJyb3I6IGUgfTt9IGZpbmFsbHkge0FTVF9Ob2RlLmxvZ19mdW5jdGlvbigpLCBBU1RfTm9kZS5kaXNhYmxlX3ZhbGlkYXRpb24oKTt9fXRvX2Jhc2U2NCA9ICJ1bmRlZmluZWQiID09IHR5cGVvZiBCdWZmZXIgPyAodG9fYXNjaWkgPSBhdG9iLCBidG9hKSA6IHZvaWQgMCA9PT0gQnVmZmVyLmFsbG9jID8gKHRvX2FzY2lpID0gZnVuY3Rpb24gdG9fYXNjaWkoZSkge3JldHVybiBuZXcgQnVmZmVyKGUsICJiYXNlNjQiKS50b1N0cmluZygpO30sIGZ1bmN0aW9uIChlKSB7cmV0dXJuIG5ldyBCdWZmZXIoZSkudG9TdHJpbmcoImJhc2U2NCIpO30pIDogKHRvX2FzY2lpID0gZnVuY3Rpb24gdG9fYXNjaWkoZSkge3JldHVybiBCdWZmZXIuZnJvbShlLCAiYmFzZTY0IikudG9TdHJpbmcoKTt9LCBmdW5jdGlvbiAoZSkge3JldHVybiBCdWZmZXIuZnJvbShlKS50b1N0cmluZygiYmFzZTY0Iik7fSk7CgogIC8vIHV0aWxzLmpzCiAgLy8gcHJldHRpZXItaWdub3JlCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCiAgInVzZSBzdHJpY3QiO2Z1bmN0aW9uIGNoYXJhY3RlcnModCkge3JldHVybiB0LnNwbGl0KCIiKTt9ZnVuY3Rpb24gbWVtYmVyKHQsIG4pIHtyZXR1cm4gMCA8PSBuLmluZGV4T2YodCk7fWZ1bmN0aW9uIGZpbmRfaWYodCwgbikge2ZvciAodmFyIGUgPSBuLmxlbmd0aDsgMCA8PSAtLWU7KSBpZiAodChuW2VdKSkgcmV0dXJuIG5bZV07fWZ1bmN0aW9uIGNvbmZpZ3VyZV9lcnJvcl9zdGFjayhlLCByKSB7dmFyIGkgPSBlLm5hbWUgKyAiOiAiICsgZS5tZXNzYWdlO09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAic3RhY2siLCB7IGdldDogZnVuY3Rpb24gZ2V0KCkge3ZhciB0LCBuO3JldHVybiByICYmIChyLm5hbWUgPSAiIiArIGUubmFtZSwgaSA9ICIiICsgci5zdGFjaywgdCA9ICIiICsgci5tZXNzYWdlLCByID0gbnVsbCwgbiA9IChuID0gaS5pbmRleE9mKHQpKSA8IDAgPyAwIDogaS5pbmRleE9mKCJcbiIsIG4gKz0gdC5sZW5ndGgpICsgMSwgaSA9IGkuc2xpY2UoMCwgbikgKyBpLnNsaWNlKGkuaW5kZXhPZigiXG4iLCBuKSArIDEpKSwgaTt9IH0pO31mdW5jdGlvbiBEZWZhdWx0c0Vycm9yKHQsIG4pIHt0aGlzLm1lc3NhZ2UgPSB0LCB0aGlzLmRlZnMgPSBuO3RyeSB7dGhyb3cgbmV3IEVycm9yKHQpO30gY2F0Y2ggKHQpIHtjb25maWd1cmVfZXJyb3Jfc3RhY2sodGhpcywgdCk7fX1mdW5jdGlvbiBkZWZhdWx0cyh0LCBuLCBlKSB7aWYgKGUpIGZvciAodmFyIHIgaW4gdCkgaWYgKEhPUCh0LCByKSAmJiAhSE9QKG4sIHIpKSB0aHJvdyBuZXcgRGVmYXVsdHNFcnJvcigiYCIgKyByICsgImAgaXMgbm90IGEgc3VwcG9ydGVkIG9wdGlvbiIsIG4pO2ZvciAodmFyIHIgaW4gdCkgSE9QKHQsIHIpICYmIChuW3JdID0gdFtyXSk7cmV0dXJuIG47fWZ1bmN0aW9uIG5vb3AoKSB7fWZ1bmN0aW9uIHJldHVybl9mYWxzZSgpIHtyZXR1cm4gITE7fWZ1bmN0aW9uIHJldHVybl90cnVlKCkge3JldHVybiAhMDt9ZnVuY3Rpb24gcmV0dXJuX3RoaXMoKSB7cmV0dXJuIHRoaXM7fWZ1bmN0aW9uIHJldHVybl9udWxsKCkge3JldHVybiBudWxsO31EZWZhdWx0c0Vycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKSwgKERlZmF1bHRzRXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRGVmYXVsdHNFcnJvcikucHJvdG90eXBlLm5hbWUgPSAiRGVmYXVsdHNFcnJvciI7dmFyIExpc3QgPSBmdW5jdGlvbiAoKSB7ZnVuY3Rpb24gdCh0LCBuKSB7Zm9yICh2YXIgZSA9IFtdLCByID0gMDsgciA8IHQubGVuZ3RoOyByKyspIHt2YXIgaSA9IG4odFtyXSwgcik7aSAhPT0gbyAmJiAoaSBpbnN0YW5jZW9mIHUgPyBlLnB1c2guYXBwbHkoZSwgaS52KSA6IGUucHVzaChpKSk7fXJldHVybiBlO310LmlzX29wID0gZnVuY3Rpb24gKHQpIHtyZXR1cm4gdCA9PT0gbyB8fCB0IGluc3RhbmNlb2YgdTt9LCB0LnNwbGljZSA9IGZ1bmN0aW9uICh0KSB7cmV0dXJuIG5ldyB1KHQpO307dmFyIG8gPSB0LnNraXAgPSB7fTtmdW5jdGlvbiB1KHQpIHt0aGlzLnYgPSB0O31yZXR1cm4gdDt9KCk7ZnVuY3Rpb24gcHVzaF91bmlxKHQsIG4pIHtpZiAodC5pbmRleE9mKG4pIDwgMCkgcmV0dXJuIHQucHVzaChuKTt9ZnVuY3Rpb24gc3RyaW5nX3RlbXBsYXRlKHQsIGUpIHtyZXR1cm4gdC5yZXBsYWNlKC9ceyhbXnt9XSspXH0vZywgZnVuY3Rpb24gKHQsIG4pIHtuID0gInRoaXMiID09IG4gPyBlIDogZVtuXTtyZXR1cm4gbiBpbnN0YW5jZW9mIEFTVF9Ob2RlID8gbi5wcmludF90b19zdHJpbmcoKSA6IG4gaW5zdGFuY2VvZiBBU1RfVG9rZW4gPyBuLmZpbGUgKyAiOiIgKyBuLmxpbmUgKyAiLCIgKyBuLmNvbCA6IG47fSk7fWZ1bmN0aW9uIHJlbW92ZSh0LCBuKSB7biA9IHQuaW5kZXhPZihuKTswIDw9IG4gJiYgdC5zcGxpY2UobiwgMSk7fWZ1bmN0aW9uIG1ha2VQcmVkaWNhdGUodCkge0FycmF5LmlzQXJyYXkodCkgfHwgKHQgPSB0LnNwbGl0KCIgIikpO3ZhciBuID0gT2JqZWN0LmNyZWF0ZShudWxsKTtyZXR1cm4gdC5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7blt0XSA9ICEwO30pLCBuO31mdW5jdGlvbiBhbGwodCwgbikge2ZvciAodmFyIGUgPSB0Lmxlbmd0aDsgMCA8PSAtLWU7KSBpZiAoIW4odFtlXSwgZSkpIHJldHVybiAhMTtyZXR1cm4gITA7fWZ1bmN0aW9uIERpY3Rpb25hcnkoKSB7dGhpcy52YWx1ZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO31mdW5jdGlvbiBIT1AodCwgbikge3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCwgbik7fWZ1bmN0aW9uIGZpcnN0X2luX3N0YXRlbWVudCh0LCBuLCBlKSB7Zm9yICh2YXIgciwgaSA9IHQucGFyZW50KC0xKSwgbyA9IDA7IHIgPSB0LnBhcmVudChvKyspOyBpID0gcikge2lmIChpc19hcnJvdyhyKSkgcmV0dXJuIG4gJiYgci52YWx1ZSA9PT0gaTtpZiAociBpbnN0YW5jZW9mIEFTVF9CaW5hcnkpIHtpZiAoci5sZWZ0ID09PSBpKSBjb250aW51ZTt9IGVsc2UgaWYgKCJDYWxsIiA9PSByLlRZUEUpIHtpZiAoci5leHByZXNzaW9uID09PSBpKSBjb250aW51ZTt9IGVsc2UgaWYgKHIgaW5zdGFuY2VvZiBBU1RfQ29uZGl0aW9uYWwpIHtpZiAoci5jb25kaXRpb24gPT09IGkpIGNvbnRpbnVlO30gZWxzZSB7aWYgKHIgaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVmYXVsdCkgcmV0dXJuIGU7aWYgKHIgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2Vzcykge2lmIChyLmV4cHJlc3Npb24gPT09IGkpIGNvbnRpbnVlO30gZWxzZSBpZiAociBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSkge2lmIChyLmV4cHJlc3Npb25zWzBdID09PSBpKSBjb250aW51ZTt9IGVsc2Uge2lmIChyIGluc3RhbmNlb2YgQVNUX1NpbXBsZVN0YXRlbWVudCkgcmV0dXJuICEwO2lmIChyIGluc3RhbmNlb2YgQVNUX1RlbXBsYXRlKSB7aWYgKHIudGFnID09PSBpKSBjb250aW51ZTt9IGVsc2UgaWYgKHIgaW5zdGFuY2VvZiBBU1RfVW5hcnlQb3N0Zml4ICYmIHIuZXhwcmVzc2lvbiA9PT0gaSkgY29udGludWU7fX1yZXR1cm4gITE7fX1mdW5jdGlvbiBERUZfQklUUFJPUFMociwgdCkge2lmICgzMSA8IHQubGVuZ3RoKSB0aHJvdyBuZXcgRXJyb3IoIlRvbyBtYW55IHByb3BlcnRpZXM6ICIgKyB0Lmxlbmd0aCArICJcbiIgKyB0LmpvaW4oIiwgIikpO3QuZm9yRWFjaChmdW5jdGlvbiAodCwgbikge3ZhciBlID0gMSA8PCBuO09iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSwgdCwgeyBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtyZXR1cm4gISEodGhpcy5fYml0cyAmIGUpO30sIHNldDogZnVuY3Rpb24gc2V0KHQpIHt0ID8gdGhpcy5fYml0cyB8PSBlIDogdGhpcy5fYml0cyAmPSB+ZTt9IH0pO30pO31EaWN0aW9uYXJ5LnByb3RvdHlwZSA9IHsgc2V0OiBmdW5jdGlvbiBzZXQodCwgbikge3JldHVybiAiX19wcm90b19fIiA9PSB0ID8gdGhpcy5wcm90b192YWx1ZSA9IG4gOiB0aGlzLnZhbHVlc1t0XSA9IG4sIHRoaXM7fSwgYWRkOiBmdW5jdGlvbiBhZGQodCwgbikge3ZhciBlID0gdGhpcy5nZXQodCk7cmV0dXJuIGUgPyBlLnB1c2gobikgOiB0aGlzLnNldCh0LCBbbl0pLCB0aGlzO30sIGdldDogZnVuY3Rpb24gZ2V0KHQpIHtyZXR1cm4gIl9fcHJvdG9fXyIgPT0gdCA/IHRoaXMucHJvdG9fdmFsdWUgOiB0aGlzLnZhbHVlc1t0XTt9LCBkZWw6IGZ1bmN0aW9uIGRlbCh0KSB7cmV0dXJuICJfX3Byb3RvX18iID09IHQgPyBkZWxldGUgdGhpcy5wcm90b192YWx1ZSA6IGRlbGV0ZSB0aGlzLnZhbHVlc1t0XSwgdGhpczt9LCBoYXM6IGZ1bmN0aW9uIGhhcyh0KSB7cmV0dXJuICJfX3Byb3RvX18iID09IHQgPyAicHJvdG9fdmFsdWUiIGluIHRoaXMgOiB0IGluIHRoaXMudmFsdWVzO30sIGFsbDogZnVuY3Rpb24gYWxsKHQpIHtmb3IgKHZhciBuIGluIHRoaXMudmFsdWVzKSBpZiAoIXQodGhpcy52YWx1ZXNbbl0sIG4pKSByZXR1cm4gITE7cmV0dXJuICEoInByb3RvX3ZhbHVlIiBpbiB0aGlzICYmICF0KHRoaXMucHJvdG9fdmFsdWUsICJfX3Byb3RvX18iKSk7fSwgZWFjaDogZnVuY3Rpb24gZWFjaCh0KSB7Zm9yICh2YXIgbiBpbiB0aGlzLnZhbHVlcykgdCh0aGlzLnZhbHVlc1tuXSwgbik7InByb3RvX3ZhbHVlIiBpbiB0aGlzICYmIHQodGhpcy5wcm90b192YWx1ZSwgIl9fcHJvdG9fXyIpO30sIHNpemU6IGZ1bmN0aW9uIHNpemUoKSB7cmV0dXJuIE9iamVjdC5rZXlzKHRoaXMudmFsdWVzKS5sZW5ndGggKyAoInByb3RvX3ZhbHVlIiBpbiB0aGlzKTt9LCBtYXA6IGZ1bmN0aW9uIG1hcCh0KSB7dmFyIG4sZSA9IFtdO2ZvciAobiBpbiB0aGlzLnZhbHVlcykgZS5wdXNoKHQodGhpcy52YWx1ZXNbbl0sIG4pKTtyZXR1cm4gInByb3RvX3ZhbHVlIiBpbiB0aGlzICYmIGUucHVzaCh0KHRoaXMucHJvdG9fdmFsdWUsICJfX3Byb3RvX18iKSksIGU7fSwgY2xvbmU6IGZ1bmN0aW9uIGNsb25lKCkge3ZhciBlID0gbmV3IERpY3Rpb25hcnkoKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICh0LCBuKSB7ZS5zZXQobiwgdCk7fSksIGU7fSwgdG9PYmplY3Q6IGZ1bmN0aW9uIHRvT2JqZWN0KCkge3ZhciBlID0ge307cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAodCwgbikge2VbIiQiICsgbl0gPSB0O30pLCBlO30gfSwgRGljdGlvbmFyeS5mcm9tT2JqZWN0ID0gZnVuY3Rpb24gKHQpIHt2YXIgbixlID0gbmV3IERpY3Rpb25hcnkoKTtmb3IgKG4gaW4gdCkgSE9QKHQsIG4pICYmIGUuc2V0KG4uc2xpY2UoMSksIHRbbl0pO3JldHVybiBlO307CgogIC8vIGFzdC5qcwogIC8vIHByZXR0aWVyLWlnbm9yZQogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZQogICJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBERUZOT0RFKGUsIHQsIG4sIG8pIHt2b2lkIDAgPT09IG8gJiYgKG8gPSBBU1RfTm9kZSk7dmFyIGksYSA9IHQgPSB0ID8gdC5zcGxpdCgvXHMrLykgOiBbXSxzID0gKG8gJiYgby5QUk9QUyAmJiAodCA9IHQuY29uY2F0KG8uUFJPUFMpKSwgWyJyZXR1cm4gZnVuY3Rpb24gQVNUXyIsIGUsICIocHJvcHMpeyIsICJ0aGlzLl9iaXRzPTA7IiwgImlmKHByb3BzKXsiXSksciA9ICh0LmZvckVhY2goZnVuY3Rpb24gKGUpIHtzLnB1c2goInRoaXMuIiwgZSwgIj1wcm9wcy4iLCBlLCAiOyIpO30pLCBzLnB1c2goIn0iKSwgT2JqZWN0LmNyZWF0ZShvICYmIG8ucHJvdG90eXBlKSksbCA9ICgobi5pbml0aWFsaXplIHx8IHIuaW5pdGlhbGl6ZSkgJiYgcy5wdXNoKCJ0aGlzLmluaXRpYWxpemUoKTsiKSwgcy5wdXNoKCJ9OyIpLCBuZXcgRnVuY3Rpb24ocy5qb2luKCIiKSkoKSk7Zm9yIChpIGluIGwucHJvdG90eXBlID0gciwgKGwucHJvdG90eXBlLkNUT1IgPSBsKS5wcm90b3R5cGUuVFlQRSA9IGwuVFlQRSA9IGUsIG8gJiYgKGwuQkFTRSA9IG8pLlNVQkNMQVNTRVMucHVzaChsKSwgbC5ERUZNRVRIT0QgPSBmdW5jdGlvbiAoZSwgdCkge3RoaXMucHJvdG90eXBlW2VdID0gdDt9LCBsLlBST1BTID0gdCwgbC5TRUxGX1BST1BTID0gYSwgbC5TVUJDTEFTU0VTID0gW10sIG4pIEhPUChuLCBpKSAmJiAoL15cJC8udGVzdChpKSA/IGxbaS5zdWJzdHIoMSldID0gbltpXSA6IGwuREVGTUVUSE9EKGksIG5baV0pKTtyZXR1cm4gInVuZGVmaW5lZCIgIT0gdHlwZW9mIGV4cG9ydHMgJiYgKGV4cG9ydHNbIkFTVF8iICsgZV0gPSBsKSwgbDt9dmFyIEFTVF9Ub2tlbiA9IERFRk5PREUoIlRva2VuIiwgInR5cGUgdmFsdWUgbGluZSBjb2wgcG9zIGVuZGxpbmUgZW5kY29sIGVuZHBvcyBubGIgY29tbWVudHNfYmVmb3JlIGNvbW1lbnRzX2FmdGVyIGZpbGUgcmF3Iiwge30sIG51bGwpLEFTVF9Ob2RlID0gREVGTk9ERSgiTm9kZSIsICJzdGFydCBlbmQiLCB7IF9jbG9uZTogZnVuY3Rpb24gX2Nsb25lKGUpIHt2YXIgdDtyZXR1cm4gZSA/ICh0ID0gdGhpcy5jbG9uZSgpKS50cmFuc2Zvcm0obmV3IFRyZWVUcmFuc2Zvcm1lcihmdW5jdGlvbiAoZSkge2lmIChlICE9PSB0KSByZXR1cm4gZS5jbG9uZSghMCk7fSkpIDogbmV3IHRoaXMuQ1RPUih0aGlzKTt9LCBjbG9uZTogZnVuY3Rpb24gY2xvbmUoZSkge3JldHVybiB0aGlzLl9jbG9uZShlKTt9LCAkZG9jdW1lbnRhdGlvbjogIkJhc2UgY2xhc3Mgb2YgYWxsIEFTVCBub2RlcyIsICRwcm9wZG9jOiB7IHN0YXJ0OiAiW0FTVF9Ub2tlbl0gVGhlIGZpcnN0IHRva2VuIG9mIHRoaXMgbm9kZSIsIGVuZDogIltBU1RfVG9rZW5dIFRoZSBsYXN0IHRva2VuIG9mIHRoaXMgbm9kZSIgfSwgZXF1YWxzOiBmdW5jdGlvbiBlcXVhbHMoZSkge3JldHVybiB0aGlzLlRZUEUgPT0gZS5UWVBFICYmIHRoaXMuX2VxdWFscyhlKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHtlLnZpc2l0KHRoaXMpO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiTm9kZSIgPT0gdGhpcy5UWVBFKSB0aHJvdyBuZXcgRXJyb3IoInNob3VsZCBub3QgaW5zdGFudGlhdGUgQVNUX05vZGUiKTt9LCB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUoKSB7Zm9yICh2YXIgZSA9IHRoaXMuQ1RPUjsgZS5wcm90b3R5cGUuX3ZhbGlkYXRlLmNhbGwodGhpcyksIGUgPSBlLkJBU0U7KTt9LCB2YWxpZGF0ZV9hc3Q6IGZ1bmN0aW9uIHZhbGlkYXRlX2FzdCgpIHt2YXIgdCA9IHt9O3RoaXMud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge2lmIChlLnZhbGlkYXRlX3Zpc2l0ZWQgPT09IHQpIHRocm93IG5ldyBFcnJvcihzdHJpbmdfdGVtcGxhdGUoImNhbm5vdCByZXVzZSBBU1Rfe1RZUEV9IGZyb20gW3tzdGFydH1dIiwgZSkpO2UudmFsaWRhdGVfdmlzaXRlZCA9IHQ7fSkpO30gfSwgbnVsbCkscmVzdG9yZV90cmFuc2Zvcm1zID0gKERFRl9CSVRQUk9QUyhBU1RfTm9kZSwgWyJfb3B0aW1pemVkIiwgIl9zcXVlZXplZCIsICJjYWxsX29ubHkiLCAiY29sbGFwc2Vfc2Nhbm5pbmciLCAiZGVmaW5lZCIsICJldmFsdWF0aW5nIiwgImZhbHN5IiwgImluX2FyZyIsICJpbl9ib29sIiwgImlzX3VuZGVmaW5lZCIsICJpbmxpbmVkIiwgImxlbmd0aF9yZWFkIiwgIm5lc3RlZCIsICJuZXciLCAib3B0aW9uYWwiLCAicHJpdmF0ZSIsICJwdXJlIiwgInNpbmdsZV91c2UiLCAic3RhdGljIiwgInRlcm1pbmFsIiwgInRydXRoeSIsICJ1c2VzX2V2YWwiLCAidXNlc193aXRoIl0pLCAoQVNUX05vZGUubG9nX2Z1bmN0aW9uID0gZnVuY3Rpb24gKHQsIGUpIHt2YXIgbjtmdW5jdGlvbiBvKGUpIHtuW2VdIHx8IChuW2VdID0gITAsIHQoZSkpO30iZnVuY3Rpb24iICE9IHR5cGVvZiB0ID8gQVNUX05vZGUuaW5mbyA9IEFTVF9Ob2RlLndhcm4gPSBub29wIDogKG4gPSBPYmplY3QuY3JlYXRlKG51bGwpLCBBU1RfTm9kZS5pbmZvID0gZSA/IGZ1bmN0aW9uIChlLCB0KSB7bygiSU5GTzogIiArIHN0cmluZ190ZW1wbGF0ZShlLCB0KSk7fSA6IG5vb3AsIEFTVF9Ob2RlLndhcm4gPSBmdW5jdGlvbiAoZSwgdCkge28oIldBUk46ICIgKyBzdHJpbmdfdGVtcGxhdGUoZSwgdCkpO30pO30pKCksIFtdKTtmdW5jdGlvbiBhbGxfZXF1YWxzKGUsIG4pIHtyZXR1cm4gZS5sZW5ndGggPT0gbi5sZW5ndGggJiYgYWxsKGUsIGZ1bmN0aW9uIChlLCB0KSB7cmV0dXJuIGUuZXF1YWxzKG5bdF0pO30pO31mdW5jdGlvbiBsaXN0X2VxdWFscyhlLCBuKSB7cmV0dXJuIGUubGVuZ3RoID09IG4ubGVuZ3RoICYmIGFsbChlLCBmdW5jdGlvbiAoZSwgdCkge3JldHVybiBlID09IG5bdF07fSk7fWZ1bmN0aW9uIHByb3BfZXF1YWxzKGUsIHQpIHtyZXR1cm4gZSA9PT0gdCB8fCAobnVsbCA9PSBlID8gbnVsbCA9PSB0IDogZSBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmIHQgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiBlLmVxdWFscyh0KSk7fUFTVF9Ob2RlLmVuYWJsZV92YWxpZGF0aW9uID0gZnVuY3Rpb24gKCkge0FTVF9Ob2RlLmRpc2FibGVfdmFsaWRhdGlvbigpLCBmdW5jdGlvbiBlKHQpIHt2YXIgbjt0LlNVQkNMQVNTRVMuZm9yRWFjaChlKSwgSE9QKHQucHJvdG90eXBlLCAidHJhbnNmb3JtIikgJiYgKG4gPSB0LnByb3RvdHlwZS50cmFuc2Zvcm0sIHQucHJvdG90eXBlLnRyYW5zZm9ybSA9IGZ1bmN0aW9uIChlLCB0KSB7ZSA9IG4uY2FsbCh0aGlzLCBlLCB0KTtpZiAoZSBpbnN0YW5jZW9mIEFTVF9Ob2RlKSBlLnZhbGlkYXRlKCk7ZWxzZSBpZiAoIShudWxsID09PSBlIHx8IHQgJiYgTGlzdC5pc19vcChlKSkpIHRocm93IG5ldyBFcnJvcigiaW52YWxpZCB0cmFuc2Zvcm1lZCB2YWx1ZTogIiArIGUpO3JldHVybiBlO30sIHJlc3RvcmVfdHJhbnNmb3Jtcy5wdXNoKGZ1bmN0aW9uICgpIHt0LnByb3RvdHlwZS50cmFuc2Zvcm0gPSBuO30pKTt9KHRoaXMpO30sIEFTVF9Ob2RlLmRpc2FibGVfdmFsaWRhdGlvbiA9IGZ1bmN0aW9uICgpIHtmb3IgKHZhciBlOyBlID0gcmVzdG9yZV90cmFuc2Zvcm1zLnBvcCgpOykgZSgpO307dmFyIEFTVF9TdGF0ZW1lbnQgPSBERUZOT0RFKCJTdGF0ZW1lbnQiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQmFzZSBjbGFzcyBvZiBhbGwgc3RhdGVtZW50cyIsIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiU3RhdGVtZW50IiA9PSB0aGlzLlRZUEUpIHRocm93IG5ldyBFcnJvcigic2hvdWxkIG5vdCBpbnN0YW50aWF0ZSBBU1RfU3RhdGVtZW50Iik7fSB9KSxBU1RfRGVidWdnZXIgPSBERUZOT0RFKCJEZWJ1Z2dlciIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJSZXByZXNlbnRzIGEgZGVidWdnZXIgc3RhdGVtZW50IiwgX2VxdWFsczogcmV0dXJuX3RydWUgfSwgQVNUX1N0YXRlbWVudCksQVNUX0RpcmVjdGl2ZSA9IERFRk5PREUoIkRpcmVjdGl2ZSIsICJxdW90ZSB2YWx1ZSIsIHsgJGRvY3VtZW50YXRpb246ICdSZXByZXNlbnRzIGEgZGlyZWN0aXZlLCBsaWtlICJ1c2Ugc3RyaWN0IjsnLCAkcHJvcGRvYzogeyBxdW90ZTogIltzdHJpbmc/XSB0aGUgb3JpZ2luYWwgcXVvdGUgY2hhcmFjdGVyIiwgdmFsdWU6ICJbc3RyaW5nXSBUaGUgdmFsdWUgb2YgdGhpcyBkaXJlY3RpdmUgYXMgYSBwbGFpbiBzdHJpbmcgKGl0J3Mgbm90IGFuIEFTVF9TdHJpbmchKSIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHRoaXMudmFsdWUgPT0gZS52YWx1ZTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAobnVsbCAhPSB0aGlzLnF1b3RlKSB7aWYgKCJzdHJpbmciICE9IHR5cGVvZiB0aGlzLnF1b3RlKSB0aHJvdyBuZXcgRXJyb3IoInF1b3RlIG11c3QgYmUgc3RyaW5nIik7aWYgKCEvXlsiJ10kLy50ZXN0KHRoaXMucXVvdGUpKSB0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgcXVvdGU6ICIgKyB0aGlzLnF1b3RlKTt9aWYgKCJzdHJpbmciICE9IHR5cGVvZiB0aGlzLnZhbHVlKSB0aHJvdyBuZXcgRXJyb3IoInZhbHVlIG11c3QgYmUgc3RyaW5nIik7fSB9LCBBU1RfU3RhdGVtZW50KSxBU1RfRW1wdHlTdGF0ZW1lbnQgPSBERUZOT0RFKCJFbXB0eVN0YXRlbWVudCIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJUaGUgZW1wdHkgc3RhdGVtZW50IChlbXB0eSBibG9jayBvciBzaW1wbHkgYSBzZW1pY29sb24pIiwgX2VxdWFsczogcmV0dXJuX3RydWUgfSwgQVNUX1N0YXRlbWVudCk7ZnVuY3Rpb24gaXNfc3RhdGVtZW50KGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TdGF0ZW1lbnQgJiYgIShlIGluc3RhbmNlb2YgQVNUX0NsYXNzRXhwcmVzc2lvbikgJiYgIShlIGluc3RhbmNlb2YgQVNUX0xhbWJkYUV4cHJlc3Npb24pO31mdW5jdGlvbiB2YWxpZGF0ZV9leHByZXNzaW9uKGUsIHQsIG4sIG8sIGkpIHtpZiAobiA9IG4gPyAiY29udGFpbiIgOiAiYmUiLCAhKGUgaW5zdGFuY2VvZiBBU1RfTm9kZSkpIHRocm93IG5ldyBFcnJvcih0ICsgIiBtdXN0ICIgKyBuICsgIiBBU1RfTm9kZSIpO2lmIChlIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSkgdGhyb3cgbmV3IEVycm9yKHQgKyAiIGNhbm5vdCAiICsgbiArICIgQVNUX0RlZmF1bHRWYWx1ZSIpO2lmIChlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCkgdGhyb3cgbmV3IEVycm9yKHQgKyAiIGNhbm5vdCAiICsgbiArICIgQVNUX0Rlc3RydWN0dXJlZCIpO2lmIChlIGluc3RhbmNlb2YgQVNUX0hvbGUgJiYgIWkpIHRocm93IG5ldyBFcnJvcih0ICsgIiBjYW5ub3QgIiArIG4gKyAiIEFTVF9Ib2xlIik7aWYgKGUgaW5zdGFuY2VvZiBBU1RfU3ByZWFkICYmICFvKSB0aHJvdyBuZXcgRXJyb3IodCArICIgY2Fubm90ICIgKyBuICsgIiBBU1RfU3ByZWFkIik7aWYgKGlzX3N0YXRlbWVudChlKSkgdGhyb3cgbmV3IEVycm9yKHQgKyAiIGNhbm5vdCAiICsgbiArICIgQVNUX1N0YXRlbWVudCIpO2lmIChlIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlY2xhcmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IodCArICIgY2Fubm90ICIgKyBuICsgIiBBU1RfU3ltYm9sRGVjbGFyYXRpb24iKTt9ZnVuY3Rpb24gbXVzdF9iZV9leHByZXNzaW9uKGUsIHQpIHt2YWxpZGF0ZV9leHByZXNzaW9uKGVbdF0sIHQpO312YXIgQVNUX1NpbXBsZVN0YXRlbWVudCA9IERFRk5PREUoIlNpbXBsZVN0YXRlbWVudCIsICJib2R5IiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgc3RhdGVtZW50IGNvbnNpc3Rpbmcgb2YgYW4gZXhwcmVzc2lvbiwgaS5lLiBhID0gMSArIDIiLCAkcHJvcGRvYzogeyBib2R5OiAiW0FTVF9Ob2RlXSBhbiBleHByZXNzaW9uIG5vZGUgKHNob3VsZCBub3QgYmUgaW5zdGFuY2VvZiBBU1RfU3RhdGVtZW50KSIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHRoaXMuYm9keS5lcXVhbHMoZS5ib2R5KTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5ib2R5LndhbGsoZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7bXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJib2R5Iik7fSB9LCBBU1RfU3RhdGVtZW50KSxBU1RfQmxvY2tTY29wZSA9IERFRk5PREUoIkJsb2NrU2NvcGUiLCAiX3Zhcl9uYW1lcyBlbmNsb3NlZCBmdW5jdGlvbnMgbWFrZV9kZWYgcGFyZW50X3Njb3BlIHZhcmlhYmxlcyIsIHsgJGRvY3VtZW50YXRpb246ICJCYXNlIGNsYXNzIGZvciBhbGwgc3RhdGVtZW50cyBpbnRyb2R1Y2luZyBhIGxleGljYWwgc2NvcGUiLCAkcHJvcGRvYzogeyBlbmNsb3NlZDogIltTeW1ib2xEZWYqL1NdIGEgbGlzdCBvZiBhbGwgc3ltYm9sIGRlZmluaXRpb25zIHRoYXQgYXJlIGFjY2Vzc2VkIGZyb20gdGhpcyBzY29wZSBvciBhbnkgaW5uZXIgc2NvcGVzIiwgZnVuY3Rpb25zOiAiW0RpY3Rpb25hcnkvU10gbGlrZSBgdmFyaWFibGVzYCwgYnV0IG9ubHkgbGlzdHMgZnVuY3Rpb24gZGVjbGFyYXRpb25zIiwgcGFyZW50X3Njb3BlOiAiW0FTVF9TY29wZT8vU10gbGluayB0byB0aGUgcGFyZW50IHNjb3BlIiwgdmFyaWFibGVzOiAiW0RpY3Rpb25hcnkvU10gYSBtYXAgb2YgbmFtZSAtLS1ceDNlIFN5bWJvbERlZiBmb3IgYWxsIHZhcmlhYmxlcy9mdW5jdGlvbnMgZGVmaW5lZCBpbiB0aGlzIHNjb3BlIiB9LCBjbG9uZTogZnVuY3Rpb24gY2xvbmUoZSkge2UgPSB0aGlzLl9jbG9uZShlKTtyZXR1cm4gdGhpcy5lbmNsb3NlZCAmJiAoZS5lbmNsb3NlZCA9IHRoaXMuZW5jbG9zZWQuc2xpY2UoKSksIHRoaXMuZnVuY3Rpb25zICYmIChlLmZ1bmN0aW9ucyA9IHRoaXMuZnVuY3Rpb25zLmNsb25lKCkpLCB0aGlzLnZhcmlhYmxlcyAmJiAoZS52YXJpYWJsZXMgPSB0aGlzLnZhcmlhYmxlcy5jbG9uZSgpKSwgZTt9LCBwaW5uZWQ6IGZ1bmN0aW9uIHBpbm5lZCgpIHtyZXR1cm4gdGhpcy5yZXNvbHZlKCkucGlubmVkKCk7fSwgcmVzb2x2ZTogZnVuY3Rpb24gcmVzb2x2ZSgpIHtyZXR1cm4gdGhpcy5wYXJlbnRfc2NvcGUucmVzb2x2ZSgpO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiQmxvY2tTY29wZSIgPT0gdGhpcy5UWVBFKSB0aHJvdyBuZXcgRXJyb3IoInNob3VsZCBub3QgaW5zdGFudGlhdGUgQVNUX0Jsb2NrU2NvcGUiKTtpZiAobnVsbCAhPSB0aGlzLnBhcmVudF9zY29wZSkge2lmICghKHRoaXMucGFyZW50X3Njb3BlIGluc3RhbmNlb2YgQVNUX0Jsb2NrU2NvcGUpKSB0aHJvdyBuZXcgRXJyb3IoInBhcmVudF9zY29wZSBtdXN0IGJlIEFTVF9CbG9ja1Njb3BlIik7aWYgKCEodGhpcy5yZXNvbHZlKCkgaW5zdGFuY2VvZiBBU1RfU2NvcGUpKSB0aHJvdyBuZXcgRXJyb3IoIm11c3QgYmUgY29udGFpbmVkIHdpdGhpbiBBU1RfU2NvcGUiKTt9fSB9LCBBU1RfU3RhdGVtZW50KTtmdW5jdGlvbiB3YWxrX2JvZHkoZSwgdCkge2UuYm9keS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKHQpO30pO312YXIgQVNUX0Jsb2NrID0gREVGTk9ERSgiQmxvY2siLCAiYm9keSIsIHsgJGRvY3VtZW50YXRpb246ICJBIGJvZHkgb2Ygc3RhdGVtZW50cyAodXN1YWxseSBicmFjZWQpIiwgJHByb3Bkb2M6IHsgYm9keTogIltBU1RfU3RhdGVtZW50Kl0gYW4gYXJyYXkgb2Ygc3RhdGVtZW50cyIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIGFsbF9lcXVhbHModGhpcy5ib2R5LCBlLmJvZHkpO30sIHdhbGs6IGZ1bmN0aW9uIHdhbGsoZSkge3ZhciB0ID0gdGhpcztlLnZpc2l0KHQsIGZ1bmN0aW9uICgpIHt3YWxrX2JvZHkodCwgZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCJCbG9jayIgPT0gdGhpcy5UWVBFKSB0aHJvdyBuZXcgRXJyb3IoInNob3VsZCBub3QgaW5zdGFudGlhdGUgQVNUX0Jsb2NrIik7dGhpcy5ib2R5LmZvckVhY2goZnVuY3Rpb24gKGUpIHtpZiAoIWlzX3N0YXRlbWVudChlKSkgdGhyb3cgbmV3IEVycm9yKCJib2R5IG11c3QgY29udGFpbiBBU1RfU3RhdGVtZW50Iik7fSk7fSB9LCBBU1RfQmxvY2tTY29wZSksQVNUX0Jsb2NrU3RhdGVtZW50ID0gREVGTk9ERSgiQmxvY2tTdGF0ZW1lbnQiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBibG9jayBzdGF0ZW1lbnQiIH0sIEFTVF9CbG9jayksQVNUX1N0YXRlbWVudFdpdGhCb2R5ID0gREVGTk9ERSgiU3RhdGVtZW50V2l0aEJvZHkiLCAiYm9keSIsIHsgJGRvY3VtZW50YXRpb246ICJCYXNlIGNsYXNzIGZvciBhbGwgc3RhdGVtZW50cyB0aGF0IGNvbnRhaW4gb25lIG5lc3RlZCBib2R5OiBgRm9yYCwgYEZvckluYCwgYERvYCwgYFdoaWxlYCwgYFdpdGhgIiwgJHByb3Bkb2M6IHsgYm9keTogIltBU1RfU3RhdGVtZW50XSB0aGUgYm9keTsgdGhpcyBzaG91bGQgYWx3YXlzIGJlIHByZXNlbnQsIGV2ZW4gaWYgaXQncyBhbiBBU1RfRW1wdHlTdGF0ZW1lbnQiIH0sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiU3RhdGVtZW50V2l0aEJvZHkiID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9TdGF0ZW1lbnRXaXRoQm9keSIpO2lmICghaXNfc3RhdGVtZW50KHRoaXMuYm9keSkpIHRocm93IG5ldyBFcnJvcigiYm9keSBtdXN0IGJlIEFTVF9TdGF0ZW1lbnQiKTt9IH0sIEFTVF9CbG9ja1Njb3BlKSxBU1RfTGFiZWxlZFN0YXRlbWVudCA9IERFRk5PREUoIkxhYmVsZWRTdGF0ZW1lbnQiLCAibGFiZWwiLCB7ICRkb2N1bWVudGF0aW9uOiAiU3RhdGVtZW50IHdpdGggYSBsYWJlbCIsICRwcm9wZG9jOiB7IGxhYmVsOiAiW0FTVF9MYWJlbF0gYSBsYWJlbCBkZWZpbml0aW9uIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gdGhpcy5sYWJlbC5lcXVhbHMoZS5sYWJlbCkgJiYgdGhpcy5ib2R5LmVxdWFscyhlLmJvZHkpO30sIHdhbGs6IGZ1bmN0aW9uIHdhbGsoZSkge3ZhciB0ID0gdGhpcztlLnZpc2l0KHQsIGZ1bmN0aW9uICgpIHt0LmxhYmVsLndhbGsoZSksIHQuYm9keS53YWxrKGUpO30pO30sIGNsb25lOiBmdW5jdGlvbiBjbG9uZShlKSB7dmFyIHQsbixvID0gdGhpcy5fY2xvbmUoZSk7cmV0dXJuIGUgJiYgKHQgPSBvLmxhYmVsLCBuID0gdGhpcy5sYWJlbCwgby53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfTG9vcENvbnRyb2wgPyBlLmxhYmVsICYmIGUubGFiZWwudGhlZGVmID09PSBuID8gKChlLmxhYmVsLnRoZWRlZiA9IHQpLnJlZmVyZW5jZXMucHVzaChlKSwgITApIDogdm9pZCAwIDogZSBpbnN0YW5jZW9mIEFTVF9TY29wZSB8fCB2b2lkIDA7fSkpKSwgbzt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoISh0aGlzLmxhYmVsIGluc3RhbmNlb2YgQVNUX0xhYmVsKSkgdGhyb3cgbmV3IEVycm9yKCJsYWJlbCBtdXN0IGJlIEFTVF9MYWJlbCIpO30gfSwgQVNUX1N0YXRlbWVudFdpdGhCb2R5KSxBU1RfSXRlcmF0aW9uU3RhdGVtZW50ID0gREVGTk9ERSgiSXRlcmF0aW9uU3RhdGVtZW50IiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkludGVybmFsIGNsYXNzLiAgQWxsIGxvb3BzIGluaGVyaXQgZnJvbSBpdC4iLCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIkl0ZXJhdGlvblN0YXRlbWVudCIgPT0gdGhpcy5UWVBFKSB0aHJvdyBuZXcgRXJyb3IoInNob3VsZCBub3QgaW5zdGFudGlhdGUgQVNUX0l0ZXJhdGlvblN0YXRlbWVudCIpO30gfSwgQVNUX1N0YXRlbWVudFdpdGhCb2R5KSxBU1RfRFdMb29wID0gREVGTk9ERSgiRFdMb29wIiwgImNvbmRpdGlvbiIsIHsgJGRvY3VtZW50YXRpb246ICJCYXNlIGNsYXNzIGZvciBkby93aGlsZSBzdGF0ZW1lbnRzIiwgJHByb3Bkb2M6IHsgY29uZGl0aW9uOiAiW0FTVF9Ob2RlXSB0aGUgbG9vcCBjb25kaXRpb24uICBTaG91bGQgbm90IGJlIGluc3RhbmNlb2YgQVNUX1N0YXRlbWVudCIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHRoaXMuYm9keS5lcXVhbHMoZS5ib2R5KSAmJiB0aGlzLmNvbmRpdGlvbi5lcXVhbHMoZS5jb25kaXRpb24pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiRFdMb29wIiA9PSB0aGlzLlRZUEUpIHRocm93IG5ldyBFcnJvcigic2hvdWxkIG5vdCBpbnN0YW50aWF0ZSBBU1RfRFdMb29wIik7bXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJjb25kaXRpb24iKTt9IH0sIEFTVF9JdGVyYXRpb25TdGF0ZW1lbnQpLEFTVF9EbyA9IERFRk5PREUoIkRvIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkEgYGRvYCBzdGF0ZW1lbnQiLCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5ib2R5LndhbGsoZSksIHQuY29uZGl0aW9uLndhbGsoZSk7fSk7fSB9LCBBU1RfRFdMb29wKSxBU1RfV2hpbGUgPSBERUZOT0RFKCJXaGlsZSIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGB3aGlsZWAgc3RhdGVtZW50Iiwgd2FsazogZnVuY3Rpb24gd2FsayhlKSB7dmFyIHQgPSB0aGlzO2UudmlzaXQodCwgZnVuY3Rpb24gKCkge3QuY29uZGl0aW9uLndhbGsoZSksIHQuYm9keS53YWxrKGUpO30pO30gfSwgQVNUX0RXTG9vcCksQVNUX0ZvciA9IERFRk5PREUoIkZvciIsICJpbml0IGNvbmRpdGlvbiBzdGVwIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgYGZvcmAgc3RhdGVtZW50IiwgJHByb3Bkb2M6IHsgaW5pdDogIltBU1RfTm9kZT9dIHRoZSBgZm9yYCBpbml0aWFsaXphdGlvbiBjb2RlLCBvciBudWxsIGlmIGVtcHR5IiwgY29uZGl0aW9uOiAiW0FTVF9Ob2RlP10gdGhlIGBmb3JgIHRlcm1pbmF0aW9uIGNsYXVzZSwgb3IgbnVsbCBpZiBlbXB0eSIsIHN0ZXA6ICJbQVNUX05vZGU/XSB0aGUgYGZvcmAgdXBkYXRlIGNsYXVzZSwgb3IgbnVsbCBpZiBlbXB0eSIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHByb3BfZXF1YWxzKHRoaXMuaW5pdCwgZS5pbml0KSAmJiBwcm9wX2VxdWFscyh0aGlzLmNvbmRpdGlvbiwgZS5jb25kaXRpb24pICYmIHByb3BfZXF1YWxzKHRoaXMuc3RlcCwgZS5zdGVwKSAmJiB0aGlzLmJvZHkuZXF1YWxzKGUuYm9keSk7fSwgd2FsazogZnVuY3Rpb24gd2FsayhlKSB7dmFyIHQgPSB0aGlzO2UudmlzaXQodCwgZnVuY3Rpb24gKCkge3QuaW5pdCAmJiB0LmluaXQud2FsayhlKSwgdC5jb25kaXRpb24gJiYgdC5jb25kaXRpb24ud2FsayhlKSwgdC5zdGVwICYmIHQuc3RlcC53YWxrKGUpLCB0LmJvZHkud2FsayhlKTt9KTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAobnVsbCAhPSB0aGlzLmluaXQpIHtpZiAoISh0aGlzLmluaXQgaW5zdGFuY2VvZiBBU1RfTm9kZSkpIHRocm93IG5ldyBFcnJvcigiaW5pdCBtdXN0IGJlIEFTVF9Ob2RlIik7aWYgKGlzX3N0YXRlbWVudCh0aGlzLmluaXQpICYmICEodGhpcy5pbml0IGluc3RhbmNlb2YgQVNUX0RlZmluaXRpb25zKSkgdGhyb3cgbmV3IEVycm9yKCJpbml0IGNhbm5vdCBiZSBBU1RfU3RhdGVtZW50Iik7fW51bGwgIT0gdGhpcy5jb25kaXRpb24gJiYgbXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJjb25kaXRpb24iKSwgbnVsbCAhPSB0aGlzLnN0ZXAgJiYgbXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJzdGVwIik7fSB9LCBBU1RfSXRlcmF0aW9uU3RhdGVtZW50KSxBU1RfRm9yRW51bWVyYXRpb24gPSBERUZOT0RFKCJGb3JFbnVtZXJhdGlvbiIsICJpbml0IG9iamVjdCIsIHsgJGRvY3VtZW50YXRpb246ICJCYXNlIGNsYXNzIGZvciBlbnVtZXJhdGlvbiBsb29wcywgaS5lLiBgZm9yIC4uLiBpbmAsIGBmb3IgLi4uIG9mYCAmIGBmb3IgYXdhaXQgLi4uIG9mYCIsICRwcm9wZG9jOiB7IGluaXQ6ICJbQVNUX05vZGVdIHRoZSBhc3NpZ25tZW50IHRhcmdldCBkdXJpbmcgaXRlcmF0aW9uIiwgb2JqZWN0OiAiW0FTVF9Ob2RlXSB0aGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3ZlciIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHRoaXMuaW5pdC5lcXVhbHMoZS5pbml0KSAmJiB0aGlzLm9iamVjdC5lcXVhbHMoZS5vYmplY3QpICYmIHRoaXMuYm9keS5lcXVhbHMoZS5ib2R5KTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5pbml0LndhbGsoZSksIHQub2JqZWN0LndhbGsoZSksIHQuYm9keS53YWxrKGUpO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiRm9yRW51bWVyYXRpb24iID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9Gb3JFbnVtZXJhdGlvbiIpO2lmICh0aGlzLmluaXQgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMpIHtpZiAoMSAhPSB0aGlzLmluaXQuZGVmaW5pdGlvbnMubGVuZ3RoKSB0aHJvdyBuZXcgRXJyb3IoImluaXQgbXVzdCBoYXZlIHNpbmdsZSBkZWNsYXJhdGlvbiIpO30gZWxzZSB2YWxpZGF0ZV9kZXN0cnVjdHVyZWQodGhpcy5pbml0LCBmdW5jdGlvbiAoZSkge2lmICghKGUgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyB8fCBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikpIHRocm93IG5ldyBFcnJvcigiaW5pdCBtdXN0IGJlIGFzc2lnbmFibGU6ICIgKyBlLlRZUEUpO30pO211c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAib2JqZWN0Iik7fSB9LCBBU1RfSXRlcmF0aW9uU3RhdGVtZW50KSxBU1RfRm9ySW4gPSBERUZOT0RFKCJGb3JJbiIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGBmb3IgLi4uIGluYCBzdGF0ZW1lbnQiIH0sIEFTVF9Gb3JFbnVtZXJhdGlvbiksQVNUX0Zvck9mID0gREVGTk9ERSgiRm9yT2YiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBgZm9yIC4uLiBvZmAgc3RhdGVtZW50IiB9LCBBU1RfRm9yRW51bWVyYXRpb24pLEFTVF9Gb3JBd2FpdE9mID0gREVGTk9ERSgiRm9yQXdhaXRPZiIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGBmb3IgYXdhaXQgLi4uIG9mYCBzdGF0ZW1lbnQiIH0sIEFTVF9Gb3JPZiksQVNUX1dpdGggPSBERUZOT0RFKCJXaXRoIiwgImV4cHJlc3Npb24iLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBgd2l0aGAgc3RhdGVtZW50IiwgJHByb3Bkb2M6IHsgZXhwcmVzc2lvbjogIltBU1RfTm9kZV0gdGhlIGB3aXRoYCBleHByZXNzaW9uIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gdGhpcy5leHByZXNzaW9uLmVxdWFscyhlLmV4cHJlc3Npb24pICYmIHRoaXMuYm9keS5lcXVhbHMoZS5ib2R5KTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5leHByZXNzaW9uLndhbGsoZSksIHQuYm9keS53YWxrKGUpO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge211c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAiZXhwcmVzc2lvbiIpO30gfSwgQVNUX1N0YXRlbWVudFdpdGhCb2R5KSxBU1RfU2NvcGUgPSBERUZOT0RFKCJTY29wZSIsICJmbl9kZWZzIG1heV9jYWxsX3RoaXMgdXNlc19ldmFsIHVzZXNfd2l0aCIsIHsgJGRvY3VtZW50YXRpb246ICJCYXNlIGNsYXNzIGZvciBhbGwgc3RhdGVtZW50cyBpbnRyb2R1Y2luZyBhIGxhbWJkYSBzY29wZSIsICRwcm9wZG9jOiB7IHVzZXNfZXZhbDogIltib29sZWFuL1NdIHRlbGxzIHdoZXRoZXIgdGhpcyBzY29wZSBjb250YWlucyBhIGRpcmVjdCBjYWxsIHRvIHRoZSBnbG9iYWwgYGV2YWxgIiwgdXNlc193aXRoOiAiW2Jvb2xlYW4vU10gdGVsbHMgd2hldGhlciB0aGlzIHNjb3BlIHVzZXMgdGhlIGB3aXRoYCBzdGF0ZW1lbnQiIH0sIHBpbm5lZDogZnVuY3Rpb24gcGlubmVkKCkge3JldHVybiB0aGlzLnVzZXNfZXZhbCB8fCB0aGlzLnVzZXNfd2l0aDt9LCByZXNvbHZlOiByZXR1cm5fdGhpcywgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCJTY29wZSIgPT0gdGhpcy5UWVBFKSB0aHJvdyBuZXcgRXJyb3IoInNob3VsZCBub3QgaW5zdGFudGlhdGUgQVNUX1Njb3BlIik7fSB9LCBBU1RfQmxvY2spLEFTVF9Ub3BsZXZlbCA9IERFRk5PREUoIlRvcGxldmVsIiwgImdsb2JhbHMiLCB7ICRkb2N1bWVudGF0aW9uOiAiVGhlIHRvcGxldmVsIHNjb3BlIiwgJHByb3Bkb2M6IHsgZ2xvYmFsczogIltEaWN0aW9uYXJ5L1NdIGEgbWFwIG9mIG5hbWUgLS0tXHgzZSBTeW1ib2xEZWYgZm9yIGFsbCB1bmRlY2xhcmVkIG5hbWVzIiB9LCB3cmFwOiBmdW5jdGlvbiB3cmFwKGUpIHt2YXIgdCA9IHRoaXMuYm9keTtyZXR1cm4gcGFyc2UoWyIoZnVuY3Rpb24oZXhwb3J0cyl7JyRPUklHJzt9KSh0eXBlb2YgIiwgZSwgIj09J3VuZGVmaW5lZCc/KCIsIGUsICI9e30pOiIsIGUsICIpOyJdLmpvaW4oIiIpLCB7IGZpbGVuYW1lOiAid3JhcD0iICsgSlNPTi5zdHJpbmdpZnkoZSkgfSkudHJhbnNmb3JtKG5ldyBUcmVlVHJhbnNmb3JtZXIoZnVuY3Rpb24gKGUpIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9EaXJlY3RpdmUgJiYgIiRPUklHIiA9PSBlLnZhbHVlKSByZXR1cm4gTGlzdC5zcGxpY2UodCk7fSkpO30sIGVuY2xvc2U6IGZ1bmN0aW9uIGVuY2xvc2UoZSkge3ZhciB0ID0gKGUgPSAic3RyaW5nIiAhPSB0eXBlb2YgZSA/ICIiIDogZSkuaW5kZXhPZigiOiIpLG4gPSAodCA8IDAgJiYgKHQgPSBlLmxlbmd0aCksIHRoaXMuYm9keSk7cmV0dXJuIHBhcnNlKFsiKGZ1bmN0aW9uKCIsIGUuc2xpY2UoMCwgdCksICcpeyIkT1JJRyJ9KSgnLCBlLnNsaWNlKHQgKyAxKSwgIikiXS5qb2luKCIiKSwgeyBmaWxlbmFtZTogImVuY2xvc2U9IiArIEpTT04uc3RyaW5naWZ5KGUpIH0pLnRyYW5zZm9ybShuZXcgVHJlZVRyYW5zZm9ybWVyKGZ1bmN0aW9uIChlKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfRGlyZWN0aXZlICYmICIkT1JJRyIgPT0gZS52YWx1ZSkgcmV0dXJuIExpc3Quc3BsaWNlKG4pO30pKTt9IH0sIEFTVF9TY29wZSksQVNUX0NsYXNzSW5pdEJsb2NrID0gREVGTk9ERSgiQ2xhc3NJbml0QmxvY2siLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiVmFsdWUgZm9yIGBjbGFzc2Agc3RhdGljIGluaXRpYWxpemF0aW9uIGJsb2NrcyIgfSwgQVNUX1Njb3BlKSxBU1RfTGFtYmRhID0gREVGTk9ERSgiTGFtYmRhIiwgImFyZ25hbWVzIGxlbmd0aF9yZWFkIHJlc3Qgc2FmZV9pZHMgdXNlc19hcmd1bWVudHMiLCB7ICRkb2N1bWVudGF0aW9uOiAiQmFzZSBjbGFzcyBmb3IgZnVuY3Rpb25zIiwgJHByb3Bkb2M6IHsgYXJnbmFtZXM6ICJbKEFTVF9EZWZhdWx0VmFsdWV8QVNUX0Rlc3RydWN0dXJlZHxBU1RfU3ltYm9sRnVuYXJnKSpdIGFycmF5IG9mIGZ1bmN0aW9uIGFyZ3VtZW50cyBhbmQvb3IgZGVzdHJ1Y3R1cmVkIGxpdGVyYWxzIiwgbGVuZ3RoX3JlYWQ6ICJbYm9vbGVhbi9TXSB3aGV0aGVyIGxlbmd0aCBwcm9wZXJ0eSBvZiB0aGlzIGZ1bmN0aW9uIGlzIGFjY2Vzc2VkIiwgcmVzdDogIlsoQVNUX0Rlc3RydWN0dXJlZHxBU1RfU3ltYm9sRnVuYXJnKT9dIHJlc3QgcGFyYW1ldGVyLCBvciBudWxsIGlmIGFic2VudCIsIHVzZXNfYXJndW1lbnRzOiAiW2Jvb2xlYW58bnVtYmVyL1NdIHdoZXRoZXIgdGhpcyBmdW5jdGlvbiBhY2Nlc3NlcyB0aGUgYXJndW1lbnRzIGFycmF5IiB9LCBlYWNoX2FyZ25hbWU6IGZ1bmN0aW9uIGVhY2hfYXJnbmFtZSh0KSB7dmFyIG4gPSBuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSA/IChlLm5hbWUud2FsayhuKSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwgPyAoZS52YWx1ZS53YWxrKG4pLCAhMCkgOiB2b2lkIChlIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZyAmJiB0KGUpKTt9KTt0aGlzLmFyZ25hbWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLndhbGsobik7fSksIHRoaXMucmVzdCAmJiB0aGlzLnJlc3Qud2FsayhuKTt9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gcHJvcF9lcXVhbHModGhpcy5yZXN0LCBlLnJlc3QpICYmIHByb3BfZXF1YWxzKHRoaXMubmFtZSwgZS5uYW1lKSAmJiBwcm9wX2VxdWFscyh0aGlzLnZhbHVlLCBlLnZhbHVlKSAmJiBhbGxfZXF1YWxzKHRoaXMuYXJnbmFtZXMsIGUuYXJnbmFtZXMpICYmIGFsbF9lcXVhbHModGhpcy5ib2R5LCBlLmJvZHkpO30sIHdhbGs6IGZ1bmN0aW9uIHdhbGsodCkge3ZhciBlID0gdGhpczt0LnZpc2l0KGUsIGZ1bmN0aW9uICgpIHtlLm5hbWUgJiYgZS5uYW1lLndhbGsodCksIGUuYXJnbmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2Uud2Fsayh0KTt9KSwgZS5yZXN0ICYmIGUucmVzdC53YWxrKHQpLCB3YWxrX2JvZHkoZSwgdCk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCJMYW1iZGEiID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9MYW1iZGEiKTt0aGlzLmFyZ25hbWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHt2YWxpZGF0ZV9kZXN0cnVjdHVyZWQoZSwgZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZykpIHRocm93IG5ldyBFcnJvcigiYXJnbmFtZXMgbXVzdCBiZSBBU1RfU3ltYm9sRnVuYXJnW10iKTt9LCAhMCk7fSksIG51bGwgIT0gdGhpcy5yZXN0ICYmIHZhbGlkYXRlX2Rlc3RydWN0dXJlZCh0aGlzLnJlc3QsIGZ1bmN0aW9uIChlKSB7aWYgKCEoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcpKSB0aHJvdyBuZXcgRXJyb3IoInJlc3QgbXVzdCBiZSBBU1RfU3ltYm9sRnVuYXJnIik7fSk7fSB9LCBBU1RfU2NvcGUpLEFTVF9BY2Nlc3NvciA9IERFRk5PREUoIkFjY2Vzc29yIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkEgZ2V0dGVyL3NldHRlciBmdW5jdGlvbiIsIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmIChudWxsICE9IHRoaXMubmFtZSkgdGhyb3cgbmV3IEVycm9yKCJuYW1lIG11c3QgYmUgbnVsbCIpO30gfSwgQVNUX0xhbWJkYSksQVNUX0xhbWJkYUV4cHJlc3Npb24gPSBERUZOT0RFKCJMYW1iZGFFeHByZXNzaW9uIiwgImlubGluZWQiLCB7ICRkb2N1bWVudGF0aW9uOiAiQmFzZSBjbGFzcyBmb3IgZnVuY3Rpb24gZXhwcmVzc2lvbnMiLCAkcHJvcGRvYzogeyBpbmxpbmVkOiAiW2Jvb2xlYW4vU10gd2hldGhlciB0aGlzIGZ1bmN0aW9uIGhhcyBiZWVuIGlubGluZWQiIH0sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiTGFtYmRhRXhwcmVzc2lvbiIgPT0gdGhpcy5UWVBFKSB0aHJvdyBuZXcgRXJyb3IoInNob3VsZCBub3QgaW5zdGFudGlhdGUgQVNUX0xhbWJkYUV4cHJlc3Npb24iKTt9IH0sIEFTVF9MYW1iZGEpO2Z1bmN0aW9uIGlzX2Fycm93KGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9BcnJvdyB8fCBlIGluc3RhbmNlb2YgQVNUX0FzeW5jQXJyb3c7fWZ1bmN0aW9uIGlzX2FzeW5jKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9Bc3luY0Fycm93IHx8IGUgaW5zdGFuY2VvZiBBU1RfQXN5bmNEZWZ1biB8fCBlIGluc3RhbmNlb2YgQVNUX0FzeW5jRnVuY3Rpb24gfHwgZSBpbnN0YW5jZW9mIEFTVF9Bc3luY0dlbmVyYXRvckRlZnVuIHx8IGUgaW5zdGFuY2VvZiBBU1RfQXN5bmNHZW5lcmF0b3JGdW5jdGlvbjt9ZnVuY3Rpb24gaXNfZ2VuZXJhdG9yKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9Bc3luY0dlbmVyYXRvckRlZnVuIHx8IGUgaW5zdGFuY2VvZiBBU1RfQXN5bmNHZW5lcmF0b3JGdW5jdGlvbiB8fCBlIGluc3RhbmNlb2YgQVNUX0dlbmVyYXRvckRlZnVuIHx8IGUgaW5zdGFuY2VvZiBBU1RfR2VuZXJhdG9yRnVuY3Rpb247fWZ1bmN0aW9uIHdhbGtfbGFtYmRhKGUsIHQpIHtpc19hcnJvdyhlKSAmJiBlLnZhbHVlID8gZS52YWx1ZS53YWxrKHQpIDogd2Fsa19ib2R5KGUsIHQpO312YXIgQVNUX0Fycm93ID0gREVGTk9ERSgiQXJyb3ciLCAidmFsdWUiLCB7ICRkb2N1bWVudGF0aW9uOiAiQW4gYXJyb3cgZnVuY3Rpb24gZXhwcmVzc2lvbiIsICRwcm9wZG9jOiB7IHZhbHVlOiAiW0FTVF9Ob2RlP10gc2ltcGxlIHJldHVybiBleHByZXNzaW9uLCBvciBudWxsIGlmIHVzaW5nIGZ1bmN0aW9uIGJvZHkuIiB9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKHQpIHt2YXIgZSA9IHRoaXM7dC52aXNpdChlLCBmdW5jdGlvbiAoKSB7ZS5hcmduYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKHQpO30pLCBlLnJlc3QgJiYgZS5yZXN0LndhbGsodCksIGUudmFsdWUgPyBlLnZhbHVlLndhbGsodCkgOiB3YWxrX2JvZHkoZSwgdCk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKG51bGwgIT0gdGhpcy5uYW1lKSB0aHJvdyBuZXcgRXJyb3IoIm5hbWUgbXVzdCBiZSBudWxsIik7aWYgKHRoaXMudXNlc19hcmd1bWVudHMpIHRocm93IG5ldyBFcnJvcigidXNlc19hcmd1bWVudHMgbXVzdCBiZSBmYWxzZSIpO2lmIChudWxsICE9IHRoaXMudmFsdWUgJiYgKG11c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAidmFsdWUiKSwgdGhpcy5ib2R5Lmxlbmd0aCkpIHRocm93IG5ldyBFcnJvcigiYm9keSBtdXN0IGJlIGVtcHR5IGlmIHZhbHVlIGV4aXN0cyIpO30gfSwgQVNUX0xhbWJkYUV4cHJlc3Npb24pLEFTVF9Bc3luY0Fycm93ID0gREVGTk9ERSgiQXN5bmNBcnJvdyIsICJ2YWx1ZSIsIHsgJGRvY3VtZW50YXRpb246ICJBbiBhc3luY2hyb25vdXMgYXJyb3cgZnVuY3Rpb24gZXhwcmVzc2lvbiIsICRwcm9wZG9jOiB7IHZhbHVlOiAiW0FTVF9Ob2RlP10gc2ltcGxlIHJldHVybiBleHByZXNzaW9uLCBvciBudWxsIGlmIHVzaW5nIGZ1bmN0aW9uIGJvZHkuIiB9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKHQpIHt2YXIgZSA9IHRoaXM7dC52aXNpdChlLCBmdW5jdGlvbiAoKSB7ZS5hcmduYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKHQpO30pLCBlLnJlc3QgJiYgZS5yZXN0LndhbGsodCksIGUudmFsdWUgPyBlLnZhbHVlLndhbGsodCkgOiB3YWxrX2JvZHkoZSwgdCk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKG51bGwgIT0gdGhpcy5uYW1lKSB0aHJvdyBuZXcgRXJyb3IoIm5hbWUgbXVzdCBiZSBudWxsIik7aWYgKHRoaXMudXNlc19hcmd1bWVudHMpIHRocm93IG5ldyBFcnJvcigidXNlc19hcmd1bWVudHMgbXVzdCBiZSBmYWxzZSIpO2lmIChudWxsICE9IHRoaXMudmFsdWUgJiYgKG11c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAidmFsdWUiKSwgdGhpcy5ib2R5Lmxlbmd0aCkpIHRocm93IG5ldyBFcnJvcigiYm9keSBtdXN0IGJlIGVtcHR5IGlmIHZhbHVlIGV4aXN0cyIpO30gfSwgQVNUX0xhbWJkYUV4cHJlc3Npb24pLEFTVF9Bc3luY0Z1bmN0aW9uID0gREVGTk9ERSgiQXN5bmNGdW5jdGlvbiIsICJuYW1lIiwgeyAkZG9jdW1lbnRhdGlvbjogIkFuIGFzeW5jaHJvbm91cyBmdW5jdGlvbiBleHByZXNzaW9uIiwgJHByb3Bkb2M6IHsgbmFtZTogIltBU1RfU3ltYm9sTGFtYmRhP10gdGhlIG5hbWUgb2YgdGhpcyBmdW5jdGlvbiwgb3IgbnVsbCBpZiBub3Qgc3BlY2lmaWVkIiB9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAobnVsbCAhPSB0aGlzLm5hbWUgJiYgISh0aGlzLm5hbWUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sTGFtYmRhKSkgdGhyb3cgbmV3IEVycm9yKCJuYW1lIG11c3QgYmUgQVNUX1N5bWJvbExhbWJkYSIpO30gfSwgQVNUX0xhbWJkYUV4cHJlc3Npb24pLEFTVF9Bc3luY0dlbmVyYXRvckZ1bmN0aW9uID0gREVGTk9ERSgiQXN5bmNHZW5lcmF0b3JGdW5jdGlvbiIsICJuYW1lIiwgeyAkZG9jdW1lbnRhdGlvbjogIkFuIGFzeW5jaHJvbm91cyBnZW5lcmF0b3IgZnVuY3Rpb24gZXhwcmVzc2lvbiIsICRwcm9wZG9jOiB7IG5hbWU6ICJbQVNUX1N5bWJvbExhbWJkYT9dIHRoZSBuYW1lIG9mIHRoaXMgZnVuY3Rpb24sIG9yIG51bGwgaWYgbm90IHNwZWNpZmllZCIgfSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKG51bGwgIT0gdGhpcy5uYW1lICYmICEodGhpcy5uYW1lIGluc3RhbmNlb2YgQVNUX1N5bWJvbExhbWJkYSkpIHRocm93IG5ldyBFcnJvcigibmFtZSBtdXN0IGJlIEFTVF9TeW1ib2xMYW1iZGEiKTt9IH0sIEFTVF9MYW1iZGFFeHByZXNzaW9uKSxBU1RfRnVuY3Rpb24gPSBERUZOT0RFKCJGdW5jdGlvbiIsICJuYW1lIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgZnVuY3Rpb24gZXhwcmVzc2lvbiIsICRwcm9wZG9jOiB7IG5hbWU6ICJbQVNUX1N5bWJvbExhbWJkYT9dIHRoZSBuYW1lIG9mIHRoaXMgZnVuY3Rpb24sIG9yIG51bGwgaWYgbm90IHNwZWNpZmllZCIgfSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKG51bGwgIT0gdGhpcy5uYW1lICYmICEodGhpcy5uYW1lIGluc3RhbmNlb2YgQVNUX1N5bWJvbExhbWJkYSkpIHRocm93IG5ldyBFcnJvcigibmFtZSBtdXN0IGJlIEFTVF9TeW1ib2xMYW1iZGEiKTt9IH0sIEFTVF9MYW1iZGFFeHByZXNzaW9uKSxBU1RfR2VuZXJhdG9yRnVuY3Rpb24gPSBERUZOT0RFKCJHZW5lcmF0b3JGdW5jdGlvbiIsICJuYW1lIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgZ2VuZXJhdG9yIGZ1bmN0aW9uIGV4cHJlc3Npb24iLCAkcHJvcGRvYzogeyBuYW1lOiAiW0FTVF9TeW1ib2xMYW1iZGE/XSB0aGUgbmFtZSBvZiB0aGlzIGZ1bmN0aW9uLCBvciBudWxsIGlmIG5vdCBzcGVjaWZpZWQiIH0sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmIChudWxsICE9IHRoaXMubmFtZSAmJiAhKHRoaXMubmFtZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xMYW1iZGEpKSB0aHJvdyBuZXcgRXJyb3IoIm5hbWUgbXVzdCBiZSBBU1RfU3ltYm9sTGFtYmRhIik7fSB9LCBBU1RfTGFtYmRhRXhwcmVzc2lvbiksQVNUX0xhbWJkYURlZmluaXRpb24gPSBERUZOT0RFKCJMYW1iZGFEZWZpbml0aW9uIiwgImlubGluZWQgbmFtZSIsIHsgJGRvY3VtZW50YXRpb246ICJCYXNlIGNsYXNzIGZvciBmdW5jdGlvbiBkZWZpbml0aW9ucyIsICRwcm9wZG9jOiB7IGlubGluZWQ6ICJbYm9vbGVhbi9TXSB3aGV0aGVyIHRoaXMgZnVuY3Rpb24gaGFzIGJlZW4gaW5saW5lZCIsIG5hbWU6ICJbQVNUX1N5bWJvbERlZnVuXSB0aGUgbmFtZSBvZiB0aGlzIGZ1bmN0aW9uIiB9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIkxhbWJkYURlZmluaXRpb24iID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9MYW1iZGFEZWZpbml0aW9uIik7aWYgKCEodGhpcy5uYW1lIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlZnVuKSkgdGhyb3cgbmV3IEVycm9yKCJuYW1lIG11c3QgYmUgQVNUX1N5bWJvbERlZnVuIik7fSB9LCBBU1RfTGFtYmRhKSxBU1RfQXN5bmNEZWZ1biA9IERFRk5PREUoIkFzeW5jRGVmdW4iLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQW4gYXN5bmNocm9ub3VzIGZ1bmN0aW9uIGRlZmluaXRpb24iIH0sIEFTVF9MYW1iZGFEZWZpbml0aW9uKSxBU1RfQXN5bmNHZW5lcmF0b3JEZWZ1biA9IERFRk5PREUoIkFzeW5jR2VuZXJhdG9yRGVmdW4iLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQW4gYXN5bmNocm9ub3VzIGdlbmVyYXRvciBmdW5jdGlvbiBkZWZpbml0aW9uIiB9LCBBU1RfTGFtYmRhRGVmaW5pdGlvbiksQVNUX0RlZnVuID0gREVGTk9ERSgiRGVmdW4iLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBmdW5jdGlvbiBkZWZpbml0aW9uIiB9LCBBU1RfTGFtYmRhRGVmaW5pdGlvbiksQVNUX0dlbmVyYXRvckRlZnVuID0gREVGTk9ERSgiR2VuZXJhdG9yRGVmdW4iLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBnZW5lcmF0b3IgZnVuY3Rpb24gZGVmaW5pdGlvbiIgfSwgQVNUX0xhbWJkYURlZmluaXRpb24pLEFTVF9DbGFzcyA9IERFRk5PREUoIkNsYXNzIiwgImV4dGVuZHMgbmFtZSBwcm9wZXJ0aWVzIiwgeyAkZG9jdW1lbnRhdGlvbjogIkJhc2UgY2xhc3MgZm9yIGNsYXNzIGxpdGVyYWxzIiwgJHByb3Bkb2M6IHsgZXh0ZW5kczogIltBU1RfTm9kZT9dIHRoZSBzdXBlciBjbGFzcywgb3IgbnVsbCBpZiBub3Qgc3BlY2lmaWVkIiwgcHJvcGVydGllczogIltBU1RfQ2xhc3NQcm9wZXJ0eSpdIGFycmF5IG9mIGNsYXNzIHByb3BlcnRpZXMiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiBwcm9wX2VxdWFscyh0aGlzLm5hbWUsIGUubmFtZSkgJiYgcHJvcF9lcXVhbHModGhpcy5leHRlbmRzLCBlLmV4dGVuZHMpICYmIGFsbF9lcXVhbHModGhpcy5wcm9wZXJ0aWVzLCBlLnByb3BlcnRpZXMpO30sIHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUoZSkge3JldHVybiBlID8gdGhpcyA6IHRoaXMucGFyZW50X3Njb3BlLnJlc29sdmUoKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKHQpIHt2YXIgZSA9IHRoaXM7dC52aXNpdChlLCBmdW5jdGlvbiAoKSB7ZS5uYW1lICYmIGUubmFtZS53YWxrKHQpLCBlLmV4dGVuZHMgJiYgZS5leHRlbmRzLndhbGsodCksIGUucHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKHQpO30pO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiQ2xhc3MiID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9DbGFzcyIpO251bGwgIT0gdGhpcy5leHRlbmRzICYmIG11c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAiZXh0ZW5kcyIpLCB0aGlzLnByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2lmICghKGUgaW5zdGFuY2VvZiBBU1RfQ2xhc3NQcm9wZXJ0eSkpIHRocm93IG5ldyBFcnJvcigicHJvcGVydGllcyBtdXN0IGNvbnRhaW4gQVNUX0NsYXNzUHJvcGVydHkiKTt9KTt9IH0sIEFTVF9CbG9ja1Njb3BlKSxBU1RfRGVmQ2xhc3MgPSBERUZOT0RFKCJEZWZDbGFzcyIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGNsYXNzIGRlZmluaXRpb24iLCAkcHJvcGRvYzogeyBuYW1lOiAiW0FTVF9TeW1ib2xEZWZDbGFzc10gdGhlIG5hbWUgb2YgdGhpcyBjbGFzcyIgfSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCEodGhpcy5uYW1lIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlZkNsYXNzKSkgdGhyb3cgbmV3IEVycm9yKCJuYW1lIG11c3QgYmUgQVNUX1N5bWJvbERlZkNsYXNzIik7fSB9LCBBU1RfQ2xhc3MpLEFTVF9DbGFzc0V4cHJlc3Npb24gPSBERUZOT0RFKCJDbGFzc0V4cHJlc3Npb24iLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBjbGFzcyBleHByZXNzaW9uIiwgJHByb3Bkb2M6IHsgbmFtZTogIltBU1RfU3ltYm9sQ2xhc3M/XSB0aGUgbmFtZSBvZiB0aGlzIGNsYXNzLCBvciBudWxsIGlmIG5vdCBzcGVjaWZpZWQiIH0sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmIChudWxsICE9IHRoaXMubmFtZSAmJiAhKHRoaXMubmFtZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xDbGFzcykpIHRocm93IG5ldyBFcnJvcigibmFtZSBtdXN0IGJlIEFTVF9TeW1ib2xDbGFzcyIpO30gfSwgQVNUX0NsYXNzKSxBU1RfQ2xhc3NQcm9wZXJ0eSA9IERFRk5PREUoIkNsYXNzUHJvcGVydHkiLCAia2V5IHByaXZhdGUgc3RhdGljIHZhbHVlIiwgeyAkZG9jdW1lbnRhdGlvbjogIkJhc2UgY2xhc3MgZm9yIGBjbGFzc2AgcHJvcGVydGllcyIsICRwcm9wZG9jOiB7IGtleTogIltzdHJpbmd8QVNUX05vZGU/XSBwcm9wZXJ0eSBuYW1lIChBU1RfTm9kZSBmb3IgY29tcHV0ZWQgcHJvcGVydHksIG51bGwgZm9yIGluaXRpYWxpemF0aW9uIGJsb2NrKSIsIHByaXZhdGU6ICJbYm9vbGVhbl0gd2hldGhlciB0aGlzIGlzIGEgcHJpdmF0ZSBwcm9wZXJ0eSIsIHN0YXRpYzogIltib29sZWFuXSB3aGV0aGVyIHRoaXMgaXMgYSBzdGF0aWMgcHJvcGVydHkiLCB2YWx1ZTogIltBU1RfTm9kZT9dIHByb3BlcnR5IHZhbHVlIChBU1RfQWNjZXNzb3IgZm9yIGdldHRlcnMvc2V0dGVycywgQVNUX0xhbWJkYUV4cHJlc3Npb24gZm9yIG1ldGhvZHMsIG51bGwgaWYgbm90IHNwZWNpZmllZCBmb3IgZmllbGRzKSIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuICF0aGlzLnByaXZhdGUgPT0gIWUucHJpdmF0ZSAmJiAhdGhpcy5zdGF0aWMgPT0gIWUuc3RhdGljICYmIHByb3BfZXF1YWxzKHRoaXMua2V5LCBlLmtleSkgJiYgcHJvcF9lcXVhbHModGhpcy52YWx1ZSwgZS52YWx1ZSk7fSwgd2FsazogZnVuY3Rpb24gd2FsayhlKSB7dmFyIHQgPSB0aGlzO2UudmlzaXQodCwgZnVuY3Rpb24gKCkge3Qua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgJiYgdC5rZXkud2FsayhlKSwgdC52YWx1ZSAmJiB0LnZhbHVlLndhbGsoZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCJDbGFzc1Byb3BlcnR5IiA9PSB0aGlzLlRZUEUpIHRocm93IG5ldyBFcnJvcigic2hvdWxkIG5vdCBpbnN0YW50aWF0ZSBBU1RfQ2xhc3NQcm9wZXJ0eSIpO2lmICh0aGlzIGluc3RhbmNlb2YgQVNUX0NsYXNzSW5pdCkge2lmIChudWxsICE9IHRoaXMua2V5KSB0aHJvdyBuZXcgRXJyb3IoImtleSBtdXN0IGJlIG51bGwiKTt9IGVsc2UgaWYgKCJzdHJpbmciICE9IHR5cGVvZiB0aGlzLmtleSkge2lmICghKHRoaXMua2V5IGluc3RhbmNlb2YgQVNUX05vZGUpKSB0aHJvdyBuZXcgRXJyb3IoImtleSBtdXN0IGJlIHN0cmluZyBvciBBU1RfTm9kZSIpO2lmICh0aGlzLnByaXZhdGUpIHRocm93IG5ldyBFcnJvcigiY29tcHV0ZWQga2V5IGNhbm5vdCBiZSBwcml2YXRlIik7bXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJrZXkiKTt9IGVsc2UgaWYgKHRoaXMucHJpdmF0ZSAmJiAhL14jLy50ZXN0KHRoaXMua2V5KSkgdGhyb3cgbmV3IEVycm9yKCJwcml2YXRlIGtleSBtdXN0IHByZWZpeCB3aXRoICMiKTtpZiAobnVsbCAhPSB0aGlzLnZhbHVlICYmICEodGhpcy52YWx1ZSBpbnN0YW5jZW9mIEFTVF9Ob2RlKSkgdGhyb3cgbmV3IEVycm9yKCJ2YWx1ZSBtdXN0IGJlIEFTVF9Ob2RlIik7fSB9KSxBU1RfQ2xhc3NGaWVsZCA9IERFRk5PREUoIkNsYXNzRmllbGQiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBgY2xhc3NgIGZpZWxkIiwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7bnVsbCAhPSB0aGlzLnZhbHVlICYmIG11c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAidmFsdWUiKTt9IH0sIEFTVF9DbGFzc1Byb3BlcnR5KSxBU1RfQ2xhc3NHZXR0ZXIgPSBERUZOT0RFKCJDbGFzc0dldHRlciIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGBjbGFzc2AgZ2V0dGVyIiwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCEodGhpcy52YWx1ZSBpbnN0YW5jZW9mIEFTVF9BY2Nlc3NvcikpIHRocm93IG5ldyBFcnJvcigidmFsdWUgbXVzdCBiZSBBU1RfQWNjZXNzb3IiKTt9IH0sIEFTVF9DbGFzc1Byb3BlcnR5KSxBU1RfQ2xhc3NTZXR0ZXIgPSBERUZOT0RFKCJDbGFzc1NldHRlciIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGBjbGFzc2Agc2V0dGVyIiwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCEodGhpcy52YWx1ZSBpbnN0YW5jZW9mIEFTVF9BY2Nlc3NvcikpIHRocm93IG5ldyBFcnJvcigidmFsdWUgbXVzdCBiZSBBU1RfQWNjZXNzb3IiKTt9IH0sIEFTVF9DbGFzc1Byb3BlcnR5KSxBU1RfQ2xhc3NNZXRob2QgPSBERUZOT0RFKCJDbGFzc01ldGhvZCIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGBjbGFzc2AgbWV0aG9kIiwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCEodGhpcy52YWx1ZSBpbnN0YW5jZW9mIEFTVF9MYW1iZGFFeHByZXNzaW9uKSkgdGhyb3cgbmV3IEVycm9yKCJ2YWx1ZSBtdXN0IGJlIEFTVF9MYW1iZGFFeHByZXNzaW9uIik7aWYgKGlzX2Fycm93KHRoaXMudmFsdWUpKSB0aHJvdyBuZXcgRXJyb3IoInZhbHVlIGNhbm5vdCBiZSBBU1RfQXJyb3cgb3IgQVNUX0FzeW5jQXJyb3ciKTtpZiAobnVsbCAhPSB0aGlzLnZhbHVlLm5hbWUpIHRocm93IG5ldyBFcnJvcigibmFtZSBvZiBjbGFzcyBtZXRob2QncyBsYW1iZGEgbXVzdCBiZSBudWxsIik7fSB9LCBBU1RfQ2xhc3NQcm9wZXJ0eSksQVNUX0NsYXNzSW5pdCA9IERFRk5PREUoIkNsYXNzSW5pdCIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGBjbGFzc2Agc3RhdGljIGluaXRpYWxpemF0aW9uIGJsb2NrIiwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCF0aGlzLnN0YXRpYykgdGhyb3cgbmV3IEVycm9yKCJzdGF0aWMgbXVzdCBiZSB0cnVlIik7aWYgKCEodGhpcy52YWx1ZSBpbnN0YW5jZW9mIEFTVF9DbGFzc0luaXRCbG9jaykpIHRocm93IG5ldyBFcnJvcigidmFsdWUgbXVzdCBiZSBBU1RfQ2xhc3NJbml0QmxvY2siKTt9LCBpbml0aWFsaXplOiBmdW5jdGlvbiBpbml0aWFsaXplKCkge3RoaXMuc3RhdGljID0gITA7fSB9LCBBU1RfQ2xhc3NQcm9wZXJ0eSksQVNUX0p1bXAgPSBERUZOT0RFKCJKdW1wIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkJhc2UgY2xhc3MgZm9yIOKAnGp1bXBz4oCdIChmb3Igbm93IHRoYXQncyBgcmV0dXJuYCwgYHRocm93YCwgYGJyZWFrYCBhbmQgYGNvbnRpbnVlYCkiLCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIkp1bXAiID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9KdW1wIik7fSB9LCBBU1RfU3RhdGVtZW50KSxBU1RfRXhpdCA9IERFRk5PREUoIkV4aXQiLCAidmFsdWUiLCB7ICRkb2N1bWVudGF0aW9uOiAiQmFzZSBjbGFzcyBmb3Ig4oCcZXhpdHPigJ0gKGByZXR1cm5gIGFuZCBgdGhyb3dgKSIsICRwcm9wZG9jOiB7IHZhbHVlOiAiW0FTVF9Ob2RlP10gdGhlIHZhbHVlIHJldHVybmVkIG9yIHRocm93biBieSB0aGlzIHN0YXRlbWVudDsgY291bGQgYmUgbnVsbCBmb3IgQVNUX1JldHVybiIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHByb3BfZXF1YWxzKHRoaXMudmFsdWUsIGUudmFsdWUpO30sIHdhbGs6IGZ1bmN0aW9uIHdhbGsoZSkge3ZhciB0ID0gdGhpcztlLnZpc2l0KHQsIGZ1bmN0aW9uICgpIHt0LnZhbHVlICYmIHQudmFsdWUud2FsayhlKTt9KTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIkV4aXQiID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9FeGl0Iik7fSB9LCBBU1RfSnVtcCksQVNUX1JldHVybiA9IERFRk5PREUoIlJldHVybiIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGByZXR1cm5gIHN0YXRlbWVudCIsIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge251bGwgIT0gdGhpcy52YWx1ZSAmJiBtdXN0X2JlX2V4cHJlc3Npb24odGhpcywgInZhbHVlIik7fSB9LCBBU1RfRXhpdCksQVNUX1Rocm93ID0gREVGTk9ERSgiVGhyb3ciLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBgdGhyb3dgIHN0YXRlbWVudCIsIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge211c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAidmFsdWUiKTt9IH0sIEFTVF9FeGl0KSxBU1RfTG9vcENvbnRyb2wgPSBERUZOT0RFKCJMb29wQ29udHJvbCIsICJsYWJlbCIsIHsgJGRvY3VtZW50YXRpb246ICJCYXNlIGNsYXNzIGZvciBsb29wIGNvbnRyb2wgc3RhdGVtZW50cyAoYGJyZWFrYCBhbmQgYGNvbnRpbnVlYCkiLCAkcHJvcGRvYzogeyBsYWJlbDogIltBU1RfTGFiZWxSZWY/XSB0aGUgbGFiZWwsIG9yIG51bGwgaWYgbm9uZSIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHByb3BfZXF1YWxzKHRoaXMubGFiZWwsIGUubGFiZWwpO30sIHdhbGs6IGZ1bmN0aW9uIHdhbGsoZSkge3ZhciB0ID0gdGhpcztlLnZpc2l0KHQsIGZ1bmN0aW9uICgpIHt0LmxhYmVsICYmIHQubGFiZWwud2FsayhlKTt9KTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIkxvb3BDb250cm9sIiA9PSB0aGlzLlRZUEUpIHRocm93IG5ldyBFcnJvcigic2hvdWxkIG5vdCBpbnN0YW50aWF0ZSBBU1RfTG9vcENvbnRyb2wiKTtpZiAobnVsbCAhPSB0aGlzLmxhYmVsICYmICEodGhpcy5sYWJlbCBpbnN0YW5jZW9mIEFTVF9MYWJlbFJlZikpIHRocm93IG5ldyBFcnJvcigibGFiZWwgbXVzdCBiZSBBU1RfTGFiZWxSZWYiKTt9IH0sIEFTVF9KdW1wKSxBU1RfQnJlYWsgPSBERUZOT0RFKCJCcmVhayIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGBicmVha2Agc3RhdGVtZW50IiB9LCBBU1RfTG9vcENvbnRyb2wpLEFTVF9Db250aW51ZSA9IERFRk5PREUoIkNvbnRpbnVlIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkEgYGNvbnRpbnVlYCBzdGF0ZW1lbnQiIH0sIEFTVF9Mb29wQ29udHJvbCksQVNUX0lmID0gREVGTk9ERSgiSWYiLCAiY29uZGl0aW9uIGFsdGVybmF0aXZlIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgYGlmYCBzdGF0ZW1lbnQiLCAkcHJvcGRvYzogeyBjb25kaXRpb246ICJbQVNUX05vZGVdIHRoZSBgaWZgIGNvbmRpdGlvbiIsIGFsdGVybmF0aXZlOiAiW0FTVF9TdGF0ZW1lbnQ/XSB0aGUgYGVsc2VgIHBhcnQsIG9yIG51bGwgaWYgbm90IHByZXNlbnQiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiB0aGlzLmJvZHkuZXF1YWxzKGUuYm9keSkgJiYgdGhpcy5jb25kaXRpb24uZXF1YWxzKGUuY29uZGl0aW9uKSAmJiBwcm9wX2VxdWFscyh0aGlzLmFsdGVybmF0aXZlLCBlLmFsdGVybmF0aXZlKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5jb25kaXRpb24ud2FsayhlKSwgdC5ib2R5LndhbGsoZSksIHQuYWx0ZXJuYXRpdmUgJiYgdC5hbHRlcm5hdGl2ZS53YWxrKGUpO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmIChtdXN0X2JlX2V4cHJlc3Npb24odGhpcywgImNvbmRpdGlvbiIpLCBudWxsICE9IHRoaXMuYWx0ZXJuYXRpdmUgJiYgIWlzX3N0YXRlbWVudCh0aGlzLmFsdGVybmF0aXZlKSkgdGhyb3cgbmV3IEVycm9yKCJhbHRlcm5hdGl2ZSBtdXN0IGJlIEFTVF9TdGF0ZW1lbnQiKTt9IH0sIEFTVF9TdGF0ZW1lbnRXaXRoQm9keSksQVNUX1N3aXRjaCA9IERFRk5PREUoIlN3aXRjaCIsICJleHByZXNzaW9uIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgYHN3aXRjaGAgc3RhdGVtZW50IiwgJHByb3Bkb2M6IHsgZXhwcmVzc2lvbjogIltBU1RfTm9kZV0gdGhlIGBzd2l0Y2hgIOKAnGRpc2NyaW1pbmFudOKAnSIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5lcXVhbHMoZS5leHByZXNzaW9uKSAmJiBhbGxfZXF1YWxzKHRoaXMuYm9keSwgZS5ib2R5KTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5leHByZXNzaW9uLndhbGsoZSksIHdhbGtfYm9keSh0LCBlKTt9KTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHttdXN0X2JlX2V4cHJlc3Npb24odGhpcywgImV4cHJlc3Npb24iKSwgdGhpcy5ib2R5LmZvckVhY2goZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1N3aXRjaEJyYW5jaCkpIHRocm93IG5ldyBFcnJvcigiYm9keSBtdXN0IGJlIEFTVF9Td2l0Y2hCcmFuY2hbXSIpO30pO30gfSwgQVNUX0Jsb2NrKSxBU1RfU3dpdGNoQnJhbmNoID0gREVGTk9ERSgiU3dpdGNoQnJhbmNoIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkJhc2UgY2xhc3MgZm9yIGBzd2l0Y2hgIGJyYW5jaGVzIiwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCJTd2l0Y2hCcmFuY2giID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9Td2l0Y2hCcmFuY2giKTt9IH0sIEFTVF9CbG9jayksQVNUX0RlZmF1bHQgPSBERUZOT0RFKCJEZWZhdWx0IiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkEgYGRlZmF1bHRgIHN3aXRjaCBicmFuY2giIH0sIEFTVF9Td2l0Y2hCcmFuY2gpLEFTVF9DYXNlID0gREVGTk9ERSgiQ2FzZSIsICJleHByZXNzaW9uIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgYGNhc2VgIHN3aXRjaCBicmFuY2giLCAkcHJvcGRvYzogeyBleHByZXNzaW9uOiAiW0FTVF9Ob2RlXSB0aGUgYGNhc2VgIGV4cHJlc3Npb24iIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiB0aGlzLmV4cHJlc3Npb24uZXF1YWxzKGUuZXhwcmVzc2lvbikgJiYgYWxsX2VxdWFscyh0aGlzLmJvZHksIGUuYm9keSk7fSwgd2FsazogZnVuY3Rpb24gd2FsayhlKSB7dmFyIHQgPSB0aGlzO2UudmlzaXQodCwgZnVuY3Rpb24gKCkge3QuZXhwcmVzc2lvbi53YWxrKGUpLCB3YWxrX2JvZHkodCwgZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7bXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJleHByZXNzaW9uIik7fSB9LCBBU1RfU3dpdGNoQnJhbmNoKSxBU1RfVHJ5ID0gREVGTk9ERSgiVHJ5IiwgImJjYXRjaCBiZmluYWxseSIsIHsgJGRvY3VtZW50YXRpb246ICJBIGB0cnlgIHN0YXRlbWVudCIsICRwcm9wZG9jOiB7IGJjYXRjaDogIltBU1RfQ2F0Y2g/XSB0aGUgY2F0Y2ggYmxvY2ssIG9yIG51bGwgaWYgbm90IHByZXNlbnQiLCBiZmluYWxseTogIltBU1RfRmluYWxseT9dIHRoZSBmaW5hbGx5IGJsb2NrLCBvciBudWxsIGlmIG5vdCBwcmVzZW50IiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gYWxsX2VxdWFscyh0aGlzLmJvZHksIGUuYm9keSkgJiYgcHJvcF9lcXVhbHModGhpcy5iY2F0Y2gsIGUuYmNhdGNoKSAmJiBwcm9wX2VxdWFscyh0aGlzLmJmaW5hbGx5LCBlLmJmaW5hbGx5KTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7d2Fsa19ib2R5KHQsIGUpLCB0LmJjYXRjaCAmJiB0LmJjYXRjaC53YWxrKGUpLCB0LmJmaW5hbGx5ICYmIHQuYmZpbmFsbHkud2FsayhlKTt9KTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAobnVsbCAhPSB0aGlzLmJjYXRjaCAmJiAhKHRoaXMuYmNhdGNoIGluc3RhbmNlb2YgQVNUX0NhdGNoKSkgdGhyb3cgbmV3IEVycm9yKCJiY2F0Y2ggbXVzdCBiZSBBU1RfQ2F0Y2giKTtpZiAobnVsbCAhPSB0aGlzLmJmaW5hbGx5ICYmICEodGhpcy5iZmluYWxseSBpbnN0YW5jZW9mIEFTVF9GaW5hbGx5KSkgdGhyb3cgbmV3IEVycm9yKCJiZmluYWxseSBtdXN0IGJlIEFTVF9GaW5hbGx5Iik7fSB9LCBBU1RfQmxvY2spLEFTVF9DYXRjaCA9IERFRk5PREUoIkNhdGNoIiwgImFyZ25hbWUiLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBgY2F0Y2hgIG5vZGU7IG9ubHkgbWFrZXMgc2Vuc2UgYXMgcGFydCBvZiBhIGB0cnlgIHN0YXRlbWVudCIsICRwcm9wZG9jOiB7IGFyZ25hbWU6ICJbKEFTVF9EZXN0cnVjdHVyZWR8QVNUX1N5bWJvbENhdGNoKT9dIHN5bWJvbCBmb3IgdGhlIGV4Y2VwdGlvbiwgb3IgbnVsbCBpZiBub3QgcHJlc2VudCIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHByb3BfZXF1YWxzKHRoaXMuYXJnbmFtZSwgZS5hcmduYW1lKSAmJiBhbGxfZXF1YWxzKHRoaXMuYm9keSwgZS5ib2R5KTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5hcmduYW1lICYmIHQuYXJnbmFtZS53YWxrKGUpLCB3YWxrX2JvZHkodCwgZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7bnVsbCAhPSB0aGlzLmFyZ25hbWUgJiYgdmFsaWRhdGVfZGVzdHJ1Y3R1cmVkKHRoaXMuYXJnbmFtZSwgZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1N5bWJvbENhdGNoKSkgdGhyb3cgbmV3IEVycm9yKCJhcmduYW1lIG11c3QgYmUgQVNUX1N5bWJvbENhdGNoIik7fSk7fSB9LCBBU1RfQmxvY2spLEFTVF9GaW5hbGx5ID0gREVGTk9ERSgiRmluYWxseSIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGBmaW5hbGx5YCBub2RlOyBvbmx5IG1ha2VzIHNlbnNlIGFzIHBhcnQgb2YgYSBgdHJ5YCBzdGF0ZW1lbnQiIH0sIEFTVF9CbG9jayksQVNUX0RlZmluaXRpb25zID0gREVGTk9ERSgiRGVmaW5pdGlvbnMiLCAiZGVmaW5pdGlvbnMiLCB7ICRkb2N1bWVudGF0aW9uOiAiQmFzZSBjbGFzcyBmb3IgYHZhcmAgbm9kZXMgKHZhcmlhYmxlIGRlY2xhcmF0aW9ucy9pbml0aWFsaXphdGlvbnMpIiwgJHByb3Bkb2M6IHsgZGVmaW5pdGlvbnM6ICJbQVNUX1ZhckRlZipdIGFycmF5IG9mIHZhcmlhYmxlIGRlZmluaXRpb25zIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gYWxsX2VxdWFscyh0aGlzLmRlZmluaXRpb25zLCBlLmRlZmluaXRpb25zKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKHQpIHt2YXIgZSA9IHRoaXM7dC52aXNpdChlLCBmdW5jdGlvbiAoKSB7ZS5kZWZpbml0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKHQpO30pO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiRGVmaW5pdGlvbnMiID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9EZWZpbml0aW9ucyIpO2lmICh0aGlzLmRlZmluaXRpb25zLmxlbmd0aCA8IDEpIHRocm93IG5ldyBFcnJvcigibXVzdCBoYXZlIGF0IGxlYXN0IG9uZSBkZWZpbml0aW9uIik7fSB9LCBBU1RfU3RhdGVtZW50KSxBU1RfQ29uc3QgPSBERUZOT0RFKCJDb25zdCIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGBjb25zdGAgc3RhdGVtZW50IiwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7dGhpcy5kZWZpbml0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7aWYgKCEoZSBpbnN0YW5jZW9mIEFTVF9WYXJEZWYpKSB0aHJvdyBuZXcgRXJyb3IoImRlZmluaXRpb25zIG11c3QgYmUgQVNUX1ZhckRlZltdIik7dmFsaWRhdGVfZGVzdHJ1Y3R1cmVkKGUubmFtZSwgZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1N5bWJvbENvbnN0KSkgdGhyb3cgbmV3IEVycm9yKCJuYW1lIG11c3QgYmUgQVNUX1N5bWJvbENvbnN0Iik7fSk7fSk7fSB9LCBBU1RfRGVmaW5pdGlvbnMpLEFTVF9MZXQgPSBERUZOT0RFKCJMZXQiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBgbGV0YCBzdGF0ZW1lbnQiLCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHt0aGlzLmRlZmluaXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1ZhckRlZikpIHRocm93IG5ldyBFcnJvcigiZGVmaW5pdGlvbnMgbXVzdCBiZSBBU1RfVmFyRGVmW10iKTt2YWxpZGF0ZV9kZXN0cnVjdHVyZWQoZS5uYW1lLCBmdW5jdGlvbiAoZSkge2lmICghKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sTGV0KSkgdGhyb3cgbmV3IEVycm9yKCJuYW1lIG11c3QgYmUgQVNUX1N5bWJvbExldCIpO30pO30pO30gfSwgQVNUX0RlZmluaXRpb25zKSxBU1RfVmFyID0gREVGTk9ERSgiVmFyIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkEgYHZhcmAgc3RhdGVtZW50IiwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7dGhpcy5kZWZpbml0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7aWYgKCEoZSBpbnN0YW5jZW9mIEFTVF9WYXJEZWYpKSB0aHJvdyBuZXcgRXJyb3IoImRlZmluaXRpb25zIG11c3QgYmUgQVNUX1ZhckRlZltdIik7dmFsaWRhdGVfZGVzdHJ1Y3R1cmVkKGUubmFtZSwgZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFZhcikpIHRocm93IG5ldyBFcnJvcigibmFtZSBtdXN0IGJlIEFTVF9TeW1ib2xWYXIiKTt9KTt9KTt9IH0sIEFTVF9EZWZpbml0aW9ucyksQVNUX1ZhckRlZiA9IERFRk5PREUoIlZhckRlZiIsICJuYW1lIHZhbHVlIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgdmFyaWFibGUgZGVjbGFyYXRpb247IG9ubHkgYXBwZWFycyBpbiBhIEFTVF9EZWZpbml0aW9ucyBub2RlIiwgJHByb3Bkb2M6IHsgbmFtZTogIltBU1RfRGVzdHJ1Y3R1cmVkfEFTVF9TeW1ib2xWYXJdIG5hbWUgb2YgdGhlIHZhcmlhYmxlIiwgdmFsdWU6ICJbQVNUX05vZGU/XSBpbml0aWFsaXplciwgb3IgbnVsbCBvZiB0aGVyZSdzIG5vIGluaXRpYWxpemVyIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gdGhpcy5uYW1lLmVxdWFscyhlLm5hbWUpICYmIHByb3BfZXF1YWxzKHRoaXMudmFsdWUsIGUudmFsdWUpO30sIHdhbGs6IGZ1bmN0aW9uIHdhbGsoZSkge3ZhciB0ID0gdGhpcztlLnZpc2l0KHQsIGZ1bmN0aW9uICgpIHt0Lm5hbWUud2FsayhlKSwgdC52YWx1ZSAmJiB0LnZhbHVlLndhbGsoZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7bnVsbCAhPSB0aGlzLnZhbHVlICYmIG11c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAidmFsdWUiKTt9IH0pLEFTVF9FeHBvcnREZWNsYXJhdGlvbiA9IERFRk5PREUoIkV4cG9ydERlY2xhcmF0aW9uIiwgImJvZHkiLCB7ICRkb2N1bWVudGF0aW9uOiAiQW4gYGV4cG9ydGAgc3RhdGVtZW50IiwgJHByb3Bkb2M6IHsgYm9keTogIltBU1RfRGVmQ2xhc3N8QVNUX0RlZmluaXRpb25zfEFTVF9MYW1iZGFEZWZpbml0aW9uXSB0aGUgc3RhdGVtZW50IHRvIGV4cG9ydCIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHRoaXMuYm9keS5lcXVhbHMoZS5ib2R5KTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5ib2R5LndhbGsoZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCEodGhpcy5ib2R5IGluc3RhbmNlb2YgQVNUX0RlZkNsYXNzIHx8IHRoaXMuYm9keSBpbnN0YW5jZW9mIEFTVF9EZWZpbml0aW9ucyB8fCB0aGlzLmJvZHkgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRGVmaW5pdGlvbikpIHRocm93IG5ldyBFcnJvcigiYm9keSBtdXN0IGJlIEFTVF9EZWZDbGFzcywgQVNUX0RlZmluaXRpb25zIG9yIEFTVF9MYW1iZGFEZWZpbml0aW9uIik7fSB9LCBBU1RfU3RhdGVtZW50KSxBU1RfRXhwb3J0RGVmYXVsdCA9IERFRk5PREUoIkV4cG9ydERlZmF1bHQiLCAiYm9keSIsIHsgJGRvY3VtZW50YXRpb246ICJBbiBgZXhwb3J0IGRlZmF1bHRgIHN0YXRlbWVudCIsICRwcm9wZG9jOiB7IGJvZHk6ICJbQVNUX05vZGVdIHRoZSBkZWZhdWx0IGV4cG9ydCIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHRoaXMuYm9keS5lcXVhbHMoZS5ib2R5KTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5ib2R5LndhbGsoZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7dGhpcy5ib2R5IGluc3RhbmNlb2YgQVNUX0RlZkNsYXNzIHx8IHRoaXMuYm9keSBpbnN0YW5jZW9mIEFTVF9MYW1iZGFEZWZpbml0aW9uIHx8IG11c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAiYm9keSIpO30gfSwgQVNUX1N0YXRlbWVudCksQVNUX0V4cG9ydEZvcmVpZ24gPSBERUZOT0RFKCJFeHBvcnRGb3JlaWduIiwgImFsaWFzZXMga2V5cyBwYXRoIiwgeyAkZG9jdW1lbnRhdGlvbjogIkFuIGBleHBvcnQgLi4uIGZyb20gJy4uLidgIHN0YXRlbWVudCIsICRwcm9wZG9jOiB7IGFsaWFzZXM6ICJbQVNUX1N0cmluZypdIGFycmF5IG9mIGFsaWFzZXMgdG8gZXhwb3J0Iiwga2V5czogIltBU1RfU3RyaW5nKl0gYXJyYXkgb2Yga2V5cyB0byBpbXBvcnQiLCBwYXRoOiAiW0FTVF9TdHJpbmddIHRoZSBwYXRoIHRvIGltcG9ydCBtb2R1bGUiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiB0aGlzLnBhdGguZXF1YWxzKGUucGF0aCkgJiYgYWxsX2VxdWFscyh0aGlzLmFsaWFzZXMsIGUuYWxpYXNlcykgJiYgYWxsX2VxdWFscyh0aGlzLmtleXMsIGUua2V5cyk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKHRoaXMuYWxpYXNlcy5sZW5ndGggIT0gdGhpcy5rZXlzLmxlbmd0aCkgdGhyb3cgbmV3IEVycm9yKCJhbGlhc2VzOmtleSBsZW5ndGggbWlzbWF0Y2g6ICIgKyB0aGlzLmFsaWFzZXMubGVuZ3RoICsgIiAhPSAiICsgdGhpcy5rZXlzLmxlbmd0aCk7aWYgKHRoaXMuYWxpYXNlcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7aWYgKCEoZSBpbnN0YW5jZW9mIEFTVF9TdHJpbmcpKSB0aHJvdyBuZXcgRXJyb3IoImFsaWFzZXMgbXVzdCBjb250YWluIEFTVF9TdHJpbmciKTt9KSwgdGhpcy5rZXlzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1N0cmluZykpIHRocm93IG5ldyBFcnJvcigia2V5cyBtdXN0IGNvbnRhaW4gQVNUX1N0cmluZyIpO30pLCAhKHRoaXMucGF0aCBpbnN0YW5jZW9mIEFTVF9TdHJpbmcpKSB0aHJvdyBuZXcgRXJyb3IoInBhdGggbXVzdCBiZSBBU1RfU3RyaW5nIik7fSB9LCBBU1RfU3RhdGVtZW50KSxBU1RfRXhwb3J0UmVmZXJlbmNlcyA9IERFRk5PREUoIkV4cG9ydFJlZmVyZW5jZXMiLCAicHJvcGVydGllcyIsIHsgJGRvY3VtZW50YXRpb246ICJBbiBgZXhwb3J0IHsgLi4uIH1gIHN0YXRlbWVudCIsICRwcm9wZG9jOiB7IHByb3BlcnRpZXM6ICJbQVNUX1N5bWJvbEV4cG9ydCpdIGFycmF5IG9mIGFsaWFzZXMgdG8gZXhwb3J0IiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gYWxsX2VxdWFscyh0aGlzLnByb3BlcnRpZXMsIGUucHJvcGVydGllcyk7fSwgd2FsazogZnVuY3Rpb24gd2Fsayh0KSB7dmFyIGUgPSB0aGlzO3QudmlzaXQoZSwgZnVuY3Rpb24gKCkge2UucHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKHQpO30pO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge3RoaXMucHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7aWYgKCEoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xFeHBvcnQpKSB0aHJvdyBuZXcgRXJyb3IoInByb3BlcnRpZXMgbXVzdCBjb250YWluIEFTVF9TeW1ib2xFeHBvcnQiKTt9KTt9IH0sIEFTVF9TdGF0ZW1lbnQpLEFTVF9JbXBvcnQgPSBERUZOT0RFKCJJbXBvcnQiLCAiYWxsIGRlZmF1bHQgcGF0aCBwcm9wZXJ0aWVzIiwgeyAkZG9jdW1lbnRhdGlvbjogIkFuIGBpbXBvcnRgIHN0YXRlbWVudCIsICRwcm9wZG9jOiB7IGFsbDogIltBU1RfU3ltYm9sSW1wb3J0P10gdGhlIGltcG9ydGVkIG5hbWVzcGFjZSwgb3IgbnVsbCBpZiBub3Qgc3BlY2lmaWVkIiwgZGVmYXVsdDogIltBU1RfU3ltYm9sSW1wb3J0P10gdGhlIGFsaWFzIGZvciBkZWZhdWx0IGBleHBvcnRgLCBvciBudWxsIGlmIG5vdCBzcGVjaWZpZWQiLCBwYXRoOiAiW0FTVF9TdHJpbmddIHRoZSBwYXRoIHRvIGltcG9ydCBtb2R1bGUiLCBwcm9wZXJ0aWVzOiAiWyhBU1RfU3ltYm9sSW1wb3J0Kik/XSBhcnJheSBvZiBhbGlhc2VzLCBvciBudWxsIGlmIG5vdCBzcGVjaWZpZWQiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiB0aGlzLnBhdGguZXF1YWxzKGUucGF0aCkgJiYgcHJvcF9lcXVhbHModGhpcy5hbGwsIGUuYWxsKSAmJiBwcm9wX2VxdWFscyh0aGlzLmRlZmF1bHQsIGUuZGVmYXVsdCkgJiYgIXRoaXMucHJvcGVydGllcyA9PSAhZS5wcm9wZXJ0aWVzICYmICghdGhpcy5wcm9wZXJ0aWVzIHx8IGFsbF9lcXVhbHModGhpcy5wcm9wZXJ0aWVzLCBlLnByb3BlcnRpZXMpKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKHQpIHt2YXIgZSA9IHRoaXM7dC52aXNpdChlLCBmdW5jdGlvbiAoKSB7ZS5hbGwgJiYgZS5hbGwud2Fsayh0KSwgZS5kZWZhdWx0ICYmIGUuZGVmYXVsdC53YWxrKHQpLCBlLnByb3BlcnRpZXMgJiYgZS5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLndhbGsodCk7fSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKG51bGwgIT0gdGhpcy5hbGwpIHtpZiAoISh0aGlzLmFsbCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xJbXBvcnQpKSB0aHJvdyBuZXcgRXJyb3IoImFsbCBtdXN0IGJlIEFTVF9TeW1ib2xJbXBvcnQiKTtpZiAobnVsbCAhPSB0aGlzLnByb3BlcnRpZXMpIHRocm93IG5ldyBFcnJvcigiY2Fubm90IGltcG9ydCBib3RoICogYW5kIHt9IGluIHRoZSBzYW1lIHN0YXRlbWVudCIpO31pZiAobnVsbCAhPSB0aGlzLmRlZmF1bHQpIHtpZiAoISh0aGlzLmRlZmF1bHQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sSW1wb3J0KSkgdGhyb3cgbmV3IEVycm9yKCJkZWZhdWx0IG11c3QgYmUgQVNUX1N5bWJvbEltcG9ydCIpO2lmICgiIiAhPT0gdGhpcy5kZWZhdWx0LmtleS52YWx1ZSkgdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIGRlZmF1bHQga2V5OiAiICsgdGhpcy5kZWZhdWx0LmtleS52YWx1ZSk7fWlmICghKHRoaXMucGF0aCBpbnN0YW5jZW9mIEFTVF9TdHJpbmcpKSB0aHJvdyBuZXcgRXJyb3IoInBhdGggbXVzdCBiZSBBU1RfU3RyaW5nIik7bnVsbCAhPSB0aGlzLnByb3BlcnRpZXMgJiYgdGhpcy5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1N5bWJvbEltcG9ydCkpIHRocm93IG5ldyBFcnJvcigicHJvcGVydGllcyBtdXN0IGNvbnRhaW4gQVNUX1N5bWJvbEltcG9ydCIpO30pO30gfSwgQVNUX1N0YXRlbWVudCksQVNUX0RlZmF1bHRWYWx1ZSA9IERFRk5PREUoIkRlZmF1bHRWYWx1ZSIsICJuYW1lIHZhbHVlIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgZGVmYXVsdCB2YWx1ZSBkZWNsYXJhdGlvbiIsICRwcm9wZG9jOiB7IG5hbWU6ICJbQVNUX0Rlc3RydWN0dXJlZHxBU1RfU3ltYm9sRGVjbGFyYXRpb25dIG5hbWUgb2YgdGhlIHZhcmlhYmxlIiwgdmFsdWU6ICJbQVNUX05vZGVdIHZhbHVlIHRvIGFzc2lnbiBpZiB2YXJpYWJsZSBpcyBgdW5kZWZpbmVkYCIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHRoaXMubmFtZS5lcXVhbHMoZS5uYW1lKSAmJiB0aGlzLnZhbHVlLmVxdWFscyhlLnZhbHVlKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5uYW1lLndhbGsoZSksIHQudmFsdWUud2FsayhlKTt9KTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHttdXN0X2JlX2V4cHJlc3Npb24odGhpcywgInZhbHVlIik7fSB9KTtmdW5jdGlvbiBtdXN0X2JlX2V4cHJlc3Npb25zKGUsIHQsIG4sIG8pIHtlW3RdLmZvckVhY2goZnVuY3Rpb24gKGUpIHt2YWxpZGF0ZV9leHByZXNzaW9uKGUsIHQsICEwLCBuLCBvKTt9KTt9dmFyIEFTVF9DYWxsID0gREVGTk9ERSgiQ2FsbCIsICJhcmdzIGV4cHJlc3Npb24gb3B0aW9uYWwgcHVyZSB0ZXJtaW5hbCIsIHsgJGRvY3VtZW50YXRpb246ICJBIGZ1bmN0aW9uIGNhbGwgZXhwcmVzc2lvbiIsICRwcm9wZG9jOiB7IGFyZ3M6ICJbQVNUX05vZGUqXSBhcnJheSBvZiBhcmd1bWVudHMiLCBleHByZXNzaW9uOiAiW0FTVF9Ob2RlXSBleHByZXNzaW9uIHRvIGludm9rZSBhcyBmdW5jdGlvbiIsIG9wdGlvbmFsOiAiW2Jvb2xlYW5dIHdoZXRoZXIgdGhlIGV4cHJlc3Npb24gaXMgb3B0aW9uYWwgY2hhaW5pbmciLCBwdXJlOiAiW2Jvb2xlYW4vU10gbWFya2VyIGZvciBzaWRlLWVmZmVjdC1mcmVlIGNhbGwgZXhwcmVzc2lvbiIsIHRlcm1pbmFsOiAiW2Jvb2xlYW5dIHdoZXRoZXIgdGhlIGNoYWluIGhhcyBlbmRlZCIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuICF0aGlzLm9wdGlvbmFsID09ICFlLm9wdGlvbmFsICYmIHRoaXMuZXhwcmVzc2lvbi5lcXVhbHMoZS5leHByZXNzaW9uKSAmJiBhbGxfZXF1YWxzKHRoaXMuYXJncywgZS5hcmdzKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKHQpIHt2YXIgZSA9IHRoaXM7dC52aXNpdChlLCBmdW5jdGlvbiAoKSB7ZS5leHByZXNzaW9uLndhbGsodCksIGUuYXJncy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKHQpO30pO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge211c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAiZXhwcmVzc2lvbiIpLCBtdXN0X2JlX2V4cHJlc3Npb25zKHRoaXMsICJhcmdzIiwgITApO30gfSksQVNUX05ldyA9IERFRk5PREUoIk5ldyIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBbiBvYmplY3QgaW5zdGFudGlhdGlvbi4gIERlcml2ZXMgZnJvbSBhIGZ1bmN0aW9uIGNhbGwgc2luY2UgaXQgaGFzIGV4YWN0bHkgdGhlIHNhbWUgcHJvcGVydGllcyIsIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICh0aGlzLm9wdGlvbmFsKSB0aHJvdyBuZXcgRXJyb3IoIm9wdGlvbmFsIG11c3QgYmUgZmFsc2UiKTtpZiAodGhpcy50ZXJtaW5hbCkgdGhyb3cgbmV3IEVycm9yKCJ0ZXJtaW5hbCBtdXN0IGJlIGZhbHNlIik7fSB9LCBBU1RfQ2FsbCksQVNUX1NlcXVlbmNlID0gREVGTk9ERSgiU2VxdWVuY2UiLCAiZXhwcmVzc2lvbnMiLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBzZXF1ZW5jZSBleHByZXNzaW9uIChjb21tYS1zZXBhcmF0ZWQgZXhwcmVzc2lvbnMpIiwgJHByb3Bkb2M6IHsgZXhwcmVzc2lvbnM6ICJbQVNUX05vZGUqXSBhcnJheSBvZiBleHByZXNzaW9ucyAoYXQgbGVhc3QgdHdvKSIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIGFsbF9lcXVhbHModGhpcy5leHByZXNzaW9ucywgZS5leHByZXNzaW9ucyk7fSwgd2FsazogZnVuY3Rpb24gd2Fsayh0KSB7dmFyIGUgPSB0aGlzO3QudmlzaXQoZSwgZnVuY3Rpb24gKCkge2UuZXhwcmVzc2lvbnMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2Uud2Fsayh0KTt9KTt9KTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAodGhpcy5leHByZXNzaW9ucy5sZW5ndGggPCAyKSB0aHJvdyBuZXcgRXJyb3IoImV4cHJlc3Npb25zIG11c3QgY29udGFpbiBtdWx0aXBsZSBlbGVtZW50cyIpO211c3RfYmVfZXhwcmVzc2lvbnModGhpcywgImV4cHJlc3Npb25zIik7fSB9KTtmdW5jdGlvbiByb290X2V4cHIoZSkge2ZvciAoOyBlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3M7KSBlID0gZS5leHByZXNzaW9uO3JldHVybiBlO312YXIgQVNUX1Byb3BBY2Nlc3MgPSBERUZOT0RFKCJQcm9wQWNjZXNzIiwgImV4cHJlc3Npb24gb3B0aW9uYWwgcHJvcGVydHkgdGVybWluYWwiLCB7ICRkb2N1bWVudGF0aW9uOiAnQmFzZSBjbGFzcyBmb3IgcHJvcGVydHkgYWNjZXNzIGV4cHJlc3Npb25zLCBpLmUuIGBhLmZvb2Agb3IgYGFbImZvbyJdYCcsICRwcm9wZG9jOiB7IGV4cHJlc3Npb246ICJbQVNUX05vZGVdIHRoZSDigJxjb250YWluZXLigJ0gZXhwcmVzc2lvbiIsIG9wdGlvbmFsOiAiW2Jvb2xlYW5dIHdoZXRoZXIgdGhlIGV4cHJlc3Npb24gaXMgb3B0aW9uYWwgY2hhaW5pbmciLCBwcm9wZXJ0eTogIltBU1RfTm9kZXxzdHJpbmddIHRoZSBwcm9wZXJ0eSB0byBhY2Nlc3MuICBGb3IgQVNUX0RvdCB0aGlzIGlzIGFsd2F5cyBhIHBsYWluIHN0cmluZywgd2hpbGUgZm9yIEFTVF9TdWIgaXQncyBhbiBhcmJpdHJhcnkgQVNUX05vZGUiLCB0ZXJtaW5hbDogIltib29sZWFuXSB3aGV0aGVyIHRoZSBjaGFpbiBoYXMgZW5kZWQiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiAhdGhpcy5vcHRpb25hbCA9PSAhZS5vcHRpb25hbCAmJiBwcm9wX2VxdWFscyh0aGlzLnByb3BlcnR5LCBlLnByb3BlcnR5KSAmJiB0aGlzLmV4cHJlc3Npb24uZXF1YWxzKGUuZXhwcmVzc2lvbik7fSwgZ2V0X3Byb3BlcnR5OiBmdW5jdGlvbiBnZXRfcHJvcGVydHkoKSB7dmFyIGUgPSB0aGlzLnByb3BlcnR5O3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0NvbnN0YW50ID8gZS52YWx1ZSA6IGUgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgInZvaWQiID09IGUub3BlcmF0b3IgJiYgZS5leHByZXNzaW9uIGluc3RhbmNlb2YgQVNUX0NvbnN0YW50ID8gdm9pZCAwIDogZTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIlByb3BBY2Nlc3MiID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9Qcm9wQWNjZXNzIik7bXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJleHByZXNzaW9uIik7fSB9KSxBU1RfRG90ID0gREVGTk9ERSgiRG90IiwgInF1b3RlZCIsIHsgJGRvY3VtZW50YXRpb246ICJBIGRvdHRlZCBwcm9wZXJ0eSBhY2Nlc3MgZXhwcmVzc2lvbiIsICRwcm9wZG9jOiB7IHF1b3RlZDogIltib29sZWFuXSB3aGV0aGVyIHByb3BlcnR5IGlzIHRyYW5zZm9ybWVkIGZyb20gYSBxdW90ZWQgc3RyaW5nIiB9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5leHByZXNzaW9uLndhbGsoZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCJzdHJpbmciICE9IHR5cGVvZiB0aGlzLnByb3BlcnR5KSB0aHJvdyBuZXcgRXJyb3IoInByb3BlcnR5IG11c3QgYmUgc3RyaW5nIik7fSB9LCBBU1RfUHJvcEFjY2VzcyksQVNUX1N1YiA9IERFRk5PREUoIlN1YiIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICdJbmRleC1zdHlsZSBwcm9wZXJ0eSBhY2Nlc3MsIGkuZS4gYGFbImZvbyJdYCcsIHdhbGs6IGZ1bmN0aW9uIHdhbGsoZSkge3ZhciB0ID0gdGhpcztlLnZpc2l0KHQsIGZ1bmN0aW9uICgpIHt0LmV4cHJlc3Npb24ud2FsayhlKSwgdC5wcm9wZXJ0eS53YWxrKGUpO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge211c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAicHJvcGVydHkiKTt9IH0sIEFTVF9Qcm9wQWNjZXNzKSxBU1RfU3ByZWFkID0gREVGTk9ERSgiU3ByZWFkIiwgImV4cHJlc3Npb24iLCB7ICRkb2N1bWVudGF0aW9uOiAiU3ByZWFkIGV4cHJlc3Npb24gaW4gYXJyYXkvb2JqZWN0IGxpdGVyYWxzIG9yIGZ1bmN0aW9uIGNhbGxzIiwgJHByb3Bkb2M6IHsgZXhwcmVzc2lvbjogIltBU1RfTm9kZV0gZXhwcmVzc2lvbiB0byBiZSBleHBhbmRlZCIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5lcXVhbHMoZS5leHByZXNzaW9uKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5leHByZXNzaW9uLndhbGsoZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7bXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJleHByZXNzaW9uIik7fSB9KSxBU1RfVW5hcnkgPSBERUZOT0RFKCJVbmFyeSIsICJvcGVyYXRvciBleHByZXNzaW9uIiwgeyAkZG9jdW1lbnRhdGlvbjogIkJhc2UgY2xhc3MgZm9yIHVuYXJ5IGV4cHJlc3Npb25zIiwgJHByb3Bkb2M6IHsgb3BlcmF0b3I6ICJbc3RyaW5nXSB0aGUgb3BlcmF0b3IiLCBleHByZXNzaW9uOiAiW0FTVF9Ob2RlXSBleHByZXNzaW9uIHRoYXQgdGhpcyB1bmFyeSBvcGVyYXRvciBhcHBsaWVzIHRvIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gdGhpcy5vcGVyYXRvciA9PSBlLm9wZXJhdG9yICYmIHRoaXMuZXhwcmVzc2lvbi5lcXVhbHMoZS5leHByZXNzaW9uKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5leHByZXNzaW9uLndhbGsoZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCJVbmFyeSIgPT0gdGhpcy5UWVBFKSB0aHJvdyBuZXcgRXJyb3IoInNob3VsZCBub3QgaW5zdGFudGlhdGUgQVNUX1VuYXJ5Iik7aWYgKCJzdHJpbmciICE9IHR5cGVvZiB0aGlzLm9wZXJhdG9yKSB0aHJvdyBuZXcgRXJyb3IoIm9wZXJhdG9yIG11c3QgYmUgc3RyaW5nIik7bXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJleHByZXNzaW9uIik7fSB9KSxBU1RfVW5hcnlQcmVmaXggPSBERUZOT0RFKCJVbmFyeVByZWZpeCIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJVbmFyeSBwcmVmaXggZXhwcmVzc2lvbiwgaS5lLiBgdHlwZW9mIGlgIG9yIGArK2lgIiB9LCBBU1RfVW5hcnkpLEFTVF9VbmFyeVBvc3RmaXggPSBERUZOT0RFKCJVbmFyeVBvc3RmaXgiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiVW5hcnkgcG9zdGZpeCBleHByZXNzaW9uLCBpLmUuIGBpKytgIiB9LCBBU1RfVW5hcnkpLEFTVF9CaW5hcnkgPSBERUZOT0RFKCJCaW5hcnkiLCAib3BlcmF0b3IgbGVmdCByaWdodCIsIHsgJGRvY3VtZW50YXRpb246ICJCaW5hcnkgZXhwcmVzc2lvbiwgaS5lLiBgYSArIGJgIiwgJHByb3Bkb2M6IHsgbGVmdDogIltBU1RfTm9kZV0gbGVmdC1oYW5kIHNpZGUgZXhwcmVzc2lvbiIsIG9wZXJhdG9yOiAiW3N0cmluZ10gdGhlIG9wZXJhdG9yIiwgcmlnaHQ6ICJbQVNUX05vZGVdIHJpZ2h0LWhhbmQgc2lkZSBleHByZXNzaW9uIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gdGhpcy5vcGVyYXRvciA9PSBlLm9wZXJhdG9yICYmIHRoaXMubGVmdC5lcXVhbHMoZS5sZWZ0KSAmJiB0aGlzLnJpZ2h0LmVxdWFscyhlLnJpZ2h0KTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5sZWZ0LndhbGsoZSksIHQucmlnaHQud2FsayhlKTt9KTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAodGhpcyBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gfHwgbXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJsZWZ0IiksICJzdHJpbmciICE9IHR5cGVvZiB0aGlzLm9wZXJhdG9yKSB0aHJvdyBuZXcgRXJyb3IoIm9wZXJhdG9yIG11c3QgYmUgc3RyaW5nIik7bXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJyaWdodCIpO30gfSksQVNUX0NvbmRpdGlvbmFsID0gREVGTk9ERSgiQ29uZGl0aW9uYWwiLCAiY29uZGl0aW9uIGNvbnNlcXVlbnQgYWx0ZXJuYXRpdmUiLCB7ICRkb2N1bWVudGF0aW9uOiAiQ29uZGl0aW9uYWwgZXhwcmVzc2lvbiB1c2luZyB0aGUgdGVybmFyeSBvcGVyYXRvciwgaS5lLiBgYSA/IGIgOiBjYCIsICRwcm9wZG9jOiB7IGNvbmRpdGlvbjogIltBU1RfTm9kZV0iLCBjb25zZXF1ZW50OiAiW0FTVF9Ob2RlXSIsIGFsdGVybmF0aXZlOiAiW0FTVF9Ob2RlXSIgfSwgX2VxdWFsczogZnVuY3Rpb24gX2VxdWFscyhlKSB7cmV0dXJuIHRoaXMuY29uZGl0aW9uLmVxdWFscyhlLmNvbmRpdGlvbikgJiYgdGhpcy5jb25zZXF1ZW50LmVxdWFscyhlLmNvbnNlcXVlbnQpICYmIHRoaXMuYWx0ZXJuYXRpdmUuZXF1YWxzKGUuYWx0ZXJuYXRpdmUpO30sIHdhbGs6IGZ1bmN0aW9uIHdhbGsoZSkge3ZhciB0ID0gdGhpcztlLnZpc2l0KHQsIGZ1bmN0aW9uICgpIHt0LmNvbmRpdGlvbi53YWxrKGUpLCB0LmNvbnNlcXVlbnQud2FsayhlKSwgdC5hbHRlcm5hdGl2ZS53YWxrKGUpO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge211c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAiY29uZGl0aW9uIiksIG11c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAiY29uc2VxdWVudCIpLCBtdXN0X2JlX2V4cHJlc3Npb24odGhpcywgImFsdGVybmF0aXZlIik7fSB9KSxBU1RfQXNzaWduID0gREVGTk9ERSgiQXNzaWduIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkFuIGFzc2lnbm1lbnQgZXhwcmVzc2lvbiDigJQgYGEgPSBiICsgNWAiLCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAodGhpcy5vcGVyYXRvci5pbmRleE9mKCI9IikgPCAwKSB0aHJvdyBuZXcgRXJyb3IoJ29wZXJhdG9yIG11c3QgY29udGFpbiAiPSInKTtpZiAodGhpcy5sZWZ0IGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCkge2lmICgiPSIgIT0gdGhpcy5vcGVyYXRvcikgdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIGRlc3RydWN0dXJpbmcgb3BlcmF0b3I6ICIgKyB0aGlzLm9wZXJhdG9yKTt2YWxpZGF0ZV9kZXN0cnVjdHVyZWQodGhpcy5sZWZ0LCBmdW5jdGlvbiAoZSkge2lmICghKGUgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyB8fCBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikpIHRocm93IG5ldyBFcnJvcigibGVmdCBtdXN0IGJlIGFzc2lnbmFibGU6ICIgKyBlLlRZUEUpO30pO30gZWxzZSBpZiAoISh0aGlzLmxlZnQgaW5zdGFuY2VvZiBBU1RfSW5maW5pdHkgfHwgdGhpcy5sZWZ0IGluc3RhbmNlb2YgQVNUX05hTiB8fCB0aGlzLmxlZnQgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyAmJiAhdGhpcy5sZWZ0Lm9wdGlvbmFsIHx8IHRoaXMubGVmdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgfHwgdGhpcy5sZWZ0IGluc3RhbmNlb2YgQVNUX1VuZGVmaW5lZCkpIHRocm93IG5ldyBFcnJvcigibGVmdCBtdXN0IGJlIGFzc2lnbmFibGUiKTt9IH0sIEFTVF9CaW5hcnkpLEFTVF9Bd2FpdCA9IERFRk5PREUoIkF3YWl0IiwgImV4cHJlc3Npb24iLCB7ICRkb2N1bWVudGF0aW9uOiAiQW4gYXdhaXQgZXhwcmVzc2lvbiIsICRwcm9wZG9jOiB7IGV4cHJlc3Npb246ICJbQVNUX05vZGVdIGV4cHJlc3Npb24gd2l0aCBQcm9taXNlIHRvIHJlc29sdmUgb24iIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiB0aGlzLmV4cHJlc3Npb24uZXF1YWxzKGUuZXhwcmVzc2lvbik7fSwgd2FsazogZnVuY3Rpb24gd2FsayhlKSB7dmFyIHQgPSB0aGlzO2UudmlzaXQodCwgZnVuY3Rpb24gKCkge3QuZXhwcmVzc2lvbi53YWxrKGUpO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge211c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAiZXhwcmVzc2lvbiIpO30gfSksQVNUX1lpZWxkID0gREVGTk9ERSgiWWllbGQiLCAiZXhwcmVzc2lvbiBuZXN0ZWQiLCB7ICRkb2N1bWVudGF0aW9uOiAiQSB5aWVsZCBleHByZXNzaW9uIiwgJHByb3Bkb2M6IHsgZXhwcmVzc2lvbjogIltBU1RfTm9kZT9dIHJldHVybiB2YWx1ZSBmb3IgaXRlcmF0b3IsIG9yIG51bGwgaWYgdW5kZWZpbmVkIiwgbmVzdGVkOiAiW2Jvb2xlYW5dIHdoZXRoZXIgdG8gaXRlcmF0ZSBvdmVyIGV4cHJlc3Npb24gYXMgZ2VuZXJhdG9yIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gIXRoaXMubmVzdGVkID09ICFlLm5lc3RlZCAmJiBwcm9wX2VxdWFscyh0aGlzLmV4cHJlc3Npb24sIGUuZXhwcmVzc2lvbik7fSwgd2FsazogZnVuY3Rpb24gd2FsayhlKSB7dmFyIHQgPSB0aGlzO2UudmlzaXQodCwgZnVuY3Rpb24gKCkge3QuZXhwcmVzc2lvbiAmJiB0LmV4cHJlc3Npb24ud2FsayhlKTt9KTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAobnVsbCAhPSB0aGlzLmV4cHJlc3Npb24pIG11c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAiZXhwcmVzc2lvbiIpO2Vsc2UgaWYgKHRoaXMubmVzdGVkKSB0aHJvdyBuZXcgRXJyb3IoInlpZWxkKiBtdXN0IGNvbnRhaW4gZXhwcmVzc2lvbiIpO30gfSksQVNUX0FycmF5ID0gREVGTk9ERSgiQXJyYXkiLCAiZWxlbWVudHMiLCB7ICRkb2N1bWVudGF0aW9uOiAiQW4gYXJyYXkgbGl0ZXJhbCIsICRwcm9wZG9jOiB7IGVsZW1lbnRzOiAiW0FTVF9Ob2RlKl0gYXJyYXkgb2YgZWxlbWVudHMiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiBhbGxfZXF1YWxzKHRoaXMuZWxlbWVudHMsIGUuZWxlbWVudHMpO30sIHdhbGs6IGZ1bmN0aW9uIHdhbGsodCkge3ZhciBlID0gdGhpczt0LnZpc2l0KGUsIGZ1bmN0aW9uICgpIHtlLmVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLndhbGsodCk7fSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7bXVzdF9iZV9leHByZXNzaW9ucyh0aGlzLCAiZWxlbWVudHMiLCAhMCwgITApO30gfSksQVNUX0Rlc3RydWN0dXJlZCA9IERFRk5PREUoIkRlc3RydWN0dXJlZCIsICJyZXN0IiwgeyAkZG9jdW1lbnRhdGlvbjogIkJhc2UgY2xhc3MgZm9yIGRlc3RydWN0dXJlZCBsaXRlcmFsIiwgJHByb3Bkb2M6IHsgcmVzdDogIlsoQVNUX0Rlc3RydWN0dXJlZHxBU1RfU3ltYm9sRGVjbGFyYXRpb258QVNUX1N5bWJvbFJlZik/XSByZXN0IHBhcmFtZXRlciwgb3IgbnVsbCBpZiBhYnNlbnQiIH0sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiRGVzdHJ1Y3R1cmVkIiA9PSB0aGlzLlRZUEUpIHRocm93IG5ldyBFcnJvcigic2hvdWxkIG5vdCBpbnN0YW50aWF0ZSBBU1RfRGVzdHJ1Y3R1cmVkIik7fSB9KTtmdW5jdGlvbiB2YWxpZGF0ZV9kZXN0cnVjdHVyZWQoZSwgdCwgbikge2lmIChlIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSAmJiBuKSByZXR1cm4gdmFsaWRhdGVfZGVzdHJ1Y3R1cmVkKGUubmFtZSwgdCk7aWYgKGUgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkKSB7aWYgKG51bGwgIT0gZS5yZXN0ICYmIHZhbGlkYXRlX2Rlc3RydWN0dXJlZChlLnJlc3QsIHQpLCBlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZEFycmF5KSByZXR1cm4gZS5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZSBpbnN0YW5jZW9mIEFTVF9Ib2xlIHx8IHZhbGlkYXRlX2Rlc3RydWN0dXJlZChlLCB0LCAhMCk7fSk7aWYgKGUgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkT2JqZWN0KSByZXR1cm4gZS5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHt2YWxpZGF0ZV9kZXN0cnVjdHVyZWQoZS52YWx1ZSwgdCwgITApO30pO310KGUpO312YXIgQVNUX0Rlc3RydWN0dXJlZEFycmF5ID0gREVGTk9ERSgiRGVzdHJ1Y3R1cmVkQXJyYXkiLCAiZWxlbWVudHMiLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBkZXN0cnVjdHVyZWQgYXJyYXkgbGl0ZXJhbCIsICRwcm9wZG9jOiB7IGVsZW1lbnRzOiAiWyhBU1RfRGVmYXVsdFZhbHVlfEFTVF9EZXN0cnVjdHVyZWR8QVNUX1N5bWJvbERlY2xhcmF0aW9ufEFTVF9TeW1ib2xSZWYpKl0gYXJyYXkgb2YgZWxlbWVudHMiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiBwcm9wX2VxdWFscyh0aGlzLnJlc3QsIGUucmVzdCkgJiYgYWxsX2VxdWFscyh0aGlzLmVsZW1lbnRzLCBlLmVsZW1lbnRzKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKHQpIHt2YXIgZSA9IHRoaXM7dC52aXNpdChlLCBmdW5jdGlvbiAoKSB7ZS5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKHQpO30pLCBlLnJlc3QgJiYgZS5yZXN0LndhbGsodCk7fSk7fSB9LCBBU1RfRGVzdHJ1Y3R1cmVkKSxBU1RfRGVzdHJ1Y3R1cmVkS2V5VmFsID0gREVGTk9ERSgiRGVzdHJ1Y3R1cmVkS2V5VmFsIiwgImtleSB2YWx1ZSIsIHsgJGRvY3VtZW50YXRpb246ICJBIGtleTogdmFsdWUgZGVzdHJ1Y3R1cmVkIHByb3BlcnR5IiwgJHByb3Bkb2M6IHsga2V5OiAiW3N0cmluZ3xBU1RfTm9kZV0gcHJvcGVydHkgbmFtZS4gIEZvciBjb21wdXRlZCBwcm9wZXJ0eSB0aGlzIGlzIGFuIEFTVF9Ob2RlLiIsIHZhbHVlOiAiW0FTVF9EZWZhdWx0VmFsdWV8QVNUX0Rlc3RydWN0dXJlZHxBU1RfU3ltYm9sRGVjbGFyYXRpb258QVNUX1N5bWJvbFJlZl0gcHJvcGVydHkgdmFsdWUiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiBwcm9wX2VxdWFscyh0aGlzLmtleSwgZS5rZXkpICYmIHRoaXMudmFsdWUuZXF1YWxzKGUudmFsdWUpO30sIHdhbGs6IGZ1bmN0aW9uIHdhbGsoZSkge3ZhciB0ID0gdGhpcztlLnZpc2l0KHQsIGZ1bmN0aW9uICgpIHt0LmtleSBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmIHQua2V5LndhbGsoZSksIHQudmFsdWUud2FsayhlKTt9KTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoInN0cmluZyIgIT0gdHlwZW9mIHRoaXMua2V5KSB7aWYgKCEodGhpcy5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSkpIHRocm93IG5ldyBFcnJvcigia2V5IG11c3QgYmUgc3RyaW5nIG9yIEFTVF9Ob2RlIik7bXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJrZXkiKTt9aWYgKCEodGhpcy52YWx1ZSBpbnN0YW5jZW9mIEFTVF9Ob2RlKSkgdGhyb3cgbmV3IEVycm9yKCJ2YWx1ZSBtdXN0IGJlIEFTVF9Ob2RlIik7fSB9KSxBU1RfRGVzdHJ1Y3R1cmVkT2JqZWN0ID0gREVGTk9ERSgiRGVzdHJ1Y3R1cmVkT2JqZWN0IiwgInByb3BlcnRpZXMiLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBkZXN0cnVjdHVyZWQgb2JqZWN0IGxpdGVyYWwiLCAkcHJvcGRvYzogeyBwcm9wZXJ0aWVzOiAiW0FTVF9EZXN0cnVjdHVyZWRLZXlWYWwqXSBhcnJheSBvZiBwcm9wZXJ0aWVzIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gcHJvcF9lcXVhbHModGhpcy5yZXN0LCBlLnJlc3QpICYmIGFsbF9lcXVhbHModGhpcy5wcm9wZXJ0aWVzLCBlLnByb3BlcnRpZXMpO30sIHdhbGs6IGZ1bmN0aW9uIHdhbGsodCkge3ZhciBlID0gdGhpczt0LnZpc2l0KGUsIGZ1bmN0aW9uICgpIHtlLnByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2Uud2Fsayh0KTt9KSwgZS5yZXN0ICYmIGUucmVzdC53YWxrKHQpO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge3RoaXMucHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7aWYgKCEoZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwpKSB0aHJvdyBuZXcgRXJyb3IoInByb3BlcnRpZXMgbXVzdCBiZSBBU1RfRGVzdHJ1Y3R1cmVkS2V5VmFsW10iKTt9KTt9IH0sIEFTVF9EZXN0cnVjdHVyZWQpLEFTVF9PYmplY3QgPSBERUZOT0RFKCJPYmplY3QiLCAicHJvcGVydGllcyIsIHsgJGRvY3VtZW50YXRpb246ICJBbiBvYmplY3QgbGl0ZXJhbCIsICRwcm9wZG9jOiB7IHByb3BlcnRpZXM6ICJbKEFTVF9PYmplY3RQcm9wZXJ0eXxBU1RfU3ByZWFkKSpdIGFycmF5IG9mIHByb3BlcnRpZXMiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiBhbGxfZXF1YWxzKHRoaXMucHJvcGVydGllcywgZS5wcm9wZXJ0aWVzKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKHQpIHt2YXIgZSA9IHRoaXM7dC52aXNpdChlLCBmdW5jdGlvbiAoKSB7ZS5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLndhbGsodCk7fSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7dGhpcy5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX09iamVjdFByb3BlcnR5IHx8IGUgaW5zdGFuY2VvZiBBU1RfU3ByZWFkKSkgdGhyb3cgbmV3IEVycm9yKCJwcm9wZXJ0aWVzIG11c3QgY29udGFpbiBBU1RfT2JqZWN0UHJvcGVydHkgYW5kL29yIEFTVF9TcHJlYWQgb25seSIpO30pO30gfSksQVNUX09iamVjdFByb3BlcnR5ID0gREVGTk9ERSgiT2JqZWN0UHJvcGVydHkiLCAia2V5IHZhbHVlIiwgeyAkZG9jdW1lbnRhdGlvbjogIkJhc2UgY2xhc3MgZm9yIGxpdGVyYWwgb2JqZWN0IHByb3BlcnRpZXMiLCAkcHJvcGRvYzogeyBrZXk6ICJbc3RyaW5nfEFTVF9Ob2RlXSBwcm9wZXJ0eSBuYW1lLiAgRm9yIGNvbXB1dGVkIHByb3BlcnR5IHRoaXMgaXMgYW4gQVNUX05vZGUuIiwgdmFsdWU6ICJbQVNUX05vZGVdIHByb3BlcnR5IHZhbHVlLiAgRm9yIGdldHRlcnMgYW5kIHNldHRlcnMgdGhpcyBpcyBhbiBBU1RfQWNjZXNzb3IuIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gcHJvcF9lcXVhbHModGhpcy5rZXksIGUua2V5KSAmJiB0aGlzLnZhbHVlLmVxdWFscyhlLnZhbHVlKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKGUpIHt2YXIgdCA9IHRoaXM7ZS52aXNpdCh0LCBmdW5jdGlvbiAoKSB7dC5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiB0LmtleS53YWxrKGUpLCB0LnZhbHVlLndhbGsoZSk7fSk7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCJPYmplY3RQcm9wZXJ0eSIgPT0gdGhpcy5UWVBFKSB0aHJvdyBuZXcgRXJyb3IoInNob3VsZCBub3QgaW5zdGFudGlhdGUgQVNUX09iamVjdFByb3BlcnR5Iik7aWYgKCJzdHJpbmciICE9IHR5cGVvZiB0aGlzLmtleSkge2lmICghKHRoaXMua2V5IGluc3RhbmNlb2YgQVNUX05vZGUpKSB0aHJvdyBuZXcgRXJyb3IoImtleSBtdXN0IGJlIHN0cmluZyBvciBBU1RfTm9kZSIpO211c3RfYmVfZXhwcmVzc2lvbih0aGlzLCAia2V5Iik7fWlmICghKHRoaXMudmFsdWUgaW5zdGFuY2VvZiBBU1RfTm9kZSkpIHRocm93IG5ldyBFcnJvcigidmFsdWUgbXVzdCBiZSBBU1RfTm9kZSIpO30gfSksQVNUX09iamVjdEtleVZhbCA9IERFRk5PREUoIk9iamVjdEtleVZhbCIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJBIGtleTogdmFsdWUgb2JqZWN0IHByb3BlcnR5IiwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7bXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJ2YWx1ZSIpO30gfSwgQVNUX09iamVjdFByb3BlcnR5KSxBU1RfT2JqZWN0TWV0aG9kID0gREVGTk9ERSgiT2JqZWN0TWV0aG9kIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkEga2V5KCl7fSBvYmplY3QgcHJvcGVydHkiLCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoISh0aGlzLnZhbHVlIGluc3RhbmNlb2YgQVNUX0xhbWJkYUV4cHJlc3Npb24pKSB0aHJvdyBuZXcgRXJyb3IoInZhbHVlIG11c3QgYmUgQVNUX0xhbWJkYUV4cHJlc3Npb24iKTtpZiAoaXNfYXJyb3codGhpcy52YWx1ZSkpIHRocm93IG5ldyBFcnJvcigidmFsdWUgY2Fubm90IGJlIEFTVF9BcnJvdyBvciBBU1RfQXN5bmNBcnJvdyIpO2lmIChudWxsICE9IHRoaXMudmFsdWUubmFtZSkgdGhyb3cgbmV3IEVycm9yKCJuYW1lIG9mIG9iamVjdCBtZXRob2QncyBsYW1iZGEgbXVzdCBiZSBudWxsIik7fSB9LCBBU1RfT2JqZWN0S2V5VmFsKSxBU1RfT2JqZWN0U2V0dGVyID0gREVGTk9ERSgiT2JqZWN0U2V0dGVyIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkFuIG9iamVjdCBzZXR0ZXIgcHJvcGVydHkiLCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoISh0aGlzLnZhbHVlIGluc3RhbmNlb2YgQVNUX0FjY2Vzc29yKSkgdGhyb3cgbmV3IEVycm9yKCJ2YWx1ZSBtdXN0IGJlIEFTVF9BY2Nlc3NvciIpO30gfSwgQVNUX09iamVjdFByb3BlcnR5KSxBU1RfT2JqZWN0R2V0dGVyID0gREVGTk9ERSgiT2JqZWN0R2V0dGVyIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkFuIG9iamVjdCBnZXR0ZXIgcHJvcGVydHkiLCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoISh0aGlzLnZhbHVlIGluc3RhbmNlb2YgQVNUX0FjY2Vzc29yKSkgdGhyb3cgbmV3IEVycm9yKCJ2YWx1ZSBtdXN0IGJlIEFTVF9BY2Nlc3NvciIpO30gfSwgQVNUX09iamVjdFByb3BlcnR5KSxBU1RfU3ltYm9sID0gREVGTk9ERSgiU3ltYm9sIiwgInNjb3BlIG5hbWUgdGhlZGVmIiwgeyAkZG9jdW1lbnRhdGlvbjogIkJhc2UgY2xhc3MgZm9yIGFsbCBzeW1ib2xzIiwgJHByb3Bkb2M6IHsgbmFtZTogIltzdHJpbmddIG5hbWUgb2YgdGhpcyBzeW1ib2wiLCBzY29wZTogIltBU1RfU2NvcGUvU10gdGhlIGN1cnJlbnQgc2NvcGUgKG5vdCBuZWNlc3NhcmlseSB0aGUgZGVmaW5pdGlvbiBzY29wZSkiLCB0aGVkZWY6ICJbU3ltYm9sRGVmL1NdIHRoZSBkZWZpbml0aW9uIG9mIHRoaXMgc3ltYm9sIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gdGhpcy50aGVkZWYgPyB0aGlzLnRoZWRlZiA9PT0gZS50aGVkZWYgOiB0aGlzLm5hbWUgPT0gZS5uYW1lO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgiU3ltYm9sIiA9PSB0aGlzLlRZUEUpIHRocm93IG5ldyBFcnJvcigic2hvdWxkIG5vdCBpbnN0YW50aWF0ZSBBU1RfU3ltYm9sIik7aWYgKCJzdHJpbmciICE9IHR5cGVvZiB0aGlzLm5hbWUpIHRocm93IG5ldyBFcnJvcigibmFtZSBtdXN0IGJlIHN0cmluZyIpO30gfSksQVNUX1N5bWJvbERlY2xhcmF0aW9uID0gREVGTk9ERSgiU3ltYm9sRGVjbGFyYXRpb24iLCAiaW5pdCIsIHsgJGRvY3VtZW50YXRpb246ICJBIGRlY2xhcmF0aW9uIHN5bWJvbCAoc3ltYm9sIGluIHZhciwgZnVuY3Rpb24gbmFtZSBvciBhcmd1bWVudCwgc3ltYm9sIGluIGNhdGNoKSIgfSwgQVNUX1N5bWJvbCksQVNUX1N5bWJvbENvbnN0ID0gREVGTk9ERSgiU3ltYm9sQ29uc3QiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiU3ltYm9sIGRlZmluaW5nIGEgY29uc3RhbnQiIH0sIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiksQVNUX1N5bWJvbEltcG9ydCA9IERFRk5PREUoIlN5bWJvbEltcG9ydCIsICJrZXkiLCB7ICRkb2N1bWVudGF0aW9uOiAiU3ltYm9sIGRlZmluZWQgYnkgYW4gYGltcG9ydGAgc3RhdGVtZW50IiwgJHByb3Bkb2M6IHsga2V5OiAiW0FTVF9TdHJpbmddIHRoZSBvcmlnaW5hbCBgZXhwb3J0YCBuYW1lIiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gdGhpcy5uYW1lID09IGUubmFtZSAmJiB0aGlzLmtleS5lcXVhbHMoZS5rZXkpO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICghKHRoaXMua2V5IGluc3RhbmNlb2YgQVNUX1N0cmluZykpIHRocm93IG5ldyBFcnJvcigia2V5IG11c3QgYmUgQVNUX1N0cmluZyIpO30gfSwgQVNUX1N5bWJvbENvbnN0KSxBU1RfU3ltYm9sTGV0ID0gREVGTk9ERSgiU3ltYm9sTGV0IiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlN5bWJvbCBkZWZpbmluZyBhIGxleGljYWwtc2NvcGVkIHZhcmlhYmxlIiB9LCBBU1RfU3ltYm9sRGVjbGFyYXRpb24pLEFTVF9TeW1ib2xWYXIgPSBERUZOT0RFKCJTeW1ib2xWYXIiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiU3ltYm9sIGRlZmluaW5nIGEgdmFyaWFibGUiIH0sIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiksQVNUX1N5bWJvbEZ1bmFyZyA9IERFRk5PREUoIlN5bWJvbEZ1bmFyZyIsICJ1bnVzZWQiLCB7ICRkb2N1bWVudGF0aW9uOiAiU3ltYm9sIG5hbWluZyBhIGZ1bmN0aW9uIGFyZ3VtZW50IiB9LCBBU1RfU3ltYm9sVmFyKSxBU1RfU3ltYm9sRGVmdW4gPSBERUZOT0RFKCJTeW1ib2xEZWZ1biIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJTeW1ib2wgZGVmaW5pbmcgYSBmdW5jdGlvbiIgfSwgQVNUX1N5bWJvbERlY2xhcmF0aW9uKSxBU1RfU3ltYm9sTGFtYmRhID0gREVGTk9ERSgiU3ltYm9sTGFtYmRhIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlN5bWJvbCBuYW1pbmcgYSBmdW5jdGlvbiBleHByZXNzaW9uIiB9LCBBU1RfU3ltYm9sRGVjbGFyYXRpb24pLEFTVF9TeW1ib2xEZWZDbGFzcyA9IERFRk5PREUoIlN5bWJvbERlZkNsYXNzIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlN5bWJvbCBkZWZpbmluZyBhIGNsYXNzIiB9LCBBU1RfU3ltYm9sQ29uc3QpLEFTVF9TeW1ib2xDbGFzcyA9IERFRk5PREUoIlN5bWJvbENsYXNzIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlN5bWJvbCBuYW1pbmcgYSBjbGFzcyBleHByZXNzaW9uIiB9LCBBU1RfU3ltYm9sQ29uc3QpLEFTVF9TeW1ib2xDYXRjaCA9IERFRk5PREUoIlN5bWJvbENhdGNoIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlN5bWJvbCBuYW1pbmcgdGhlIGV4Y2VwdGlvbiBpbiBjYXRjaCIgfSwgQVNUX1N5bWJvbERlY2xhcmF0aW9uKSxBU1RfTGFiZWwgPSBERUZOT0RFKCJMYWJlbCIsICJyZWZlcmVuY2VzIiwgeyAkZG9jdW1lbnRhdGlvbjogIlN5bWJvbCBuYW1pbmcgYSBsYWJlbCAoZGVjbGFyYXRpb24pIiwgJHByb3Bkb2M6IHsgcmVmZXJlbmNlczogIltBU1RfTG9vcENvbnRyb2wqXSBhIGxpc3Qgb2Ygbm9kZXMgcmVmZXJyaW5nIHRvIHRoaXMgbGFiZWwiIH0sIGluaXRpYWxpemU6IGZ1bmN0aW9uIGluaXRpYWxpemUoKSB7dGhpcy5yZWZlcmVuY2VzID0gW10sIHRoaXMudGhlZGVmID0gdGhpczt9IH0sIEFTVF9TeW1ib2wpLEFTVF9TeW1ib2xSZWYgPSBERUZOT0RFKCJTeW1ib2xSZWYiLCAiZml4ZWQgaW5fYXJnIHJlZGVmIiwgeyAkZG9jdW1lbnRhdGlvbjogIlJlZmVyZW5jZSB0byBzb21lIHN5bWJvbCAobm90IGRlZmluaXRpb24vZGVjbGFyYXRpb24pIiB9LCBBU1RfU3ltYm9sKSxBU1RfU3ltYm9sRXhwb3J0ID0gREVGTk9ERSgiU3ltYm9sRXhwb3J0IiwgImFsaWFzIiwgeyAkZG9jdW1lbnRhdGlvbjogIlJlZmVyZW5jZSBpbiBhbiBgZXhwb3J0YCBzdGF0ZW1lbnQiLCAkcHJvcGRvYzogeyBhbGlhczogIltBU1RfU3RyaW5nXSB0aGUgYGV4cG9ydGAgYWxpYXMiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiB0aGlzLm5hbWUgPT0gZS5uYW1lICYmIHRoaXMuYWxpYXMuZXF1YWxzKGUuYWxpYXMpO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICghKHRoaXMuYWxpYXMgaW5zdGFuY2VvZiBBU1RfU3RyaW5nKSkgdGhyb3cgbmV3IEVycm9yKCJhbGlhcyBtdXN0IGJlIEFTVF9TdHJpbmciKTt9IH0sIEFTVF9TeW1ib2xSZWYpLEFTVF9MYWJlbFJlZiA9IERFRk5PREUoIkxhYmVsUmVmIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlJlZmVyZW5jZSB0byBhIGxhYmVsIHN5bWJvbCIgfSwgQVNUX1N5bWJvbCksQVNUX09iamVjdElkZW50aXR5ID0gREVGTk9ERSgiT2JqZWN0SWRlbnRpdHkiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQmFzZSBjbGFzcyBmb3IgYHN1cGVyYCAmIGB0aGlzYCIsIF9lcXVhbHM6IHJldHVybl90cnVlLCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIk9iamVjdElkZW50aXR5IiA9PSB0aGlzLlRZUEUpIHRocm93IG5ldyBFcnJvcigic2hvdWxkIG5vdCBpbnN0YW50aWF0ZSBBU1RfT2JqZWN0SWRlbnRpdHkiKTt9IH0sIEFTVF9TeW1ib2wpLEFTVF9TdXBlciA9IERFRk5PREUoIlN1cGVyIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlRoZSBgc3VwZXJgIHN5bWJvbCIsIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICgic3VwZXIiICE9PSB0aGlzLm5hbWUpIHRocm93IG5ldyBFcnJvcignbmFtZSBtdXN0IGJlICJzdXBlciInKTt9IH0sIEFTVF9PYmplY3RJZGVudGl0eSksQVNUX1RoaXMgPSBERUZOT0RFKCJUaGlzIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlRoZSBgdGhpc2Agc3ltYm9sIiwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCJUaGlzIiA9PSB0aGlzLlRZUEUgJiYgInRoaXMiICE9PSB0aGlzLm5hbWUpIHRocm93IG5ldyBFcnJvcignbmFtZSBtdXN0IGJlICJ0aGlzIicpO30gfSwgQVNUX09iamVjdElkZW50aXR5KSxBU1RfTmV3VGFyZ2V0ID0gREVGTk9ERSgiTmV3VGFyZ2V0IiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlRoZSBgbmV3LnRhcmdldGAgc3ltYm9sIiwgaW5pdGlhbGl6ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHt0aGlzLm5hbWUgPSAibmV3LnRhcmdldCI7fSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKCJuZXcudGFyZ2V0IiAhPT0gdGhpcy5uYW1lKSB0aHJvdyBuZXcgRXJyb3IoJ25hbWUgbXVzdCBiZSAibmV3LnRhcmdldCI6ICcgKyB0aGlzLm5hbWUpO30gfSwgQVNUX1RoaXMpLEFTVF9UZW1wbGF0ZSA9IERFRk5PREUoIlRlbXBsYXRlIiwgImV4cHJlc3Npb25zIHN0cmluZ3MgdGFnIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgdGVtcGxhdGUgbGl0ZXJhbCwgaS5lLiB0YWdgc3RyMSR7ZXhwcjF9Li4uc3RyTiR7ZXhwck59c3RyTisxYCIsICRwcm9wZG9jOiB7IGV4cHJlc3Npb25zOiAiW0FTVF9Ob2RlKl0gdGhlIHBsYWNlaG9sZGVyIGV4cHJlc3Npb25zIiwgc3RyaW5nczogIltzdHJpbmcqXSB0aGUgcmF3IHRleHQgc2VnbWVudHMiLCB0YWc6ICJbQVNUX05vZGU/XSB0YWcgZnVuY3Rpb24sIG9yIG51bGwgaWYgYWJzZW50IiB9LCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gcHJvcF9lcXVhbHModGhpcy50YWcsIGUudGFnKSAmJiBsaXN0X2VxdWFscyh0aGlzLnN0cmluZ3MsIGUuc3RyaW5ncykgJiYgYWxsX2VxdWFscyh0aGlzLmV4cHJlc3Npb25zLCBlLmV4cHJlc3Npb25zKTt9LCB3YWxrOiBmdW5jdGlvbiB3YWxrKHQpIHt2YXIgZSA9IHRoaXM7dC52aXNpdChlLCBmdW5jdGlvbiAoKSB7ZS50YWcgJiYgZS50YWcud2Fsayh0KSwgZS5leHByZXNzaW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKHQpO30pO30pO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICh0aGlzLmV4cHJlc3Npb25zLmxlbmd0aCArIDEgIT0gdGhpcy5zdHJpbmdzLmxlbmd0aCkgdGhyb3cgbmV3IEVycm9yKCJtYWxmb3JtZWQgdGVtcGxhdGUgd2l0aCAiICsgdGhpcy5leHByZXNzaW9ucy5sZW5ndGggKyAiIHBsYWNlaG9sZGVyKHMpIGJ1dCAiICsgdGhpcy5zdHJpbmdzLmxlbmd0aCArICIgdGV4dCBzZWdtZW50KHMpIik7bXVzdF9iZV9leHByZXNzaW9ucyh0aGlzLCAiZXhwcmVzc2lvbnMiKSwgdGhpcy5zdHJpbmdzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtpZiAoInN0cmluZyIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBFcnJvcigic3RyaW5ncyBtdXN0IGNvbnRhaW4gc3RyaW5nIik7fSksIG51bGwgIT0gdGhpcy50YWcgJiYgbXVzdF9iZV9leHByZXNzaW9uKHRoaXMsICJ0YWciKTt9IH0pLEFTVF9Db25zdGFudCA9IERFRk5PREUoIkNvbnN0YW50IiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkJhc2UgY2xhc3MgZm9yIGFsbCBjb25zdGFudHMiLCBfZXF1YWxzOiBmdW5jdGlvbiBfZXF1YWxzKGUpIHtyZXR1cm4gdGhpcy52YWx1ZSA9PT0gZS52YWx1ZTt9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIkNvbnN0YW50IiA9PSB0aGlzLlRZUEUpIHRocm93IG5ldyBFcnJvcigic2hvdWxkIG5vdCBpbnN0YW50aWF0ZSBBU1RfQ29uc3RhbnQiKTt9IH0pLEFTVF9TdHJpbmcgPSBERUZOT0RFKCJTdHJpbmciLCAicXVvdGUgdmFsdWUiLCB7ICRkb2N1bWVudGF0aW9uOiAiQSBzdHJpbmcgbGl0ZXJhbCIsICRwcm9wZG9jOiB7IHF1b3RlOiAiW3N0cmluZz9dIHRoZSBvcmlnaW5hbCBxdW90ZSBjaGFyYWN0ZXIiLCB2YWx1ZTogIltzdHJpbmddIHRoZSBjb250ZW50cyBvZiB0aGlzIHN0cmluZyIgfSwgX3ZhbGlkYXRlOiBmdW5jdGlvbiBfdmFsaWRhdGUoKSB7aWYgKG51bGwgIT0gdGhpcy5xdW90ZSkge2lmICgic3RyaW5nIiAhPSB0eXBlb2YgdGhpcy5xdW90ZSkgdGhyb3cgbmV3IEVycm9yKCJxdW90ZSBtdXN0IGJlIHN0cmluZyIpO2lmICghL15bIiddJC8udGVzdCh0aGlzLnF1b3RlKSkgdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIHF1b3RlOiAiICsgdGhpcy5xdW90ZSk7fWlmICgic3RyaW5nIiAhPSB0eXBlb2YgdGhpcy52YWx1ZSkgdGhyb3cgbmV3IEVycm9yKCJ2YWx1ZSBtdXN0IGJlIHN0cmluZyIpO30gfSwgQVNUX0NvbnN0YW50KSxBU1RfTnVtYmVyID0gREVGTk9ERSgiTnVtYmVyIiwgInZhbHVlIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgbnVtYmVyIGxpdGVyYWwiLCAkcHJvcGRvYzogeyB2YWx1ZTogIltudW1iZXJdIHRoZSBudW1lcmljIHZhbHVlIiB9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIm51bWJlciIgIT0gdHlwZW9mIHRoaXMudmFsdWUpIHRocm93IG5ldyBFcnJvcigidmFsdWUgbXVzdCBiZSBudW1iZXIiKTtpZiAoIWlzRmluaXRlKHRoaXMudmFsdWUpKSB0aHJvdyBuZXcgRXJyb3IoInZhbHVlIG11c3QgYmUgZmluaXRlIik7aWYgKHRoaXMudmFsdWUgPCAwKSB0aHJvdyBuZXcgRXJyb3IoInZhbHVlIGNhbm5vdCBiZSBuZWdhdGl2ZSIpO30gfSwgQVNUX0NvbnN0YW50KSxBU1RfQmlnSW50ID0gREVGTk9ERSgiQmlnSW50IiwgInZhbHVlIiwgeyAkZG9jdW1lbnRhdGlvbjogIkEgQmlnSW50IGxpdGVyYWwiLCAkcHJvcGRvYzogeyB2YWx1ZTogIltzdHJpbmddIHRoZSBudW1lcmljIHJlcHJlc2VudGF0aW9uIiB9LCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoInN0cmluZyIgIT0gdHlwZW9mIHRoaXMudmFsdWUpIHRocm93IG5ldyBFcnJvcigidmFsdWUgbXVzdCBiZSBzdHJpbmciKTtpZiAoIi0iID09IHRoaXMudmFsdWVbMF0pIHRocm93IG5ldyBFcnJvcigidmFsdWUgY2Fubm90IGJlIG5lZ2F0aXZlIik7fSB9LCBBU1RfQ29uc3RhbnQpLEFTVF9SZWdFeHAgPSBERUZOT0RFKCJSZWdFeHAiLCAidmFsdWUiLCB7ICRkb2N1bWVudGF0aW9uOiAiQSByZWdleHAgbGl0ZXJhbCIsICRwcm9wZG9jOiB7IHZhbHVlOiAiW1JlZ0V4cF0gdGhlIGFjdHVhbCByZWdleHAiIH0sIF9lcXVhbHM6IGZ1bmN0aW9uIF9lcXVhbHMoZSkge3JldHVybiAiIiArIHRoaXMudmFsdWUgPT0gIiIgKyBlLnZhbHVlO30sIF92YWxpZGF0ZTogZnVuY3Rpb24gX3ZhbGlkYXRlKCkge2lmICghKHRoaXMudmFsdWUgaW5zdGFuY2VvZiBSZWdFeHApKSB0aHJvdyBuZXcgRXJyb3IoInZhbHVlIG11c3QgYmUgUmVnRXhwIik7fSB9LCBBU1RfQ29uc3RhbnQpLEFTVF9BdG9tID0gREVGTk9ERSgiQXRvbSIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJCYXNlIGNsYXNzIGZvciBhdG9tcyIsIF9lcXVhbHM6IHJldHVybl90cnVlLCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIkF0b20iID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9BdG9tIik7fSB9LCBBU1RfQ29uc3RhbnQpLEFTVF9OdWxsID0gREVGTk9ERSgiTnVsbCIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJUaGUgYG51bGxgIGF0b20iLCB2YWx1ZTogbnVsbCB9LCBBU1RfQXRvbSksQVNUX05hTiA9IERFRk5PREUoIk5hTiIsIG51bGwsIHsgJGRvY3VtZW50YXRpb246ICJUaGUgaW1wb3NzaWJsZSB2YWx1ZSIsIHZhbHVlOiBOYU4gfSwgQVNUX0F0b20pLEFTVF9VbmRlZmluZWQgPSBERUZOT0RFKCJVbmRlZmluZWQiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiVGhlIGB1bmRlZmluZWRgIHZhbHVlIiwgdmFsdWU6IHZvaWQgMCB9LCBBU1RfQXRvbSksQVNUX0hvbGUgPSBERUZOT0RFKCJIb2xlIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIkEgaG9sZSBpbiBhbiBhcnJheSIsIHZhbHVlOiB2b2lkIDAgfSwgQVNUX0F0b20pLEFTVF9JbmZpbml0eSA9IERFRk5PREUoIkluZmluaXR5IiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlRoZSBgSW5maW5pdHlgIHZhbHVlIiwgdmFsdWU6IDEgLyAwIH0sIEFTVF9BdG9tKSxBU1RfQm9vbGVhbiA9IERFRk5PREUoIkJvb2xlYW4iLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiQmFzZSBjbGFzcyBmb3IgYm9vbGVhbnMiLCBfdmFsaWRhdGU6IGZ1bmN0aW9uIF92YWxpZGF0ZSgpIHtpZiAoIkJvb2xlYW4iID09IHRoaXMuVFlQRSkgdGhyb3cgbmV3IEVycm9yKCJzaG91bGQgbm90IGluc3RhbnRpYXRlIEFTVF9Cb29sZWFuIik7fSB9LCBBU1RfQXRvbSksQVNUX0ZhbHNlID0gREVGTk9ERSgiRmFsc2UiLCBudWxsLCB7ICRkb2N1bWVudGF0aW9uOiAiVGhlIGBmYWxzZWAgYXRvbSIsIHZhbHVlOiAhMSB9LCBBU1RfQm9vbGVhbiksQVNUX1RydWUgPSBERUZOT0RFKCJUcnVlIiwgbnVsbCwgeyAkZG9jdW1lbnRhdGlvbjogIlRoZSBgdHJ1ZWAgYXRvbSIsIHZhbHVlOiAhMCB9LCBBU1RfQm9vbGVhbik7ZnVuY3Rpb24gVHJlZVdhbGtlcihlKSB7dGhpcy5jYWxsYmFjayA9IGUsIHRoaXMuZGlyZWN0aXZlcyA9IE9iamVjdC5jcmVhdGUobnVsbCksIHRoaXMuc3RhY2sgPSBbXTt9VHJlZVdhbGtlci5wcm90b3R5cGUgPSB7IHZpc2l0OiBmdW5jdGlvbiB2aXNpdChlLCB0KSB7dGhpcy5wdXNoKGUpLCAhdGhpcy5jYWxsYmFjayhlLCB0IHx8IG5vb3ApICYmIHQgJiYgdCgpLCB0aGlzLnBvcCgpO30sIHBhcmVudDogZnVuY3Rpb24gcGFyZW50KGUpIHtyZXR1cm4gdGhpcy5zdGFja1t0aGlzLnN0YWNrLmxlbmd0aCAtIDIgLSAoZSB8fCAwKV07fSwgcHVzaDogZnVuY3Rpb24gcHVzaChlKSB7dmFyIHQ7ZSBpbnN0YW5jZW9mIEFTVF9DbGFzcyA/ICh0aGlzLmRpcmVjdGl2ZXMgPSBPYmplY3QuY3JlYXRlKHRoaXMuZGlyZWN0aXZlcyksIHQgPSAidXNlIHN0cmljdCIpIDogZSBpbnN0YW5jZW9mIEFTVF9EaXJlY3RpdmUgPyB0ID0gZS52YWx1ZSA6IGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhICYmICh0aGlzLmRpcmVjdGl2ZXMgPSBPYmplY3QuY3JlYXRlKHRoaXMuZGlyZWN0aXZlcykpLCB0ICYmICF0aGlzLmRpcmVjdGl2ZXNbdF0gJiYgKHRoaXMuZGlyZWN0aXZlc1t0XSA9IGUpLCB0aGlzLnN0YWNrLnB1c2goZSk7fSwgcG9wOiBmdW5jdGlvbiBwb3AoKSB7dmFyIGUgPSB0aGlzLnN0YWNrLnBvcCgpOyhlIGluc3RhbmNlb2YgQVNUX0NsYXNzIHx8IGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhKSAmJiAodGhpcy5kaXJlY3RpdmVzID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMuZGlyZWN0aXZlcykpO30sIHNlbGY6IGZ1bmN0aW9uIHNlbGYoKSB7cmV0dXJuIHRoaXMuc3RhY2tbdGhpcy5zdGFjay5sZW5ndGggLSAxXTt9LCBmaW5kX3BhcmVudDogZnVuY3Rpb24gZmluZF9wYXJlbnQoZSkge2ZvciAodmFyIHQgPSB0aGlzLnN0YWNrLCBuID0gdC5sZW5ndGggLSAxOyAwIDw9IC0tbjspIHt2YXIgbyA9IHRbbl07aWYgKG8gaW5zdGFuY2VvZiBlKSByZXR1cm4gbzt9fSwgaGFzX2RpcmVjdGl2ZTogZnVuY3Rpb24gaGFzX2RpcmVjdGl2ZShlKSB7dmFyIHQgPSB0aGlzLmRpcmVjdGl2ZXNbZV07aWYgKHQpIHJldHVybiB0O3ZhciBuID0gdGhpcy5zdGFja1t0aGlzLnN0YWNrLmxlbmd0aCAtIDFdO2lmIChuIGluc3RhbmNlb2YgQVNUX1Njb3BlKSBmb3IgKHZhciBvID0gMDsgbyA8IG4uYm9keS5sZW5ndGg7ICsrbykge3ZhciBpID0gbi5ib2R5W29dO2lmICghKGkgaW5zdGFuY2VvZiBBU1RfRGlyZWN0aXZlKSkgYnJlYWs7aWYgKGkudmFsdWUgPT0gZSkgcmV0dXJuIGk7fX0sIGxvb3Bjb250cm9sX3RhcmdldDogZnVuY3Rpb24gbG9vcGNvbnRyb2xfdGFyZ2V0KGUpIHt2YXIgdCxuID0gdGhpcy5zdGFjaztpZiAoZS5sYWJlbCkge2ZvciAodmFyIG8gPSBuLmxlbmd0aDsgMCA8PSAtLW87KSBpZiAoKHQgPSBuW29dKSBpbnN0YW5jZW9mIEFTVF9MYWJlbGVkU3RhdGVtZW50ICYmIHQubGFiZWwubmFtZSA9PSBlLmxhYmVsLm5hbWUpIHJldHVybiB0LmJvZHk7fSBlbHNlIGZvciAobyA9IG4ubGVuZ3RoOyAwIDw9IC0tbzspIGlmICgodCA9IG5bb10pIGluc3RhbmNlb2YgQVNUX0l0ZXJhdGlvblN0YXRlbWVudCB8fCBlIGluc3RhbmNlb2YgQVNUX0JyZWFrICYmIHQgaW5zdGFuY2VvZiBBU1RfU3dpdGNoKSByZXR1cm4gdDt9LCBpbl9ib29sZWFuX2NvbnRleHQ6IGZ1bmN0aW9uIGluX2Jvb2xlYW5fY29udGV4dCgpIHtmb3IgKHZhciBlLCB0ID0gITAsIG4gPSAwLCBvID0gdGhpcy5zZWxmKCk7IGUgPSB0aGlzLnBhcmVudChuKyspOyBvID0gZSkge2lmIChlIGluc3RhbmNlb2YgQVNUX0JpbmFyeSkgc3dpdGNoIChlLm9wZXJhdG9yKSB7Y2FzZSAiJiYiOmNhc2UgInx8IjplLmxlZnQgPT09IG8gJiYgKHQgPSAhMSk7Y29udGludWU7ZGVmYXVsdDpyZXR1cm4gITE7fWlmICghKGUgaW5zdGFuY2VvZiBBU1RfQ29uZGl0aW9uYWwpKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfRFdMb29wKSByZXR1cm4gZS5jb25kaXRpb24gPT09IG87aWYgKGUgaW5zdGFuY2VvZiBBU1RfRm9yKSByZXR1cm4gZS5jb25kaXRpb24gPT09IG87aWYgKGUgaW5zdGFuY2VvZiBBU1RfSWYpIHJldHVybiBlLmNvbmRpdGlvbiA9PT0gbztpZiAoZSBpbnN0YW5jZW9mIEFTVF9SZXR1cm4pIHtpZiAoZS5pbl9ib29sKSByZXR1cm4gITA7Zm9yICg7IGUgPSB0aGlzLnBhcmVudChuKyspOykgaWYgKGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhKSB7aWYgKGUubmFtZSkgcmV0dXJuICExO2lmICgiQ2FsbCIgIT0gKGUgPSB0aGlzLnBhcmVudChuKyspKS5UWVBFKSByZXR1cm4gITE7YnJlYWs7fX1pZiAoZSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSkge2lmIChlLnRhaWxfbm9kZSgpID09PSBvKSBjb250aW51ZTtyZXR1cm4gIXQgfHwgImQiO31yZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQgPyAhdCB8fCAiZCIgOiBlIGluc3RhbmNlb2YgQVNUX1VuYXJ5UHJlZml4ICYmICIhIiA9PSBlLm9wZXJhdG9yO31pZiAoZS5jb25kaXRpb24gPT09IG8pIHJldHVybiAhMDt9fSB9OwoKICAvLyBwYXJzZS5qcwogIC8vIHByZXR0aWVyLWlnbm9yZQogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZQogICJ1c2Ugc3RyaWN0Ijt2YXIgUkVTRVJWRURfV09SRFMgPSBbImFic3RyYWN0IGFzeW5jIGF3YWl0IGJvb2xlYW4gYnl0ZSBjaGFyIGRvdWJsZSBlbnVtIGV4cG9ydCBmaW5hbCBmbG9hdCBnb3RvIGltcGxlbWVudHMgaW1wb3J0IGludCBpbnRlcmZhY2UgbGV0IGxvbmcgbmF0aXZlIHBhY2thZ2UgcHJpdmF0ZSBwcm90ZWN0ZWQgcHVibGljIHNob3J0IHN0YXRpYyBzdXBlciBzeW5jaHJvbml6ZWQgdGhpcyB0aHJvd3MgdHJhbnNpZW50IHZvbGF0aWxlIHlpZWxkIiwgS0VZV09SRFNfQVRPTSA9ICJmYWxzZSBudWxsIHRydWUiLCBLRVlXT1JEUyA9ICJicmVhayBjYXNlIGNhdGNoIGNsYXNzIGNvbnN0IGNvbnRpbnVlIGRlYnVnZ2VyIGRlZmF1bHQgZGVsZXRlIGRvIGVsc2UgZXh0ZW5kcyBmaW5hbGx5IGZvciBmdW5jdGlvbiBpZiBpbiBpbnN0YW5jZW9mIG5ldyByZXR1cm4gc3dpdGNoIHRocm93IHRyeSB0eXBlb2YgdmFyIHZvaWQgd2hpbGUgd2l0aCJdLmpvaW4oIiAiKSxLRVlXT1JEU19CRUZPUkVfRVhQUkVTU0lPTiA9ICJyZXR1cm4gbmV3IGRlbGV0ZSB0aHJvdyBlbHNlIGNhc2UiLEtFWVdPUkRTID0gbWFrZVByZWRpY2F0ZShLRVlXT1JEUyksUkVTRVJWRURfV09SRFMgPSBtYWtlUHJlZGljYXRlKFJFU0VSVkVEX1dPUkRTKSxLRVlXT1JEU19CRUZPUkVfRVhQUkVTU0lPTiA9IG1ha2VQcmVkaWNhdGUoS0VZV09SRFNfQkVGT1JFX0VYUFJFU1NJT04pLEtFWVdPUkRTX0FUT00gPSBtYWtlUHJlZGljYXRlKEtFWVdPUkRTX0FUT00pLFJFX0JJTl9OVU1CRVIgPSAvXjBiKFswMV0rKSQvaSxSRV9IRVhfTlVNQkVSID0gL14weChbMC05YS1mXSspJC9pLFJFX09DVF9OVU1CRVIgPSAvXjBvPyhbMC03XSspJC9pLE9QRVJBVE9SUyA9IG1ha2VQcmVkaWNhdGUoWyJpbiIsICJpbnN0YW5jZW9mIiwgInR5cGVvZiIsICJuZXciLCAidm9pZCIsICJkZWxldGUiLCAiKysiLCAiLS0iLCAiKyIsICItIiwgIiEiLCAifiIsICImIiwgInwiLCAiXiIsICIqIiwgIi8iLCAiJSIsICIqKiIsICI+PiIsICI8PCIsICI+Pj4iLCAiPCIsICI+IiwgIjw9IiwgIj49IiwgIj09IiwgIj09PSIsICIhPSIsICIhPT0iLCAiPyIsICI9IiwgIis9IiwgIi09IiwgIi89IiwgIio9IiwgIiU9IiwgIioqPSIsICI+Pj0iLCAiPDw9IiwgIj4+Pj0iLCAiJj0iLCAifD0iLCAiXj0iLCAiJiYiLCAifHwiLCAiPz8iLCAiJiY9IiwgInx8PSIsICI/Pz0iXSksTkVXTElORV9DSEFSUyA9ICJcblxyXHUyMDI4XHUyMDI5IixPUEVSQVRPUl9DSEFSUyA9ICIrLSomJT08PiE/fH5eIixQVU5DX09QRU5FUlMgPSAiW3soIixQVU5DX1NFUEFSQVRPUlMgPSAiLDs6IixQVU5DX0NMT1NFUlMgPSAiKX1dIixQVU5DX0FGVEVSX0VYUFJFU1NJT04gPSBQVU5DX1NFUEFSQVRPUlMgKyBQVU5DX0NMT1NFUlMsUFVOQ19CRUZPUkVfRVhQUkVTU0lPTiA9IFBVTkNfT1BFTkVSUyArIFBVTkNfU0VQQVJBVE9SUyxQVU5DX0NIQVJTID0gUFVOQ19CRUZPUkVfRVhQUkVTU0lPTiArICJgIiArIFBVTkNfQ0xPU0VSUyxXSElURVNQQUNFX0NIQVJTID0gTkVXTElORV9DSEFSUyArICIgXHhBMFx0XGZceDBCXHUyMDBCXHUyMDAwXHUyMDAxXHUyMDAyXHUyMDAzXHUyMDA0XHUyMDA1XHUyMDA2XHUyMDA3XHUyMDA4XHUyMDA5XHUyMDBBXHUyMDJGXHUyMDVGXHUzMDAwXHVGRUZGIixOT05fSURFTlRJRklFUl9DSEFSUyA9IG1ha2VQcmVkaWNhdGUoY2hhcmFjdGVycygiLi8nXCIjIiArIE9QRVJBVE9SX0NIQVJTICsgUFVOQ19DSEFSUyArIFdISVRFU1BBQ0VfQ0hBUlMpKTtmdW5jdGlvbiBpc19zdXJyb2dhdGVfcGFpcl9oZWFkKGUpIHtyZXR1cm4gNTUyOTYgPD0gZSAmJiBlIDw9IDU2MzE5O31mdW5jdGlvbiBpc19zdXJyb2dhdGVfcGFpcl90YWlsKGUpIHtyZXR1cm4gNTYzMjAgPD0gZSAmJiBlIDw9IDU3MzQzO31mdW5jdGlvbiBpc19kaWdpdChlKSB7cmV0dXJuIDQ4IDw9IGUgJiYgZSA8PSA1Nzt9ZnVuY3Rpb24gaXNfaWRlbnRpZmllcl9jaGFyKGUpIHtyZXR1cm4gIU5PTl9JREVOVElGSUVSX0NIQVJTW2VdO31mdW5jdGlvbiBpc19pZGVudGlmaWVyX3N0cmluZyhlKSB7cmV0dXJuIC9eW2Etel8kXVthLXowLTlfJF0qJC9pLnRlc3QoZSk7fWZ1bmN0aW9uIGRlY29kZV9lc2NhcGVfc2VxdWVuY2UoZSkge3N3aXRjaCAoZVswXSkge2Nhc2UgImIiOnJldHVybiAiXGIiO2Nhc2UgImYiOnJldHVybiAiXGYiO2Nhc2UgIm4iOnJldHVybiAiXG4iO2Nhc2UgInIiOnJldHVybiAiXHIiO2Nhc2UgInQiOnJldHVybiAiXHQiO2Nhc2UgInUiOmlmICgieyIgPT0gZVsxXSAmJiAifSIgPT0gZS5zbGljZSgtMSkpIG4gPSBlLnNsaWNlKDIsIC0xKTtlbHNlIHtpZiAoNSAhPSBlLmxlbmd0aCkgcmV0dXJuO24gPSBlLnNsaWNlKDEpO31yZXR1cm4gKG4gPSBwYXJzZUludChuLCAxNikpIDwgMCB8fCBpc05hTihuKSA/IHZvaWQgMCA6IG4gPCA2NTUzNiA/IFN0cmluZy5mcm9tQ2hhckNvZGUobikgOiAxMTE0MTExIDwgbiA/IHZvaWQgMCA6IFN0cmluZy5mcm9tQ2hhckNvZGUoNTUyMzIgKyAobiA+PiAxMCkpICsgU3RyaW5nLmZyb21DaGFyQ29kZSg1NjMyMCArICgxMDIzICYgbikpO2Nhc2UgInYiOnJldHVybiAiXHYiO2Nhc2UgIngiOnZhciBuO3JldHVybiAzICE9IGUubGVuZ3RoID8gdm9pZCAwIDogKG4gPSBwYXJzZUludChlLnNsaWNlKDEpLCAxNikpIDwgMCB8fCBpc05hTihuKSA/IHZvaWQgMCA6IFN0cmluZy5mcm9tQ2hhckNvZGUobik7Y2FzZSAiXHIiOmNhc2UgIlxuIjpyZXR1cm4gIiI7ZGVmYXVsdDpyZXR1cm4gIjAiID09IGUgPyAiXDAiIDogIjAiIDw9IGVbMF0gJiYgZVswXSA8PSAiOSIgPyB2b2lkIDAgOiBlO319ZnVuY3Rpb24gcGFyc2VfanNfbnVtYmVyKGUpIHt2YXIgbjtyZXR1cm4gKG4gPSBSRV9CSU5fTlVNQkVSLmV4ZWMoZSkpID8gcGFyc2VJbnQoblsxXSwgMikgOiAobiA9IFJFX0hFWF9OVU1CRVIuZXhlYyhlKSkgPyBwYXJzZUludChuWzFdLCAxNikgOiAobiA9IFJFX09DVF9OVU1CRVIuZXhlYyhlKSkgPyBwYXJzZUludChuWzFdLCA4KSA6IChuID0gcGFyc2VGbG9hdChlKSkgPT0gZSA/IG4gOiB2b2lkIDA7fWZ1bmN0aW9uIEpTX1BhcnNlX0Vycm9yKGUsIG4sIHQsIHIsIGEpIHt0aGlzLm1lc3NhZ2UgPSBlLCB0aGlzLmZpbGVuYW1lID0gbiwgdGhpcy5saW5lID0gdCwgdGhpcy5jb2wgPSByLCB0aGlzLnBvcyA9IGE7dHJ5IHt0aHJvdyBuZXcgU3ludGF4RXJyb3IoZSwgbiwgdCwgcik7fSBjYXRjaCAoZSkge2NvbmZpZ3VyZV9lcnJvcl9zdGFjayh0aGlzLCBlKTt9fWZ1bmN0aW9uIGpzX2Vycm9yKGUsIG4sIHQsIHIsIGEpIHt0aHJvdyBuZXcgSlNfUGFyc2VfRXJyb3IoZSwgbiwgdCwgciwgYSk7fWZ1bmN0aW9uIGlzX3Rva2VuKGUsIG4sIHQpIHtyZXR1cm4gZS50eXBlID09IG4gJiYgKG51bGwgPT0gdCB8fCBlLnZhbHVlID09IHQpO31ORVdMSU5FX0NIQVJTID0gbWFrZVByZWRpY2F0ZShjaGFyYWN0ZXJzKE5FV0xJTkVfQ0hBUlMpKSwgT1BFUkFUT1JfQ0hBUlMgPSBtYWtlUHJlZGljYXRlKGNoYXJhY3RlcnMoT1BFUkFUT1JfQ0hBUlMpKSwgUFVOQ19BRlRFUl9FWFBSRVNTSU9OID0gbWFrZVByZWRpY2F0ZShjaGFyYWN0ZXJzKFBVTkNfQUZURVJfRVhQUkVTU0lPTikpLCBQVU5DX0JFRk9SRV9FWFBSRVNTSU9OID0gbWFrZVByZWRpY2F0ZShjaGFyYWN0ZXJzKFBVTkNfQkVGT1JFX0VYUFJFU1NJT04pKSwgUFVOQ19DSEFSUyA9IG1ha2VQcmVkaWNhdGUoY2hhcmFjdGVycyhQVU5DX0NIQVJTKSksIFdISVRFU1BBQ0VfQ0hBUlMgPSBtYWtlUHJlZGljYXRlKGNoYXJhY3RlcnMoV0hJVEVTUEFDRV9DSEFSUykpLCBKU19QYXJzZV9FcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFN5bnRheEVycm9yLnByb3RvdHlwZSksIEpTX1BhcnNlX0Vycm9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEpTX1BhcnNlX0Vycm9yO3ZhciBFWF9FT0YgPSB7fTtmdW5jdGlvbiB0b2tlbml6ZXIociwgYSwgbywgcykge3ZhciBpID0geyB0ZXh0OiByLCBmaWxlbmFtZTogYSwgcG9zOiAwLCB0b2twb3M6IDAsIGxpbmU6IDEsIHRva2xpbmU6IDAsIGNvbDogMCwgdG9rY29sOiAwLCBuZXdsaW5lX2JlZm9yZTogITEsIHJlZ2V4X2FsbG93ZWQ6ICExLCBjb21tZW50c19iZWZvcmU6IFtdLCBkaXJlY3RpdmVzOiBPYmplY3QuY3JlYXRlKG51bGwpLCByZWFkX3RlbXBsYXRlOiBlKCJVbnRlcm1pbmF0ZWQgdGVtcGxhdGUgbGl0ZXJhbCIsIGZ1bmN0aW9uIChlKSB7Zm9yICh2YXIgbiA9ICIiOzspIHt2YXIgdCA9IHIoKTtzd2l0Y2ggKHQpIHtjYXNlICJcXCI6dCArPSByKCk7YnJlYWs7Y2FzZSAiYCI6cmV0dXJuIHZvaWQgZS5wdXNoKG4pO2Nhc2UgIiQiOmlmICgieyIgPT0gYygpKSByZXR1cm4gbCgpLCBlLnB1c2gobiksIGkucmVnZXhfYWxsb3dlZCA9ICEwO31uICs9IHQ7fWZ1bmN0aW9uIHIoKSB7dmFyIGUgPSBsKCEwLCAhMCk7cmV0dXJuICJcciIgPT0gZSA/ICJcbiIgOiBlO319KSB9LHUgPSAhMTtmdW5jdGlvbiBjKCkge3JldHVybiBpLnRleHQuY2hhckF0KGkucG9zKTt9ZnVuY3Rpb24gbChlLCBuKSB7dmFyIHQgPSBpLnRleHQuY2hhckF0KGkucG9zKyspO2lmIChlICYmICF0KSB0aHJvdyBFWF9FT0Y7cmV0dXJuIE5FV0xJTkVfQ0hBUlNbdF0gPyAoaS5jb2wgPSAwLCBpLmxpbmUrKywgbiB8fCAoaS5uZXdsaW5lX2JlZm9yZSA9ICEwKSwgIlxyIiA9PSB0ICYmICJcbiIgPT0gYygpICYmIChpLnBvcysrLCB0ID0gIlxuIikpIDogaS5jb2wrKywgdDt9ZnVuY3Rpb24gXyhlKSB7Zm9yICg7IDAgPCBlLS07KSBsKCk7fWZ1bmN0aW9uIGYoZSkge3JldHVybiBpLnRleHQuc3Vic3RyKGkucG9zLCBlLmxlbmd0aCkgPT0gZTt9ZnVuY3Rpb24gcCgpIHtpLnRva2xpbmUgPSBpLmxpbmUsIGkudG9rY29sID0gaS5jb2wsIGkudG9rcG9zID0gaS5wb3M7fWZ1bmN0aW9uIGQoZSwgbiwgdCkge2kucmVnZXhfYWxsb3dlZCA9ICJvcGVyYXRvciIgPT0gZSAmJiAhVU5BUllfUE9TVEZJWFtuXSB8fCAia2V5d29yZCIgPT0gZSAmJiBLRVlXT1JEU19CRUZPUkVfRVhQUkVTU0lPTltuXSB8fCAicHVuYyIgPT0gZSAmJiBQVU5DX0JFRk9SRV9FWFBSRVNTSU9OW25dLCAicHVuYyIgPT0gZSAmJiAiLiIgPT0gbiA/IHUgPSAhMCA6IHQgfHwgKHUgPSAhMSk7biA9IHsgdHlwZTogZSwgdmFsdWU6IG4sIGxpbmU6IGkudG9rbGluZSwgY29sOiBpLnRva2NvbCwgcG9zOiBpLnRva3BvcywgZW5kbGluZTogaS5saW5lLCBlbmRjb2w6IGkuY29sLCBlbmRwb3M6IGkucG9zLCBubGI6IGkubmV3bGluZV9iZWZvcmUsIGZpbGU6IGEgfTtyZXR1cm4gL14oPzpudW18c3RyaW5nfHJlZ2V4cCkkL2kudGVzdChlKSAmJiAobi5yYXcgPSByLnN1YnN0cmluZyhuLnBvcywgbi5lbmRwb3MpKSwgdCB8fCAobi5jb21tZW50c19iZWZvcmUgPSBpLmNvbW1lbnRzX2JlZm9yZSwgbi5jb21tZW50c19hZnRlciA9IGkuY29tbWVudHNfYmVmb3JlID0gW10pLCBpLm5ld2xpbmVfYmVmb3JlID0gITEsIG5ldyBBU1RfVG9rZW4obik7fWZ1bmN0aW9uIFMoZSkge2pzX2Vycm9yKGUsIGEsIGkudG9rbGluZSwgaS50b2tjb2wsIGkudG9rcG9zKTt9ZnVuY3Rpb24gQShlKSB7cmV0dXJuIC9eMFswLTdfXSskLy50ZXN0KGUpO31mdW5jdGlvbiBtKGUpIHt2YXIgdCA9ICExLHIgPSAhMSxhID0gITEsbyA9ICIuIiA9PSBlLG4gPSBmdW5jdGlvbiAoZSkge2ZvciAodmFyIG4sIHQgPSAiIjsgKG4gPSBjKCkpICYmIGUobiwgdCk7KSB0ICs9IGwoKTtyZXR1cm4gdDt9KGZ1bmN0aW9uIChlLCBuKSB7c3dpdGNoIChlKSB7Y2FzZSAieCI6Y2FzZSAiWCI6cmV0dXJuICFhICYmIChhID0gITApO2Nhc2UgImUiOmNhc2UgIkUiOnJldHVybiBhIHx8ICF0ICYmICh0ID0gciA9ICEwKTtjYXNlICIrIjpjYXNlICItIjpyZXR1cm4gcjtjYXNlIChyID0gITEsICIuIik6cmV0dXJuICEobyB8fCB0IHx8IGEgfHwgQShuKSkgJiYgKG8gPSAhMCk7fXJldHVybiAvW18wLTlhLWRmb10vaS50ZXN0KGUpO30pLGUgPSAoQShuID0gZSA/IGUgKyBuIDogbikgPyBFLmhhc19kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSAmJiBTKCJMZWdhY3kgb2N0YWwgbGl0ZXJhbHMgYXJlIG5vdCBhbGxvd2VkIGluIHN0cmljdCBtb2RlIikgOiBuID0gbi5yZXBsYWNlKGEgPyAvKFsxLTlhLWZdfC4wKV8oPz1bMC05YS1mXSkvZ2kgOiAvKFsxLTldfC4wKV8oPz1bMC05XSkvZ2ksICIkMSIpLCBwYXJzZV9qc19udW1iZXIobikpO3JldHVybiBpc05hTihlKSAmJiBTKCJJbnZhbGlkIHN5bnRheDogIiArIG4pLCBvIHx8IHQgfHwgIm4iICE9IGMoKSA/IGQoIm51bSIsIGUpIDogKGwoKSwgZCgiYmlnaW50Iiwgbi50b0xvd2VyQ2FzZSgpKSk7fWZ1bmN0aW9uIHYoZSkge3ZhciBuLHQgPSBsKCEwLCBlKTtpZiAoIjAiIDw9IHQgJiYgdCA8PSAiNyIpIHJldHVybiBuID0gdCwgIjAiIDw9IChhID0gYygpKSAmJiBhIDw9ICI3IiAmJiAobiArPSBsKCEwKSlbMF0gPD0gIjMiICYmICIwIiA8PSAoYSA9IGMoKSkgJiYgYSA8PSAiNyIgJiYgKG4gKz0gbCghMCkpLCAiMCIgPT09IG4gPyAiXDAiIDogKDAgPCBuLmxlbmd0aCAmJiBFLmhhc19kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSAmJiBTKCJMZWdhY3kgb2N0YWwgZXNjYXBlIHNlcXVlbmNlcyBhcmUgbm90IGFsbG93ZWQgaW4gc3RyaWN0IG1vZGUiKSwgU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChuLCA4KSkpO2lmICgidSIgPT0gdCkge3ZhciByID0gbCghMCwgZSk7aWYgKHQgKz0gciwgInsiICE9IHIpIHQgKz0gbCghMCwgZSkgKyBsKCEwLCBlKSArIGwoITAsIGUpO2Vsc2UgZm9yICg7IHQgKz0gciA9IGwoITAsIGUpLCAifSIgIT0gcjspO30gZWxzZSAieCIgPT0gdCAmJiAodCArPSBsKCEwLCBlKSArIGwoITAsIGUpKTt2YXIgYSA9IGRlY29kZV9lc2NhcGVfc2VxdWVuY2UodCk7cmV0dXJuICJzdHJpbmciICE9IHR5cGVvZiBhICYmIFMoIkludmFsaWQgZXNjYXBlIHNlcXVlbmNlOiBcXCIgKyB0KSwgYTt9dmFyIFQgPSBlKCJVbnRlcm1pbmF0ZWQgc3RyaW5nIGNvbnN0YW50IiwgZnVuY3Rpb24gKGUpIHtmb3IgKHZhciBuID0gbCgpLCB0ID0gIiI7Oykge3ZhciByID0gbCghMCwgITApO2lmICgiXFwiID09IHIpIHIgPSB2KCEwKTtlbHNlIGlmIChORVdMSU5FX0NIQVJTW3JdKSBTKCJVbnRlcm1pbmF0ZWQgc3RyaW5nIGNvbnN0YW50Iik7ZWxzZSBpZiAociA9PSBuKSBicmVhazt0ICs9IHI7fXZhciBhID0gZCgic3RyaW5nIiwgdCk7cmV0dXJuIGEucXVvdGUgPSBlLCBhO30pO2Z1bmN0aW9uIGsoZSkge3ZhciBuLHQgPSBpLnJlZ2V4X2FsbG93ZWQsciA9IGZ1bmN0aW9uICgpIHtmb3IgKHZhciBlID0gaS50ZXh0LCBuID0gaS5wb3M7IG4gPCBpLnRleHQubGVuZ3RoOyArK24pIGlmIChORVdMSU5FX0NIQVJTW2Vbbl1dKSByZXR1cm4gbjtyZXR1cm4gLTE7fSgpO3JldHVybiAtMSA9PSByID8gKG4gPSBpLnRleHQuc3Vic3RyKGkucG9zKSwgaS5wb3MgPSBpLnRleHQubGVuZ3RoKSA6IChuID0gaS50ZXh0LnN1YnN0cmluZyhpLnBvcywgciksIGkucG9zID0gciksIGkuY29sID0gaS50b2tjb2wgKyAoaS5wb3MgLSBpLnRva3BvcyksIGkuY29tbWVudHNfYmVmb3JlLnB1c2goZChlLCBuLCAhMCkpLCBpLnJlZ2V4X2FsbG93ZWQgPSB0LCBFO312YXIgdyA9IGUoIlVudGVybWluYXRlZCBtdWx0aWxpbmUgY29tbWVudCIsIGZ1bmN0aW9uICgpIHt2YXIgZSA9IGkucmVnZXhfYWxsb3dlZCxuID0gZnVuY3Rpb24gKGUsIG4pIHtpZiAoZSA9IGkudGV4dC5pbmRleE9mKGUsIGkucG9zKSwgbiAmJiAtMSA9PSBlKSB0aHJvdyBFWF9FT0Y7cmV0dXJuIGU7fSgiKi8iLCAhMCksbiA9IGkudGV4dC5zdWJzdHJpbmcoaS5wb3MsIG4pLnJlcGxhY2UoL1xyXG58XHJ8XHUyMDI4fFx1MjAyOS9nLCAiXG4iKTtyZXR1cm4gXyhuLmxlbmd0aCArIDIpLCBpLmNvbW1lbnRzX2JlZm9yZS5wdXNoKGQoImNvbW1lbnQyIiwgbiwgITApKSwgaS5yZWdleF9hbGxvd2VkID0gZSwgRTt9KTtmdW5jdGlvbiB5KCkge2ZvciAodmFyIGUsIG4sIHQgPSAhMSwgciA9ICExLCBhID0gIiMiID09IGMoKSA/IGwoKSA6ICIiOyBlID0gYygpOykgaWYgKHQpICJ1IiAhPSBlICYmIFMoIkV4cGVjdGluZyBVbmljb2RlRXNjYXBlU2VxdWVuY2UgLS0gdVhYWFgiKSwgaXNfaWRlbnRpZmllcl9jaGFyKGUgPSB2KCkpIHx8IFMoIlVuaWNvZGUgY2hhcjogIiArIGUuY2hhckNvZGVBdCgwKSArICIgaXMgbm90IHZhbGlkIGluIGlkZW50aWZpZXIiKSwgYSArPSBlLCB0ID0gITE7ZWxzZSBpZiAoIlxcIiA9PSBlKSByID0gdCA9ICEwLCBsKCk7ZWxzZSB7aWYgKCFpc19pZGVudGlmaWVyX2NoYXIoZSkpIGJyZWFrO2EgKz0gbCgpO31yZXR1cm4gS0VZV09SRFNbYV0gJiYgciAmJiAobiA9IGEuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKSwgYSA9ICJcXHUiICsgIjAwMDAiLnN1YnN0cihuLmxlbmd0aCkgKyBuICsgYS5zbGljZSgxKSksIGE7fXZhciBiID0gZSgiVW50ZXJtaW5hdGVkIHJlZ3VsYXIgZXhwcmVzc2lvbiIsIGZ1bmN0aW9uIChlKSB7Zm9yICh2YXIgbiwgdCA9ICExLCByID0gITE7IG4gPSBsKCEwKTspIGlmIChORVdMSU5FX0NIQVJTW25dKSBTKCJVbmV4cGVjdGVkIGxpbmUgdGVybWluYXRvciIpO2Vsc2UgaWYgKHQpIGUgKz0gIlxcIiArIG4sIHQgPSAhMTtlbHNlIGlmICgiWyIgPT0gbikgciA9ICEwLCBlICs9IG47ZWxzZSBpZiAoIl0iID09IG4gJiYgcikgciA9ICExLCBlICs9IG47ZWxzZSB7aWYgKCIvIiA9PSBuICYmICFyKSBicmVhazsiXFwiID09IG4gPyB0ID0gITAgOiBlICs9IG47fXZhciBhID0geSgpO3RyeSB7dmFyIG8gPSBuZXcgUmVnRXhwKGUsIGEpO3JldHVybiBvLnJhd19zb3VyY2UgPSBlLCBkKCJyZWdleHAiLCBvKTt9IGNhdGNoIChlKSB7UyhlLm1lc3NhZ2UpO319KTtmdW5jdGlvbiBoKGUpIHtyZXR1cm4gZCgib3BlcmF0b3IiLCBmdW5jdGlvbiBlKG4pIHt2YXIgdDtyZXR1cm4gYygpICYmICh0ID0gbiArIGMoKSwgT1BFUkFUT1JTW3RdKSA/IChsKCksIGUodCkpIDogbjt9KGUgfHwgbCgpKSk7fWZ1bmN0aW9uIGUobiwgdCkge3JldHVybiBmdW5jdGlvbiAoZSkge3RyeSB7cmV0dXJuIHQoZSk7fSBjYXRjaCAoZSkge2lmIChlICE9PSBFWF9FT0YpIHRocm93IGU7UyhuKTt9fTt9ZnVuY3Rpb24gRShlKSB7aWYgKG51bGwgIT0gZSkgcmV0dXJuIGIoZSk7Zm9yIChzICYmIDAgPT0gaS5wb3MgJiYgZigiIyEiKSAmJiAocCgpLCBfKDIpLCBrKCJjb21tZW50NSIpKTs7KSB7Zm9yICg7IFdISVRFU1BBQ0VfQ0hBUlNbYygpXTspIGwoKTtpZiAocCgpLCBvKSB7aWYgKGYoIlx4M2MhLS0iKSkge18oNCksIGsoImNvbW1lbnQzIik7Y29udGludWU7fWlmIChmKCItLVx4M2UiKSAmJiBpLm5ld2xpbmVfYmVmb3JlKSB7XygzKSwgaygiY29tbWVudDQiKTtjb250aW51ZTt9fXZhciBuID0gYygpO2lmICghbikgcmV0dXJuIGQoImVvZiIpO3ZhciB0ID0gbi5jaGFyQ29kZUF0KDApO3N3aXRjaCAodCkge2Nhc2UgMzQ6Y2FzZSAzOTpyZXR1cm4gVChuKTtjYXNlIDQ2OnJldHVybiBsKCksIGYoIi4uIikgPyBkKCJvcGVyYXRvciIsICIuIiArIGwoKSArIGwoKSkgOiBpc19kaWdpdChjKCkuY2hhckNvZGVBdCgwKSkgPyBtKCIuIikgOiBkKCJwdW5jIiwgIi4iKTtjYXNlIDQ3OnZhciByID0gZnVuY3Rpb24gKCkge3N3aXRjaCAobCgpLCBjKCkpIHtjYXNlICIvIjpyZXR1cm4gbCgpLCBrKCJjb21tZW50MSIpO2Nhc2UgIioiOnJldHVybiBsKCksIHcoKTt9cmV0dXJuIGkucmVnZXhfYWxsb3dlZCA/IGIoIiIpIDogaCgiLyIpO30oKTtpZiAociA9PT0gRSkgY29udGludWU7cmV0dXJuIHI7fWlmIChpc19kaWdpdCh0KSkgcmV0dXJuIG0oKTtpZiAoUFVOQ19DSEFSU1tuXSkgcmV0dXJuIGQoInB1bmMiLCBsKCkpO2lmIChmKCI9PiIpKSByZXR1cm4gZCgicHVuYyIsIGwoKSArIGwoKSk7aWYgKE9QRVJBVE9SX0NIQVJTW25dKSByZXR1cm4gaCgpO2lmICgzNSAhPSB0ICYmIDkyICE9IHQgJiYgTk9OX0lERU5USUZJRVJfQ0hBUlNbbl0pIGJyZWFrO3JldHVybiB0ID0gdm9pZCAwLCB0ID0geSgpLCB1ID8gZCgibmFtZSIsIHQpIDogS0VZV09SRFNfQVRPTVt0XSA/IGQoImF0b20iLCB0KSA6IEtFWVdPUkRTW3RdID8gT1BFUkFUT1JTW3RdID8gZCgib3BlcmF0b3IiLCB0KSA6IGQoImtleXdvcmQiLCB0KSA6IGQoIm5hbWUiLCB0KTt9UygiVW5leHBlY3RlZCBjaGFyYWN0ZXIgJyIgKyBuICsgIiciKTt9cmV0dXJuIEUuY29udGV4dCA9IGZ1bmN0aW9uIChlKSB7cmV0dXJuIGkgPSBlID8gZSA6IGk7fSwgRS5hZGRfZGlyZWN0aXZlID0gZnVuY3Rpb24gKGUpIHtpLmRpcmVjdGl2ZXNbZV0gPSAhMDt9LCBFLnB1c2hfZGlyZWN0aXZlc19zdGFjayA9IGZ1bmN0aW9uICgpIHtpLmRpcmVjdGl2ZXMgPSBPYmplY3QuY3JlYXRlKGkuZGlyZWN0aXZlcyk7fSwgRS5wb3BfZGlyZWN0aXZlc19zdGFjayA9IGZ1bmN0aW9uICgpIHtpLmRpcmVjdGl2ZXMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoaS5kaXJlY3RpdmVzKTt9LCBFLmhhc19kaXJlY3RpdmUgPSBmdW5jdGlvbiAoZSkge3JldHVybiAhIWkuZGlyZWN0aXZlc1tlXTt9LCBFO312YXIgVU5BUllfUFJFRklYID0gbWFrZVByZWRpY2F0ZSgidHlwZW9mIHZvaWQgZGVsZXRlIC0tICsrICEgfiAtICsiKSxVTkFSWV9QT1NURklYID0gbWFrZVByZWRpY2F0ZSgiLS0gKysiKSxBU1NJR05NRU5UID0gbWFrZVByZWRpY2F0ZSgiPSArPSAtPSAvPSAqPSAlPSAqKj0gPj49IDw8PSA+Pj49ICY9IHw9IF49ICYmPSB8fD0gPz89IiksUFJFQ0VERU5DRSA9IGZ1bmN0aW9uIChlLCBuKSB7Zm9yICh2YXIgdCA9IDA7IHQgPCBlLmxlbmd0aDspIGZvciAodmFyIHIgPSBlW3QrK10sIGEgPSAwOyBhIDwgci5sZW5ndGg7IGErKykgbltyW2FdXSA9IHQ7cmV0dXJuIG47fShbWyI/PyJdLCBbInx8Il0sIFsiJiYiXSwgWyJ8Il0sIFsiXiJdLCBbIiYiXSwgWyI9PSIsICI9PT0iLCAiIT0iLCAiIT09Il0sIFsiPCIsICI+IiwgIjw9IiwgIj49IiwgImluIiwgImluc3RhbmNlb2YiXSwgWyI+PiIsICI8PCIsICI+Pj4iXSwgWyIrIiwgIi0iXSwgWyIqIiwgIi8iLCAiJSJdLCBbIioqIl1dLCB7fSksQVRPTUlDX1NUQVJUX1RPS0VOID0gbWFrZVByZWRpY2F0ZSgiYXRvbSBiaWdpbnQgbnVtIHJlZ2V4cCBzdHJpbmciKTtmdW5jdGlvbiBwYXJzZShlLCBnKSB7ZyA9IGRlZmF1bHRzKGcsIHsgYmFyZV9yZXR1cm5zOiAhMSwgZXhwcmVzc2lvbjogITEsIGZpbGVuYW1lOiBudWxsLCBodG1sNV9jb21tZW50czogITAsIG1vZHVsZTogITEsIHNoZWJhbmc6ICEwLCBzdHJpY3Q6ICExLCB0b3BsZXZlbDogbnVsbCB9LCAhMCk7dmFyIFIgPSB7IGlucHV0OiAic3RyaW5nIiA9PSB0eXBlb2YgZSA/IHRva2VuaXplcihlLCBnLmZpbGVuYW1lLCBnLmh0bWw1X2NvbW1lbnRzLCBnLnNoZWJhbmcpIDogZSwgaW5fYXN5bmM6ICExLCBpbl9kaXJlY3RpdmVzOiAhMCwgaW5fZnVuYXJnOiAtMSwgaW5fZnVuY3Rpb246IDAsIGluX2dlbmVyYXRvcjogITEsIGluX2xvb3A6IDAsIGxhYmVsczogW10sIHBlZWtlZDogbnVsbCwgcHJldjogbnVsbCwgdG9rZW46IG51bGwgfTtmdW5jdGlvbiBDKGUsIG4pIHtyZXR1cm4gaXNfdG9rZW4oUi50b2tlbiwgZSwgbik7fWZ1bmN0aW9uIE8oKSB7cmV0dXJuIFIucGVla2VkIHx8IChSLnBlZWtlZCA9IFIuaW5wdXQoKSk7fWZ1bmN0aW9uIE4oKSB7cmV0dXJuIFIucHJldiA9IFIudG9rZW4sIFIucGVla2VkID8gKFIudG9rZW4gPSBSLnBlZWtlZCwgUi5wZWVrZWQgPSBudWxsKSA6IFIudG9rZW4gPSBSLmlucHV0KCksIFIuaW5fZGlyZWN0aXZlcyA9IFIuaW5fZGlyZWN0aXZlcyAmJiAoInN0cmluZyIgPT0gUi50b2tlbi50eXBlIHx8IEMoInB1bmMiLCAiOyIpKSwgUi50b2tlbjt9ZnVuY3Rpb24geCgpIHtyZXR1cm4gUi5wcmV2O31mdW5jdGlvbiBQKGUsIG4sIHQsIHIpIHt2YXIgYSA9IFIuaW5wdXQuY29udGV4dCgpO2pzX2Vycm9yKGUsIGEuZmlsZW5hbWUsIG51bGwgIT0gbiA/IG4gOiBhLnRva2xpbmUsIG51bGwgIT0gdCA/IHQgOiBhLnRva2NvbCwgbnVsbCAhPSByID8gciA6IGEudG9rcG9zKTt9ZnVuY3Rpb24gRChlLCBuKSB7UChuLCBlLmxpbmUsIGUuY29sKTt9ZnVuY3Rpb24gcihlLCBuKSB7cmV0dXJuIGUgKyAodm9pZCAwID09PSBuID8gIiIgOiAiIMKrIiArIG4gKyAiwrsiKTt9ZnVuY3Rpb24gSShlKSB7RChlID0gbnVsbCA9PSBlID8gUi50b2tlbiA6IGUsICJVbmV4cGVjdGVkIHRva2VuOiAiICsgcihlLnR5cGUsIGUudmFsdWUpKTt9ZnVuY3Rpb24gRihlLCBuKSB7aWYgKEMoZSwgbikpIHJldHVybiBOKCk7RChSLnRva2VuLCAiVW5leHBlY3RlZCB0b2tlbjogIiArIHIoUi50b2tlbi50eXBlLCBSLnRva2VuLnZhbHVlKSArICIsIGV4cGVjdGVkOiAiICsgcihlLCBuKSk7fWZ1bmN0aW9uIFUoZSkge0YoInB1bmMiLCBlKTt9ZnVuY3Rpb24gSChlKSB7cmV0dXJuIGUubmxiIHx8ICFhbGwoZS5jb21tZW50c19iZWZvcmUsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICFlLm5sYjt9KTt9ZnVuY3Rpb24gWigpIHtyZXR1cm4gIWcuc3RyaWN0ICYmIChDKCJlb2YiKSB8fCBDKCJwdW5jIiwgIn0iKSB8fCBIKFIudG9rZW4pKTt9ZnVuY3Rpb24gVyhlKSB7QygicHVuYyIsICI7IikgPyBOKCkgOiBlIHx8IFooKSB8fCBVKCI7Iik7fWZ1bmN0aW9uIFgoKSB7VSgiKCIpO3ZhciBlID0gSigpO3JldHVybiBVKCIpIiksIGU7fWZ1bmN0aW9uIG4ocikge3JldHVybiBmdW5jdGlvbiAoKSB7dmFyIGUgPSBSLnRva2VuLG4gPSByLmFwcGx5KG51bGwsIGFyZ3VtZW50cyksdCA9IHgoKTtyZXR1cm4gbi5zdGFydCA9IGUsIG4uZW5kID0gdCwgbjt9O31mdW5jdGlvbiBqKCkgeyhDKCJvcGVyYXRvciIsICIvIikgfHwgQygib3BlcmF0b3IiLCAiLz0iKSkgJiYgKFIucGVla2VkID0gbnVsbCwgUi50b2tlbiA9IFIuaW5wdXQoUi50b2tlbi52YWx1ZS5zdWJzdHIoMSkpKTt9Ui50b2tlbiA9IE4oKTt2YXIgWSA9IG4oZnVuY3Rpb24gKGUpIHtzd2l0Y2ggKGooKSwgUi50b2tlbi50eXBlKSB7Y2FzZSAic3RyaW5nIjp2YXIgbiA9IFIuaW5fZGlyZWN0aXZlcyx0ID0gSigpO3JldHVybiBuICYmICh0IGluc3RhbmNlb2YgQVNUX1N0cmluZyA/ICh3ID0gdC5zdGFydC5yYXcuc2xpY2UoMSwgLTEpLCBSLmlucHV0LmFkZF9kaXJlY3RpdmUodyksIHQudmFsdWUgPSB3KSA6IFIuaW5fZGlyZWN0aXZlcyA9IG4gPSAhMSksIFcoKSwgbiA/IG5ldyBBU1RfRGlyZWN0aXZlKHQpIDogbmV3IEFTVF9TaW1wbGVTdGF0ZW1lbnQoeyBib2R5OiB0IH0pO2Nhc2UgIm51bSI6Y2FzZSAiYmlnaW50IjpjYXNlICJyZWdleHAiOmNhc2UgIm9wZXJhdG9yIjpjYXNlICJhdG9tIjpyZXR1cm4gSygpO2Nhc2UgIm5hbWUiOnN3aXRjaCAoUi50b2tlbi52YWx1ZSkge2Nhc2UgImFzeW5jIjppZiAoaXNfdG9rZW4oTygpLCAia2V5d29yZCIsICJmdW5jdGlvbiIpKSByZXR1cm4gTigpLCBOKCksIEMoIm9wZXJhdG9yIiwgIioiKSA/IChOKCksIFYoQVNUX0FzeW5jR2VuZXJhdG9yRGVmdW4pKSA6IFYoQVNUX0FzeW5jRGVmdW4pO2JyZWFrO2Nhc2UgImF3YWl0IjppZiAoUi5pbl9hc3luYykgcmV0dXJuIEsoKTticmVhaztjYXNlICJleHBvcnQiOmlmIChlIHx8ICIiID09PSBnLm1vZHVsZSB8fCBJKCksIE4oKSwgQygib3BlcmF0b3IiLCAiKiIpKSByZXR1cm4gcyA9IG8gPSBSLnRva2VuLCBOKCksIEMoIm5hbWUiLCAiYXMiKSAmJiAoTigpLCB0ZSgpIHx8IEYoIm5hbWUiKSwgcyA9IFIudG9rZW4sIE4oKSksIEYoIm5hbWUiLCAiZnJvbSIpLCBuZXcgQVNUX0V4cG9ydEZvcmVpZ24oeyBhbGlhc2VzOiBbQihzKV0sIGtleXM6IFtCKG8pXSwgcGF0aDogcmUoKSB9KTtpZiAoQygicHVuYyIsICJ7IikpIHtOKCk7Zm9yICh2YXIgciA9IFtdLCBhID0gW107IHRlKCk7KSB7dmFyIG8gPSBSLnRva2VuO04oKSwgYS5wdXNoKG8pLCBDKCJuYW1lIiwgImFzIikgPyAoTigpLCB0ZSgpIHx8IEYoIm5hbWUiKSwgci5wdXNoKFIudG9rZW4pLCBOKCkpIDogci5wdXNoKG8pLCBDKCJwdW5jIiwgIn0iKSB8fCBVKCIsIik7fXJldHVybiAoVSgifSIpLCBDKCJuYW1lIiwgImZyb20iKSkgPyAoTigpLCBuZXcgQVNUX0V4cG9ydEZvcmVpZ24oeyBhbGlhc2VzOiByLm1hcChCKSwga2V5czogYS5tYXAoQiksIHBhdGg6IHJlKCkgfSkpIDogKFcoKSwgbmV3IEFTVF9FeHBvcnRSZWZlcmVuY2VzKHsgcHJvcGVydGllczogYS5tYXAoZnVuY3Rpb24gKGUsIG4pIHtpc190b2tlbihlLCAibmFtZSIpIHx8IEQoZSwgIk5hbWUgZXhwZWN0ZWQiKTtlID0gbGUoQVNUX1N5bWJvbEV4cG9ydCwgZSk7cmV0dXJuIGUuYWxpYXMgPSBCKHJbbl0pLCBlO30pIH0pKTt9cmV0dXJuIEMoImtleXdvcmQiLCAiZGVmYXVsdCIpID8gKE4oKSwgcyA9IFIudG9rZW4sIChjID0gZnVuY3Rpb24gKCkge2lmIChDKCJuYW1lIiwgImFzeW5jIikpIHtpZiAoaXNfdG9rZW4oTygpLCAia2V5d29yZCIsICJmdW5jdGlvbiIpKSByZXR1cm4gTigpLCBOKCksIEMoIm9wZXJhdG9yIiwgIioiKSA/IChOKCksIE0oQVNUX0FzeW5jR2VuZXJhdG9yRGVmdW4sIFYoQVNUX0FzeW5jR2VuZXJhdG9yRnVuY3Rpb24pKSkgOiBNKEFTVF9Bc3luY0RlZnVuLCBWKEFTVF9Bc3luY0Z1bmN0aW9uKSk7fSBlbHNlIGlmIChDKCJrZXl3b3JkIikpIHN3aXRjaCAoUi50b2tlbi52YWx1ZSkge2Nhc2UgImNsYXNzIjpyZXR1cm4gTigpLCBNKEFTVF9EZWZDbGFzcywgbmUoQVNUX0NsYXNzRXhwcmVzc2lvbikpO2Nhc2UgImZ1bmN0aW9uIjpyZXR1cm4gKE4oKSwgQygib3BlcmF0b3IiLCAiKiIpKSA/IChOKCksIE0oQVNUX0dlbmVyYXRvckRlZnVuLCBWKEFTVF9HZW5lcmF0b3JGdW5jdGlvbikpKSA6IE0oQVNUX0RlZnVuLCBWKEFTVF9GdW5jdGlvbikpO319KCkpID8gKGMuc3RhcnQgPSBzLCBjLmVuZCA9IHgoKSkgOiAoaigpLCBjID0gSigpLCBXKCkpLCBuZXcgQVNUX0V4cG9ydERlZmF1bHQoeyBib2R5OiBjIH0pKSA6IG5ldyBBU1RfRXhwb3J0RGVjbGFyYXRpb24oeyBib2R5OiBhZSgpIH0pO2Nhc2UgImltcG9ydCI6dmFyIHMgPSBPKCk7aWYgKCJwdW5jIiA9PSBzLnR5cGUgJiYgL15bKC5dJC8udGVzdChzLnZhbHVlKSkgYnJlYWs7ZSB8fCAiIiA9PT0gZy5tb2R1bGUgfHwgSSgpLCBOKCk7dmFyIGksdSxjID0gbnVsbCxsID0gRyhBU1RfU3ltYm9sSW1wb3J0LCAhMCksXyA9IG51bGw7aWYgKGwgPyAobC5rZXkgPSBuZXcgQVNUX1N0cmluZyh7IHN0YXJ0OiBsLnN0YXJ0LCB2YWx1ZTogIiIsIGVuZDogbC5lbmQgfSksIChpID0gQygicHVuYyIsICIsIikpICYmIE4oKSkgOiBpID0gIUMoInN0cmluZyIpLCBpKSBpZiAoQygib3BlcmF0b3IiLCAiKiIpKSB7dmFyIGYgPSBSLnRva2VuO04oKSwgRigibmFtZSIsICJhcyIpLCAoYyA9IEcoQVNUX1N5bWJvbEltcG9ydCkpLmtleSA9IEIoZik7fSBlbHNlIHtmb3IgKFUoInsiKSwgXyA9IFtdOyB0ZSgpOykgaXNfdG9rZW4oTygpLCAibmFtZSIsICJhcyIpID8gKGYgPSBSLnRva2VuLCBOKCksIE4oKSwgKHUgPSBHKEFTVF9TeW1ib2xJbXBvcnQpKS5rZXkgPSBCKGYpKSA6ICh1ID0gRyhBU1RfU3ltYm9sSW1wb3J0KSkua2V5ID0gbmV3IEFTVF9TdHJpbmcoeyBzdGFydDogdS5zdGFydCwgdmFsdWU6IHUubmFtZSwgZW5kOiB1LmVuZCB9KSwgXy5wdXNoKHUpLCBDKCJwdW5jIiwgIn0iKSB8fCBVKCIsIik7VSgifSIpO31yZXR1cm4gKGMgfHwgbCB8fCBfKSAmJiBGKCJuYW1lIiwgImZyb20iKSwgbmV3IEFTVF9JbXBvcnQoeyBhbGw6IGMsIGRlZmF1bHQ6IGwsIHBhdGg6IHJlKCksIHByb3BlcnRpZXM6IF8gfSk7Y2FzZSAibGV0IjppZiAoc2UoKSkgcmV0dXJuIE4oKSwgcCA9IHVlKCksIFcoKSwgcDticmVhaztjYXNlICJ5aWVsZCI6aWYgKFIuaW5fZ2VuZXJhdG9yKSByZXR1cm4gSygpO31yZXR1cm4gKGlzX3Rva2VuKE8oKSwgInB1bmMiLCAiOiIpID8gZnVuY3Rpb24gKCkge3ZhciBuID0gRyhBU1RfTGFiZWwpO2FsbChSLmxhYmVscywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gZS5uYW1lICE9IG4ubmFtZTt9KSB8fCBQKCJMYWJlbCAiICsgbi5uYW1lICsgIiBkZWZpbmVkIHR3aWNlIik7VSgiOiIpLCBSLmxhYmVscy5wdXNoKG4pO3ZhciBlID0gWSgpO1IubGFiZWxzLnBvcCgpLCBlIGluc3RhbmNlb2YgQVNUX0l0ZXJhdGlvblN0YXRlbWVudCB8fCBuLnJlZmVyZW5jZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2UgaW5zdGFuY2VvZiBBU1RfQ29udGludWUgJiYgRChlLmxhYmVsLnN0YXJ0LCAiQ29udGludWUgbGFiZWwgYCIgKyBuLm5hbWUgKyAiYCBtdXN0IHJlZmVyIHRvIEl0ZXJhdGlvblN0YXRlbWVudCIpO30pO3JldHVybiBuZXcgQVNUX0xhYmVsZWRTdGF0ZW1lbnQoeyBib2R5OiBlLCBsYWJlbDogbiB9KTt9IDogSykoKTtjYXNlICJwdW5jIjpzd2l0Y2ggKFIudG9rZW4udmFsdWUpIHtjYXNlICJ7IjpyZXR1cm4gbmV3IEFTVF9CbG9ja1N0YXRlbWVudCh7IHN0YXJ0OiBSLnRva2VuLCBib2R5OiBMKCksIGVuZDogeCgpIH0pO2Nhc2UgIlsiOmNhc2UgIigiOmNhc2UgImAiOnJldHVybiBLKCk7Y2FzZSAiOyI6cmV0dXJuIFIuaW5fZGlyZWN0aXZlcyA9ICExLCBOKCksIG5ldyBBU1RfRW1wdHlTdGF0ZW1lbnQoKTtkZWZhdWx0OkkoKTt9Y2FzZSAia2V5d29yZCI6c3dpdGNoIChSLnRva2VuLnZhbHVlKSB7Y2FzZSAiYnJlYWsiOnJldHVybiBOKCksIGVlKEFTVF9CcmVhayk7Y2FzZSAiY2xhc3MiOnJldHVybiBOKCksIG5lKEFTVF9EZWZDbGFzcyk7Y2FzZSAiY29uc3QiOk4oKTt2YXIgcCA9IGllKCk7cmV0dXJuIFcoKSwgcDtjYXNlICJjb250aW51ZSI6cmV0dXJuIE4oKSwgZWUoQVNUX0NvbnRpbnVlKTtjYXNlICJkZWJ1Z2dlciI6cmV0dXJuIE4oKSwgVygpLCBuZXcgQVNUX0RlYnVnZ2VyKCk7Y2FzZSAiZG8iOk4oKTt2YXIgdCA9IFEoWSksZCA9IChGKCJrZXl3b3JkIiwgIndoaWxlIiksIFgoKSk7cmV0dXJuIFcoITApLCBuZXcgQVNUX0RvKHsgYm9keTogdCwgY29uZGl0aW9uOiBkIH0pO2Nhc2UgIndoaWxlIjpyZXR1cm4gTigpLCBuZXcgQVNUX1doaWxlKHsgY29uZGl0aW9uOiBYKCksIGJvZHk6IFEoWSkgfSk7Y2FzZSAiZm9yIjpOKCk7dmFyIGQgPSBDKCJuYW1lIiwgImF3YWl0IikgJiYgTigpLFMgPSAoVSgiKCIpLCBudWxsKTtpZiAoIWQgJiYgQygicHVuYyIsICI7IikgfHwgKFMgPSAoQygia2V5d29yZCIsICJjb25zdCIpID8gKE4oKSwgaWUpIDogQygibmFtZSIsICJsZXQiKSAmJiBzZSgpID8gKE4oKSwgdWUpIDogQygia2V5d29yZCIsICJ2YXIiKSA/IChOKCksIGNlKSA6IEopKCEwKSwgZCA/IChGKCJuYW1lIiwgIm9mIiksIFQgPSBBU1RfRm9yQXdhaXRPZikgOiBDKCJvcGVyYXRvciIsICJpbiIpID8gKE4oKSwgVCA9IEFTVF9Gb3JJbikgOiBDKCJuYW1lIiwgIm9mIikgJiYgKE4oKSwgVCA9IEFTVF9Gb3JPZiksICFUKSkgcmV0dXJuIEEgPSBTLCBVKCI7IiksIG0gPSBDKCJwdW5jIiwgIjsiKSA/IG51bGwgOiBKKCksIFUoIjsiKSwgdiA9IEMoInB1bmMiLCAiKSIpID8gbnVsbCA6IEooKSwgVSgiKSIpLCBuZXcgQVNUX0Zvcih7IGluaXQ6IEEsIGNvbmRpdGlvbjogbSwgc3RlcDogdiwgYm9keTogUShZKSB9KTtTIGluc3RhbmNlb2YgQVNUX0RlZmluaXRpb25zID8gKDEgPCBTLmRlZmluaXRpb25zLmxlbmd0aCAmJiBEKFMuc3RhcnQsICJPbmx5IG9uZSB2YXJpYWJsZSBkZWNsYXJhdGlvbiBhbGxvd2VkIGluIGZvci4uaW4vb2YgbG9vcCIpLCBUICE9PSBBU1RfRm9ySW4gJiYgUy5kZWZpbml0aW9uc1swXS52YWx1ZSAmJiBEKFMuZGVmaW5pdGlvbnNbMF0udmFsdWUuc3RhcnQsICJObyBpbml0aWFsaXplcnMgYWxsb3dlZCBpbiBmb3IuLm9mIGxvb3AiKSkgOiAkKFMpIHx8IChTID0geihTKSkgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkIHx8IEQoUy5zdGFydCwgIkludmFsaWQgbGVmdC1oYW5kIHNpZGUgaW4gZm9yLi5pbi9vZiBsb29wIik7dmFyIEEgPSBULG0gPSBTLHYgPSAoaigpLCBKKCkpO3JldHVybiBVKCIpIiksIG5ldyBBKHsgaW5pdDogbSwgb2JqZWN0OiB2LCBib2R5OiBRKFkpIH0pO2Nhc2UgImZ1bmN0aW9uIjpyZXR1cm4gKE4oKSwgQygib3BlcmF0b3IiLCAiKiIpKSA/IChOKCksIFYoQVNUX0dlbmVyYXRvckRlZnVuKSkgOiBWKEFTVF9EZWZ1bik7Y2FzZSAiaWYiOk4oKTt2YXIgVCA9IFgoKSxTID0gWSgpLGsgPSBudWxsO3JldHVybiBDKCJrZXl3b3JkIiwgImVsc2UiKSAmJiAoTigpLCBrID0gWSgpKSwgbmV3IEFTVF9JZih7IGNvbmRpdGlvbjogVCwgYm9keTogUywgYWx0ZXJuYXRpdmU6IGsgfSk7Y2FzZSAicmV0dXJuIjowICE9IFIuaW5fZnVuY3Rpb24gfHwgZy5iYXJlX3JldHVybnMgfHwgUCgiJ3JldHVybicgb3V0c2lkZSBvZiBmdW5jdGlvbiIpLCBOKCk7dmFyIHcgPSBudWxsO3JldHVybiBDKCJwdW5jIiwgIjsiKSA/IE4oKSA6IFooKSB8fCAodyA9IEooKSwgVygpKSwgbmV3IEFTVF9SZXR1cm4oeyB2YWx1ZTogdyB9KTtjYXNlICJzd2l0Y2giOnJldHVybiBOKCksIG5ldyBBU1RfU3dpdGNoKHsgZXhwcmVzc2lvbjogWCgpLCBib2R5OiBRKG9lKSB9KTtjYXNlICJ0aHJvdyI6TigpLCBIKFIudG9rZW4pICYmIFAoIklsbGVnYWwgbmV3bGluZSBhZnRlciAndGhyb3cnIik7dyA9IEooKTtyZXR1cm4gVygpLCBuZXcgQVNUX1Rocm93KHsgdmFsdWU6IHcgfSk7Y2FzZSAidHJ5IjpOKCk7dmFyIHksYixrID0gTCgpLGggPSBudWxsLEUgPSBudWxsO3JldHVybiBDKCJrZXl3b3JkIiwgImNhdGNoIikgJiYgKGIgPSBSLnRva2VuLCBOKCksIHkgPSBudWxsLCBDKCJwdW5jIiwgIigiKSAmJiAoTigpLCB5ID0gcShBU1RfU3ltYm9sQ2F0Y2gpLCBVKCIpIikpLCBoID0gbmV3IEFTVF9DYXRjaCh7IHN0YXJ0OiBiLCBhcmduYW1lOiB5LCBib2R5OiBMKCksIGVuZDogeCgpIH0pKSwgQygia2V5d29yZCIsICJmaW5hbGx5IikgJiYgKGIgPSBSLnRva2VuLCBOKCksIEUgPSBuZXcgQVNUX0ZpbmFsbHkoeyBzdGFydDogYiwgYm9keTogTCgpLCBlbmQ6IHgoKSB9KSksIGggfHwgRSB8fCBQKCJNaXNzaW5nIGNhdGNoL2ZpbmFsbHkgYmxvY2tzIiksIG5ldyBBU1RfVHJ5KHsgYm9keTogaywgYmNhdGNoOiBoLCBiZmluYWxseTogRSB9KTtjYXNlICJ2YXIiOk4oKTtwID0gY2UoKTtyZXR1cm4gVygpLCBwO2Nhc2UgIndpdGgiOnJldHVybiBSLmlucHV0Lmhhc19kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSAmJiBQKCJTdHJpY3QgbW9kZSBtYXkgbm90IGluY2x1ZGUgYSB3aXRoIHN0YXRlbWVudCIpLCBOKCksIG5ldyBBU1RfV2l0aCh7IGV4cHJlc3Npb246IFgoKSwgYm9keTogWSgpIH0pO319SSgpO30pO2Z1bmN0aW9uIEsoKSB7dmFyIGUgPSBKKCk7cmV0dXJuIFcoKSwgbmV3IEFTVF9TaW1wbGVTdGF0ZW1lbnQoeyBib2R5OiBlIH0pO31mdW5jdGlvbiBlZShlKSB7dmFyIG4sdCA9IG51bGwsZSA9IChudWxsICE9ICh0ID0gWigpID8gdCA6IEcoQVNUX0xhYmVsUmVmLCAhMCkpID8gKChuID0gZmluZF9pZihmdW5jdGlvbiAoZSkge3JldHVybiBlLm5hbWUgPT0gdC5uYW1lO30sIFIubGFiZWxzKSkgfHwgRCh0LnN0YXJ0LCAiVW5kZWZpbmVkIGxhYmVsICIgKyB0Lm5hbWUpLCB0LnRoZWRlZiA9IG4pIDogMCA9PSBSLmluX2xvb3AgJiYgUChlLlRZUEUgKyAiIG5vdCBpbnNpZGUgYSBsb29wIG9yIHN3aXRjaCIpLCBXKCksIG5ldyBlKHsgbGFiZWw6IHQgfSkpO3JldHVybiBuICYmIG4ucmVmZXJlbmNlcy5wdXNoKGUpLCBlO31mdW5jdGlvbiBBKGUsIG4pIHtpZiAoQygibmFtZSIsIGUpKSB7ZSA9IE8oKTtpZiAoZSAmJiAhaXNfdG9rZW4oZSwgIm9wZXJhdG9yIiwgIj0iKSAmJiAhKCJwdW5jIiA9PSBlLnR5cGUgJiYgL15bKDt9XSQvLnRlc3QoZS52YWx1ZSkgfHwgbiAmJiBIKGUpKSkgcmV0dXJuIE4oKTt9fWZ1bmN0aW9uIG5lKGUpIHtmb3IgKHZhciBuLCB0ID0gUi5pbl9hc3luYywgciA9IFIuaW5fZ2VuZXJhdG9yLCBhID0gKFIuaW5wdXQucHVzaF9kaXJlY3RpdmVzX3N0YWNrKCksIFIuaW5wdXQuYWRkX2RpcmVjdGl2ZSgidXNlIHN0cmljdCIpLCBuID0gZSA9PT0gQVNUX0RlZkNsYXNzID8gRyhBU1RfU3ltYm9sRGVmQ2xhc3MpIDogRyhBU1RfU3ltYm9sQ2xhc3MsICEwKSwgbnVsbCksIG8gPSAoQygia2V5d29yZCIsICJleHRlbmRzIikgJiYgKE4oKSwgaigpLCBhID0gX20oITApKSwgVSgieyIpLCBbXSk7ICFDKCJwdW5jIiwgIn0iKTspIGlmIChDKCJwdW5jIiwgIjsiKSkgTigpO2Vsc2Uge3ZhciBzID0gUi50b2tlbixpID0gISFBKCJzdGF0aWMiKSx1ID0gQSgiYXN5bmMiLCAhMCk7aWYgKEMoIm9wZXJhdG9yIiwgIioiKSkge04oKTt2YXIgYyA9IEMoIm5hbWUiKSAmJiAvXiMvLnRlc3QoUi50b2tlbi52YWx1ZSksbCA9IGQoKSxfID0gUi50b2tlbixmID0gVih1ID8gQVNUX0FzeW5jR2VuZXJhdG9yRnVuY3Rpb24gOiBBU1RfR2VuZXJhdG9yRnVuY3Rpb24pO2Yuc3RhcnQgPSBfLCBmLmVuZCA9IHgoKSwgby5wdXNoKG5ldyBBU1RfQ2xhc3NNZXRob2QoeyBzdGFydDogcywgc3RhdGljOiBpLCBwcml2YXRlOiBjLCBrZXk6IGwsIHZhbHVlOiBmLCBlbmQ6IHgoKSB9KSk7fSBlbHNlIGlmIChpICYmIEMoInB1bmMiLCAieyIpKSBvLnB1c2gobmV3IEFTVF9DbGFzc0luaXQoeyBzdGFydDogcywgdmFsdWU6IG5ldyBBU1RfQ2xhc3NJbml0QmxvY2soeyBzdGFydDogcywgYm9keTogTCgpLCBlbmQ6IHgoKSB9KSwgZW5kOiB4KCkgfSkpO2Vsc2Uge2MgPSBDKCJuYW1lIikgJiYgL14jLy50ZXN0KFIudG9rZW4udmFsdWUpLCBsID0gZCgpO2lmIChDKCJwdW5jIiwgIigiKSkge18gPSBSLnRva2VuLCBmID0gVih1ID8gQVNUX0FzeW5jRnVuY3Rpb24gOiBBU1RfRnVuY3Rpb24pO2Yuc3RhcnQgPSBfLCBmLmVuZCA9IHgoKSwgby5wdXNoKG5ldyBBU1RfQ2xhc3NNZXRob2QoeyBzdGFydDogcywgc3RhdGljOiBpLCBwcml2YXRlOiBjLCBrZXk6IGwsIHZhbHVlOiBmLCBlbmQ6IHgoKSB9KSk7fSBlbHNlIHt1ICYmIEkodSk7dSA9IG51bGw7aWYgKEMoIm9wZXJhdG9yIiwgIj0iKSkgTigpLCBSLmluX2FzeW5jID0gITEsIFIuaW5fZ2VuZXJhdG9yID0gITEsIHUgPSBTKCksIFIuaW5fZ2VuZXJhdG9yID0gciwgUi5pbl9hc3luYyA9IHQ7ZWxzZSBpZiAoIUMoInB1bmMiLCAiOyIpICYmICFDKCJwdW5jIiwgIn0iKSkge3ZhciBwID0gbnVsbDtzd2l0Y2ggKGwpIHtjYXNlICJnZXQiOnAgPSBBU1RfQ2xhc3NHZXR0ZXI7YnJlYWs7Y2FzZSAic2V0IjpwID0gQVNUX0NsYXNzU2V0dGVyO31pZiAocCkge28ucHVzaChuZXcgcCh7IHN0YXJ0OiBzLCBzdGF0aWM6IGksIHByaXZhdGU6IEMoIm5hbWUiKSAmJiAvXiMvLnRlc3QoUi50b2tlbi52YWx1ZSksIGtleTogZCgpLCB2YWx1ZTogVCgpLCBlbmQ6IHgoKSB9KSk7Y29udGludWU7fX1XKCksIG8ucHVzaChuZXcgQVNUX0NsYXNzRmllbGQoeyBzdGFydDogcywgc3RhdGljOiBpLCBwcml2YXRlOiBjLCBrZXk6IGwsIHZhbHVlOiB1LCBlbmQ6IHgoKSB9KSk7fX19cmV0dXJuIE4oKSwgUi5pbnB1dC5wb3BfZGlyZWN0aXZlc19zdGFjaygpLCBSLmluX2dlbmVyYXRvciA9IHIsIFIuaW5fYXN5bmMgPSB0LCBuZXcgZSh7IGV4dGVuZHM6IGEsIG5hbWU6IG4sIHByb3BlcnRpZXM6IG8gfSk7fWZ1bmN0aW9uIF8oZSkge3ZhciBuO3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0FycmF5ID8gKG4gPSBudWxsLCBlLmVsZW1lbnRzW2UuZWxlbWVudHMubGVuZ3RoIC0gMV0gaW5zdGFuY2VvZiBBU1RfU3ByZWFkICYmIChuID0gXyhlLmVsZW1lbnRzLnBvcCgpLmV4cHJlc3Npb24pKSwgbmV3IEFTVF9EZXN0cnVjdHVyZWRBcnJheSh7IHN0YXJ0OiBlLnN0YXJ0LCBlbGVtZW50czogZS5lbGVtZW50cy5tYXAoXyksIHJlc3Q6IG4sIGVuZDogZS5lbmQgfSkpIDogZSBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gPyBuZXcgQVNUX0RlZmF1bHRWYWx1ZSh7IHN0YXJ0OiBlLnN0YXJ0LCBuYW1lOiBfKGUubGVmdCksIHZhbHVlOiBlLnJpZ2h0LCBlbmQ6IGUuZW5kIH0pIDogZSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgPyAoZS5uYW1lID0gXyhlLm5hbWUpLCBlKSA6IGUgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkQXJyYXkgPyAoZS5lbGVtZW50cyA9IGUuZWxlbWVudHMubWFwKF8pLCBlLnJlc3QgJiYgKGUucmVzdCA9IF8oZS5yZXN0KSksIGUpIDogZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRPYmplY3QgPyAoZS5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLnZhbHVlID0gXyhlLnZhbHVlKTt9KSwgZS5yZXN0ICYmIChlLnJlc3QgPSBfKGUucmVzdCkpLCBlKSA6IGUgaW5zdGFuY2VvZiBBU1RfSG9sZSA/IGUgOiBlIGluc3RhbmNlb2YgQVNUX09iamVjdCA/IChuID0gbnVsbCwgZS5wcm9wZXJ0aWVzW2UucHJvcGVydGllcy5sZW5ndGggLSAxXSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQgJiYgKG4gPSBfKGUucHJvcGVydGllcy5wb3AoKS5leHByZXNzaW9uKSksIG5ldyBBU1RfRGVzdHJ1Y3R1cmVkT2JqZWN0KHsgc3RhcnQ6IGUuc3RhcnQsIHByb3BlcnRpZXM6IGUucHJvcGVydGllcy5tYXAoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9PYmplY3RLZXlWYWwgfHwgRChlLnN0YXJ0LCAiSW52YWxpZCBkZXN0cnVjdHVyaW5nIGFzc2lnbm1lbnQiKSwgbmV3IEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwoeyBzdGFydDogZS5zdGFydCwga2V5OiBlLmtleSwgdmFsdWU6IF8oZS52YWx1ZSksIGVuZDogZS5lbmQgfSk7fSksIHJlc3Q6IG4sIGVuZDogZS5lbmQgfSkpIDogZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcgPyBlIDogZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyBuZXcgQVNUX1N5bWJvbEZ1bmFyZyhlKSA6IGUgaW5zdGFuY2VvZiBBU1RfWWllbGQgPyBuZXcgQVNUX1N5bWJvbEZ1bmFyZyh7IHN0YXJ0OiBlLnN0YXJ0LCBuYW1lOiAieWllbGQiLCBlbmQ6IGUuZW5kIH0pIDogdm9pZCBEKGUuc3RhcnQsICJJbnZhbGlkIGFycm93IHBhcmFtZXRlciIpO31mdW5jdGlvbiBsKGUsIG4sIHQpIHt2YXIgcixhLG8gPSBSLmluX2FzeW5jLHMgPSBSLmluX2dlbmVyYXRvcixpID0gKFIuaW5fYXN5bmMgPSB0LCBSLmluX2dlbmVyYXRvciA9ICExLCBSLmluX2Z1bmFyZyksdSA9IChSLmluX2Z1bmFyZyA9IFIuaW5fZnVuY3Rpb24sIGUubWFwKF8pKSxlID0gKGUgPSBlLnJlc3QgfHwgbnVsbCkgJiYgXyhlKSxpID0gKFIuaW5fZnVuYXJnID0gaSwgVSgiPT4iKSwgUi5pbl9sb29wKSxjID0gUi5sYWJlbHMsbCA9ICgrK1IuaW5fZnVuY3Rpb24sIFIuaW5wdXQucHVzaF9kaXJlY3RpdmVzX3N0YWNrKCksIFIuaW5fbG9vcCA9IDAsIFIubGFiZWxzID0gW10sIGEgPSBDKCJwdW5jIiwgInsiKSA/IChSLmluX2RpcmVjdGl2ZXMgPSAhMCwgciA9IEwoKSwgbnVsbCkgOiAociA9IFtdLCBqKCksIFMoKSksIFIuaW5wdXQuaGFzX2RpcmVjdGl2ZSgidXNlIHN0cmljdCIpKSxpID0gKFIuaW5wdXQucG9wX2RpcmVjdGl2ZXNfc3RhY2soKSwgLS1SLmluX2Z1bmN0aW9uLCBSLmluX2xvb3AgPSBpLCBSLmxhYmVscyA9IGMsIFIuaW5fZ2VuZXJhdG9yID0gcywgUi5pbl9hc3luYyA9IG8sIG5ldyAodCA/IEFTVF9Bc3luY0Fycm93IDogQVNUX0Fycm93KSh7IHN0YXJ0OiBuLCBhcmduYW1lczogdSwgcmVzdDogZSwgYm9keTogciwgdmFsdWU6IGEsIGVuZDogeCgpIH0pKTtyZXR1cm4gbCAmJiBpLmVhY2hfYXJnbmFtZSh3KSwgaTt9dmFyIFYgPSBmdW5jdGlvbiBWKGUpIHt2YXIgbix0ID0gUi5pbl9hc3luYyxyID0gUi5pbl9nZW5lcmF0b3IsYSA9ICgvRGVmdW4kLy50ZXN0KGUuVFlQRSkgPyAobiA9IEcoQVNUX1N5bWJvbERlZnVuKSwgUi5pbl9hc3luYyA9IC9eQXN5bmMvLnRlc3QoZS5UWVBFKSwgUi5pbl9nZW5lcmF0b3IgPSAvR2VuZXJhdG9yLy50ZXN0KGUuVFlQRSkpIDogKFIuaW5fYXN5bmMgPSAvXkFzeW5jLy50ZXN0KGUuVFlQRSksIFIuaW5fZ2VuZXJhdG9yID0gL0dlbmVyYXRvci8udGVzdChlLlRZUEUpLCBuID0gRyhBU1RfU3ltYm9sTGFtYmRhLCAhMCkpLCAhbiB8fCBlID09PSBBU1RfQWNjZXNzb3IgfHwgbiBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiB8fCBJKHgoKSksIFUoIigiKSwgUi5pbl9mdW5hcmcpLG8gPSAoUi5pbl9mdW5hcmcgPSBSLmluX2Z1bmN0aW9uLCBmKCIpIiwgIWcuc3RyaWN0LCAhMSwgZnVuY3Rpb24gKCkge3JldHVybiBjKEFTVF9TeW1ib2xGdW5hcmcpO30pKSxhID0gKFIuaW5fZnVuYXJnID0gYSwgUi5pbl9sb29wKSxzID0gUi5sYWJlbHMsaSA9ICgrK1IuaW5fZnVuY3Rpb24sIFIuaW5fZGlyZWN0aXZlcyA9ICEwLCBSLmlucHV0LnB1c2hfZGlyZWN0aXZlc19zdGFjaygpLCBSLmluX2xvb3AgPSAwLCBSLmxhYmVscyA9IFtdLCBMKCkpLHUgPSBSLmlucHV0Lmhhc19kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSxhID0gKFIuaW5wdXQucG9wX2RpcmVjdGl2ZXNfc3RhY2soKSwgLS1SLmluX2Z1bmN0aW9uLCBSLmluX2xvb3AgPSBhLCBSLmxhYmVscyA9IHMsIFIuaW5fZ2VuZXJhdG9yID0gciwgUi5pbl9hc3luYyA9IHQsIG5ldyBlKHsgbmFtZTogbiwgYXJnbmFtZXM6IG8sIHJlc3Q6IG8ucmVzdCB8fCBudWxsLCBib2R5OiBpIH0pKTtyZXR1cm4gdSAmJiAobiAmJiB3KG4pLCBhLmVhY2hfYXJnbmFtZSh3KSksIGE7fTtmdW5jdGlvbiB0ZSgpIHtyZXR1cm4gQygibmFtZSIpIHx8IEMoInN0cmluZyIpIHx8IGlzX2lkZW50aWZpZXJfc3RyaW5nKFIudG9rZW4udmFsdWUpO31mdW5jdGlvbiBCKGUpIHtyZXR1cm4gbmV3IEFTVF9TdHJpbmcoeyBzdGFydDogZSwgcXVvdGU6IGUucXVvdGUsIHZhbHVlOiBlLnZhbHVlLCBlbmQ6IGUgfSk7fWZ1bmN0aW9uIHJlKCkge3ZhciBlID0gUi50b2tlbjtyZXR1cm4gRigic3RyaW5nIiksIFcoKSwgQihlKTt9ZnVuY3Rpb24gTShlLCBuKSB7cmV0dXJuIG4ubmFtZSAmJiAoKG4gPSBuZXcgZShuKSkubmFtZSA9IG5ldyAoZSA9PT0gQVNUX0RlZkNsYXNzID8gQVNUX1N5bWJvbERlZkNsYXNzIDogQVNUX1N5bWJvbERlZnVuKShuLm5hbWUpKSwgbjt9dmFyIGFlID0gbihmdW5jdGlvbiAoKSB7aWYgKEMoIm5hbWUiKSkgc3dpdGNoIChSLnRva2VuLnZhbHVlKSB7Y2FzZSAiYXN5bmMiOnJldHVybiAoTigpLCBGKCJrZXl3b3JkIiwgImZ1bmN0aW9uIiksIEMoIm9wZXJhdG9yIiwgIioiKSkgPyAoTigpLCBWKEFTVF9Bc3luY0dlbmVyYXRvckRlZnVuKSkgOiBWKEFTVF9Bc3luY0RlZnVuKTtjYXNlICJsZXQiOk4oKTt2YXIgZSA9IHVlKCk7cmV0dXJuIFcoKSwgZTt9IGVsc2UgaWYgKEMoImtleXdvcmQiKSkgc3dpdGNoIChSLnRva2VuLnZhbHVlKSB7Y2FzZSAiY2xhc3MiOnJldHVybiBOKCksIG5lKEFTVF9EZWZDbGFzcyk7Y2FzZSAiY29uc3QiOk4oKTtlID0gaWUoKTtyZXR1cm4gVygpLCBlO2Nhc2UgImZ1bmN0aW9uIjpyZXR1cm4gKE4oKSwgQygib3BlcmF0b3IiLCAiKiIpKSA/IChOKCksIFYoQVNUX0dlbmVyYXRvckRlZnVuKSkgOiBWKEFTVF9EZWZ1bik7Y2FzZSAidmFyIjpOKCk7ZSA9IGNlKCk7cmV0dXJuIFcoKSwgZTt9SSgpO30pO2Z1bmN0aW9uIEwoKSB7VSgieyIpO2ZvciAodmFyIGUgPSBbXTsgIUMoInB1bmMiLCAifSIpOykgQygiZW9mIikgJiYgVSgifSIpLCBlLnB1c2goWSgpKTtyZXR1cm4gTigpLCBlO31mdW5jdGlvbiBvZSgpIHtVKCJ7Iik7Zm9yICh2YXIgZSwgbiwgdCwgciwgYSA9IFtdOyAhQygicHVuYyIsICJ9Iik7KSBDKCJlb2YiKSAmJiBVKCJ9IiksIEMoImtleXdvcmQiLCAiY2FzZSIpID8gKGUgJiYgKGUuZW5kID0geCgpKSwgbiA9IFtdLCBlID0gbmV3IEFTVF9DYXNlKHsgc3RhcnQ6IChyID0gUi50b2tlbiwgTigpLCByKSwgZXhwcmVzc2lvbjogSigpLCBib2R5OiBuIH0pLCBhLnB1c2goZSksIFUoIjoiKSkgOiBDKCJrZXl3b3JkIiwgImRlZmF1bHQiKSA/IChlICYmIChlLmVuZCA9IHgoKSksIHQgJiYgUCgiTW9yZSB0aGFuIG9uZSBkZWZhdWx0IGNsYXVzZSBpbiBzd2l0Y2ggc3RhdGVtZW50IiksIG4gPSBbXSwgZSA9IG5ldyBBU1RfRGVmYXVsdCh7IHN0YXJ0OiAociA9IFIudG9rZW4sIE4oKSwgVSgiOiIpLCByKSwgYm9keTogbiB9KSwgYS5wdXNoKGUpLCB0ID0gZSkgOiAobiB8fCBJKCksIG4ucHVzaChZKCkpKTtyZXR1cm4gZSAmJiAoZS5lbmQgPSB4KCkpLCBOKCksIGE7fWZ1bmN0aW9uIGEoZSwgbikge2ZvciAodmFyIHQgPSBbXTs7KSB7dmFyIHIgPSBSLnRva2VuLGEgPSBxKGUpLG8gPSBudWxsO2lmIChDKCJvcGVyYXRvciIsICI9IikgPyAoTigpLCBvID0gUyhuKSkgOiAhbiAmJiAoZSA9PT0gQVNUX1N5bWJvbENvbnN0IHx8IGEgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkKSAmJiBQKCJNaXNzaW5nIGluaXRpYWxpemVyIGluIGRlY2xhcmF0aW9uIiksIHQucHVzaChuZXcgQVNUX1ZhckRlZih7IHN0YXJ0OiByLCBuYW1lOiBhLCB2YWx1ZTogbywgZW5kOiB4KCkgfSkpLCAhQygicHVuYyIsICIsIikpIGJyZWFrO04oKTt9cmV0dXJuIHQ7fWZ1bmN0aW9uIHNlKCkge3ZhciBlID0gTygpO3JldHVybiBpc190b2tlbihlLCAibmFtZSIpIHx8IGlzX3Rva2VuKGUsICJwdW5jIiwgIlsiKSB8fCBpc190b2tlbihlLCAicHVuYyIsICJ7Iik7fXZhciBpZSA9IGZ1bmN0aW9uIGllKGUpIHtyZXR1cm4gbmV3IEFTVF9Db25zdCh7IHN0YXJ0OiB4KCksIGRlZmluaXRpb25zOiBhKEFTVF9TeW1ib2xDb25zdCwgZSksIGVuZDogeCgpIH0pO30sdWUgPSBmdW5jdGlvbiB1ZShlKSB7cmV0dXJuIG5ldyBBU1RfTGV0KHsgc3RhcnQ6IHgoKSwgZGVmaW5pdGlvbnM6IGEoQVNUX1N5bWJvbExldCwgZSksIGVuZDogeCgpIH0pO30sY2UgPSBmdW5jdGlvbiBjZShlKSB7cmV0dXJuIG5ldyBBU1RfVmFyKHsgc3RhcnQ6IHgoKSwgZGVmaW5pdGlvbnM6IGEoQVNUX1N5bWJvbFZhciwgZSksIGVuZDogeCgpIH0pO307dmFyIF9tID0gZnVuY3Rpb24gbShlKSB7aWYgKEMoIm9wZXJhdG9yIiwgIm5ldyIpKSByZXR1cm4gbiA9IGUsIGkgPSBSLnRva2VuLCBGKCJvcGVyYXRvciIsICJuZXciKSwgKHUgPSBDKCJwdW5jIiwgIi4iKSAmJiBpc190b2tlbihPKCksICJuYW1lIiwgInRhcmdldCIpID8gKE4oKSwgTigpLCBuZXcgQVNUX05ld1RhcmdldCgpKSA6ICh1ID0gX20oITEpLCBjID0gQygicHVuYyIsICIoIikgPyAoTigpLCBmKCIpIiwgIWcuc3RyaWN0KSkgOiBbXSwgbmV3IEFTVF9OZXcoeyBleHByZXNzaW9uOiB1LCBhcmdzOiBjIH0pKSkuc3RhcnQgPSBpLCB1LmVuZCA9IHgoKSwgcCh1LCBuKTt2YXIgbix0LHIsYSA9IFIudG9rZW47aWYgKEMoInB1bmMiKSkge3N3aXRjaCAoYS52YWx1ZSkge2Nhc2UgImAiOnJldHVybiBwKHkobnVsbCksIGUpO2Nhc2UgIigiOnJldHVybiAoTigpLCBDKCJwdW5jIiwgIikiKSkgPyAoTigpLCBsKFtdLCBhKSkgOiAodCA9IEooITEsICEwKSwgciA9IGEuY29tbWVudHNfYmVmb3JlLmxlbmd0aCwgW10udW5zaGlmdC5hcHBseSh0LnN0YXJ0LmNvbW1lbnRzX2JlZm9yZSwgYS5jb21tZW50c19iZWZvcmUpLCBhLmNvbW1lbnRzX2JlZm9yZS5sZW5ndGggPSAwLCBhLmNvbW1lbnRzX2JlZm9yZSA9IHQuc3RhcnQuY29tbWVudHNfYmVmb3JlLCAwID09IChhLmNvbW1lbnRzX2JlZm9yZV9sZW5ndGggPSByKSAmJiAwIDwgYS5jb21tZW50c19iZWZvcmUubGVuZ3RoICYmICgociA9IGEuY29tbWVudHNfYmVmb3JlWzBdKS5ubGIgfHwgKHIubmxiID0gYS5ubGIsIGEubmxiID0gITEpKSwgYS5jb21tZW50c19hZnRlciA9IHQuc3RhcnQuY29tbWVudHNfYWZ0ZXIsIHQuc3RhcnQgPSBhLCBVKCIpIiksIChyID0geCgpKS5jb21tZW50c19iZWZvcmUgPSB0LmVuZC5jb21tZW50c19iZWZvcmUsIHIuY29tbWVudHNfYWZ0ZXIuZm9yRWFjaChmdW5jdGlvbiAoZSkge3QuZW5kLmNvbW1lbnRzX2FmdGVyLnB1c2goZSksIGUubmxiICYmIChSLnRva2VuLm5sYiA9ICEwKTt9KSwgci5jb21tZW50c19hZnRlci5sZW5ndGggPSAwLCByLmNvbW1lbnRzX2FmdGVyID0gdC5lbmQuY29tbWVudHNfYWZ0ZXIsIHQuZW5kID0gciwgQygicHVuYyIsICI9PiIpID8gbCh0IGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlID8gdC5leHByZXNzaW9ucyA6IFt0XSwgYSkgOiBwKHQsIGUpKTtjYXNlICJbIjpyZXR1cm4gcCh2KCksIGUpO2Nhc2UgInsiOnJldHVybiBwKGsoKSwgZSk7fUkoKTt9aWYgKEMoImtleXdvcmQiKSkgc3dpdGNoIChhLnZhbHVlKSB7Y2FzZSAiY2xhc3MiOk4oKTt2YXIgbyA9IG5lKEFTVF9DbGFzc0V4cHJlc3Npb24pO3JldHVybiBvLnN0YXJ0ID0gYSwgby5lbmQgPSB4KCksIHAobywgZSk7Y2FzZSAiZnVuY3Rpb24iOnJldHVybiBOKCksIChzID0gQygib3BlcmF0b3IiLCAiKiIpID8gKE4oKSwgVihBU1RfR2VuZXJhdG9yRnVuY3Rpb24pKSA6IFYoQVNUX0Z1bmN0aW9uKSkuc3RhcnQgPSBhLCBzLmVuZCA9IHgoKSwgcChzLCBlKTt9aWYgKEMoIm5hbWUiKSkge3ZhciBzLGksdSxjID0gbGUoQVNUX1N5bWJvbFJlZiwgYSk7aWYgKE4oKSwgImFzeW5jIiA9PSBjLm5hbWUpIHtpZiAoQygia2V5d29yZCIsICJmdW5jdGlvbiIpKSByZXR1cm4gTigpLCAocyA9IEMoIm9wZXJhdG9yIiwgIioiKSA/IChOKCksIFYoQVNUX0FzeW5jR2VuZXJhdG9yRnVuY3Rpb24pKSA6IFYoQVNUX0FzeW5jRnVuY3Rpb24pKS5zdGFydCA9IGEsIHMuZW5kID0geCgpLCBwKHMsIGUpO2lmIChDKCJuYW1lIikgJiYgaXNfdG9rZW4oTygpLCAicHVuYyIsICI9PiIpKSByZXR1cm4gYSA9IFIudG9rZW4sIGMgPSBsZShBU1RfU3ltYm9sUmVmLCBhKSwgTigpLCBsKFtjXSwgYSwgITApO2lmIChDKCJwdW5jIiwgIigiKSkgcmV0dXJuIGkgPSBwKGMsIGUpLCBDKCJwdW5jIiwgIj0+IikgPyAoKHUgPSBpLmFyZ3MpW3UubGVuZ3RoIC0gMV0gaW5zdGFuY2VvZiBBU1RfU3ByZWFkICYmICh1LnJlc3QgPSB1LnBvcCgpLmV4cHJlc3Npb24pLCBsKHUsIGEsICEwKSkgOiBpO31yZXR1cm4gQygicHVuYyIsICI9PiIpID8gbChbY10sIGEpIDogcChjLCBlKTt9aWYgKEFUT01JQ19TVEFSVF9UT0tFTltSLnRva2VuLnR5cGVdKSByZXR1cm4gcChmdW5jdGlvbiAoKSB7dmFyIGUsbiA9IFIudG9rZW4sdCA9IG4udmFsdWU7c3dpdGNoIChuLnR5cGUpIHtjYXNlICJudW0iOmlzRmluaXRlKHQpID8gZSA9IG5ldyBBU1RfTnVtYmVyKHsgdmFsdWU6IHQgfSkgOiAoZSA9IG5ldyBBU1RfSW5maW5pdHkoKSwgdCA8IDAgJiYgKGUgPSBuZXcgQVNUX1VuYXJ5UHJlZml4KHsgb3BlcmF0b3I6ICItIiwgZXhwcmVzc2lvbjogZSB9KSkpO2JyZWFrO2Nhc2UgImJpZ2ludCI6ZSA9IG5ldyBBU1RfQmlnSW50KHsgdmFsdWU6IHQgfSk7YnJlYWs7Y2FzZSAic3RyaW5nIjplID0gbmV3IEFTVF9TdHJpbmcoeyB2YWx1ZTogdCwgcXVvdGU6IG4ucXVvdGUgfSk7YnJlYWs7Y2FzZSAicmVnZXhwIjplID0gbmV3IEFTVF9SZWdFeHAoeyB2YWx1ZTogdCB9KTticmVhaztjYXNlICJhdG9tIjpzd2l0Y2ggKHQpIHtjYXNlICJmYWxzZSI6ZSA9IG5ldyBBU1RfRmFsc2UoKTticmVhaztjYXNlICJ0cnVlIjplID0gbmV3IEFTVF9UcnVlKCk7YnJlYWs7Y2FzZSAibnVsbCI6ZSA9IG5ldyBBU1RfTnVsbCgpO2JyZWFrO2RlZmF1bHQ6SSgpO31icmVhaztkZWZhdWx0OkkoKTt9cmV0dXJuIE4oKSwgZS5zdGFydCA9IGUuZW5kID0gbiwgZTt9KCksIGUpO0koKTt9O2Z1bmN0aW9uIGYoZSwgbiwgdCwgcikge3IgPSByIHx8IFM7Zm9yICh2YXIgYSA9ICEwLCBvID0gW107ICFDKCJwdW5jIiwgZSkgJiYgKGEgPyBhID0gITEgOiBVKCIsIiksICFuIHx8ICFDKCJwdW5jIiwgZSkpOykgaWYgKHQgJiYgQygicHVuYyIsICIsIikpIG8ucHVzaChuZXcgQVNUX0hvbGUoeyBzdGFydDogUi50b2tlbiwgZW5kOiBSLnRva2VuIH0pKTtlbHNlIGlmIChDKCJvcGVyYXRvciIsICIuLi4iKSkge2lmIChyICE9PSBTKSB7TigpLCBvLnJlc3QgPSByKCksIG8ucmVzdCBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgJiYgRChvLnJlc3Quc3RhcnQsICJJbnZhbGlkIHJlc3QgcGFyYW1ldGVyIik7YnJlYWs7fW8ucHVzaChuZXcgQVNUX1NwcmVhZCh7IHN0YXJ0OiBSLnRva2VuLCBleHByZXNzaW9uOiAoTigpLCByKCkpLCBlbmQ6IHgoKSB9KSk7fSBlbHNlIG8ucHVzaChyKCkpO3JldHVybiBVKGUpLCBvO312YXIgdiA9IG4oZnVuY3Rpb24gKCkge3JldHVybiBVKCJbIiksIG5ldyBBU1RfQXJyYXkoeyBlbGVtZW50czogZigiXSIsICFnLnN0cmljdCwgITApIH0pO30pLFQgPSBuKGZ1bmN0aW9uICgpIHtyZXR1cm4gVihBU1RfQWNjZXNzb3IpO30pLGsgPSBuKGZ1bmN0aW9uICgpIHtVKCJ7Iik7Zm9yICh2YXIgZSA9ICEwLCBuID0gW107ICFDKCJwdW5jIiwgIn0iKSAmJiAoZSA/IGUgPSAhMSA6IFUoIiwiKSwgZy5zdHJpY3QgfHwgIUMoInB1bmMiLCAifSIpKTspIHt2YXIgdCA9IFIudG9rZW47aWYgKEMoIm9wZXJhdG9yIiwgIioiKSkge04oKTt2YXIgciA9IGQoKSxhID0gUi50b2tlbixvID0gVihBU1RfR2VuZXJhdG9yRnVuY3Rpb24pO28uc3RhcnQgPSBhLCBvLmVuZCA9IHgoKSwgbi5wdXNoKG5ldyBBU1RfT2JqZWN0TWV0aG9kKHsgc3RhcnQ6IHQsIGtleTogciwgdmFsdWU6IG8sIGVuZDogeCgpIH0pKTt9IGVsc2UgaWYgKEMoIm9wZXJhdG9yIiwgIi4uLiIpKSBOKCksIG4ucHVzaChuZXcgQVNUX1NwcmVhZCh7IHN0YXJ0OiB0LCBleHByZXNzaW9uOiBTKCksIGVuZDogeCgpIH0pKTtlbHNlIGlmIChpc190b2tlbihPKCksICJvcGVyYXRvciIsICI9IikpIHthID0gRyhBU1RfU3ltYm9sUmVmKTtOKCksIG4ucHVzaChuZXcgQVNUX09iamVjdEtleVZhbCh7IHN0YXJ0OiB0LCBrZXk6IHQudmFsdWUsIHZhbHVlOiBuZXcgQVNUX0Fzc2lnbih7IHN0YXJ0OiB0LCBsZWZ0OiBhLCBvcGVyYXRvcjogIj0iLCByaWdodDogUygpLCBlbmQ6IHgoKSB9KSwgZW5kOiB4KCkgfSkpO30gZWxzZSBpZiAoaXNfdG9rZW4oTygpLCAicHVuYyIsICIsIikgfHwgaXNfdG9rZW4oTygpLCAicHVuYyIsICJ9IikpIG4ucHVzaChuZXcgQVNUX09iamVjdEtleVZhbCh7IHN0YXJ0OiB0LCBrZXk6IHQudmFsdWUsIHZhbHVlOiBHKEFTVF9TeW1ib2xSZWYpLCBlbmQ6IHgoKSB9KSk7ZWxzZSB7ciA9IGQoKTtpZiAoQygicHVuYyIsICIoIikpIHt2YXIgcyA9IFIudG9rZW47KGkgPSBWKEFTVF9GdW5jdGlvbikpLnN0YXJ0ID0gcywgaS5lbmQgPSB4KCksIG4ucHVzaChuZXcgQVNUX09iamVjdE1ldGhvZCh7IHN0YXJ0OiB0LCBrZXk6IHIsIHZhbHVlOiBpLCBlbmQ6IHgoKSB9KSk7fSBlbHNlIGlmIChDKCJwdW5jIiwgIjoiKSkgTigpLCBuLnB1c2gobmV3IEFTVF9PYmplY3RLZXlWYWwoeyBzdGFydDogdCwga2V5OiByLCB2YWx1ZTogUygpLCBlbmQ6IHgoKSB9KSk7ZWxzZSB7aWYgKCJuYW1lIiA9PSB0LnR5cGUpIHN3aXRjaCAocikge2Nhc2UgImFzeW5jIjp2YXIgaSx1ID0gQygib3BlcmF0b3IiLCAiKiIpICYmIE4oKSxzID0gKHIgPSBkKCksIFIudG9rZW4pOyhpID0gVih1ID8gQVNUX0FzeW5jR2VuZXJhdG9yRnVuY3Rpb24gOiBBU1RfQXN5bmNGdW5jdGlvbikpLnN0YXJ0ID0gcywgaS5lbmQgPSB4KCksIG4ucHVzaChuZXcgQVNUX09iamVjdE1ldGhvZCh7IHN0YXJ0OiB0LCBrZXk6IHIsIHZhbHVlOiBpLCBlbmQ6IHgoKSB9KSk7Y29udGludWU7Y2FzZSAiZ2V0IjpuLnB1c2gobmV3IEFTVF9PYmplY3RHZXR0ZXIoeyBzdGFydDogdCwga2V5OiBkKCksIHZhbHVlOiBUKCksIGVuZDogeCgpIH0pKTtjb250aW51ZTtjYXNlICJzZXQiOm4ucHVzaChuZXcgQVNUX09iamVjdFNldHRlcih7IHN0YXJ0OiB0LCBrZXk6IGQoKSwgdmFsdWU6IFQoKSwgZW5kOiB4KCkgfSkpO2NvbnRpbnVlO31JKCk7fX19cmV0dXJuIE4oKSwgbmV3IEFTVF9PYmplY3QoeyBwcm9wZXJ0aWVzOiBuIH0pO30pO2Z1bmN0aW9uIGQoKSB7dmFyIGUgPSBSLnRva2VuO3N3aXRjaCAoZS50eXBlKSB7Y2FzZSAib3BlcmF0b3IiOktFWVdPUkRTW2UudmFsdWVdIHx8IEkoKTtjYXNlICJudW0iOmNhc2UgInN0cmluZyI6Y2FzZSAibmFtZSI6Y2FzZSAia2V5d29yZCI6Y2FzZSAiYXRvbSI6cmV0dXJuIE4oKSwgIiIgKyBlLnZhbHVlO2Nhc2UgInB1bmMiOlUoIlsiKTt2YXIgbiA9IFMoKTtyZXR1cm4gVSgiXSIpLCBuO2RlZmF1bHQ6SSgpO319ZnVuY3Rpb24gbGUoZSwgbikge3ZhciB0ID0gbi52YWx1ZTtzd2l0Y2ggKHQpIHtjYXNlICJhd2FpdCI6Ui5pbl9hc3luYyAmJiBJKG4pO2JyZWFrO2Nhc2UgInN1cGVyIjplID0gQVNUX1N1cGVyO2JyZWFrO2Nhc2UgInRoaXMiOmUgPSBBU1RfVGhpczticmVhaztjYXNlICJ5aWVsZCI6Ui5pbl9nZW5lcmF0b3IgJiYgSShuKTt9cmV0dXJuIG5ldyBlKHsgbmFtZTogIiIgKyB0LCBzdGFydDogbiwgZW5kOiBuIH0pO31mdW5jdGlvbiB3KGUpIHsiYXJndW1lbnRzIiAhPSBlLm5hbWUgJiYgImV2YWwiICE9IGUubmFtZSAmJiAibGV0IiAhPSBlLm5hbWUgfHwgRChlLnN0YXJ0LCAiVW5leHBlY3RlZCAiICsgZS5uYW1lICsgIiBpbiBzdHJpY3QgbW9kZSIpO31mdW5jdGlvbiBHKGUsIG4pIHtyZXR1cm4gQygibmFtZSIpID8gKGUgPSBsZShlLCBSLnRva2VuKSwgUi5pbnB1dC5oYXNfZGlyZWN0aXZlKCJ1c2Ugc3RyaWN0IikgJiYgZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiAmJiB3KGUpLCBOKCksIGUpIDogKG4gfHwgUCgiTmFtZSBleHBlY3RlZCIpLCBudWxsKTt9ZnVuY3Rpb24gcShlKSB7dmFyIG4sdCA9IFIudG9rZW47aWYgKEMoInB1bmMiLCAiWyIpKSByZXR1cm4gTigpLCBuID0gZigiXSIsICFnLnN0cmljdCwgITAsIGZ1bmN0aW9uICgpIHtyZXR1cm4gYyhlKTt9KSwgbmV3IEFTVF9EZXN0cnVjdHVyZWRBcnJheSh7IHN0YXJ0OiB0LCBlbGVtZW50czogbiwgcmVzdDogbi5yZXN0IHx8IG51bGwsIGVuZDogeCgpIH0pO2lmIChDKCJwdW5jIiwgInsiKSkge04oKTtmb3IgKHZhciByID0gITAsIGEgPSBbXSwgbyA9IG51bGw7ICFDKCJwdW5jIiwgIn0iKSAmJiAociA/IHIgPSAhMSA6IFUoIiwiKSwgZy5zdHJpY3QgfHwgIUMoInB1bmMiLCAifSIpKTspIHt2YXIgcyA9IFIudG9rZW47aWYgKEMoInB1bmMiLCAiWyIpIHx8IGlzX3Rva2VuKE8oKSwgInB1bmMiLCAiOiIpKSB7dmFyIGkgPSBkKCk7VSgiOiIpLCBhLnB1c2gobmV3IEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwoeyBzdGFydDogcywga2V5OiBpLCB2YWx1ZTogYyhlKSwgZW5kOiB4KCkgfSkpO30gZWxzZSB7aWYgKEMoIm9wZXJhdG9yIiwgIi4uLiIpKSB7TigpLCBvID0gcShlKTticmVhazt9aSA9IEcoZSk7Qygib3BlcmF0b3IiLCAiPSIpICYmIChOKCksIGkgPSBuZXcgQVNUX0RlZmF1bHRWYWx1ZSh7IHN0YXJ0OiBpLnN0YXJ0LCBuYW1lOiBpLCB2YWx1ZTogUygpLCBlbmQ6IHgoKSB9KSksIGEucHVzaChuZXcgQVNUX0Rlc3RydWN0dXJlZEtleVZhbCh7IHN0YXJ0OiBzLCBrZXk6IHMudmFsdWUsIHZhbHVlOiBpLCBlbmQ6IHgoKSB9KSk7fX1yZXR1cm4gVSgifSIpLCBuZXcgQVNUX0Rlc3RydWN0dXJlZE9iamVjdCh7IHN0YXJ0OiB0LCBwcm9wZXJ0aWVzOiBhLCByZXN0OiBvLCBlbmQ6IHgoKSB9KTt9cmV0dXJuIEcoZSk7fWZ1bmN0aW9uIGMoZSkge3ZhciBuID0gUi50b2tlbixlID0gcShlKTtyZXR1cm4gQygib3BlcmF0b3IiLCAiPSIpID8gKE4oKSwgbmV3IEFTVF9EZWZhdWx0VmFsdWUoeyBzdGFydDogbiwgbmFtZTogZSwgdmFsdWU6IFMoKSwgZW5kOiB4KCkgfSkpIDogZTt9ZnVuY3Rpb24geShlKSB7Zm9yICh2YXIgbiA9IGUgPyBlLnN0YXJ0IDogUi50b2tlbiwgdCA9IFIuaW5wdXQuY29udGV4dCgpLnJlYWRfdGVtcGxhdGUsIHIgPSBbXSwgYSA9IFtdOyB0KHIpOykgTigpLCBhLnB1c2goSigpKSwgQygicHVuYyIsICJ9IikgfHwgSSgpO3JldHVybiBOKCksIG5ldyBBU1RfVGVtcGxhdGUoeyBzdGFydDogbiwgZXhwcmVzc2lvbnM6IGEsIHN0cmluZ3M6IHIsIHRhZzogZSwgZW5kOiB4KCkgfSk7fWZ1bmN0aW9uIHAoZSwgbikge2ZvciAodmFyIHQgPSBlLnN0YXJ0LCByID0gbnVsbDs7KSBpZiAoQygib3BlcmF0b3IiLCAiPyIpICYmIGlzX3Rva2VuKE8oKSwgInB1bmMiLCAiLiIpICYmIChOKCksIE4oKSwgciA9IGUpLCBDKCJwdW5jIiwgIlsiKSkge04oKTt2YXIgYSA9IEooKTtVKCJdIiksIGUgPSBuZXcgQVNUX1N1Yih7IHN0YXJ0OiB0LCBvcHRpb25hbDogciA9PT0gZSwgZXhwcmVzc2lvbjogZSwgcHJvcGVydHk6IGEsIGVuZDogeCgpIH0pO30gZWxzZSBpZiAobiAmJiBDKCJwdW5jIiwgIigiKSkgTigpLCBlID0gbmV3IEFTVF9DYWxsKHsgc3RhcnQ6IHQsIG9wdGlvbmFsOiByID09PSBlLCBleHByZXNzaW9uOiBlLCBhcmdzOiBmKCIpIiwgIWcuc3RyaWN0KSwgZW5kOiB4KCkgfSk7ZWxzZSBpZiAociA9PT0gZSB8fCBDKCJwdW5jIiwgIi4iKSkgciAhPT0gZSAmJiBOKCksIGUgPSBuZXcgQVNUX0RvdCh7IHN0YXJ0OiB0LCBvcHRpb25hbDogciA9PT0gZSwgZXhwcmVzc2lvbjogZSwgcHJvcGVydHk6IChhID0gdm9pZCAwLCBhID0gUi50b2tlbi52YWx1ZSwgRigibmFtZSIpLCBhKSwgZW5kOiB4KCkgfSk7ZWxzZSB7aWYgKCFDKCJwdW5jIiwgImAiKSkgYnJlYWs7ciAmJiBQKCJJbnZhbGlkIHRlbXBsYXRlIG9uIG9wdGlvbmFsIGNoYWluIiksIGUgPSB5KGUpO31pZiAociAmJiAoZS50ZXJtaW5hbCA9ICEwKSwgZSBpbnN0YW5jZW9mIEFTVF9DYWxsICYmICFlLnB1cmUpIGZvciAodmFyIG8gPSAodCA9IGUuc3RhcnQpLmNvbW1lbnRzX2JlZm9yZSwgcyA9IEhPUCh0LCAiY29tbWVudHNfYmVmb3JlX2xlbmd0aCIpID8gdC5jb21tZW50c19iZWZvcmVfbGVuZ3RoIDogby5sZW5ndGg7IDAgPD0gLS1zOykgaWYgKC9bQCNdX19QVVJFX18vLnRlc3Qob1tzXS52YWx1ZSkpIHtlLnB1cmUgPSAhMDticmVhazt9cmV0dXJuIGU7fWZ1bmN0aW9uIG8oZSkge3ZhciBuLHQsciA9IFIudG9rZW47aWYgKFIuaW5fYXN5bmMgJiYgQygibmFtZSIsICJhd2FpdCIpKSByZXR1cm4gUi5pbl9mdW5hcmcgPT09IFIuaW5fZnVuY3Rpb24gJiYgUCgiSW52YWxpZCB1c2Ugb2YgYXdhaXQgaW4gZnVuY3Rpb24gYXJndW1lbnQiKSwgUi5pbnB1dC5jb250ZXh0KCkucmVnZXhfYWxsb3dlZCA9ICEwLCBOKCksIG5ldyBBU1RfQXdhaXQoeyBzdGFydDogciwgZXhwcmVzc2lvbjogbyhlKSwgZW5kOiB4KCkgfSk7aWYgKFIuaW5fZ2VuZXJhdG9yICYmIEMoIm5hbWUiLCAieWllbGQiKSkgcmV0dXJuIFIuaW5fZnVuYXJnID09PSBSLmluX2Z1bmN0aW9uICYmIFAoIkludmFsaWQgdXNlIG9mIHlpZWxkIGluIGZ1bmN0aW9uIGFyZ3VtZW50IiksIFIuaW5wdXQuY29udGV4dCgpLnJlZ2V4X2FsbG93ZWQgPSAhMCwgTigpLCB0ID0gbnVsbCwgbiA9ICExLCBDKCJvcGVyYXRvciIsICIqIikgPyAoTigpLCB0ID0gUyhlKSwgbiA9ICEwKSA6IChDKCJwdW5jIikgPyBQVU5DX0FGVEVSX0VYUFJFU1NJT05bUi50b2tlbi52YWx1ZV0gOiBaKCkpIHx8ICh0ID0gUyhlKSksIG5ldyBBU1RfWWllbGQoeyBzdGFydDogciwgZXhwcmVzc2lvbjogdCwgbmVzdGVkOiBuLCBlbmQ6IHgoKSB9KTtpZiAoQygib3BlcmF0b3IiKSAmJiBVTkFSWV9QUkVGSVhbci52YWx1ZV0pIHJldHVybiBOKCksIGooKSwgKHQgPSBzKEFTVF9VbmFyeVByZWZpeCwgciwgbyhlKSkpLnN0YXJ0ID0gciwgdC5lbmQgPSB4KCksIHQ7Zm9yICh2YXIgYSA9IF9tKCEwKTsgQygib3BlcmF0b3IiKSAmJiBVTkFSWV9QT1NURklYW1IudG9rZW4udmFsdWVdICYmICFIKFIudG9rZW4pOykgKGEgPSBzKEFTVF9VbmFyeVBvc3RmaXgsIFIudG9rZW4sIGEpKS5zdGFydCA9IHIsIGEuZW5kID0gUi50b2tlbiwgTigpO3JldHVybiBhO31mdW5jdGlvbiBzKGUsIG4sIHQpIHt2YXIgciA9IG4udmFsdWU7c3dpdGNoIChyKSB7Y2FzZSAiKysiOmNhc2UgIi0tIjokKHQpIHx8IEQobiwgIkludmFsaWQgdXNlIG9mICIgKyByICsgIiBvcGVyYXRvciIpO2JyZWFrO2Nhc2UgImRlbGV0ZSI6dCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgUi5pbnB1dC5oYXNfZGlyZWN0aXZlKCJ1c2Ugc3RyaWN0IikgJiYgRCh0LnN0YXJ0LCAiQ2FsbGluZyBkZWxldGUgb24gZXhwcmVzc2lvbiBub3QgYWxsb3dlZCBpbiBzdHJpY3QgbW9kZSIpO31yZXR1cm4gbmV3IGUoeyBvcGVyYXRvcjogciwgZXhwcmVzc2lvbjogdCB9KTt9dmFyIF9pID0gZnVuY3Rpb24gaShlLCBuLCB0KSB7dmFyIHIgPSBDKCJvcGVyYXRvciIpID8gUi50b2tlbi52YWx1ZSA6IG51bGwsYSA9IG51bGwgIT0gKHIgPSAiaW4iID09IHIgJiYgdCA/IG51bGwgOiByKSA/IFBSRUNFREVOQ0Vbcl0gOiBudWxsO3JldHVybiBudWxsICE9IGEgJiYgbiA8IGEgPyAoTigpLCBhID0gX2kobyh0KSwgIioqIiA9PSByID8gYSAtIDEgOiBhLCB0KSwgX2kobmV3IEFTVF9CaW5hcnkoeyBzdGFydDogZS5zdGFydCwgbGVmdDogZSwgb3BlcmF0b3I6IHIsIHJpZ2h0OiBhLCBlbmQ6IGEuZW5kIH0pLCBuLCB0KSkgOiBlO307dmFyIHUgPSBmdW5jdGlvbiB1KGUpIHt2YXIgbix0ID0gUi50b2tlbixyID0gX2kobyhyID0gZSksIDAsIHIpO3JldHVybiBDKCJvcGVyYXRvciIsICI/IikgPyAoTigpLCBuID0gUygpLCBVKCI6IiksIG5ldyBBU1RfQ29uZGl0aW9uYWwoeyBzdGFydDogdCwgY29uZGl0aW9uOiByLCBjb25zZXF1ZW50OiBuLCBhbHRlcm5hdGl2ZTogUyhlKSwgZW5kOiB4KCkgfSkpIDogcjt9O2Z1bmN0aW9uICQoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgJiYgIWUub3B0aW9uYWwgfHwgZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWY7fWZ1bmN0aW9uIHooZSkge3ZhciBuO2lmIChlIGluc3RhbmNlb2YgQVNUX0FycmF5KSByZXR1cm4gdCA9IG51bGwsICghKGUuZWxlbWVudHNbZS5lbGVtZW50cy5sZW5ndGggLSAxXSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQpIHx8ICh0ID0geihlLmVsZW1lbnRzLnBvcCgpLmV4cHJlc3Npb24pKSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQgfHwgJCh0KSkgJiYgKG4gPSBlLmVsZW1lbnRzLm1hcCh6KSwgYWxsKG4sIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdFZhbHVlIHx8IGUgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkIHx8IGUgaW5zdGFuY2VvZiBBU1RfSG9sZSB8fCAkKGUpO30pKSA/IG5ldyBBU1RfRGVzdHJ1Y3R1cmVkQXJyYXkoeyBzdGFydDogZS5zdGFydCwgZWxlbWVudHM6IG4sIHJlc3Q6IHQsIGVuZDogZS5lbmQgfSkgOiBlO2lmIChlIGluc3RhbmNlb2YgQVNUX0Fzc2lnbikgcmV0dXJuIChuID0geihlLmxlZnQpKSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQgfHwgJChuKSA/IG5ldyBBU1RfRGVmYXVsdFZhbHVlKHsgc3RhcnQ6IGUuc3RhcnQsIG5hbWU6IG4sIHZhbHVlOiBlLnJpZ2h0LCBlbmQ6IGUuZW5kIH0pIDogZTtpZiAoIShlIGluc3RhbmNlb2YgQVNUX09iamVjdCkpIHJldHVybiBlO3ZhciB0ID0gbnVsbDtpZiAoZS5wcm9wZXJ0aWVzW2UucHJvcGVydGllcy5sZW5ndGggLSAxXSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQgJiYgISgodCA9IHooZS5wcm9wZXJ0aWVzLnBvcCgpLmV4cHJlc3Npb24pKSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQgfHwgJCh0KSkpIHJldHVybiBlO2ZvciAodmFyIHIgPSBbXSwgYSA9IDA7IGEgPCBlLnByb3BlcnRpZXMubGVuZ3RoOyBhKyspIHt2YXIgbyA9IGUucHJvcGVydGllc1thXTtpZiAoIShvIGluc3RhbmNlb2YgQVNUX09iamVjdEtleVZhbCkpIHJldHVybiBlO3ZhciBzID0geihvLnZhbHVlKTtpZiAoIShzIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSB8fCBzIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCB8fCAkKHMpKSkgcmV0dXJuIGU7ci5wdXNoKG5ldyBBU1RfRGVzdHJ1Y3R1cmVkS2V5VmFsKHsgc3RhcnQ6IG8uc3RhcnQsIGtleTogby5rZXksIHZhbHVlOiBzLCBlbmQ6IG8uZW5kIH0pKTt9cmV0dXJuIG5ldyBBU1RfRGVzdHJ1Y3R1cmVkT2JqZWN0KHsgc3RhcnQ6IGUuc3RhcnQsIHByb3BlcnRpZXM6IHIsIHJlc3Q6IHQsIGVuZDogZS5lbmQgfSk7fWZ1bmN0aW9uIFMoZSkge3ZhciBuID0gUi50b2tlbix0ID0gdShlKSxyID0gUi50b2tlbi52YWx1ZTtpZiAoQygib3BlcmF0b3IiKSAmJiBBU1NJR05NRU5UW3JdKSB7aWYgKCQodCkgfHwgIj0iID09IHIgJiYgKHQgPSB6KHQpKSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQpIHJldHVybiBOKCksIG5ldyBBU1RfQXNzaWduKHsgc3RhcnQ6IG4sIGxlZnQ6IHQsIG9wZXJhdG9yOiByLCByaWdodDogUyhlKSwgZW5kOiB4KCkgfSk7UCgiSW52YWxpZCBhc3NpZ25tZW50Iik7fXJldHVybiB0O31mdW5jdGlvbiBKKGUsIG4pIHtmb3IgKHZhciB0ID0gUi50b2tlbiwgciA9IFtdOzspIHtpZiAobiAmJiBDKCJvcGVyYXRvciIsICIuLi4iKSkge04oKSwgci5yZXN0ID0gcShBU1RfU3ltYm9sRnVuYXJnKTticmVhazt9aWYgKHIucHVzaChTKGUpKSwgIUMoInB1bmMiLCAiLCIpKSBicmVhaztpZiAoTigpLCBuICYmIEMoInB1bmMiLCAiKSIpICYmIGlzX3Rva2VuKE8oKSwgInB1bmMiLCAiPT4iKSkgYnJlYWs7fXJldHVybiAxICE9IHIubGVuZ3RoIHx8IHIucmVzdCA/IG5ldyBBU1RfU2VxdWVuY2UoeyBzdGFydDogdCwgZXhwcmVzc2lvbnM6IHIsIGVuZDogeCgpIH0pIDogclswXTt9ZnVuY3Rpb24gUShlKSB7KytSLmluX2xvb3A7ZSA9IGUoKTtyZXR1cm4gLS1SLmluX2xvb3AsIGU7fWlmIChnLmV4cHJlc3Npb24pIHJldHVybiBqKCksIGUgPSBKKCksIEYoImVvZiIpLCBlO3ZhciBlID0gUi50b2tlbixiID0gW107Zm9yIChnLm1vZHVsZSAmJiAoUi5pbl9hc3luYyA9ICEwLCBSLmlucHV0LmFkZF9kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSksIFIuaW5wdXQucHVzaF9kaXJlY3RpdmVzX3N0YWNrKCk7ICFDKCJlb2YiKTspIGIucHVzaChZKCEwKSk7Ui5pbnB1dC5wb3BfZGlyZWN0aXZlc19zdGFjaygpO3ZhciBoID0geCgpIHx8IGUsdCA9IGcudG9wbGV2ZWw7cmV0dXJuIHQgPyAodC5ib2R5ID0gdC5ib2R5LmNvbmNhdChiKSwgdC5lbmQgPSBoKSA6IHQgPSBuZXcgQVNUX1RvcGxldmVsKHsgc3RhcnQ6IGUsIGJvZHk6IGIsIGVuZDogaCB9KSwgdDt9CgogIC8vIHRyYW5zZm9ybS5qcwogIC8vIHByZXR0aWVyLWlnbm9yZQogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZQogICJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBUcmVlVHJhbnNmb3JtZXIobiwgcikge1RyZWVXYWxrZXIuY2FsbCh0aGlzKSwgdGhpcy5iZWZvcmUgPSBuLCB0aGlzLmFmdGVyID0gcjt9VHJlZVRyYW5zZm9ybWVyLnByb3RvdHlwZSA9IG5ldyBUcmVlV2Fsa2VyKCksIGZ1bmN0aW9uIChuKSB7ZnVuY3Rpb24gbyhuLCByKSB7cmV0dXJuIExpc3QobiwgZnVuY3Rpb24gKG4pIHtyZXR1cm4gbi50cmFuc2Zvcm0ociwgITApO30pO31mdW5jdGlvbiByKG4sIHIpIHtuLmFyZ25hbWVzID0gbyhuLmFyZ25hbWVzLCByKSwgbi5yZXN0ICYmIChuLnJlc3QgPSBuLnJlc3QudHJhbnNmb3JtKHIpKSwgbi52YWx1ZSA/IG4udmFsdWUgPSBuLnZhbHVlLnRyYW5zZm9ybShyKSA6IG4uYm9keSA9IG8obi5ib2R5LCByKTt9bihBU1RfTm9kZSwgbm9vcCksIG4oQVNUX0xhYmVsZWRTdGF0ZW1lbnQsIGZ1bmN0aW9uIChuLCByKSB7bi5sYWJlbCA9IG4ubGFiZWwudHJhbnNmb3JtKHIpLCBuLmJvZHkgPSBuLmJvZHkudHJhbnNmb3JtKHIpO30pLCBuKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGZ1bmN0aW9uIChuLCByKSB7bi5ib2R5ID0gbi5ib2R5LnRyYW5zZm9ybShyKTt9KSwgbihBU1RfQmxvY2ssIGZ1bmN0aW9uIChuLCByKSB7bi5ib2R5ID0gbyhuLmJvZHksIHIpO30pLCBuKEFTVF9EbywgZnVuY3Rpb24gKG4sIHIpIHtuLmJvZHkgPSBuLmJvZHkudHJhbnNmb3JtKHIpLCBuLmNvbmRpdGlvbiA9IG4uY29uZGl0aW9uLnRyYW5zZm9ybShyKTt9KSwgbihBU1RfV2hpbGUsIGZ1bmN0aW9uIChuLCByKSB7bi5jb25kaXRpb24gPSBuLmNvbmRpdGlvbi50cmFuc2Zvcm0ociksIG4uYm9keSA9IG4uYm9keS50cmFuc2Zvcm0ocik7fSksIG4oQVNUX0ZvciwgZnVuY3Rpb24gKG4sIHIpIHtuLmluaXQgJiYgKG4uaW5pdCA9IG4uaW5pdC50cmFuc2Zvcm0ocikpLCBuLmNvbmRpdGlvbiAmJiAobi5jb25kaXRpb24gPSBuLmNvbmRpdGlvbi50cmFuc2Zvcm0ocikpLCBuLnN0ZXAgJiYgKG4uc3RlcCA9IG4uc3RlcC50cmFuc2Zvcm0ocikpLCBuLmJvZHkgPSBuLmJvZHkudHJhbnNmb3JtKHIpO30pLCBuKEFTVF9Gb3JFbnVtZXJhdGlvbiwgZnVuY3Rpb24gKG4sIHIpIHtuLmluaXQgPSBuLmluaXQudHJhbnNmb3JtKHIpLCBuLm9iamVjdCA9IG4ub2JqZWN0LnRyYW5zZm9ybShyKSwgbi5ib2R5ID0gbi5ib2R5LnRyYW5zZm9ybShyKTt9KSwgbihBU1RfV2l0aCwgZnVuY3Rpb24gKG4sIHIpIHtuLmV4cHJlc3Npb24gPSBuLmV4cHJlc3Npb24udHJhbnNmb3JtKHIpLCBuLmJvZHkgPSBuLmJvZHkudHJhbnNmb3JtKHIpO30pLCBuKEFTVF9FeGl0LCBmdW5jdGlvbiAobiwgcikge24udmFsdWUgJiYgKG4udmFsdWUgPSBuLnZhbHVlLnRyYW5zZm9ybShyKSk7fSksIG4oQVNUX0xvb3BDb250cm9sLCBmdW5jdGlvbiAobiwgcikge24ubGFiZWwgJiYgKG4ubGFiZWwgPSBuLmxhYmVsLnRyYW5zZm9ybShyKSk7fSksIG4oQVNUX0lmLCBmdW5jdGlvbiAobiwgcikge24uY29uZGl0aW9uID0gbi5jb25kaXRpb24udHJhbnNmb3JtKHIpLCBuLmJvZHkgPSBuLmJvZHkudHJhbnNmb3JtKHIpLCBuLmFsdGVybmF0aXZlICYmIChuLmFsdGVybmF0aXZlID0gbi5hbHRlcm5hdGl2ZS50cmFuc2Zvcm0ocikpO30pLCBuKEFTVF9Td2l0Y2gsIGZ1bmN0aW9uIChuLCByKSB7bi5leHByZXNzaW9uID0gbi5leHByZXNzaW9uLnRyYW5zZm9ybShyKSwgbi5ib2R5ID0gbyhuLmJvZHksIHIpO30pLCBuKEFTVF9DYXNlLCBmdW5jdGlvbiAobiwgcikge24uZXhwcmVzc2lvbiA9IG4uZXhwcmVzc2lvbi50cmFuc2Zvcm0ociksIG4uYm9keSA9IG8obi5ib2R5LCByKTt9KSwgbihBU1RfVHJ5LCBmdW5jdGlvbiAobiwgcikge24uYm9keSA9IG8obi5ib2R5LCByKSwgbi5iY2F0Y2ggJiYgKG4uYmNhdGNoID0gbi5iY2F0Y2gudHJhbnNmb3JtKHIpKSwgbi5iZmluYWxseSAmJiAobi5iZmluYWxseSA9IG4uYmZpbmFsbHkudHJhbnNmb3JtKHIpKTt9KSwgbihBU1RfQ2F0Y2gsIGZ1bmN0aW9uIChuLCByKSB7bi5hcmduYW1lICYmIChuLmFyZ25hbWUgPSBuLmFyZ25hbWUudHJhbnNmb3JtKHIpKSwgbi5ib2R5ID0gbyhuLmJvZHksIHIpO30pLCBuKEFTVF9EZWZpbml0aW9ucywgZnVuY3Rpb24gKG4sIHIpIHtuLmRlZmluaXRpb25zID0gbyhuLmRlZmluaXRpb25zLCByKTt9KSwgbihBU1RfVmFyRGVmLCBmdW5jdGlvbiAobiwgcikge24ubmFtZSA9IG4ubmFtZS50cmFuc2Zvcm0ociksIG4udmFsdWUgJiYgKG4udmFsdWUgPSBuLnZhbHVlLnRyYW5zZm9ybShyKSk7fSksIG4oQVNUX0RlZmF1bHRWYWx1ZSwgZnVuY3Rpb24gKG4sIHIpIHtuLm5hbWUgPSBuLm5hbWUudHJhbnNmb3JtKHIpLCBuLnZhbHVlID0gbi52YWx1ZS50cmFuc2Zvcm0ocik7fSksIG4oQVNUX0xhbWJkYSwgZnVuY3Rpb24gKG4sIHIpIHtuLm5hbWUgJiYgKG4ubmFtZSA9IG4ubmFtZS50cmFuc2Zvcm0ocikpLCBuLmFyZ25hbWVzID0gbyhuLmFyZ25hbWVzLCByKSwgbi5yZXN0ICYmIChuLnJlc3QgPSBuLnJlc3QudHJhbnNmb3JtKHIpKSwgbi5ib2R5ID0gbyhuLmJvZHksIHIpO30pLCBuKEFTVF9BcnJvdywgciksIG4oQVNUX0FzeW5jQXJyb3csIHIpLCBuKEFTVF9DbGFzcywgZnVuY3Rpb24gKG4sIHIpIHtuLm5hbWUgJiYgKG4ubmFtZSA9IG4ubmFtZS50cmFuc2Zvcm0ocikpLCBuLmV4dGVuZHMgJiYgKG4uZXh0ZW5kcyA9IG4uZXh0ZW5kcy50cmFuc2Zvcm0ocikpLCBuLnByb3BlcnRpZXMgPSBvKG4ucHJvcGVydGllcywgcik7fSksIG4oQVNUX0NsYXNzUHJvcGVydHksIGZ1bmN0aW9uIChuLCByKSB7bi5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiAobi5rZXkgPSBuLmtleS50cmFuc2Zvcm0ocikpLCBuLnZhbHVlICYmIChuLnZhbHVlID0gbi52YWx1ZS50cmFuc2Zvcm0ocikpO30pLCBuKEFTVF9DYWxsLCBmdW5jdGlvbiAobiwgcikge24uZXhwcmVzc2lvbiA9IG4uZXhwcmVzc2lvbi50cmFuc2Zvcm0ociksIG4uYXJncyA9IG8obi5hcmdzLCByKTt9KSwgbihBU1RfU2VxdWVuY2UsIGZ1bmN0aW9uIChuLCByKSB7bi5leHByZXNzaW9ucyA9IG8obi5leHByZXNzaW9ucywgcik7fSksIG4oQVNUX0F3YWl0LCBmdW5jdGlvbiAobiwgcikge24uZXhwcmVzc2lvbiA9IG4uZXhwcmVzc2lvbi50cmFuc2Zvcm0ocik7fSksIG4oQVNUX1lpZWxkLCBmdW5jdGlvbiAobiwgcikge24uZXhwcmVzc2lvbiAmJiAobi5leHByZXNzaW9uID0gbi5leHByZXNzaW9uLnRyYW5zZm9ybShyKSk7fSksIG4oQVNUX0RvdCwgZnVuY3Rpb24gKG4sIHIpIHtuLmV4cHJlc3Npb24gPSBuLmV4cHJlc3Npb24udHJhbnNmb3JtKHIpO30pLCBuKEFTVF9TdWIsIGZ1bmN0aW9uIChuLCByKSB7bi5leHByZXNzaW9uID0gbi5leHByZXNzaW9uLnRyYW5zZm9ybShyKSwgbi5wcm9wZXJ0eSA9IG4ucHJvcGVydHkudHJhbnNmb3JtKHIpO30pLCBuKEFTVF9TcHJlYWQsIGZ1bmN0aW9uIChuLCByKSB7bi5leHByZXNzaW9uID0gbi5leHByZXNzaW9uLnRyYW5zZm9ybShyKTt9KSwgbihBU1RfVW5hcnksIGZ1bmN0aW9uIChuLCByKSB7bi5leHByZXNzaW9uID0gbi5leHByZXNzaW9uLnRyYW5zZm9ybShyKTt9KSwgbihBU1RfQmluYXJ5LCBmdW5jdGlvbiAobiwgcikge24ubGVmdCA9IG4ubGVmdC50cmFuc2Zvcm0ociksIG4ucmlnaHQgPSBuLnJpZ2h0LnRyYW5zZm9ybShyKTt9KSwgbihBU1RfQ29uZGl0aW9uYWwsIGZ1bmN0aW9uIChuLCByKSB7bi5jb25kaXRpb24gPSBuLmNvbmRpdGlvbi50cmFuc2Zvcm0ociksIG4uY29uc2VxdWVudCA9IG4uY29uc2VxdWVudC50cmFuc2Zvcm0ociksIG4uYWx0ZXJuYXRpdmUgPSBuLmFsdGVybmF0aXZlLnRyYW5zZm9ybShyKTt9KSwgbihBU1RfQXJyYXksIGZ1bmN0aW9uIChuLCByKSB7bi5lbGVtZW50cyA9IG8obi5lbGVtZW50cywgcik7fSksIG4oQVNUX0Rlc3RydWN0dXJlZEFycmF5LCBmdW5jdGlvbiAobiwgcikge24uZWxlbWVudHMgPSBvKG4uZWxlbWVudHMsIHIpLCBuLnJlc3QgJiYgKG4ucmVzdCA9IG4ucmVzdC50cmFuc2Zvcm0ocikpO30pLCBuKEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwsIGZ1bmN0aW9uIChuLCByKSB7bi5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiAobi5rZXkgPSBuLmtleS50cmFuc2Zvcm0ocikpLCBuLnZhbHVlID0gbi52YWx1ZS50cmFuc2Zvcm0ocik7fSksIG4oQVNUX0Rlc3RydWN0dXJlZE9iamVjdCwgZnVuY3Rpb24gKG4sIHIpIHtuLnByb3BlcnRpZXMgPSBvKG4ucHJvcGVydGllcywgciksIG4ucmVzdCAmJiAobi5yZXN0ID0gbi5yZXN0LnRyYW5zZm9ybShyKSk7fSksIG4oQVNUX09iamVjdCwgZnVuY3Rpb24gKG4sIHIpIHtuLnByb3BlcnRpZXMgPSBvKG4ucHJvcGVydGllcywgcik7fSksIG4oQVNUX09iamVjdFByb3BlcnR5LCBmdW5jdGlvbiAobiwgcikge24ua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgJiYgKG4ua2V5ID0gbi5rZXkudHJhbnNmb3JtKHIpKSwgbi52YWx1ZSA9IG4udmFsdWUudHJhbnNmb3JtKHIpO30pLCBuKEFTVF9FeHBvcnREZWNsYXJhdGlvbiwgZnVuY3Rpb24gKG4sIHIpIHtuLmJvZHkgPSBuLmJvZHkudHJhbnNmb3JtKHIpO30pLCBuKEFTVF9FeHBvcnREZWZhdWx0LCBmdW5jdGlvbiAobiwgcikge24uYm9keSA9IG4uYm9keS50cmFuc2Zvcm0ocik7fSksIG4oQVNUX0V4cG9ydFJlZmVyZW5jZXMsIGZ1bmN0aW9uIChuLCByKSB7bi5wcm9wZXJ0aWVzID0gbyhuLnByb3BlcnRpZXMsIHIpO30pLCBuKEFTVF9JbXBvcnQsIGZ1bmN0aW9uIChuLCByKSB7bi5hbGwgJiYgKG4uYWxsID0gbi5hbGwudHJhbnNmb3JtKHIpKSwgbi5kZWZhdWx0ICYmIChuLmRlZmF1bHQgPSBuLmRlZmF1bHQudHJhbnNmb3JtKHIpKSwgbi5wcm9wZXJ0aWVzICYmIChuLnByb3BlcnRpZXMgPSBvKG4ucHJvcGVydGllcywgcikpO30pLCBuKEFTVF9UZW1wbGF0ZSwgZnVuY3Rpb24gKG4sIHIpIHtuLnRhZyAmJiAobi50YWcgPSBuLnRhZy50cmFuc2Zvcm0ocikpLCBuLmV4cHJlc3Npb25zID0gbyhuLmV4cHJlc3Npb25zLCByKTt9KTt9KGZ1bmN0aW9uIChuLCBlKSB7bi5ERUZNRVRIT0QoInRyYW5zZm9ybSIsIGZ1bmN0aW9uIChuLCByKSB7dmFyIG87cmV0dXJuIG4ucHVzaCh0aGlzKSwgdm9pZCAwID09PSAobyA9IG4uYmVmb3JlID8gbi5iZWZvcmUodGhpcywgZSwgcikgOiBvKSAmJiAoZShvID0gdGhpcywgbiksIG4uYWZ0ZXIpICYmIHZvaWQgMCAhPT0gKHIgPSBuLmFmdGVyKG8sIHIpKSAmJiAobyA9IHIpLCBuLnBvcCgpLCBvO30pO30pOwoKICAvLyBzY29wZS5qcwogIC8vIHByZXR0aWVyLWlnbm9yZQogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZQogICJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBTeW1ib2xEZWYoZSwgbiwgYSwgdCkge3RoaXMuX2JpdHMgPSAwLCB0aGlzLmRlZnVuID0gdm9pZCAwLCB0aGlzLmVsaW1pbmF0ZWQgPSAwLCB0aGlzLmlkID0gZSwgdGhpcy5pbml0ID0gdCwgdGhpcy5tYW5nbGVkX25hbWUgPSBudWxsLCB0aGlzLm5hbWUgPSBhLm5hbWUsIHRoaXMub3JpZyA9IFthXSwgdGhpcy5yZWZlcmVuY2VzID0gW10sIHRoaXMucmVwbGFjZWQgPSAwLCB0aGlzLnNhZmVfaWRzID0gdm9pZCAwLCB0aGlzLnNjb3BlID0gbjt9ZnVuY3Rpb24gaXNfZnVuYXJnKGUpIHtyZXR1cm4gZS5vcmlnWzBdIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZyB8fCBlLm9yaWdbMV0gaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnO31TeW1ib2xEZWYucHJvdG90eXBlID0geyBmb3JFYWNoOiBmdW5jdGlvbiBmb3JFYWNoKGUpIHt0aGlzLm9yaWcuZm9yRWFjaChlKSwgdGhpcy5yZWZlcmVuY2VzLmZvckVhY2goZSk7fSwgbWFuZ2xlOiBmdW5jdGlvbiBtYW5nbGUoZSkge3ZhciBuLCBhO3RoaXMubWFuZ2xlZF9uYW1lIHx8ICgobiA9IHRoaXMuZ2xvYmFsICYmIGUuY2FjaGUgJiYgZS5jYWNoZS5wcm9wcykgJiYgbi5oYXModGhpcy5uYW1lKSA/IHRoaXMubWFuZ2xlZF9uYW1lID0gbi5nZXQodGhpcy5uYW1lKSA6IHRoaXMudW5tYW5nbGVhYmxlKGUpIHx8IChhID0gdGhpcy5yZWRlZmluZWQoKSwgdGhpcy5tYW5nbGVkX25hbWUgPSBhID8gYS5tYW5nbGVkX25hbWUgfHwgYS5uYW1lIDogbmV4dF9tYW5nbGVkX25hbWUodGhpcywgZSksIG4gJiYgbi5zZXQodGhpcy5uYW1lLCB0aGlzLm1hbmdsZWRfbmFtZSkpKTt9LCByZWRlZmluZWQ6IGZ1bmN0aW9uIHJlZGVmaW5lZCgpIHt2YXIgbixlID0gdGhpcyxhID0gZS5kZWZ1bjtyZXR1cm4gKGEgPSBhICYmIChhLnZhcmlhYmxlcy5nZXQobiA9IGUubmFtZSkgfHwgYSBpbnN0YW5jZW9mIEFTVF9Ub3BsZXZlbCAmJiBhLmdsb2JhbHMuZ2V0KG4pIHx8IGUub3JpZ1swXSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xDb25zdCAmJiBmaW5kX2lmKGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUubmFtZSA9PSBuO30sIGEuZW5jbG9zZWQpKSkgJiYgYSAhPT0gZSA/IGEucmVkZWZpbmVkKCkgfHwgYSA6IHZvaWQgMDt9LCB1bm1hbmdsZWFibGU6IGZ1bmN0aW9uIHVubWFuZ2xlYWJsZShlKSB7aWYgKHRoaXMuZXhwb3J0ZWQpIHJldHVybiAhMDtpZiAodGhpcy51bmRlY2xhcmVkKSByZXR1cm4gITA7aWYgKCFlLmV2YWwgJiYgdGhpcy5zY29wZS5waW5uZWQoKSkgcmV0dXJuICEwO2lmIChlLmtlZXBfZmFyZ3MgJiYgaXNfZnVuYXJnKHRoaXMpKSByZXR1cm4gITA7aWYgKGUua2VlcF9mbmFtZXMpIHt2YXIgbiA9IHRoaXMub3JpZ1swXTtpZiAobiBpbnN0YW5jZW9mIEFTVF9TeW1ib2xDbGFzcykgcmV0dXJuICEwO2lmIChuIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlZkNsYXNzKSByZXR1cm4gITA7aWYgKG4gaW5zdGFuY2VvZiBBU1RfU3ltYm9sRGVmdW4pIHJldHVybiAhMDtpZiAobiBpbnN0YW5jZW9mIEFTVF9TeW1ib2xMYW1iZGEpIHJldHVybiAhMDt9cmV0dXJuICEoZS50b3BsZXZlbCB8fCAhdGhpcy5nbG9iYWwpO30gfSwgREVGX0JJVFBST1BTKFN5bWJvbERlZiwgWyJjb25zdF9yZWRlZnMiLCAiY3Jvc3NfbG9vcCIsICJkaXJlY3RfYWNjZXNzIiwgImV4cG9ydGVkIiwgImdsb2JhbCIsICJ1bmRlY2xhcmVkIl0pO3ZhciB1bmFyeV9zaWRlX2VmZmVjdHMgPSBtYWtlUHJlZGljYXRlKCJkZWxldGUgKysgLS0iKTtmdW5jdGlvbiBpc19saHMoZSwgbikge3JldHVybiBuIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiA/IG4ubGVmdCA9PT0gZSAmJiBlIDogbiBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgPyBuLm5hbWUgPT09IGUgJiYgZSA6IG4gaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkIHx8IG4gaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkS2V5VmFsID8gZSA6IG4gaW5zdGFuY2VvZiBBU1RfRm9yRW51bWVyYXRpb24gPyBuLmluaXQgPT09IGUgJiYgZSA6IG4gaW5zdGFuY2VvZiBBU1RfVW5hcnkgPyB1bmFyeV9zaWRlX2VmZmVjdHNbbi5vcGVyYXRvcl0gJiYgbi5leHByZXNzaW9uIDogdm9pZCAwO31mdW5jdGlvbiBpbml0X2Jsb2NrX3ZhcnMoZSwgbiwgYSkge2UuZW5jbG9zZWQgPSBhID8gYS5lbmNsb3NlZC5zbGljZSgpIDogW10sIGUuZnVuY3Rpb25zID0gYSA/IGEuZnVuY3Rpb25zLmNsb25lKCkgOiBuZXcgRGljdGlvbmFyeSgpLCBlLnZhcmlhYmxlcyA9IGEgPyBhLnZhcmlhYmxlcy5jbG9uZSgpIDogbmV3IERpY3Rpb25hcnkoKSwgbiAmJiAoZS5tYWtlX2RlZiA9IG4ubWFrZV9kZWYsIGUucGFyZW50X3Njb3BlID0gbik7fWZ1bmN0aW9uIGluaXRfc2NvcGVfdmFycyhlLCBuLCBhKSB7aW5pdF9ibG9ja192YXJzKGUsIG4sIGEpLCBlLnVzZXNfZXZhbCA9ICExLCBlLnVzZXNfd2l0aCA9ICExO31mdW5jdGlvbiBuYW1lc19pbl91c2UoZSwgbikge3ZhciBhLHQgPSBlLm5hbWVzX2luX3VzZTtyZXR1cm4gdCB8fCAoZS5jbmFtZSA9IC0xLCBlLmNuYW1lX2hvbGVzID0gW10sIGUubmFtZXNfaW5fdXNlID0gdCA9IG5ldyBEaWN0aW9uYXJ5KCksIGEgPSBuLmNhY2hlICYmIG4uY2FjaGUucHJvcHMsIGUuZW5jbG9zZWQuZm9yRWFjaChmdW5jdGlvbiAoZSkge2UudW5tYW5nbGVhYmxlKG4pICYmIHQuc2V0KGUubmFtZSwgITApLCBlLmdsb2JhbCAmJiBhICYmIGEuaGFzKGUubmFtZSkgJiYgdC5zZXQoYS5nZXQoZS5uYW1lKSwgITApO30pKSwgdDt9ZnVuY3Rpb24gbmV4dF9tYW5nbGVkX25hbWUoZSwgYSkge3ZhciBuLHQgPSBlLnNjb3BlLGkgPSBuYW1lc19pbl91c2UodCwgYSksbyA9IHQuY25hbWVfaG9sZXMsciA9IG5ldyBEaWN0aW9uYXJ5KCkscyA9IFt0XTtlLmZvckVhY2goZnVuY3Rpb24gKGUpIHt2YXIgbiA9IGUuc2NvcGU7ZG8ge2lmIChtZW1iZXIobiwgcykpIGJyZWFrO25hbWVzX2luX3VzZShuLCBhKS5lYWNoKGZ1bmN0aW9uIChlLCBuKSB7ci5zZXQobiwgZSk7fSksIHMucHVzaChuKTt9IHdoaWxlIChuID0gbi5wYXJlbnRfc2NvcGUpO30pO2ZvciAodmFyIGMgPSAwOyBjIDwgby5sZW5ndGg7IGMrKykgaWYgKG4gPSBiYXNlNTQob1tjXSksICFyLmhhcyhuKSkgcmV0dXJuIG8uc3BsaWNlKGMsIDEpLCBpLnNldChuLCAhMCksIG47Zm9yICg7OykgaWYgKG4gPSBiYXNlNTQoKyt0LmNuYW1lKSwgIShpLmhhcyhuKSB8fCBSRVNFUlZFRF9XT1JEU1tuXSB8fCBhLnJlc2VydmVkLmhhc1tuXSkpIHtpZiAoIXIuaGFzKG4pKSBicmVhaztvLnB1c2godC5jbmFtZSk7fXJldHVybiBpLnNldChuLCAhMCksIG47fWZ1bmN0aW9uIF9kZWZhdWx0X21hbmdsZXJfb3B0aW9ucyhlKSB7cmV0dXJuIGUgPSBkZWZhdWx0cyhlLCB7IGV2YWw6ICExLCBpZTogITEsIGtlZXBfZmFyZ3M6ICExLCBrZWVwX2ZuYW1lczogITEsIHJlc2VydmVkOiBbXSwgdG9wbGV2ZWw6ICExLCB2ODogITEsIHdlYmtpdDogITEgfSksIEFycmF5LmlzQXJyYXkoZS5yZXNlcnZlZCkgfHwgKGUucmVzZXJ2ZWQgPSBbXSksIHB1c2hfdW5pcShlLnJlc2VydmVkLCAiYXJndW1lbnRzIiksIGUucmVzZXJ2ZWQuaGFzID0gbWFrZVByZWRpY2F0ZShlLnJlc2VydmVkKSwgZTt9QVNUX1RvcGxldmVsLkRFRk1FVEhPRCgiZmlndXJlX291dF9zY29wZSIsIGZ1bmN0aW9uIChsKSB7bCA9IGRlZmF1bHRzKGwsIHsgY2FjaGU6IG51bGwsIGllOiAhMSB9KTt2YXIgXyA9IHRoaXMsciA9IG51bGwscyA9ICExLGEgPSAwLGMgPSBfLnBhcmVudF9zY29wZSA9IG51bGwsdSA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uICh0LCBlKSB7dmFyIG4sIGE7aWYgKHQgaW5zdGFuY2VvZiBBU1RfRGVmQ2xhc3MpIHJldHVybiBuID0gcywgcyA9IHUucGFyZW50KCkgaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVjbGFyYXRpb24sIHQubmFtZS53YWxrKHUpLCBzID0gbiwgbyhmdW5jdGlvbiAoKSB7dC5leHRlbmRzICYmIHQuZXh0ZW5kcy53YWxrKHUpLCB0LnByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2Uud2Fsayh1KTt9KTt9KSwgITA7aWYgKHQgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMpIHJldHVybiBuID0gcywgcyA9IHUucGFyZW50KCkgaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVjbGFyYXRpb24sIGUoKSwgcyA9IG4sICEwO2lmICh0IGluc3RhbmNlb2YgQVNUX0xhbWJkYURlZmluaXRpb24pIHJldHVybiBuID0gcywgcyA9IHUucGFyZW50KCkgaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVjbGFyYXRpb24sIHQubmFtZS53YWxrKHUpLCBzID0gbiwgbyhmdW5jdGlvbiAoKSB7dC5hcmduYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKHUpO30pLCB0LnJlc3QgJiYgdC5yZXN0LndhbGsodSksIHdhbGtfYm9keSh0LCB1KTt9KSwgITA7aWYgKHQgaW5zdGFuY2VvZiBBU1RfU3dpdGNoKSByZXR1cm4gdC5leHByZXNzaW9uLndhbGsodSksIG8oZnVuY3Rpb24gKCkge3dhbGtfYm9keSh0LCB1KTt9KSwgITA7aWYgKHQgaW5zdGFuY2VvZiBBU1RfU3dpdGNoQnJhbmNoKSByZXR1cm4gdC5pbml0X3ZhcnMoYyksIGUoKSwgITA7aWYgKHQgaW5zdGFuY2VvZiBBU1RfVHJ5KSByZXR1cm4gbyhmdW5jdGlvbiAoKSB7d2Fsa19ib2R5KHQsIHUpO30pLCB0LmJjYXRjaCAmJiB0LmJjYXRjaC53YWxrKHUpLCB0LmJmaW5hbGx5ICYmIHQuYmZpbmFsbHkud2Fsayh1KSwgITA7aWYgKHQgaW5zdGFuY2VvZiBBU1RfV2l0aCkge2ZvciAodmFyIGkgPSBjOyAhKGkgPSBpLnJlc29sdmUoKSkudXNlc193aXRoICYmIChpLnVzZXNfd2l0aCA9ICEwLCBpID0gaS5wYXJlbnRfc2NvcGUpOyk7cmV0dXJuIG8oZSksICEwO31pZiAodCBpbnN0YW5jZW9mIEFTVF9CbG9ja1Njb3BlKSByZXR1cm4gbyhlKSwgITA7ZnVuY3Rpb24gbyhlKSB7dC5pbml0X3ZhcnMoYyk7dmFyIG4gPSByLGEgPSBjO3QgaW5zdGFuY2VvZiBBU1RfU2NvcGUgJiYgKHIgPSB0KSwgYyA9IHQsIGUoKSwgYyA9IGEsIHIgPSBuO310IGluc3RhbmNlb2YgQVNUX1N5bWJvbCAmJiAodC5zY29wZSA9IGMpLCB0IGluc3RhbmNlb2YgQVNUX0xhYmVsICYmICgodC50aGVkZWYgPSB0KS5yZWZlcmVuY2VzID0gW10pLCB0IGluc3RhbmNlb2YgQVNUX1N5bWJvbENhdGNoID8gYy5kZWZfdmFyaWFibGUodCkuZGVmdW4gPSByIDogdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xDb25zdCA/ICgoYSA9IGMuZGVmX3ZhcmlhYmxlKHQpKS5kZWZ1biA9IHIsIHMgJiYgKGEuZXhwb3J0ZWQgPSAhMCkpIDogdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWZ1biA/IChhID0gci5kZWZfZnVuY3Rpb24odCwgdS5wYXJlbnQoKSksIHMgJiYgKGEuZXhwb3J0ZWQgPSAhMCkpIDogdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcgPyByLmRlZl92YXJpYWJsZSh0KSA6IHQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sTGFtYmRhID8gKGEgPSByLmRlZl9mdW5jdGlvbih0LCAiYXJndW1lbnRzIiA9PSB0Lm5hbWUgPyB2b2lkIDAgOiByKSwgbC5pZSAmJiAiYXJndW1lbnRzIiAhPSB0Lm5hbWUgJiYgKGEuZGVmdW4gPSByLnBhcmVudF9zY29wZS5yZXNvbHZlKCkpKSA6IHQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sTGV0ID8gKGEgPSBjLmRlZl92YXJpYWJsZSh0KSwgcyAmJiAoYS5leHBvcnRlZCA9ICEwKSkgOiB0IGluc3RhbmNlb2YgQVNUX1N5bWJvbFZhciAmJiAoYSA9IHIuZGVmX3ZhcmlhYmxlKHQsIHQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sSW1wb3J0ID8gdm9pZCAwIDogbnVsbCksIHMpICYmIChhLmV4cG9ydGVkID0gITApO30pLGQgPSAoXy5tYWtlX2RlZiA9IGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuIG5ldyBTeW1ib2xEZWYoKythLCB0aGlzLCBlLCBuKTt9LCBfLndhbGsodSksIF8uZ2xvYmFscyA9IG5ldyBEaWN0aW9uYXJ5KCksIFtdKSx1ID0gbmV3IFRyZWVXYWxrZXIoZnVuY3Rpb24gKGUpIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9DYXRjaCkgcmV0dXJuIGUuYXJnbmFtZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQgPyAoZC5wdXNoKGUpLCBlLmFyZ25hbWUud2Fsayh1KSwgZC5wb3AoKSwgd2Fsa19ib2R5KGUsIHUpLCAhMCkgOiB2b2lkIDA7aWYgKGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhKSByZXR1cm4gZC5wdXNoKGUpLCBlLm5hbWUgJiYgZS5uYW1lLndhbGsodSksIGUuYXJnbmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2Uud2Fsayh1KTt9KSwgZS5yZXN0ICYmIGUucmVzdC53YWxrKHUpLCBkLnBvcCgpLCB3YWxrX2xhbWJkYShlLCB1KSwgITA7aWYgKGUgaW5zdGFuY2VvZiBBU1RfTG9vcENvbnRyb2wpIHJldHVybiBlLmxhYmVsICYmIGUubGFiZWwudGhlZGVmLnJlZmVyZW5jZXMucHVzaChlKSwgITA7aWYgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRGVjbGFyYXRpb24pIHt2YXIgbixhID0gZS5kZWZpbml0aW9uKCk7aWYgKGEucHJlaW5pdCA9IGEucmVmZXJlbmNlcy5sZW5ndGgsIGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sQ2F0Y2gpIHtpZiAobiA9IGEucmVkZWZpbmVkKCkpIGZvciAodmFyIHQgPSBlLnNjb3BlOyB0ICYmIHB1c2hfdW5pcSh0LmVuY2xvc2VkLCBuKSAmJiB0ICE9PSBuLnNjb3BlOyB0ID0gdC5wYXJlbnRfc2NvcGUpO30gZWxzZSBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbENvbnN0ID8gKG4gPSBhLnJlZGVmaW5lZCgpKSAmJiAobi5jb25zdF9yZWRlZnMgPSAhMCkgOiBhLnNjb3BlICE9PSBlLnNjb3BlICYmIChlIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlZnVuIHx8IGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnIHx8IGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sVmFyKSAmJiAoZS5tYXJrX2VuY2xvc2VkKGwpLCBuID0gZS5zY29wZS5maW5kX3ZhcmlhYmxlKGUubmFtZSksIGUudGhlZGVmICE9PSBuKSAmJiAoKGUudGhlZGVmID0gbikub3JpZy5wdXNoKGUpLCBlLm1hcmtfZW5jbG9zZWQobCkpO3JldHVybiAiYXJndW1lbnRzIiAhPSBlLm5hbWUgfHwgKGkgPSBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFZhciAmJiB1LnBhcmVudCgpKSBpbnN0YW5jZW9mIEFTVF9WYXJEZWYgJiYgIWkudmFsdWUgfHwgKHIgPSBlLnNjb3BlLnJlc29sdmUoKS5maW5kX3ZhcmlhYmxlKCJhcmd1bWVudHMiKSkgJiYgbShyKSAmJiAoci5zY29wZS51c2VzX2FyZ3VtZW50cyA9IDMpLCAhMDt9aWYgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmKSB7Zm9yICh2YXIgaSwgbyA9IGUubmFtZSwgciA9IGUuc2NvcGUuZmluZF92YXJpYWJsZShvKSwgcyA9IGQubGVuZ3RoOyAwIDwgcyAmJiByICYmICEoKHMgPSBkLmxhc3RJbmRleE9mKHIuc2NvcGUsIHMgLSAxKSkgPCAwKTspIHt2YXIgYyA9IHIub3JpZ1swXTtpZiAoYyBpbnN0YW5jZW9mIEFTVF9TeW1ib2xDYXRjaCB8fCBjIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZyB8fCBjIGluc3RhbmNlb2YgQVNUX1N5bWJvbExhbWJkYSkge2UuaW5fYXJnID0gITA7YnJlYWs7fXIgPSByLnNjb3BlLnBhcmVudF9zY29wZS5maW5kX3ZhcmlhYmxlKG8pO31pZiAociA/ICJhcmd1bWVudHMiID09IG8gJiYgbShyKSAmJiAoaXNfbGhzKGUsIGkgPSB1LnBhcmVudCgpKSA/IHIuc2NvcGUudXNlc19hcmd1bWVudHMgPSAzIDogci5zY29wZS51c2VzX2FyZ3VtZW50cyA8IDIgJiYgIShpIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgJiYgaS5leHByZXNzaW9uID09PSBlKSA/IHIuc2NvcGUudXNlc19hcmd1bWVudHMgPSAyIDogci5zY29wZS51c2VzX2FyZ3VtZW50cyB8fCAoci5zY29wZS51c2VzX2FyZ3VtZW50cyA9ICEwKSkgOiByID0gXy5kZWZfZ2xvYmFsKGUpLCAiZXZhbCIgPT0gbykgaWYgKCJDYWxsIiA9PSAoaSA9IHUucGFyZW50KCkpLlRZUEUgJiYgaS5leHByZXNzaW9uID09PSBlKSBmb3IgKHQgPSBlLnNjb3BlOyAhKHQgPSB0LnJlc29sdmUoKSkudXNlc19ldmFsICYmICh0LnVzZXNfZXZhbCA9ICEwLCB0ID0gdC5wYXJlbnRfc2NvcGUpOyk7ZWxzZSByLnVuZGVjbGFyZWQgJiYgKF8udXNlc19ldmFsID0gITApO2lmIChyLmluaXQgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRGVmaW5pdGlvbiAmJiByLnNjb3BlICE9PSByLmluaXQubmFtZS5zY29wZSkge3ZhciBmID0gZS5zY29wZTtkbyB7aWYgKGYgPT09IHIuaW5pdC5uYW1lLnNjb3BlKSBicmVhazt9IHdoaWxlIChmID0gZi5wYXJlbnRfc2NvcGUpO2YgfHwgKHIuaW5pdCA9IHZvaWQgMCk7fXJldHVybiBlLnRoZWRlZiA9IHIsIGUucmVmZXJlbmNlKGwpLCAhMDt9fSk7ZnVuY3Rpb24gbShlKSB7cmV0dXJuIGUub3JpZ1swXSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcgJiYgIShlLm9yaWdbMV0gaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnIHx8IGUub3JpZ1syXSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcpICYmICFpc19hcnJvdyhlLnNjb3BlKTt9ZnVuY3Rpb24gdChlLCBuKSB7dmFyIGEsdCxpID0gZS5uYW1lLG8gPSBlLnRoZWRlZjtpZiAoYWxsKG8ub3JpZywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX1N5bWJvbENvbnN0IHx8IGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sTGV0KTt9KSkgcmV0dXJuIChhID0gbi5maW5kX3ZhcmlhYmxlKGkpKSA/ICh0ID0gYS5yZWRlZmluZWQoKSkgJiYgKGEgPSB0KSA6IGEgPSBfLmdsb2JhbHMuZ2V0KGkpLCBhID8gYS5vcmlnLnB1c2goZSkgOiBhID0gbi5kZWZfdmFyaWFibGUoZSksIGEudW5kZWNsYXJlZCAmJiBfLnZhcmlhYmxlcy5zZXQoaSwgYSksICJhcmd1bWVudHMiID09IGkgJiYgbShvKSAmJiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbExhbWJkYSB8fCAoby5kZWZ1biA9IGEuc2NvcGUsIG8uZm9yRWFjaChmdW5jdGlvbiAoZSkge2UucmVkZWYgPSBvLCBlLnRoZWRlZiA9IGEsIGUucmVmZXJlbmNlKGwpO30pKSwgMTt9Xy53YWxrKHUpLCBsLmllICYmIF8ud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3ZhciBuLCBhO3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbENhdGNoID8gKG4gPSAoYSA9IGUudGhlZGVmKS5kZWZ1biwgdChlLCBuID0gImFyZ3VtZW50cyIgIT0gYS5uYW1lICYmIG4ubmFtZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xMYW1iZGEgJiYgbi5uYW1lLm5hbWUgPT0gYS5uYW1lID8gbi5wYXJlbnRfc2NvcGUucmVzb2x2ZSgpIDogbiksICEwKSA6IGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sTGFtYmRhID8gKGEgPSBlLnRoZWRlZiwgdChlLCBlLnNjb3BlLnBhcmVudF9zY29wZS5yZXNvbHZlKCkpID8gdm9pZCAwICE9PSBlLnRoZWRlZi5pbml0ID8gZS50aGVkZWYuaW5pdCA9ICExIDogYS5pbml0ICYmIChlLnRoZWRlZi5pbml0ID0gYS5pbml0KSA6IGEuZGVmdW4gPSB2b2lkIDAsICEwKSA6IHZvaWQgMDt9KSk7fSksIEFTVF9Ub3BsZXZlbC5ERUZNRVRIT0QoImRlZl9nbG9iYWwiLCBmdW5jdGlvbiAoZSkge3ZhciBuID0gdGhpcy5nbG9iYWxzLGEgPSBlLm5hbWU7cmV0dXJuIG4uaGFzKGEpID8gbi5nZXQoYSkgOiAoKGUgPSB0aGlzLm1ha2VfZGVmKGUpKS51bmRlY2xhcmVkID0gITAsIGUuZ2xvYmFsID0gITAsIG4uc2V0KGEsIGUpLCBlKTt9KSwgQVNUX0Jsb2NrU2NvcGUuREVGTUVUSE9EKCJpbml0X3ZhcnMiLCBmdW5jdGlvbiAoZSwgbikge2luaXRfYmxvY2tfdmFycyh0aGlzLCBlLCBuKTt9KSwgQVNUX1Njb3BlLkRFRk1FVEhPRCgiaW5pdF92YXJzIiwgZnVuY3Rpb24gKGUsIG4pIHtpbml0X3Njb3BlX3ZhcnModGhpcywgZSwgbik7fSksIEFTVF9BcnJvdy5ERUZNRVRIT0QoImluaXRfdmFycyIsIGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuIGluaXRfc2NvcGVfdmFycyh0aGlzLCBlLCBuKSwgdGhpczt9KSwgQVNUX0FzeW5jQXJyb3cuREVGTUVUSE9EKCJpbml0X3ZhcnMiLCBmdW5jdGlvbiAoZSwgbikge2luaXRfc2NvcGVfdmFycyh0aGlzLCBlLCBuKTt9KSwgQVNUX0xhbWJkYS5ERUZNRVRIT0QoImluaXRfdmFycyIsIGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuIGluaXRfc2NvcGVfdmFycyh0aGlzLCBlLCBuKSwgdGhpcy51c2VzX2FyZ3VtZW50cyA9ICExLCB0aGlzLmRlZl92YXJpYWJsZShuZXcgQVNUX1N5bWJvbEZ1bmFyZyh7IG5hbWU6ICJhcmd1bWVudHMiLCBzY29wZTogdGhpcywgc3RhcnQ6IHRoaXMuc3RhcnQsIGVuZDogdGhpcy5lbmQgfSkpLCB0aGlzO30pLCBBU1RfU3ltYm9sLkRFRk1FVEhPRCgibWFya19lbmNsb3NlZCIsIGZ1bmN0aW9uIChlKSB7Zm9yICh2YXIgbiA9IHRoaXMuZGVmaW5pdGlvbigpLCBhID0gdGhpcy5zY29wZTsgYSAmJiBwdXNoX3VuaXEoYS5lbmNsb3NlZCwgbikgJiYgKGUgPyAoZS5rZWVwX2ZhcmdzICYmIGEgaW5zdGFuY2VvZiBBU1RfTGFtYmRhICYmIGEuZWFjaF9hcmduYW1lKGZ1bmN0aW9uIChlKSB7cHVzaF91bmlxKG4uc2NvcGUuZW5jbG9zZWQsIGUuZGVmaW5pdGlvbigpKTt9KSwgZS5rZWVwX2ZuYW1lcyAmJiBhLmZ1bmN0aW9ucy5lYWNoKGZ1bmN0aW9uIChlKSB7cHVzaF91bmlxKG4uc2NvcGUuZW5jbG9zZWQsIGUpO30pKSA6IGEuX3Zhcl9uYW1lcyA9IHZvaWQgMCwgYSAhPT0gbi5zY29wZSk7IGEgPSBhLnBhcmVudF9zY29wZSk7fSksIEFTVF9TeW1ib2wuREVGTUVUSE9EKCJyZWZlcmVuY2UiLCBmdW5jdGlvbiAoZSkge3RoaXMuZGVmaW5pdGlvbigpLnJlZmVyZW5jZXMucHVzaCh0aGlzKSwgdGhpcy5tYXJrX2VuY2xvc2VkKGUpO30pLCBBU1RfQmxvY2tTY29wZS5ERUZNRVRIT0QoImZpbmRfdmFyaWFibGUiLCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLnZhcmlhYmxlcy5nZXQoZSkgfHwgdGhpcy5wYXJlbnRfc2NvcGUgJiYgdGhpcy5wYXJlbnRfc2NvcGUuZmluZF92YXJpYWJsZShlKTt9KSwgQVNUX0Jsb2NrU2NvcGUuREVGTUVUSE9EKCJkZWZfZnVuY3Rpb24iLCBmdW5jdGlvbiAoZSwgbikge3ZhciBhID0gdGhpcy5kZWZfdmFyaWFibGUoZSwgbik7cmV0dXJuICghYS5pbml0IHx8IGEuaW5pdCBpbnN0YW5jZW9mIEFTVF9MYW1iZGFEZWZpbml0aW9uKSAmJiAoYS5pbml0ID0gbiksIHRoaXMuZnVuY3Rpb25zLnNldChlLm5hbWUsIGEpLCBhO30pLCBBU1RfQmxvY2tTY29wZS5ERUZNRVRIT0QoImRlZl92YXJpYWJsZSIsIGZ1bmN0aW9uIChlLCBuKSB7dmFyIGEgPSB0aGlzLnZhcmlhYmxlcy5nZXQoZS5uYW1lKTtyZXR1cm4gYSA/IChhLm9yaWcucHVzaChlKSwgYS5pbml0IGluc3RhbmNlb2YgQVNUX0xhbWJkYUV4cHJlc3Npb24gJiYgKGEuaW5pdCA9IG4pKSA6IChhID0gdGhpcy5tYWtlX2RlZihlLCBuKSwgdGhpcy52YXJpYWJsZXMuc2V0KGUubmFtZSwgYSksIGEuZ2xvYmFsID0gIXRoaXMucGFyZW50X3Njb3BlKSwgZS50aGVkZWYgPSBhO30pLCBBU1RfU3ltYm9sLkRFRk1FVEhPRCgidW5tYW5nbGVhYmxlIiwgZnVuY3Rpb24gKGUpIHt2YXIgbiA9IHRoaXMuZGVmaW5pdGlvbigpO3JldHVybiAhbiB8fCBuLnVubWFuZ2xlYWJsZShlKTt9KSwgQVNUX0xhYmVsLkRFRk1FVEhPRCgidW5tYW5nbGVhYmxlIiwgcmV0dXJuX2ZhbHNlKSwgQVNUX1N5bWJvbC5ERUZNRVRIT0QoImRlZmluaXRpb24iLCBmdW5jdGlvbiAoKSB7cmV0dXJuIHRoaXMudGhlZGVmO30pLCBBU1RfVG9wbGV2ZWwuREVGTUVUSE9EKCJtYW5nbGVfbmFtZXMiLCBmdW5jdGlvbiAobykgeyhvID0gX2RlZmF1bHRfbWFuZ2xlcl9vcHRpb25zKG8pKS5jYWNoZSAmJiBvLmNhY2hlLnByb3BzICYmIChuID0gbmFtZXNfaW5fdXNlKHRoaXMsIG8pLCBvLmNhY2hlLnByb3BzLmVhY2goZnVuY3Rpb24gKGUpIHtuLnNldChlLCAhMCk7fSkpO3ZhciBuLHIgPSAtMSxzID0gW10sYyA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChhLCBlKSB7dmFyIG4sIHQsIGk7aWYgKGEgaW5zdGFuY2VvZiBBU1RfQmxvY2tTY29wZSkgcmV0dXJuIGEgaW5zdGFuY2VvZiBBU1RfTGFiZWxlZFN0YXRlbWVudCAmJiAobiA9IHIpLCBvLndlYmtpdCAmJiBhIGluc3RhbmNlb2YgQVNUX0l0ZXJhdGlvblN0YXRlbWVudCAmJiBhLmluaXQgaW5zdGFuY2VvZiBBU1RfTGV0ICYmIGEuaW5pdC5kZWZpbml0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS5uYW1lLm1hdGNoX3N5bWJvbChmdW5jdGlvbiAoZSkge3ZhciBuLCBhLCB0O2UgaW5zdGFuY2VvZiBBU1RfU3ltYm9sTGV0ICYmIChuID0gZS5kZWZpbml0aW9uKCksIGEgPSBlLnNjb3BlLnBhcmVudF9zY29wZSwgdCA9IGEuZGVmX3ZhcmlhYmxlKGUpLCBlLnRoZWRlZiA9IG4sIGEudG9fbWFuZ2xlLnB1c2godCksIG4ucmVkZWZpbmVkID0gZnVuY3Rpb24gKCkge3JldHVybiB0O30pO30pO30sICEwKSwgdCA9IGEudG9fbWFuZ2xlID0gW10sIGEudmFyaWFibGVzLmVhY2goZnVuY3Rpb24gKGUsIG4pIHtlLnVubWFuZ2xlYWJsZShvKSA/IG5hbWVzX2luX3VzZShhLCBvKS5zZXQobiwgITApIDogZnVuY3Rpb24gKG4pIHt2YXIgZSA9IG4ub3JpZ1swXSxhID0gbi5yZWRlZmluZWQoKTtpZiAoIWEpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1N5bWJvbENvbnN0KSkgcmV0dXJuO3ZhciB0ID0gbi5zY29wZS5yZXNvbHZlKCk7aWYgKG4uc2NvcGUgPT09IHQpIHJldHVybjtpZiAobi5zY29wZS5wYXJlbnRfc2NvcGUuZmluZF92YXJpYWJsZShlLm5hbWUpKSByZXR1cm47YSA9IHQuZGVmX3ZhcmlhYmxlKGUpLCB0LnRvX21hbmdsZS5wdXNoKGEpO31zLnB1c2gobiksIG4ucmVmZXJlbmNlcy5mb3JFYWNoKGkpLCAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xDYXRjaCB8fCBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbENvbnN0KSAmJiAoaShlKSwgbi5yZWRlZmluZWQgPSBmdW5jdGlvbiAoKSB7cmV0dXJuIGE7fSk7cmV0dXJuIDE7ZnVuY3Rpb24gaShlKSB7ZS50aGVkZWYgPSBhLCBlLnJlZmVyZW5jZShvKSwgZS50aGVkZWYgPSBuO319KGUpIHx8IHQucHVzaChlKTt9KSwgZSgpLCBvLmNhY2hlICYmIGEgaW5zdGFuY2VvZiBBU1RfVG9wbGV2ZWwgJiYgYS5nbG9iYWxzLmVhY2goZiksIGEgaW5zdGFuY2VvZiBBU1RfRGVmdW4gJiYgYy5oYXNfZGlyZWN0aXZlKCJ1c2UgYXNtIikgJiYgKChlID0gbmV3IEFTVF9TeW1ib2xSZWYoYS5uYW1lKSkuc2NvcGUgPSBhLCBlLnJlZmVyZW5jZShvKSksICh0ID0gMzYgPCB0Lmxlbmd0aCA/IChlID0gdC5tYXAoZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gbjt9KS5zb3J0KGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuIHRbbl0ucmVmZXJlbmNlcy5sZW5ndGggLSB0W2VdLnJlZmVyZW5jZXMubGVuZ3RoIHx8IGUgLSBuO30pKS5zbGljZSgwLCAzNikuc29ydChmdW5jdGlvbiAoZSwgbikge3JldHVybiBlIC0gbjt9KS5tYXAoZnVuY3Rpb24gKGUpIHtyZXR1cm4gdFtlXTt9KS5jb25jYXQoZS5zbGljZSgzNikuc29ydChmdW5jdGlvbiAoZSwgbikge3JldHVybiBlIC0gbjt9KS5tYXAoZnVuY3Rpb24gKGUpIHtyZXR1cm4gdFtlXTt9KSkgOiB0KS5mb3JFYWNoKGYpLCAhKGEgaW5zdGFuY2VvZiBBU1RfTGFiZWxlZFN0YXRlbWVudCkgfHwgby52OCAmJiBmdW5jdGlvbiAoZSkge3ZhciBuLGEgPSAwO2ZvciAoOyBuID0gZS5wYXJlbnQoYSsrKTspIHtpZiAobiBpbnN0YW5jZW9mIEFTVF9CbG9jaykgcmV0dXJuIG4gaW5zdGFuY2VvZiBBU1RfVG9wbGV2ZWwgJiYgIW8udG9wbGV2ZWw7aWYgKG4gaW5zdGFuY2VvZiBBU1RfTGFiZWxlZFN0YXRlbWVudCkgcmV0dXJuIDE7fX0oYykgfHwgKHIgPSBuKSwgITA7aWYgKGEgaW5zdGFuY2VvZiBBU1RfTGFiZWwpIHtmb3IgKDsgaSA9IGJhc2U1NCgrK3IpLCBSRVNFUlZFRF9XT1JEU1tpXTspO3JldHVybiBhLm1hbmdsZWRfbmFtZSA9IGksICEwO319KTtmdW5jdGlvbiBmKGUpIHtvLnJlc2VydmVkLmhhc1tlLm5hbWVdIHx8IGUubWFuZ2xlKG8pO310aGlzLndhbGsoYyksIHMuZm9yRWFjaChmKTt9KSwgQVNUX1RvcGxldmVsLkRFRk1FVEhPRCgiZmluZF9jb2xsaWRpbmdfbmFtZXMiLCBmdW5jdGlvbiAoYSkge3ZhciB0ID0gYS5jYWNoZSAmJiBhLmNhY2hlLnByb3BzLG4gPSBPYmplY3QuY3JlYXRlKFJFU0VSVkVEX1dPUkRTKTtyZXR1cm4gYS5yZXNlcnZlZC5mb3JFYWNoKGkpLCB0aGlzLmdsb2JhbHMuZWFjaChvKSwgdGhpcy53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7ZSBpbnN0YW5jZW9mIEFTVF9CbG9ja1Njb3BlICYmIGUudmFyaWFibGVzLmVhY2gobyk7fSkpLCBuO2Z1bmN0aW9uIGkoZSkge25bZV0gPSAhMDt9ZnVuY3Rpb24gbyhlKSB7dmFyIG4gPSBlLm5hbWU7aWYgKGUuZ2xvYmFsICYmIHQgJiYgdC5oYXMobikpIG4gPSB0LmdldChuKTtlbHNlIGlmICghZS51bm1hbmdsZWFibGUoYSkpIHJldHVybjtpKG4pO319KSwgQVNUX1RvcGxldmVsLkRFRk1FVEhPRCgiZXhwYW5kX25hbWVzIiwgZnVuY3Rpb24gKHQpIHtiYXNlNTQucmVzZXQoKSwgYmFzZTU0LnNvcnQoKSwgdCA9IF9kZWZhdWx0X21hbmdsZXJfb3B0aW9ucyh0KTt2YXIgaSA9IHRoaXMuZmluZF9jb2xsaWRpbmdfbmFtZXModCksbyA9IDA7ZnVuY3Rpb24gbihuKSB7dmFyIGUsIGE7bi5nbG9iYWwgJiYgdC5jYWNoZSB8fCBuLnVubWFuZ2xlYWJsZSh0KSB8fCB0LnJlc2VydmVkLmhhc1tuLm5hbWVdIHx8IChlID0gbi5yZWRlZmluZWQoKSwgYSA9IGUgPyBlLnJlbmFtZSB8fCBlLm5hbWUgOiBmdW5jdGlvbiAoKSB7Zm9yICh2YXIgZTsgZSA9IGJhc2U1NChvKyspLCBpW2VdOyk7cmV0dXJuIGU7fSgpLCBuLnJlbmFtZSA9IGEsIG4uZm9yRWFjaChmdW5jdGlvbiAoZSkge2UuZGVmaW5pdGlvbigpID09PSBuICYmIChlLm5hbWUgPSBhKTt9KSk7fXRoaXMuZ2xvYmFscy5lYWNoKG4pLCB0aGlzLndhbGsobmV3IFRyZWVXYWxrZXIoZnVuY3Rpb24gKGUpIHtlIGluc3RhbmNlb2YgQVNUX0Jsb2NrU2NvcGUgJiYgZS52YXJpYWJsZXMuZWFjaChuKTt9KSk7fSksIEFTVF9Ob2RlLkRFRk1FVEhPRCgidGFpbF9ub2RlIiwgcmV0dXJuX3RoaXMpLCBBU1RfU2VxdWVuY2UuREVGTUVUSE9EKCJ0YWlsX25vZGUiLCBmdW5jdGlvbiAoKSB7cmV0dXJuIHRoaXMuZXhwcmVzc2lvbnNbdGhpcy5leHByZXNzaW9ucy5sZW5ndGggLSAxXTt9KSwgQVNUX1RvcGxldmVsLkRFRk1FVEhPRCgiY29tcHV0ZV9jaGFyX2ZyZXF1ZW5jeSIsIGZ1bmN0aW9uIChlKSB7ZSA9IF9kZWZhdWx0X21hbmdsZXJfb3B0aW9ucyhlKSwgYmFzZTU0LnJlc2V0KCk7dmFyIG4gPSBBU1RfU3ltYm9sLnByb3RvdHlwZS5hZGRfc291cmNlX21hcDt0cnkge0FTVF9TeW1ib2wucHJvdG90eXBlLmFkZF9zb3VyY2VfbWFwID0gZnVuY3Rpb24gKCkge3RoaXMudW5tYW5nbGVhYmxlKGUpIHx8IGJhc2U1NC5jb25zaWRlcih0aGlzLm5hbWUsIC0xKTt9LCBlLnByb3BlcnRpZXMgJiYgKEFTVF9Eb3QucHJvdG90eXBlLmFkZF9zb3VyY2VfbWFwID0gZnVuY3Rpb24gKCkge2Jhc2U1NC5jb25zaWRlcih0aGlzLnByb3BlcnR5LCAtMSk7fSwgQVNUX1N1Yi5wcm90b3R5cGUuYWRkX3NvdXJjZV9tYXAgPSBmdW5jdGlvbiAoKSB7IWZ1bmN0aW9uIGUobikge24gaW5zdGFuY2VvZiBBU1RfU3RyaW5nID8gYmFzZTU0LmNvbnNpZGVyKG4udmFsdWUsIC0xKSA6IG4gaW5zdGFuY2VvZiBBU1RfQ29uZGl0aW9uYWwgPyAoZShuLmNvbnNlcXVlbnQpLCBlKG4uYWx0ZXJuYXRpdmUpKSA6IG4gaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgJiYgZShuLnRhaWxfbm9kZSgpKTt9KHRoaXMucHJvcGVydHkpO30pLCBiYXNlNTQuY29uc2lkZXIodGhpcy5wcmludF90b19zdHJpbmcoKSwgMSk7fSBmaW5hbGx5IHtBU1RfU3ltYm9sLnByb3RvdHlwZS5hZGRfc291cmNlX21hcCA9IG4sIGRlbGV0ZSBBU1RfRG90LnByb3RvdHlwZS5hZGRfc291cmNlX21hcCwgZGVsZXRlIEFTVF9TdWIucHJvdG90eXBlLmFkZF9zb3VyY2VfbWFwO31iYXNlNTQuc29ydCgpO30pO3ZhciBiYXNlNTQgPSBmdW5jdGlvbiAoKSB7dmFyIGkgPSBPYmplY3QuY3JlYXRlKG51bGwpO2Z1bmN0aW9uIGUoZSkge2ZvciAodmFyIG4gPSBbXSwgYSA9IDA7IGEgPCBlLmxlbmd0aDsgYSsrKSB7dmFyIHQgPSBlW2FdO24ucHVzaCh0KSwgaVt0XSA9IC0uMDEgKiBhO31yZXR1cm4gbjt9dmFyIGEsdCxuID0gZSgiMDEyMzQ1Njc4OSIpLG8gPSBlKCJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ekFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaJF8iKTtmdW5jdGlvbiByKCkge2EgPSBudWxsLCB0ID0gT2JqZWN0LmNyZWF0ZShpKTt9ZnVuY3Rpb24gcyhlLCBuKSB7cmV0dXJuIHRbbl0gLSB0W2VdO31mdW5jdGlvbiBjKGUpIHt2YXIgbiA9IG9bZSAlIDU0XTtmb3IgKGUgPSBNYXRoLmZsb29yKGUgLyA1NCk7IDAgPD0gLS1lOyBlID4+PSA2KSBuICs9IGFbNjMgJiBlXTtyZXR1cm4gbjt9cmV0dXJuIGMuY29uc2lkZXIgPSBmdW5jdGlvbiAoZSwgbikge2ZvciAodmFyIGEgPSBlLmxlbmd0aDsgMCA8PSAtLWE7KSB0W2VbYV1dICs9IG47fSwgYy5zb3J0ID0gZnVuY3Rpb24gKCkge2EgPSBvLnNvcnQocykuY29uY2F0KG4pLnNvcnQocyk7fSwgKGMucmVzZXQgPSByKSgpLCBjO30oKTsKCiAgLy8gb3V0cHV0LmpzCiAgLy8gcHJldHRpZXItaWdub3JlCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCiAgInVzZSBzdHJpY3QiO2Z1bmN0aW9uIGlzX3NvbWVfY29tbWVudHMobikge3JldHVybiAiY29tbWVudDIiID09IG4udHlwZSAmJiAvQHByZXNlcnZlfEBsaWNlbnNlfEBjY19vbi9pLnRlc3Qobi52YWx1ZSk7fWZ1bmN0aW9uIE91dHB1dFN0cmVhbShjKSB7YyA9IGRlZmF1bHRzKGMsIHsgYW5ub3RhdGlvbnM6ICExLCBhc2NpaV9vbmx5OiAhMSwgYmVhdXRpZnk6ICExLCBicmFjZXM6ICExLCBjb21tZW50czogITEsIGV4dGVuZHNjcmlwdDogITEsIGdhbGlvOiAhMSwgaWU6ICExLCBpbmRlbnRfbGV2ZWw6IDQsIGluZGVudF9zdGFydDogMCwgaW5saW5lX3NjcmlwdDogITAsIGtlZXBfcXVvdGVkX3Byb3BzOiAhMSwgbWF4X2xpbmVfbGVuOiAhMSwgcHJlYW1ibGU6IG51bGwsIHByZXNlcnZlX2xpbmU6ICExLCBxdW90ZV9rZXlzOiAhMSwgcXVvdGVfc3R5bGU6IDAsIHNlbWljb2xvbnM6ICEwLCBzaGViYW5nOiAhMCwgc291cmNlX21hcDogbnVsbCwgdjg6ICExLCB3ZWJraXQ6ICExLCB3aWR0aDogODAsIHdyYXBfaWlmZTogITEgfSwgITApO3ZhciB0LHAgPSByZXR1cm5fZmFsc2U7ZnVuY3Rpb24gbihuKSB7aWYgKCJudW1iZXIiID09IHR5cGVvZiBuKSByZXR1cm4gbmV3IEFycmF5KG4gKyAxKS5qb2luKCIgIik7aWYgKCFuKSByZXR1cm4gIiI7aWYgKC9eXHMqJC8udGVzdChuKSkgcmV0dXJuIG47dGhyb3cgbmV3IEVycm9yKCJ1bnN1cHBvcnRlZCBpbmRlbnRhdGlvbjogIiArIEpTT04uc3RyaW5naWZ5KCIiICsgbikpO31jLmNvbW1lbnRzICYmICgic3RyaW5nIiA9PSB0eXBlb2YgKHQgPSBjLmNvbW1lbnRzKSAmJiAvXlwvLipcL1thLXpBLVpdKiQvLnRlc3QoYy5jb21tZW50cykgJiYgKEIgPSBjLmNvbW1lbnRzLmxhc3RJbmRleE9mKCIvIiksIHQgPSBuZXcgUmVnRXhwKGMuY29tbWVudHMuc3Vic3RyKDEsIEIgLSAxKSwgYy5jb21tZW50cy5zdWJzdHIoQiArIDEpKSksIHAgPSB0IGluc3RhbmNlb2YgUmVnRXhwID8gZnVuY3Rpb24gKG4pIHtyZXR1cm4gImNvbW1lbnQ1IiAhPSBuLnR5cGUgJiYgdC50ZXN0KG4udmFsdWUpO30gOiAiZnVuY3Rpb24iID09IHR5cGVvZiB0ID8gZnVuY3Rpb24gKG4pIHtyZXR1cm4gImNvbW1lbnQ1IiAhPSBuLnR5cGUgJiYgdCh0aGlzLCBuKTt9IDogInNvbWUiID09PSB0ID8gaXNfc29tZV9jb21tZW50cyA6IHJldHVybl90cnVlKTt2YXIgcixvLHMsYSx1LGYsZSxfID0gMCxsID0gMSxpID0gbihjLmluZGVudF9zdGFydCksUyA9IG4oYy5pbmRlbnRfbGV2ZWwpLFIgPSBTLmxlbmd0aCArIDEgPj4gMSxoID0gMCxBID0gITAsVCA9IGMuc291cmNlX21hcCAmJiBbXSxtID0gITEsZCA9ICExLHYgPSAiIjtmdW5jdGlvbiB5KCkge3UgPSBhID0gITEsIGUgPSBbXTt2YXIgbiA9IGY7cmV0dXJuIGYgPSByID0gIiIsIG47fXkoKTt2YXIgZyA9IGMuYXNjaWlfb25seSA/IGZ1bmN0aW9uIChuLCBlKSB7cmV0dXJuIChuID0gZSA/IG4ucmVwbGFjZSgvW1x1ZDgwMC1cdWRiZmZdW1x1ZGMwMC1cdWRmZmZdL2csIGZ1bmN0aW9uIChuKSB7cmV0dXJuICJcXHV7IiArIChuLmNoYXJDb2RlQXQoMCkgLSA1NTIzMiA8PCAxMCB8IG4uY2hhckNvZGVBdCgxKSAtIDU2MzIwKS50b1N0cmluZygxNikgKyAifSI7fSkgOiBuKS5yZXBsYWNlKC9bXHUwMDAwLVx1MDAxZlx1MDA3Zi1cdWZmZmZdL2csIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSBuLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpO2lmICh0Lmxlbmd0aCA8PSAyICYmICFlKSB7Zm9yICg7IHQubGVuZ3RoIDwgMjspIHQgPSAiMCIgKyB0O3JldHVybiAiXFx4IiArIHQ7fWZvciAoOyB0Lmxlbmd0aCA8IDQ7KSB0ID0gIjAiICsgdDtyZXR1cm4gIlxcdSIgKyB0O30pO30gOiBmdW5jdGlvbiAobikge2ZvciAodmFyIHQgPSAiIiwgZSA9IDAsIGkgPSAwOyBlIDwgbi5sZW5ndGg7IGUrKykge3ZhciByID0gbi5jaGFyQ29kZUF0KGUpO2lmIChpc19zdXJyb2dhdGVfcGFpcl9oZWFkKHIpKSB7aWYgKGlzX3N1cnJvZ2F0ZV9wYWlyX3RhaWwobi5jaGFyQ29kZUF0KGUgKyAxKSkpIHtlKys7Y29udGludWU7fX0gZWxzZSBpZiAoIWlzX3N1cnJvZ2F0ZV9wYWlyX3RhaWwocikpIGNvbnRpbnVlO3QgKz0gbi5zbGljZShpLCBlKSArICJcXHUiICsgci50b1N0cmluZygxNiksIGkgPSBlICsgMTt9cmV0dXJuIDAgPT0gaSA/IG4gOiB0ICsgbi5zbGljZShpKTt9O2Z1bmN0aW9uIGIobikge3JldHVybiAiJyIgKyBuLnJlcGxhY2UoL1x4MjcvZywgIlxcJyIpICsgIiciO31mdW5jdGlvbiB3KG4pIHtyZXR1cm4gJyInICsgbi5yZXBsYWNlKC9ceDIyL2csICdcXCInKSArICciJzt9dmFyICQgPSBbbnVsbCwgYiwgdywgZnVuY3Rpb24gKG4sIHQpIHtyZXR1cm4gKCInIiA9PSB0ID8gYiA6IHcpKG4pO31dW2MucXVvdGVfc3R5bGVdIHx8IGZ1bmN0aW9uIChuLCB0LCBlLCBpKSB7cmV0dXJuIChpIDwgZSA/IGIgOiB3KShuKTt9O2Z1bmN0aW9uIHgoZSwgbikge3ZhciBpID0gMCxyID0gMDtyZXR1cm4gZSA9IGUucmVwbGFjZSgvW1xcXGJcZlxuXHJcdlx0XHgyMlx4MjdcdTIwMjhcdTIwMjlcMFx1ZmVmZl0vZywgZnVuY3Rpb24gKG4sIHQpIHtzd2l0Y2ggKG4pIHtjYXNlICciJzpyZXR1cm4gKytpLCAnIic7Y2FzZSAiJyI6cmV0dXJuICsrciwgIiciO2Nhc2UgIlxcIjpyZXR1cm4gIlxcXFwiO2Nhc2UgIlxuIjpyZXR1cm4gIlxcbiI7Y2FzZSAiXHIiOnJldHVybiAiXFxyIjtjYXNlICJcdCI6cmV0dXJuICJcXHQiO2Nhc2UgIlxiIjpyZXR1cm4gIlxcYiI7Y2FzZSAiXGYiOnJldHVybiAiXFxmIjtjYXNlICJcdiI6cmV0dXJuIGMuaWUgPyAiXFx4MEIiIDogIlxcdiI7Y2FzZSAiXHUyMDI4IjpyZXR1cm4gIlxcdTIwMjgiO2Nhc2UgIlx1MjAyOSI6cmV0dXJuICJcXHUyMDI5IjtjYXNlICJcdUZFRkYiOnJldHVybiAiXFx1ZmVmZiI7Y2FzZSAiXDAiOnJldHVybiAvWzAtOV0vLnRlc3QoZS5jaGFyQXQodCArIDEpKSA/ICJcXHgwMCIgOiAiXFwwIjt9cmV0dXJuIG47fSksICQoZyhlKSwgbiwgaSwgcik7fXZhciBqID0gVCA/IGZ1bmN0aW9uICh0LCBlKSB7VC5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7bi5saW5lICs9IHQsIG4uY29sICs9IGU7fSk7fSA6IG5vb3AsRSA9IFQgPyBmdW5jdGlvbiAoKSB7VC5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7Yy5zb3VyY2VfbWFwLmFkZChuLnRva2VuLmZpbGUsIG4ubGluZSwgbi5jb2wsIG4udG9rZW4ubGluZSwgbi50b2tlbi5jb2wsIG4ubmFtZSB8fCAibmFtZSIgIT0gbi50b2tlbi50eXBlID8gbi5uYW1lIDogbi50b2tlbi52YWx1ZSk7fSksIFQgPSBbXTt9IDogbm9vcDtmdW5jdGlvbiBDKG4pIHt2ICs9IGYuc2xpY2UoMCwgaCk7dmFyIHQgPSAoZiA9IGYuc2xpY2UoaCkpLmxlbmd0aDtmb3IgKGoobiwgdCAtIF8pLCBsICs9IG4sIF8gPSB0OyBuLS07KSB2ICs9ICJcbiI7fXZhciBEID0gYy5tYXhfbGluZV9sZW4gPyBmdW5jdGlvbiAobikge0EgPyBfID4gYy5tYXhfbGluZV9sZW4gJiYgQVNUX05vZGUud2FybigiT3V0cHV0IGV4Y2VlZHMge21heF9saW5lX2xlbn0gY2hhcmFjdGVycyIsIGMpIDogKF8gPiBjLm1heF9saW5lX2xlbiAmJiAoQygxKSwgQSA9ICEwKSwgKEEgfHwgbikgJiYgRSgpKTt9IDogbm9vcCxWID0gbWFrZVByZWRpY2F0ZSgiOyB9IiksSSA9IG1ha2VQcmVkaWNhdGUoIiggWyArICogLyAtICwgLiBgIiksTCA9IG1ha2VQcmVkaWNhdGUoImluIGluc3RhbmNlb2YiKTtmdW5jdGlvbiBrKG4sIHQsIGUpIHtyZXR1cm4gaXNfaWRlbnRpZmllcl9jaGFyKG4pICYmIChpc19pZGVudGlmaWVyX2NoYXIodCkgfHwgIlxcIiA9PSB0KSB8fCAiLyIgPT0gdCAmJiB0ID09IG4gfHwgKCIrIiA9PSB0IHx8ICItIiA9PSB0KSAmJiB0ID09IHIgfHwgIi0tIiA9PSByICYmICI+IiA9PSB0IHx8ICIhIiA9PSByICYmICItLSIgPT0gZSB8fCAiLyIgPT0gbiAmJiAoImluIiA9PSBlIHx8ICJpbnN0YW5jZW9mIiA9PSBlKTt9dmFyIE8gPSBjLmJlYXV0aWZ5IHx8IGMuY29tbWVudHMgfHwgYy5tYXhfbGluZV9sZW4gfHwgYy5wcmVzZXJ2ZV9saW5lIHx8IGMuc2hlYmFuZyB8fCAhYy5zZW1pY29sb25zIHx8IGMuc291cmNlX21hcCB8fCBjLndpZHRoID8gZnVuY3Rpb24gKG4pIHt2YXIgdCA9IG4uY2hhckF0KDApLGUgPSAobSAmJiB0ICYmIChtID0gITEsICJcbiIgIT0gdCkgJiYgKE8oIlxuIiksIEYoKSksIGQgJiYgdCAmJiAoZCA9ICExLCAvW1xzO30pXS8udGVzdCh0KSB8fCBQKCkpLCByLnNsaWNlKC0xKSksaSA9ICh1ICYmICh1ID0gITEsICI7IiA9PSBlIHx8IFZbdF0gfHwgKChpID0gSVt0XSB8fCBMW25dKSB8fCBjLnNlbWljb2xvbnMgPyAoZiArPSAiOyIsIF8rKywgQSB8fCAoRCgpLCBBICYmICFpICYmICI7IiA9PSBmICYmIChmID0gIiIsIF8gPSAwKSksIGggPT0gZi5sZW5ndGggLSAxICYmIGgrKykgOiAoRCgpLCBmICs9ICJcbiIsIGwrKywgXyA9IDAsIC9eXHMrJC8udGVzdChuKSAmJiAodSA9ICEwKSksIGMuYmVhdXRpZnkpIHx8IChhID0gITEpKSwgYSAmJiAoayhlLCB0LCBuKSAmJiAoZiArPSAiICIsIF8rKyksICI8IiA9PSBlICYmICIhIiA9PSBuIHx8IChhID0gITEpKSwgcyAmJiAoVC5wdXNoKHsgdG9rZW46IHMsIG5hbWU6IG8sIGxpbmU6IGwsIGNvbDogXyB9KSwgcyA9ICExLCBBKSAmJiBFKCksIGYgKz0gbiwgbi5zcGxpdCgvXHI/XG4vKSksdCA9IGkubGVuZ3RoIC0gMTtsICs9IHQsIF8gKz0gaVswXS5sZW5ndGgsIDAgPCB0ICYmIChEKCksIF8gPSBpW3RdLmxlbmd0aCksIHIgPSBuO30gOiBmdW5jdGlvbiAobikge3ZhciB0ID0gbi5jaGFyQXQoMCksZSA9IHIuc2xpY2UoLTEpO3UgJiYgKHUgPSAhMSwgIjoiID09IGUgJiYgIn0iID09IHQgfHwgKCF0IHx8ICI7fSIuaW5kZXhPZih0KSA8IDApICYmICI7IiAhPSBlKSAmJiAoZiArPSAiOyIsIGEgPSAhMSksIGEgJiYgKGsoZSwgdCwgbikgJiYgKGYgKz0gIiAiKSwgIjwiID09IGUgJiYgIiEiID09IG4gfHwgKGEgPSAhMSkpLCBmICs9IG4sIHIgPSBuO30sUCA9IGMuYmVhdXRpZnkgPyBmdW5jdGlvbiAoKSB7TygiICIpO30gOiBmdW5jdGlvbiAoKSB7YSA9ICEwO30sRiA9IGMuYmVhdXRpZnkgPyBmdW5jdGlvbiAobikge20gJiYgTygiXG4iKSwgTyhuID8gaS5zbGljZSgwLCAtUikgOiBpKTt9IDogbm9vcCxVID0gYy5iZWF1dGlmeSA/IGZ1bmN0aW9uIChuKSB7dmFyIHQgPSBpO2kgKz0gUywgbigpLCBpID0gdDt9IDogZnVuY3Rpb24gKG4pIHtuKCk7fSxxID0gYy5tYXhfbGluZV9sZW4gfHwgYy5wcmVzZXJ2ZV9saW5lID8gZnVuY3Rpb24gKCkge0QoKSwgaCA9IGYubGVuZ3RoLCBBID0gITE7fSA6IG5vb3AsRyA9IGMuYmVhdXRpZnkgPyBmdW5jdGlvbiAoKSB7TygiXG4iKSwgaCA9IGYubGVuZ3RoO30gOiBxLEIgPSBjLmJlYXV0aWZ5ID8gZnVuY3Rpb24gKCkge08oIjsiKTt9IDogZnVuY3Rpb24gKCkge3UgPSAhMDt9O3ZhciBIID0gVCA/IGZ1bmN0aW9uIChuLCB0KSB7cyA9IG4sIG8gPSB0O30gOiBub29wO2Z1bmN0aW9uIE4obiwgdCkge20gfHwgKCFuLm5sYiB8fCAhdCAmJiAvKF58XG4pICokLy50ZXN0KGYpID8gdCAmJiAoZCA9ICEwKSA6IG0gPSAhMCk7fWZ1bmN0aW9uIE0obikge3ZhciB0ID0gbi52YWx1ZS5yZXBsYWNlKC9bQCNdX19QVVJFX18vZywgIiAiKTtyZXR1cm4gKCEvXlxzKiQvLnRlc3QodCkgfHwgL15ccyokLy50ZXN0KG4udmFsdWUpKSAmJiAoL2NvbW1lbnRbMTM0XS8udGVzdChuLnR5cGUpID8gKE8oIi8vIiArIHQpLCBtID0gITApIDogImNvbW1lbnQyIiA9PSBuLnR5cGUgJiYgTygiLyoiICsgdCArICIqLyIpLCAxKTt9cmV0dXJuIHsgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7cmV0dXJuIEEgfHwgRCghMCksIHYgKyBmO30sIHJlc2V0OiB5LCBpbmRlbnQ6IEYsIHNob3VsZF9icmVhazogYy5iZWF1dGlmeSAmJiBjLndpZHRoID8gZnVuY3Rpb24gKCkge3JldHVybiBfID49IGMud2lkdGg7fSA6IHJldHVybl9mYWxzZSwgaGFzX3BhcmVuczogZnVuY3Rpb24gaGFzX3BhcmVucygpIHtyZXR1cm4gIigiID09IHIuc2xpY2UoLTEpO30sIG5ld2xpbmU6IEcsIHByaW50OiBPLCBzcGFjZTogUCwgY29tbWE6IGZ1bmN0aW9uIGNvbW1hKCkge3EoKSwgTygiLCIpLCBxKCksIFAoKTt9LCBjb2xvbjogZnVuY3Rpb24gY29sb24oKSB7TygiOiIpLCBQKCk7fSwgbGFzdDogZnVuY3Rpb24gbGFzdCgpIHtyZXR1cm4gcjt9LCBzZW1pY29sb246IEIsIGZvcmNlX3NlbWljb2xvbjogZnVuY3Rpb24gZm9yY2Vfc2VtaWNvbG9uKCkge3UgJiYgTygiOyIpLCBPKCI7Iik7fSwgdG9fdXRmODogZywgcHJpbnRfbmFtZTogZnVuY3Rpb24gcHJpbnRfbmFtZShuKSB7TyhnKG4udG9TdHJpbmcoKSwgITApKTt9LCBwcmludF9zdHJpbmc6IGMuaW5saW5lX3NjcmlwdCA/IGZ1bmN0aW9uIChuLCB0KSB7biA9IHgobiwgdCkucmVwbGFjZSgvPFx4MmYoc2NyaXB0KShbPlwvXHRcblxmXHIgXSkvZ2ksICI8XFwvJDEkMiIpLCBPKG4ucmVwbGFjZSgvXHgzYyEtLS9nLCAiXFx4M2MhLS0iKS5yZXBsYWNlKC8tLVx4M2UvZywgIi0tXFx4M2UiKSk7fSA6IGZ1bmN0aW9uIChuLCB0KSB7Tyh4KG4sIHQpKTt9LCB3aXRoX2luZGVudDogVSwgd2l0aF9ibG9jazogZnVuY3Rpb24gd2l0aF9ibG9jayhuLCB0KSB7TygieyIpLCBHKCksIFUobiksIEgodCksIEYoKSwgTygifSIpO30sIHdpdGhfcGFyZW5zOiBmdW5jdGlvbiB3aXRoX3BhcmVucyhuKSB7TygiKCIpLCBxKCksIG4oKSwgcSgpLCBPKCIpIik7fSwgd2l0aF9zcXVhcmU6IGZ1bmN0aW9uIHdpdGhfc3F1YXJlKG4pIHtPKCJbIiksIHEoKSwgbigpLCBxKCksIE8oIl0iKTt9LCBhZGRfbWFwcGluZzogSCwgb3B0aW9uOiBmdW5jdGlvbiBvcHRpb24obikge3JldHVybiBjW25dO30sIHByZXBlbmRfY29tbWVudHM6IGMuY29tbWVudHMgfHwgYy5zaGViYW5nID8gZnVuY3Rpb24gKG4pIHt2YXIgZSxpID0gdGhpcztuIGluc3RhbmNlb2YgQVNUX0V4aXQgPyBlID0gbi52YWx1ZSA6IG4gaW5zdGFuY2VvZiBBU1RfWWllbGQgJiYgKGUgPSBuLmV4cHJlc3Npb24pO3ZhciByLHQsbyA9IChvID0gYShuKSkgfHwgW10scyA9IChlICYmICgociA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChuKSB7aWYgKGUgPSBuLCAhKCh0ID0gci5wYXJlbnQoKSkgaW5zdGFuY2VvZiBBU1RfQmluYXJ5ID8gdC5sZWZ0ID09PSBlIDogIkNhbGwiID09IHQuVFlQRSA/IHQuZXhwcmVzc2lvbiA9PT0gZSA6IHQgaW5zdGFuY2VvZiBBU1RfQ29uZGl0aW9uYWwgPyB0LmNvbmRpdGlvbiA9PT0gZSA6IHQgaW5zdGFuY2VvZiBBU1RfRG90ID8gdC5leHByZXNzaW9uID09PSBlIDogdCBpbnN0YW5jZW9mIEFTVF9FeGl0IHx8ICh0IGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlID8gdC5leHByZXNzaW9uc1swXSA9PT0gZSA6IHQgaW5zdGFuY2VvZiBBU1RfU3ViID8gdC5leHByZXNzaW9uID09PSBlIDogdCBpbnN0YW5jZW9mIEFTVF9VbmFyeVBvc3RmaXggfHwgdCBpbnN0YW5jZW9mIEFTVF9ZaWVsZCkpKSByZXR1cm4gITA7dmFyIHQsZSA9IGEobik7ZSAmJiAobyA9IG8uY29uY2F0KGUpKTt9KSkucHVzaChuKSwgZS53YWxrKHIpKSwgMSA9PSBsICYmIDAgPT0gXyAmJiAoMCA8IG8ubGVuZ3RoICYmIGMuc2hlYmFuZyAmJiAiY29tbWVudDUiID09IG9bMF0udHlwZSAmJiAoTygiIyEiICsgby5zaGlmdCgpLnZhbHVlICsgIlxuIiksIEYoKSksIHQgPSBjLnByZWFtYmxlKSAmJiBPKHQucmVwbGFjZSgvXHJcbj98XHUyMDI4fFx1MjAyOXwoXnxcUylccyokL2csICIkMVxuIikpLCBvID0gby5maWx0ZXIocCwgbiksICExKTtmdW5jdGlvbiBhKG4pIHt2YXIgdCA9IG4uc3RhcnQ7aWYgKCF0KSB7aWYgKCFlKSByZXR1cm47bi5zdGFydCA9IHQgPSBuZXcgQVNUX1Rva2VuKCk7fW4gPSB0LmNvbW1lbnRzX2JlZm9yZTtpZiAoIW4pIHtpZiAoIWUpIHJldHVybjt0LmNvbW1lbnRzX2JlZm9yZSA9IG4gPSBbXTt9aWYgKG4uX2R1bXBlZCAhPT0gaSkgcmV0dXJuIG4uX2R1bXBlZCA9IGksIG47fW8uZm9yRWFjaChmdW5jdGlvbiAobiwgdCkge04obiwgdCksIE0obikgJiYgKHMgPSAhMCk7fSksIHMgJiYgTihuLnN0YXJ0LCAhMCk7fSA6IG5vb3AsIGFwcGVuZF9jb21tZW50czogYy5jb21tZW50cyA/IGZ1bmN0aW9uIChuLCBlKSB7dmFyIHQgPSBuLmVuZDt0ICYmICh0ID0gdFtlID8gImNvbW1lbnRzX2JlZm9yZSIgOiAiY29tbWVudHNfYWZ0ZXIiXSkgJiYgdC5fZHVtcGVkICE9PSB0aGlzICYmIChuIGluc3RhbmNlb2YgQVNUX1N0YXRlbWVudCB8fCBhbGwodCwgZnVuY3Rpb24gKG4pIHtyZXR1cm4gIS9jb21tZW50WzEzNF0vLnRlc3Qobi50eXBlKTt9KSkgJiYgKHQuX2R1bXBlZCA9IHRoaXMsIHQuZmlsdGVyKHAsIG4pLmZvckVhY2goZnVuY3Rpb24gKG4sIHQpIHtOKG4sIHQgfHwgIWUpLCBNKG4pO30pKTt9IDogbm9vcCwgcHVzaF9ub2RlOiBmdW5jdGlvbiBwdXNoX25vZGUobikge2UucHVzaChuKTt9LCBwb3Bfbm9kZTogYy5wcmVzZXJ2ZV9saW5lID8gZnVuY3Rpb24gKCkge3ZhciBuID0gZS5wb3AoKTtuLnN0YXJ0ICYmIG4uc3RhcnQubGluZSA+IGwgJiYgQyhuLnN0YXJ0LmxpbmUgLSBsKTt9IDogZnVuY3Rpb24gKCkge2UucG9wKCk7fSwgcGFyZW50OiBmdW5jdGlvbiBwYXJlbnQobikge3JldHVybiBlW2UubGVuZ3RoIC0gMiAtIChuIHx8IDApXTt9IH07fSFmdW5jdGlvbiAoKSB7ZnVuY3Rpb24gbihuLCB0KSB7bi5ERUZNRVRIT0QoIl9jb2RlZ2VuIiwgdCk7fXZhciBzID0gITEsdCA9IChBU1RfTm9kZS5ERUZNRVRIT0QoInByaW50IiwgZnVuY3Rpb24gKG4sIHQpIHt2YXIgZSA9IHRoaXM7ZnVuY3Rpb24gaSgpIHtuLnByZXBlbmRfY29tbWVudHMoZSksIGUuYWRkX3NvdXJjZV9tYXAobiksIGUuX2NvZGVnZW4obiksIG4uYXBwZW5kX2NvbW1lbnRzKGUpO31uLnB1c2hfbm9kZShlKSwgdCB8fCBlLm5lZWRzX3BhcmVucyhuKSA/IG4ud2l0aF9wYXJlbnMoaSkgOiBpKCksIG4ucG9wX25vZGUoKTt9KSwgT3V0cHV0U3RyZWFtKHsgaW5saW5lX3NjcmlwdDogITEsIHNoZWJhbmc6ICExLCB3aWR0aDogITEgfSkpO2Z1bmN0aW9uIGUobiwgdCkge24uREVGTUVUSE9EKCJuZWVkc19wYXJlbnMiLCB0KTt9ZnVuY3Rpb24gaShuKSB7dmFyIHQgPSBuLnBhcmVudCgpO3JldHVybiAhbi5oYXNfcGFyZW5zKCkgJiYgZmlyc3RfaW5fc3RhdGVtZW50KG4sICExLCAhMCkgPyB0aGlzLm5hbWUgfHwgISh0IGluc3RhbmNlb2YgQVNUX0V4cG9ydERlZmF1bHQpIDogISEobi5vcHRpb24oIndlYmtpdCIpICYmIHQgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyAmJiB0LmV4cHJlc3Npb24gPT09IHRoaXMpIHx8ICEhKG4ub3B0aW9uKCJ3cmFwX2lpZmUiKSAmJiB0IGluc3RhbmNlb2YgQVNUX0NhbGwgJiYgdC5leHByZXNzaW9uID09PSB0aGlzKSB8fCB2b2lkIDA7fWZ1bmN0aW9uIHIobikge3JldHVybiAhbi5oYXNfcGFyZW5zKCkgJiYgZmlyc3RfaW5fc3RhdGVtZW50KG4sICEwKTt9ZnVuY3Rpb24gbyhuKSB7biA9IG4ucGFyZW50KCk7cmV0dXJuIG4gaW5zdGFuY2VvZiBBU1RfQmluYXJ5ID8gIioqIiA9PSBuLm9wZXJhdG9yICYmIG4ubGVmdCA9PT0gdGhpcyA6IG4gaW5zdGFuY2VvZiBBU1RfQ2FsbCA/IG4uZXhwcmVzc2lvbiA9PT0gdGhpcyA6IG4gaW5zdGFuY2VvZiBBU1RfQ2xhc3MgfHwgKG4gaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyA/IG4uZXhwcmVzc2lvbiA9PT0gdGhpcyA6IG4gaW5zdGFuY2VvZiBBU1RfVGVtcGxhdGUgPyBuLnRhZyA9PT0gdGhpcyA6IHZvaWQgMCk7fWZ1bmN0aW9uIGEobiwgdCkge3JldHVybiAhIW4udGVybWluYWwgJiYgKHQgaW5zdGFuY2VvZiBBU1RfQ2FsbCB8fCB0IGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpICYmIHQuZXhwcmVzc2lvbiA9PT0gbjt9ZnVuY3Rpb24gYyhuLCB0KSB7dCA9IHQucGFyZW50KCk7cmV0dXJuIHQgaW5zdGFuY2VvZiBBU1RfQXdhaXQgfHwgKHQgaW5zdGFuY2VvZiBBU1RfQmluYXJ5ID8gISh0IGluc3RhbmNlb2YgQVNUX0Fzc2lnbikgOiB0IGluc3RhbmNlb2YgQVNUX0NhbGwgPyB0LmV4cHJlc3Npb24gPT09IG4gOiB0IGluc3RhbmNlb2YgQVNUX0NsYXNzIHx8ICh0IGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsID8gdC5jb25kaXRpb24gPT09IG4gOiB0IGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgPyB0LmV4cHJlc3Npb24gPT09IG4gOiB0IGluc3RhbmNlb2YgQVNUX1RlbXBsYXRlID8gdC50YWcgPT09IG4gOiB0IGluc3RhbmNlb2YgQVNUX1VuYXJ5IHx8IHZvaWQgMCkpO31mdW5jdGlvbiBwKG4sIGUsIGksIHQpIHt2YXIgciA9IG4ubGVuZ3RoIC0gMSxvID0gdCx0ID0gcztuLmZvckVhY2goZnVuY3Rpb24gKG4sIHQpIHtvICYmIChuIGluc3RhbmNlb2YgQVNUX0RpcmVjdGl2ZSA/ICJ1c2UgYXNtIiA9PSBuLnZhbHVlICYmIChzID0gITApIDogbiBpbnN0YW5jZW9mIEFTVF9FbXB0eVN0YXRlbWVudCB8fCAobiBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQgJiYgbi5ib2R5IGluc3RhbmNlb2YgQVNUX1N0cmluZyAmJiBpLmZvcmNlX3NlbWljb2xvbigpLCBvID0gITEpKSwgbiBpbnN0YW5jZW9mIEFTVF9FbXB0eVN0YXRlbWVudCB8fCAoaS5pbmRlbnQoKSwgbi5wcmludChpKSwgdCA9PSByICYmIGUpIHx8IChpLm5ld2xpbmUoKSwgZSAmJiBpLm5ld2xpbmUoKSk7fSksIHMgPSB0O31mdW5jdGlvbiB1KG4sIHQpIHt0LnByaW50KCJ7IiksIHQud2l0aF9pbmRlbnQoZnVuY3Rpb24gKCkge3QuYXBwZW5kX2NvbW1lbnRzKG4sICEwKTt9KSwgdC5wcmludCgifSIpO31mdW5jdGlvbiBmKG4sIHQsIGUpIHswIDwgbi5ib2R5Lmxlbmd0aCA/IHQud2l0aF9ibG9jayhmdW5jdGlvbiAoKSB7cChuLmJvZHksICExLCB0LCBlKTt9LCBuLmVuZCkgOiB1KG4sIHQpO31mdW5jdGlvbiBfKGUsIGkpIHtyZXR1cm4gZnVuY3Rpb24gKG4pIHt2YXIgdCA9IHRoaXM7bi5wcmludChlKSwgbi5zcGFjZSgpLCBuLndpdGhfcGFyZW5zKGZ1bmN0aW9uICgpIHt0LmluaXQucHJpbnQobiksIG4uc3BhY2UoKSwgbi5wcmludChpKSwgbi5zcGFjZSgpLCB0Lm9iamVjdC5wcmludChuKTt9KSwgUCh0LmJvZHksIG4pO307fWZ1bmN0aW9uIGwobiwgdCkge3ZhciBlID0gbi52YWx1ZTsiKiIgPT0gZSB8fCBpc19pZGVudGlmaWVyX3N0cmluZyhlKSA/IHQucHJpbnRfbmFtZShlKSA6IHQucHJpbnRfc3RyaW5nKGUsIG4ucXVvdGUpO31mdW5jdGlvbiBTKG4sIGUpIHtlLndpdGhfcGFyZW5zKGZ1bmN0aW9uICgpIHtuLmFyZ25hbWVzLmZvckVhY2goZnVuY3Rpb24gKG4sIHQpIHt0ICYmIGUuY29tbWEoKSwgbi5wcmludChlKTt9KSwgbi5yZXN0ICYmIChuLmFyZ25hbWVzLmxlbmd0aCAmJiBlLmNvbW1hKCksIGUucHJpbnQoIi4uLiIpLCBuLnJlc3QucHJpbnQoZSkpO30pO31mdW5jdGlvbiBoKG4sIHQpIHt2YXIgZSA9IDEgPT0gbi5hcmduYW1lcy5sZW5ndGggJiYgIW4ucmVzdCAmJiBuLmFyZ25hbWVzWzBdO2UgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnICYmICJ5aWVsZCIgIT0gZS5uYW1lID8gZS5wcmludCh0KSA6IFMobiwgdCksIHQuc3BhY2UoKSwgdC5wcmludCgiPT4iKSwgdC5zcGFjZSgpLCBuLnZhbHVlID8gbi52YWx1ZS5wcmludCh0KSA6IGYobiwgdCwgITApO31mdW5jdGlvbiBBKG4sIHQpIHtuLm5hbWUgJiYgKHQuc3BhY2UoKSwgbi5uYW1lLnByaW50KHQpKSwgUyhuLCB0KSwgdC5zcGFjZSgpLCBmKG4sIHQsICEwKTt9ZnVuY3Rpb24gVChuKSB7bi5wcmludCgiYXN5bmMiKSwgbi5zcGFjZSgpLCBuLnByaW50KCJmdW5jdGlvbiIpLCBBKHRoaXMsIG4pO31mdW5jdGlvbiBtKG4pIHtuLnByaW50KCJhc3luYyIpLCBuLnNwYWNlKCksIG4ucHJpbnQoImZ1bmN0aW9uKiIpLCBBKHRoaXMsIG4pO31mdW5jdGlvbiBkKG4pIHtuLnByaW50KCJmdW5jdGlvbioiKSwgQSh0aGlzLCBuKTt9ZnVuY3Rpb24gdihuLCB0KSB7dmFyIGUgPSBuLnZhbHVlO2lzX2FzeW5jKGUpICYmICh0LnByaW50KCJhc3luYyIpLCB0LnNwYWNlKCkpLCBpc19nZW5lcmF0b3IoZSkgJiYgdC5wcmludCgiKiIpLCBEKG4sIHQpLCBBKG4udmFsdWUsIHQpO31mdW5jdGlvbiB5KGUsIGkpIHtyZXR1cm4gZnVuY3Rpb24gKG4pIHtuLnByaW50KGUpO3ZhciB0ID0gdGhpc1tpXTt0ICYmIChuLnNwYWNlKCksIHQucHJpbnQobikpLCBuLnNlbWljb2xvbigpO307fWZ1bmN0aW9uIGcobiwgdCkge3QubmV3bGluZSgpLCBuLmJvZHkuZm9yRWFjaChmdW5jdGlvbiAobikge3QuaW5kZW50KCksIG4ucHJpbnQodCksIHQubmV3bGluZSgpO30pO31mdW5jdGlvbiBiKHQpIHtyZXR1cm4gZnVuY3Rpb24gKGUpIHtlLnByaW50KHQpLCBlLnNwYWNlKCksIHRoaXMuZGVmaW5pdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobiwgdCkge3QgJiYgZS5jb21tYSgpLCBuLnByaW50KGUpO30pO3ZhciBuID0gZS5wYXJlbnQoKTtuIGluc3RhbmNlb2YgQVNUX0l0ZXJhdGlvblN0YXRlbWVudCAmJiBuLmluaXQgPT09IHRoaXMgfHwgZS5zZW1pY29sb24oKTt9O31mdW5jdGlvbiB3KG4sIHQsIGUpIHt2YXIgaSA9ICExO2UgJiYgbi53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChuKSB7cmV0dXJuICEhaSB8fCAobiBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgImluIiA9PSBuLm9wZXJhdG9yID8gaSA9ICEwIDogbiBpbnN0YW5jZW9mIEFTVF9TY29wZSAmJiAoIWlzX2Fycm93KG4pIHx8ICFuLnZhbHVlKSB8fCB2b2lkIDApO30pKSwgbi5wcmludCh0LCBpKTt9ZnVuY3Rpb24geChuLCB0KSB7aWYgKHQub3B0aW9uKCJhbm5vdGF0aW9ucyIpICYmIG4ucHVyZSkge3ZhciBlLGkgPSAwLHIgPSBuO2RvIHtpZiAoZSA9IHIsIChyID0gdC5wYXJlbnQoaSsrKSkgaW5zdGFuY2VvZiBBU1RfQ2FsbCAmJiByLmV4cHJlc3Npb24gPT09IGUpIHJldHVybjt9IHdoaWxlIChyIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgJiYgci5leHByZXNzaW9uID09PSBlKTt0LnByaW50KCIvKkBfX1BVUkVfXyovIik7fX1mdW5jdGlvbiBFKG4sIGUpIHtlLndpdGhfcGFyZW5zKGZ1bmN0aW9uICgpIHtuLmFyZ3MuZm9yRWFjaChmdW5jdGlvbiAobiwgdCkge3QgJiYgZS5jb21tYSgpLCBuLnByaW50KGUpO30pLCBlLmFkZF9tYXBwaW5nKG4uZW5kKTt9KTt9ZnVuY3Rpb24gQyhuLCBlLCBpKSB7dmFyIHQgPSBuLnByb3BlcnRpZXM7MCA8IHQubGVuZ3RoID8gZS53aXRoX2Jsb2NrKGZ1bmN0aW9uICgpIHt0LmZvckVhY2goZnVuY3Rpb24gKG4sIHQpIHt0ICYmIChpIHx8IGUucHJpbnQoIiwiKSwgZS5uZXdsaW5lKCkpLCBlLmluZGVudCgpLCBuLnByaW50KGUpO30pLCBlLm5ld2xpbmUoKTt9LCBuLmVuZCkgOiB1KG4sIGUpO31mdW5jdGlvbiBEKG4sIHQpIHt2YXIgZSA9IG4ua2V5O2lmIChlIGluc3RhbmNlb2YgQVNUX05vZGUpIHJldHVybiB0LndpdGhfc3F1YXJlKGZ1bmN0aW9uICgpIHtlLnByaW50KHQpO30pO3ZhciBpID0gbi5zdGFydCAmJiBuLnN0YXJ0LnF1b3RlO2lmICh0Lm9wdGlvbigicXVvdGVfa2V5cyIpIHx8IGkgJiYgdC5vcHRpb24oImtlZXBfcXVvdGVkX3Byb3BzIikpIHQucHJpbnRfc3RyaW5nKGUsIGkpO2Vsc2UgaWYgKCIiICsgK2UgPT0gZSAmJiAwIDw9IGUpIHQucHJpbnQocShlKSk7ZWxzZSBpZiAobi5wcml2YXRlKSB0LnByaW50X25hbWUoZSk7ZWxzZSB7aWYgKFJFU0VSVkVEX1dPUkRTW2VdID8gIXQub3B0aW9uKCJpZSIpIDogaXNfaWRlbnRpZmllcl9zdHJpbmcoZSkpIHJldHVybiB0LnByaW50X25hbWUoZSksIGU7dC5wcmludF9zdHJpbmcoZSwgaSk7fX1mdW5jdGlvbiBrKHQpIHtyZXR1cm4gZnVuY3Rpb24gKG4pIHt0aGlzLnN0YXRpYyAmJiAobi5wcmludCgic3RhdGljIiksIG4uc3BhY2UoKSksIG4ucHJpbnQodCksIG4uc3BhY2UoKSwgRCh0aGlzLCBuKSwgQSh0aGlzLnZhbHVlLCBuKTt9O31mdW5jdGlvbiBPKG4pIHt2YXIgdCA9IG4uZGVmaW5pdGlvbigpO3JldHVybiB0ICYmIHQubWFuZ2xlZF9uYW1lIHx8IG4ubmFtZTt9ZnVuY3Rpb24gUChuLCB0KSB7dC5vcHRpb24oImJyYWNlcyIpICYmICEobiBpbnN0YW5jZW9mIEFTVF9Db25zdCB8fCBuIGluc3RhbmNlb2YgQVNUX0xldCkgPyBCKG4sIHQpIDogbiBpbnN0YW5jZW9mIEFTVF9FbXB0eVN0YXRlbWVudCA/IHQuZm9yY2Vfc2VtaWNvbG9uKCkgOiAodC5zcGFjZSgpLCBuLnByaW50KHQpKTt9ZnVuY3Rpb24gRihuLCB0KSB7cmV0dXJuIDAgPCBuLmFyZ3MubGVuZ3RoIHx8IHQub3B0aW9uKCJiZWF1dGlmeSIpO31mdW5jdGlvbiBxKG4pIHtmb3IgKHZhciB0LCBlLCBpID0gbi50b1N0cmluZygxMCkucmVwbGFjZSgvXjBcLi8sICIuIikucmVwbGFjZSgiZSsiLCAiZSIpLCByID0gW2ldLCBvID0gKE1hdGguZmxvb3IobikgPT09IG4gJiYgci5wdXNoKG4gPCAwID8gIi0weCIgKyAoLW4pLnRvU3RyaW5nKDE2KS50b0xvd2VyQ2FzZSgpIDogIjB4IiArIG4udG9TdHJpbmcoMTYpLnRvTG93ZXJDYXNlKCkpLCAobiA9IC9eXC4wKy8uZXhlYyhpKSkgPyAodCA9IG5bMF0ubGVuZ3RoLCBlID0gaS5zbGljZSh0KSwgci5wdXNoKGUgKyAiZS0iICsgKGUubGVuZ3RoICsgdCAtIDEpKSkgOiAobiA9IC9bXjBdMCskLy5leGVjKGkpKSA/ICh0ID0gblswXS5sZW5ndGggLSAxLCByLnB1c2goaS5zbGljZSgwLCAtdCkgKyAiZSIgKyB0KSkgOiAobiA9IC9eKFxkKVwuKFxkKyllKC0/XGQrKSQvLmV4ZWMoaSkpICYmIHIucHVzaChuWzFdICsgblsyXSArICJlIiArIChuWzNdIC0gblsyXS5sZW5ndGgpKSwgciksIHMgPSBvWzBdLCBhID0gcy5sZW5ndGgsIGMgPSAxOyBjIDwgby5sZW5ndGg7ICsrYykgb1tjXS5sZW5ndGggPCBhICYmIChhID0gKHMgPSBvW2NdKS5sZW5ndGgpO3JldHVybiBzO31mdW5jdGlvbiBCKG4sIHQpIHt0LnNwYWNlKCksIG4gaW5zdGFuY2VvZiBBU1RfRW1wdHlTdGF0ZW1lbnQgPyB1KG4sIHQpIDogbiBpbnN0YW5jZW9mIEFTVF9CbG9ja1N0YXRlbWVudCA/IG4ucHJpbnQodCkgOiB0LndpdGhfYmxvY2soZnVuY3Rpb24gKCkge3QuaW5kZW50KCksIG4ucHJpbnQodCksIHQubmV3bGluZSgpO30sIG4uZW5kKTt9ZnVuY3Rpb24gTihuLCB0KSB7bi5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7bi5ERUZNRVRIT0QoImFkZF9zb3VyY2VfbWFwIiwgdCk7fSk7fUFTVF9Ob2RlLkRFRk1FVEhPRCgicHJpbnRfdG9fc3RyaW5nIiwgZnVuY3Rpb24gKG4pIHtyZXR1cm4gbiA/IChuID0gT3V0cHV0U3RyZWFtKG4pLCB0aGlzLnByaW50KG4pLCBuLmdldCgpKSA6ICh0aGlzLnByaW50KHQpLCB0LnJlc2V0KCkpO30pLCBlKEFTVF9Ob2RlLCByZXR1cm5fZmFsc2UpLCBlKEFTVF9Bc3luY0Z1bmN0aW9uLCBpKSwgZShBU1RfQXN5bmNHZW5lcmF0b3JGdW5jdGlvbiwgaSksIGUoQVNUX0NsYXNzRXhwcmVzc2lvbiwgaSksIGUoQVNUX0Z1bmN0aW9uLCBpKSwgZShBU1RfR2VuZXJhdG9yRnVuY3Rpb24sIGkpLCBlKEFTVF9PYmplY3QsIHIpLCBlKEFTVF9Bd2FpdCwgbyksIGUoQVNUX1VuYXJ5LCBvKSwgZShBU1RfU2VxdWVuY2UsIGZ1bmN0aW9uIChuKSB7biA9IG4ucGFyZW50KCk7cmV0dXJuIG4gaW5zdGFuY2VvZiBBU1RfQXJyYXkgfHwgaXNfYXJyb3cobikgJiYgbi52YWx1ZSA9PT0gdGhpcyB8fCBuIGluc3RhbmNlb2YgQVNUX0F3YWl0IHx8IG4gaW5zdGFuY2VvZiBBU1RfQmluYXJ5IHx8IG4gaW5zdGFuY2VvZiBBU1RfQ2FsbCB8fCBuIGluc3RhbmNlb2YgQVNUX0NsYXNzIHx8IG4gaW5zdGFuY2VvZiBBU1RfQ2xhc3NQcm9wZXJ0eSB8fCBuIGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsIHx8IG4gaW5zdGFuY2VvZiBBU1RfRGVmYXVsdFZhbHVlIHx8IG4gaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkS2V5VmFsIHx8IG4gaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVmYXVsdCB8fCBuIGluc3RhbmNlb2YgQVNUX0Zvck9mIHx8IG4gaW5zdGFuY2VvZiBBU1RfT2JqZWN0UHJvcGVydHkgfHwgbiBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzICYmIG4uZXhwcmVzc2lvbiA9PT0gdGhpcyB8fCBuIGluc3RhbmNlb2YgQVNUX1NwcmVhZCB8fCBuIGluc3RhbmNlb2YgQVNUX1RlbXBsYXRlICYmIG4udGFnID09PSB0aGlzIHx8IG4gaW5zdGFuY2VvZiBBU1RfVW5hcnkgfHwgbiBpbnN0YW5jZW9mIEFTVF9WYXJEZWYgfHwgbiBpbnN0YW5jZW9mIEFTVF9ZaWVsZDt9KSwgZShBU1RfQmluYXJ5LCBmdW5jdGlvbiAobikge3ZhciB0LGUsaSxyLG4gPSBuLnBhcmVudCgpO3JldHVybiBuIGluc3RhbmNlb2YgQVNUX0F3YWl0IHx8IChuIGluc3RhbmNlb2YgQVNUX0JpbmFyeSA/ICh0ID0gbi5vcGVyYXRvciwgZSA9IFBSRUNFREVOQ0VbdF0sIGkgPSB0aGlzLm9wZXJhdG9yLCAociA9IFBSRUNFREVOQ0VbaV0pIDwgZSB8fCAiPz8iID09IHQgJiYgKCImJiIgPT0gaSB8fCAifHwiID09IGkpIHx8IGUgPT0gciAmJiB0aGlzID09PSBuWyIqKiIgPT0gdCA/ICJsZWZ0IiA6ICJyaWdodCJdKSA6IG4gaW5zdGFuY2VvZiBBU1RfQ2FsbCA/IG4uZXhwcmVzc2lvbiA9PT0gdGhpcyA6IG4gaW5zdGFuY2VvZiBBU1RfQ2xhc3MgfHwgKG4gaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyA/IG4uZXhwcmVzc2lvbiA9PT0gdGhpcyA6IG4gaW5zdGFuY2VvZiBBU1RfVGVtcGxhdGUgPyBuLnRhZyA9PT0gdGhpcyA6IG4gaW5zdGFuY2VvZiBBU1RfVW5hcnkgfHwgdm9pZCAwKSk7fSksIGUoQVNUX1Byb3BBY2Nlc3MsIGZ1bmN0aW9uIChuKSB7biA9IG4ucGFyZW50KCk7cmV0dXJuIG4gaW5zdGFuY2VvZiBBU1RfTmV3ICYmIG4uZXhwcmVzc2lvbiA9PT0gdGhpcyAmJiAiQ2FsbCIgPT0gcm9vdF9leHByKHRoaXMpLlRZUEUgfHwgYSh0aGlzLCBuKTt9KSwgZShBU1RfQ2FsbCwgZnVuY3Rpb24gKG4pIHt2YXIgdCA9IG4ucGFyZW50KCk7aWYgKHQgaW5zdGFuY2VvZiBBU1RfTmV3KSByZXR1cm4gdC5leHByZXNzaW9uID09PSB0aGlzO2lmIChuLm9wdGlvbigid2Via2l0IikgJiYgdGhpcy5leHByZXNzaW9uIGluc3RhbmNlb2YgQVNUX0Z1bmN0aW9uICYmIHQgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyAmJiB0LmV4cHJlc3Npb24gPT09IHRoaXMpIHtuID0gbi5wYXJlbnQoMSk7aWYgKG4gaW5zdGFuY2VvZiBBU1RfQXNzaWduICYmIG4ubGVmdCA9PT0gdCkgcmV0dXJuICEwO31yZXR1cm4gYSh0aGlzLCB0KTt9KSwgZShBU1RfTmV3LCBmdW5jdGlvbiAobikge3JldHVybiAhRih0aGlzLCBuKSAmJiAoKG4gPSBuLnBhcmVudCgpKSBpbnN0YW5jZW9mIEFTVF9DYWxsID8gbi5leHByZXNzaW9uID09PSB0aGlzIDogbiBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzIHx8IChuIGluc3RhbmNlb2YgQVNUX1RlbXBsYXRlID8gbi50YWcgPT09IHRoaXMgOiB2b2lkIDApKTt9KSwgZShBU1RfTnVtYmVyLCBmdW5jdGlvbiAobikge3JldHVybiAhIW4ub3B0aW9uKCJnYWxpbyIpICYmIChuID0gbi5wYXJlbnQoKSkgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyAmJiBuLmV4cHJlc3Npb24gPT09IHRoaXMgJiYgL14wLy50ZXN0KHEodGhpcy52YWx1ZSkpO30pLCBlKEFTVF9BcnJvdywgZnVuY3Rpb24gKG4pIHtyZXR1cm4gYyh0aGlzLCBuKTt9KSwgZShBU1RfQXNzaWduLCBmdW5jdGlvbiAobikge3JldHVybiAhIWModGhpcywgbikgfHwgKG4ub3B0aW9uKCJ2OCIpID8gdGhpcy5sZWZ0IGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCA6IHRoaXMubGVmdCBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRPYmplY3QgPyByKG4pIDogdm9pZCAwKTt9KSwgZShBU1RfQXN5bmNBcnJvdywgZnVuY3Rpb24gKG4pIHtyZXR1cm4gYyh0aGlzLCBuKTt9KSwgZShBU1RfQ29uZGl0aW9uYWwsIGZ1bmN0aW9uIChuKSB7cmV0dXJuIGModGhpcywgbikgfHwgbi5vcHRpb24oImV4dGVuZHNjcmlwdCIpICYmIG4ucGFyZW50KCkgaW5zdGFuY2VvZiBBU1RfQ29uZGl0aW9uYWw7fSksIGUoQVNUX1lpZWxkLCBmdW5jdGlvbiAobikge3JldHVybiBjKHRoaXMsIG4pO30pLCBuKEFTVF9EaXJlY3RpdmUsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzLnF1b3RlLGUgPSB0aGlzLnZhbHVlO3N3aXRjaCAobi5vcHRpb24oInF1b3RlX3N0eWxlIikpIHtjYXNlIDA6Y2FzZSAyOi0xID09IGUuaW5kZXhPZignIicpICYmICh0ID0gJyInKTticmVhaztjYXNlIDE6LTEgPT0gZS5pbmRleE9mKCInIikgJiYgKHQgPSAiJyIpO31uLnByaW50KHQgKyBlICsgdCksIG4uc2VtaWNvbG9uKCk7fSksIG4oQVNUX0RlYnVnZ2VyLCBmdW5jdGlvbiAobikge24ucHJpbnQoImRlYnVnZ2VyIiksIG4uc2VtaWNvbG9uKCk7fSksIG4oQVNUX1RvcGxldmVsLCBmdW5jdGlvbiAobikge3AodGhpcy5ib2R5LCAhMCwgbiwgITApLCBuLnByaW50KCIiKTt9KSwgbihBU1RfTGFiZWxlZFN0YXRlbWVudCwgZnVuY3Rpb24gKG4pIHt0aGlzLmxhYmVsLnByaW50KG4pLCBuLmNvbG9uKCk7dmFyIHQgPSB0aGlzLmJvZHk7dCBpbnN0YW5jZW9mIEFTVF9FbXB0eVN0YXRlbWVudCA/IG4uZm9yY2Vfc2VtaWNvbG9uKCkgOiB0LnByaW50KG4pO30pLCBuKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGZ1bmN0aW9uIChuKSB7dGhpcy5ib2R5LnByaW50KG4pLCBuLnNlbWljb2xvbigpO30pLCBuKEFTVF9CbG9ja1N0YXRlbWVudCwgZnVuY3Rpb24gKG4pIHtmKHRoaXMsIG4pO30pLCBuKEFTVF9FbXB0eVN0YXRlbWVudCwgZnVuY3Rpb24gKG4pIHtuLnNlbWljb2xvbigpO30pLCBuKEFTVF9EbywgZnVuY3Rpb24gKG4pIHt2YXIgdCA9IHRoaXM7bi5wcmludCgiZG8iKSwgQih0LmJvZHksIG4pLCBuLnNwYWNlKCksIG4ucHJpbnQoIndoaWxlIiksIG4uc3BhY2UoKSwgbi53aXRoX3BhcmVucyhmdW5jdGlvbiAoKSB7dC5jb25kaXRpb24ucHJpbnQobik7fSksIG4uc2VtaWNvbG9uKCk7fSksIG4oQVNUX1doaWxlLCBmdW5jdGlvbiAobikge3ZhciB0ID0gdGhpcztuLnByaW50KCJ3aGlsZSIpLCBuLnNwYWNlKCksIG4ud2l0aF9wYXJlbnMoZnVuY3Rpb24gKCkge3QuY29uZGl0aW9uLnByaW50KG4pO30pLCBQKHQuYm9keSwgbik7fSksIG4oQVNUX0ZvciwgZnVuY3Rpb24gKG4pIHt2YXIgdCA9IHRoaXM7bi5wcmludCgiZm9yIiksIG4uc3BhY2UoKSwgbi53aXRoX3BhcmVucyhmdW5jdGlvbiAoKSB7dC5pbml0ID8gKHQuaW5pdCBpbnN0YW5jZW9mIEFTVF9EZWZpbml0aW9ucyA/IHQuaW5pdC5wcmludChuKSA6IHcodC5pbml0LCBuLCAhMCksIG4ucHJpbnQoIjsiKSwgbi5zcGFjZSgpKSA6IG4ucHJpbnQoIjsiKSwgdC5jb25kaXRpb24gPyAodC5jb25kaXRpb24ucHJpbnQobiksIG4ucHJpbnQoIjsiKSwgbi5zcGFjZSgpKSA6IG4ucHJpbnQoIjsiKSwgdC5zdGVwICYmIHQuc3RlcC5wcmludChuKTt9KSwgUCh0LmJvZHksIG4pO30pLCBuKEFTVF9Gb3JBd2FpdE9mLCBfKCJmb3IgYXdhaXQiLCAib2YiKSksIG4oQVNUX0ZvckluLCBfKCJmb3IiLCAiaW4iKSksIG4oQVNUX0Zvck9mLCBfKCJmb3IiLCAib2YiKSksIG4oQVNUX1dpdGgsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzO24ucHJpbnQoIndpdGgiKSwgbi5zcGFjZSgpLCBuLndpdGhfcGFyZW5zKGZ1bmN0aW9uICgpIHt0LmV4cHJlc3Npb24ucHJpbnQobik7fSksIFAodC5ib2R5LCBuKTt9KSwgbihBU1RfRXhwb3J0RGVjbGFyYXRpb24sIGZ1bmN0aW9uIChuKSB7bi5wcmludCgiZXhwb3J0IiksIG4uc3BhY2UoKSwgdGhpcy5ib2R5LnByaW50KG4pO30pLCBuKEFTVF9FeHBvcnREZWZhdWx0LCBmdW5jdGlvbiAobikge24ucHJpbnQoImV4cG9ydCIpLCBuLnNwYWNlKCksIG4ucHJpbnQoImRlZmF1bHQiKSwgbi5zcGFjZSgpO3ZhciB0ID0gdGhpcy5ib2R5O3QucHJpbnQobiksIHQgaW5zdGFuY2VvZiBBU1RfQ2xhc3NFeHByZXNzaW9uICYmICF0Lm5hbWUgfHwgdCBpbnN0YW5jZW9mIEFTVF9EZWZDbGFzcyB8fCB0IGluc3RhbmNlb2YgQVNUX0xhbWJkYURlZmluaXRpb24gfHwgdCBpbnN0YW5jZW9mIEFTVF9MYW1iZGFFeHByZXNzaW9uICYmICF0Lm5hbWUgJiYgIWlzX2Fycm93KHQpIHx8IG4uc2VtaWNvbG9uKCk7fSksIG4oQVNUX0V4cG9ydEZvcmVpZ24sIGZ1bmN0aW9uIChlKSB7dmFyIGkgPSB0aGlzLHQgPSAoZS5wcmludCgiZXhwb3J0IiksIGUuc3BhY2UoKSwgaS5rZXlzLmxlbmd0aCk7ZnVuY3Rpb24gcihuKSB7dmFyIHQgPSBpLmFsaWFzZXNbbl0sbiA9IGkua2V5c1tuXTtsKG4sIGUpLCB0LnZhbHVlICE9IG4udmFsdWUgJiYgKGUuc3BhY2UoKSwgZS5wcmludCgiYXMiKSwgZS5zcGFjZSgpLCBsKHQsIGUpKTt9MCA9PSB0ID8gdShpLCBlKSA6ICIqIiA9PSBpLmtleXNbMF0udmFsdWUgPyByKDApIDogZS53aXRoX2Jsb2NrKGZ1bmN0aW9uICgpIHtlLmluZGVudCgpLCByKDApO2ZvciAodmFyIG4gPSAxOyBuIDwgdDsgbisrKSBlLnByaW50KCIsIiksIGUubmV3bGluZSgpLCBlLmluZGVudCgpLCByKG4pO2UubmV3bGluZSgpO30sIGkuZW5kKSwgZS5zcGFjZSgpLCBlLnByaW50KCJmcm9tIiksIGUuc3BhY2UoKSwgaS5wYXRoLnByaW50KGUpLCBlLnNlbWljb2xvbigpO30pLCBuKEFTVF9FeHBvcnRSZWZlcmVuY2VzLCBmdW5jdGlvbiAobikge24ucHJpbnQoImV4cG9ydCIpLCBuLnNwYWNlKCksIEModGhpcywgbiksIG4uc2VtaWNvbG9uKCk7fSksIG4oQVNUX0ltcG9ydCwgZnVuY3Rpb24gKG4pIHt2YXIgdCA9IHRoaXM7bi5wcmludCgiaW1wb3J0IiksIG4uc3BhY2UoKSwgdC5kZWZhdWx0ICYmIHQuZGVmYXVsdC5wcmludChuKSwgdC5hbGwgJiYgKHQuZGVmYXVsdCAmJiBuLmNvbW1hKCksIHQuYWxsLnByaW50KG4pKSwgdC5wcm9wZXJ0aWVzICYmICh0LmRlZmF1bHQgJiYgbi5jb21tYSgpLCBDKHQsIG4pKSwgKHQuYWxsIHx8IHQuZGVmYXVsdCB8fCB0LnByb3BlcnRpZXMpICYmIChuLnNwYWNlKCksIG4ucHJpbnQoImZyb20iKSwgbi5zcGFjZSgpKSwgdC5wYXRoLnByaW50KG4pLCBuLnNlbWljb2xvbigpO30pLCBuKEFTVF9BcnJvdywgZnVuY3Rpb24gKG4pIHtoKHRoaXMsIG4pO30pLCBuKEFTVF9Bc3luY0Fycm93LCBmdW5jdGlvbiAobikge24ucHJpbnQoImFzeW5jIiksIG4uc3BhY2UoKSwgaCh0aGlzLCBuKTt9KSwgbihBU1RfTGFtYmRhLCBmdW5jdGlvbiAobikge24ucHJpbnQoImZ1bmN0aW9uIiksIEEodGhpcywgbik7fSksIG4oQVNUX0FzeW5jRGVmdW4sIFQpLCBuKEFTVF9Bc3luY0Z1bmN0aW9uLCBUKSwgbihBU1RfQXN5bmNHZW5lcmF0b3JEZWZ1biwgbSksIG4oQVNUX0FzeW5jR2VuZXJhdG9yRnVuY3Rpb24sIG0pLCBuKEFTVF9HZW5lcmF0b3JEZWZ1biwgZCksIG4oQVNUX0dlbmVyYXRvckZ1bmN0aW9uLCBkKSwgbihBU1RfQ2xhc3MsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzO24ucHJpbnQoImNsYXNzIiksIHQubmFtZSAmJiAobi5zcGFjZSgpLCB0Lm5hbWUucHJpbnQobikpLCB0LmV4dGVuZHMgJiYgKG4uc3BhY2UoKSwgbi5wcmludCgiZXh0ZW5kcyIpLCBuLnNwYWNlKCksIHQuZXh0ZW5kcy5wcmludChuKSksIG4uc3BhY2UoKSwgQyh0LCBuLCAhMCk7fSksIG4oQVNUX0NsYXNzRmllbGQsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzO2lmICh0LnN0YXRpYyAmJiAobi5wcmludCgic3RhdGljIiksIG4uc3BhY2UoKSksIEQodCwgbiksIHQudmFsdWUpIG4uc3BhY2UoKSwgbi5wcmludCgiPSIpLCBuLnNwYWNlKCksIHQudmFsdWUucHJpbnQobik7ZWxzZSBzd2l0Y2ggKHQua2V5KSB7Y2FzZSAiZ2V0IjpjYXNlICJzZXQiOmNhc2UgInN0YXRpYyI6cmV0dXJuIHZvaWQgbi5mb3JjZV9zZW1pY29sb24oKTt9bi5zZW1pY29sb24oKTt9KSwgbihBU1RfQ2xhc3NHZXR0ZXIsIGsoImdldCIpKSwgbihBU1RfQ2xhc3NTZXR0ZXIsIGsoInNldCIpKSwgbihBU1RfQ2xhc3NNZXRob2QsIGZ1bmN0aW9uIChuKSB7dGhpcy5zdGF0aWMgJiYgKG4ucHJpbnQoInN0YXRpYyIpLCBuLnNwYWNlKCkpLCB2KHRoaXMsIG4pO30pLCBuKEFTVF9DbGFzc0luaXQsIGZ1bmN0aW9uIChuKSB7bi5wcmludCgic3RhdGljIiksIG4uc3BhY2UoKSwgZih0aGlzLnZhbHVlLCBuKTt9KSwgbihBU1RfUmV0dXJuLCB5KCJyZXR1cm4iLCAidmFsdWUiKSksIG4oQVNUX1Rocm93LCB5KCJ0aHJvdyIsICJ2YWx1ZSIpKSwgbihBU1RfQnJlYWssIHkoImJyZWFrIiwgImxhYmVsIikpLCBuKEFTVF9Db250aW51ZSwgeSgiY29udGludWUiLCAibGFiZWwiKSksIG4oQVNUX0lmLCBmdW5jdGlvbiAobikge3ZhciB0ID0gdGhpcztuLnByaW50KCJpZiIpLCBuLnNwYWNlKCksIG4ud2l0aF9wYXJlbnMoZnVuY3Rpb24gKCkge3QuY29uZGl0aW9uLnByaW50KG4pO30pLCB0LmFsdGVybmF0aXZlID8gKGZ1bmN0aW9uIChuLCB0KSB7dmFyIGUgPSBuLmJvZHk7aWYgKHQub3B0aW9uKCJicmFjZXMiKSAmJiAhKGUgaW5zdGFuY2VvZiBBU1RfQ29uc3QgfHwgZSBpbnN0YW5jZW9mIEFTVF9MZXQpIHx8IHQub3B0aW9uKCJpZSIpICYmIGUgaW5zdGFuY2VvZiBBU1RfRG8pIHJldHVybiBCKGUsIHQpO2lmICghZSkgcmV0dXJuIHQuZm9yY2Vfc2VtaWNvbG9uKCk7Zm9yICg7OykgaWYgKGUgaW5zdGFuY2VvZiBBU1RfSWYpIHtpZiAoIWUuYWx0ZXJuYXRpdmUpIHJldHVybiBCKG4uYm9keSwgdCk7ZSA9IGUuYWx0ZXJuYXRpdmU7fSBlbHNlIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1N0YXRlbWVudFdpdGhCb2R5KSkgYnJlYWs7ZSA9IGUuYm9keTt9UChuLmJvZHksIHQpO30odCwgbiksIG4uc3BhY2UoKSwgbi5wcmludCgiZWxzZSIpLCB0LmFsdGVybmF0aXZlIGluc3RhbmNlb2YgQVNUX0lmID8gKG4uc3BhY2UoKSwgdC5hbHRlcm5hdGl2ZS5wcmludChuKSkgOiBQKHQuYWx0ZXJuYXRpdmUsIG4pKSA6IFAodC5ib2R5LCBuKTt9KSwgbihBU1RfU3dpdGNoLCBmdW5jdGlvbiAoZSkge3ZhciBuID0gdGhpcyxpID0gKGUucHJpbnQoInN3aXRjaCIpLCBlLnNwYWNlKCksIGUud2l0aF9wYXJlbnMoZnVuY3Rpb24gKCkge24uZXhwcmVzc2lvbi5wcmludChlKTt9KSwgZS5zcGFjZSgpLCBuLmJvZHkubGVuZ3RoIC0gMSk7aSA8IDAgPyB1KG4sIGUpIDogZS53aXRoX2Jsb2NrKGZ1bmN0aW9uICgpIHtuLmJvZHkuZm9yRWFjaChmdW5jdGlvbiAobiwgdCkge2UuaW5kZW50KCEwKSwgbi5wcmludChlKSwgdCA8IGkgJiYgMCA8IG4uYm9keS5sZW5ndGggJiYgZS5uZXdsaW5lKCk7fSk7fSwgbi5lbmQpO30pLCBuKEFTVF9EZWZhdWx0LCBmdW5jdGlvbiAobikge24ucHJpbnQoImRlZmF1bHQ6IiksIGcodGhpcywgbik7fSksIG4oQVNUX0Nhc2UsIGZ1bmN0aW9uIChuKSB7bi5wcmludCgiY2FzZSIpLCBuLnNwYWNlKCksIHRoaXMuZXhwcmVzc2lvbi5wcmludChuKSwgbi5wcmludCgiOiIpLCBnKHRoaXMsIG4pO30pLCBuKEFTVF9UcnksIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzO24ucHJpbnQoInRyeSIpLCBuLnNwYWNlKCksIGYodCwgbiksIHQuYmNhdGNoICYmIChuLnNwYWNlKCksIHQuYmNhdGNoLnByaW50KG4pKSwgdC5iZmluYWxseSAmJiAobi5zcGFjZSgpLCB0LmJmaW5hbGx5LnByaW50KG4pKTt9KSwgbihBU1RfQ2F0Y2gsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzO24ucHJpbnQoImNhdGNoIiksIHQuYXJnbmFtZSAmJiAobi5zcGFjZSgpLCBuLndpdGhfcGFyZW5zKGZ1bmN0aW9uICgpIHt0LmFyZ25hbWUucHJpbnQobik7fSkpLCBuLnNwYWNlKCksIGYodCwgbik7fSksIG4oQVNUX0ZpbmFsbHksIGZ1bmN0aW9uIChuKSB7bi5wcmludCgiZmluYWxseSIpLCBuLnNwYWNlKCksIGYodGhpcywgbik7fSksIG4oQVNUX0NvbnN0LCBiKCJjb25zdCIpKSwgbihBU1RfTGV0LCBiKCJsZXQiKSksIG4oQVNUX1ZhciwgYigidmFyIikpLCBuKEFTVF9WYXJEZWYsIGZ1bmN0aW9uIChuKSB7dmFyIHQ7dGhpcy5uYW1lLnByaW50KG4pLCB0aGlzLnZhbHVlICYmIChuLnNwYWNlKCksIG4ucHJpbnQoIj0iKSwgbi5zcGFjZSgpLCB0ID0gKHQgPSBuLnBhcmVudCgxKSkgaW5zdGFuY2VvZiBBU1RfRm9yIHx8IHQgaW5zdGFuY2VvZiBBU1RfRm9yRW51bWVyYXRpb24sIHcodGhpcy52YWx1ZSwgbiwgdCkpO30pLCBuKEFTVF9EZWZhdWx0VmFsdWUsIGZ1bmN0aW9uIChuKSB7dGhpcy5uYW1lLnByaW50KG4pLCBuLnNwYWNlKCksIG4ucHJpbnQoIj0iKSwgbi5zcGFjZSgpLCB0aGlzLnZhbHVlLnByaW50KG4pO30pLCBuKEFTVF9DYWxsLCBmdW5jdGlvbiAobikge3godGhpcywgbiksIHRoaXMuZXhwcmVzc2lvbi5wcmludChuKSwgdGhpcy5vcHRpb25hbCAmJiBuLnByaW50KCI/LiIpLCBFKHRoaXMsIG4pO30pLCBuKEFTVF9OZXcsIGZ1bmN0aW9uIChuKSB7eCh0aGlzLCBuKSwgbi5wcmludCgibmV3IiksIG4uc3BhY2UoKSwgdGhpcy5leHByZXNzaW9uLnByaW50KG4pLCBGKHRoaXMsIG4pICYmIEUodGhpcywgbik7fSksIG4oQVNUX1NlcXVlbmNlLCBmdW5jdGlvbiAoZSkge3RoaXMuZXhwcmVzc2lvbnMuZm9yRWFjaChmdW5jdGlvbiAobiwgdCkgezAgPCB0ICYmIChlLmNvbW1hKCksIGUuc2hvdWxkX2JyZWFrKCkpICYmIChlLm5ld2xpbmUoKSwgZS5pbmRlbnQoKSksIG4ucHJpbnQoZSk7fSk7fSksIG4oQVNUX0RvdCwgZnVuY3Rpb24gKG4pIHt2YXIgdCA9IHRoaXMsZSA9IHQuZXhwcmVzc2lvbixpID0gKGUucHJpbnQobiksIHQucHJvcGVydHkpO24ub3B0aW9uKCJpZSIpICYmIFJFU0VSVkVEX1dPUkRTW2ldIHx8IHQucXVvdGVkICYmIG4ub3B0aW9uKCJrZWVwX3F1b3RlZF9wcm9wcyIpID8gKHQub3B0aW9uYWwgJiYgbi5wcmludCgiPy4iKSwgbi53aXRoX3NxdWFyZShmdW5jdGlvbiAoKSB7bi5hZGRfbWFwcGluZyh0LmVuZCksIG4ucHJpbnRfc3RyaW5nKGkpO30pKSA6IChlIGluc3RhbmNlb2YgQVNUX051bWJlciAmJiAhL1tleC4pXS9pLnRlc3Qobi5sYXN0KCkpICYmIG4ucHJpbnQoIi4iKSwgbi5wcmludCh0Lm9wdGlvbmFsID8gIj8uIiA6ICIuIiksIG4uYWRkX21hcHBpbmcodC5lbmQpLCBuLnByaW50X25hbWUoaSkpO30pLCBuKEFTVF9TdWIsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzO3QuZXhwcmVzc2lvbi5wcmludChuKSwgdC5vcHRpb25hbCAmJiBuLnByaW50KCI/LiIpLCBuLndpdGhfc3F1YXJlKGZ1bmN0aW9uICgpIHt0LnByb3BlcnR5LnByaW50KG4pO30pO30pLCBuKEFTVF9TcHJlYWQsIGZ1bmN0aW9uIChuKSB7bi5wcmludCgiLi4uIiksIHRoaXMuZXhwcmVzc2lvbi5wcmludChuKTt9KSwgbihBU1RfVW5hcnlQcmVmaXgsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzLm9wZXJhdG9yLGUgPSB0aGlzLmV4cHJlc3Npb247bi5wcmludCh0KSwgKC9eW2Etel0vaS50ZXN0KHQpIHx8IC9bKy1dJC8udGVzdCh0KSAmJiBlIGluc3RhbmNlb2YgQVNUX1VuYXJ5UHJlZml4ICYmIC9eWystXS8udGVzdChlLm9wZXJhdG9yKSkgJiYgbi5zcGFjZSgpLCBlLnByaW50KG4pO30pLCBuKEFTVF9VbmFyeVBvc3RmaXgsIGZ1bmN0aW9uIChuKSB7dGhpcy5leHByZXNzaW9uLnByaW50KG4pLCBuLmFkZF9tYXBwaW5nKHRoaXMuZW5kKSwgbi5wcmludCh0aGlzLm9wZXJhdG9yKTt9KSwgbihBU1RfQmluYXJ5LCBmdW5jdGlvbiAobikge3RoaXMubGVmdC5wcmludChuKSwgbi5zcGFjZSgpLCBuLnByaW50KHRoaXMub3BlcmF0b3IpLCBuLnNwYWNlKCksIHRoaXMucmlnaHQucHJpbnQobik7fSksIG4oQVNUX0NvbmRpdGlvbmFsLCBmdW5jdGlvbiAobikge3RoaXMuY29uZGl0aW9uLnByaW50KG4pLCBuLnNwYWNlKCksIG4ucHJpbnQoIj8iKSwgbi5zcGFjZSgpLCB0aGlzLmNvbnNlcXVlbnQucHJpbnQobiksIG4uc3BhY2UoKSwgbi5jb2xvbigpLCB0aGlzLmFsdGVybmF0aXZlLnByaW50KG4pO30pLCBuKEFTVF9Bd2FpdCwgZnVuY3Rpb24gKG4pIHtuLnByaW50KCJhd2FpdCIpLCBuLnNwYWNlKCksIHRoaXMuZXhwcmVzc2lvbi5wcmludChuKTt9KSwgbihBU1RfWWllbGQsIGZ1bmN0aW9uIChuKSB7bi5wcmludCh0aGlzLm5lc3RlZCA/ICJ5aWVsZCoiIDogInlpZWxkIiksIHRoaXMuZXhwcmVzc2lvbiAmJiAobi5zcGFjZSgpLCB0aGlzLmV4cHJlc3Npb24ucHJpbnQobikpO30pLCBuKEFTVF9BcnJheSwgZnVuY3Rpb24gKGUpIHt2YXIgbiA9IHRoaXMuZWxlbWVudHMsaSA9IG4ubGVuZ3RoO2Uud2l0aF9zcXVhcmUoMCA8IGkgPyBmdW5jdGlvbiAoKSB7ZS5zcGFjZSgpLCBuLmZvckVhY2goZnVuY3Rpb24gKG4sIHQpIHt0ICYmIGUuY29tbWEoKSwgbi5wcmludChlKSwgdCA9PT0gaSAtIDEgJiYgbiBpbnN0YW5jZW9mIEFTVF9Ib2xlICYmIGUuY29tbWEoKTt9KSwgZS5zcGFjZSgpO30gOiBub29wKTt9KSwgbihBU1RfRGVzdHJ1Y3R1cmVkQXJyYXksIGZ1bmN0aW9uIChlKSB7dmFyIG4gPSB0aGlzLmVsZW1lbnRzLHQgPSBuLmxlbmd0aCxpID0gdGhpcy5yZXN0O2Uud2l0aF9zcXVhcmUodCB8fCBpID8gZnVuY3Rpb24gKCkge2Uuc3BhY2UoKSwgbi5mb3JFYWNoKGZ1bmN0aW9uIChuLCB0KSB7dCAmJiBlLmNvbW1hKCksIG4ucHJpbnQoZSk7fSksIGkgPyAodCAmJiBlLmNvbW1hKCksIGUucHJpbnQoIi4uLiIpLCBpLnByaW50KGUpKSA6IG5bdCAtIDFdIGluc3RhbmNlb2YgQVNUX0hvbGUgJiYgZS5jb21tYSgpLCBlLnNwYWNlKCk7fSA6IG5vb3ApO30pLCBuKEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSBEKHRoaXMsIG4pLGUgPSB0aGlzLnZhbHVlO2lmICh0KSBpZiAoZSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUpIHtpZiAoZS5uYW1lIGluc3RhbmNlb2YgQVNUX1N5bWJvbCAmJiB0ID09IE8oZS5uYW1lKSkgcmV0dXJuIG4uc3BhY2UoKSwgbi5wcmludCgiPSIpLCBuLnNwYWNlKCksIHZvaWQgZS52YWx1ZS5wcmludChuKTt9IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sICYmIHQgPT0gTyhlKSkgcmV0dXJuO24uY29sb24oKSwgZS5wcmludChuKTt9KSwgbihBU1RfRGVzdHJ1Y3R1cmVkT2JqZWN0LCBmdW5jdGlvbiAoZSkge3ZhciBuID0gdGhpcy5wcm9wZXJ0aWVzLHQgPSBuLmxlbmd0aCxpID0gdGhpcy5yZXN0O3QgfHwgaSA/IGUud2l0aF9ibG9jayhmdW5jdGlvbiAoKSB7bi5mb3JFYWNoKGZ1bmN0aW9uIChuLCB0KSB7dCAmJiAoZS5wcmludCgiLCIpLCBlLm5ld2xpbmUoKSksIGUuaW5kZW50KCksIG4ucHJpbnQoZSk7fSksIGkgJiYgKHQgJiYgKGUucHJpbnQoIiwiKSwgZS5uZXdsaW5lKCkpLCBlLmluZGVudCgpLCBlLnByaW50KCIuLi4iKSwgaS5wcmludChlKSksIGUubmV3bGluZSgpO30sIHRoaXMuZW5kKSA6IHUodGhpcywgZSk7fSksIG4oQVNUX09iamVjdCwgZnVuY3Rpb24gKG4pIHtDKHRoaXMsIG4pO30pLCBuKEFTVF9PYmplY3RLZXlWYWwsIGZ1bmN0aW9uIChuKSB7RCh0aGlzLCBuKSwgbi5jb2xvbigpLCB0aGlzLnZhbHVlLnByaW50KG4pO30pLCBuKEFTVF9PYmplY3RNZXRob2QsIGZ1bmN0aW9uIChuKSB7dih0aGlzLCBuKTt9KSwgbihBU1RfT2JqZWN0R2V0dGVyLCBrKCJnZXQiKSksIG4oQVNUX09iamVjdFNldHRlciwgaygic2V0IikpLCBuKEFTVF9TeW1ib2wsIGZ1bmN0aW9uIChuKSB7bi5wcmludF9uYW1lKE8odGhpcykpO30pLCBuKEFTVF9TeW1ib2xFeHBvcnQsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSBPKHRoaXMpLGUgPSAobi5wcmludF9uYW1lKHQpLCB0aGlzLmFsaWFzKTtlLnZhbHVlICE9IHQgJiYgKG4uc3BhY2UoKSwgbi5wcmludCgiYXMiKSwgbi5zcGFjZSgpLCBsKGUsIG4pKTt9KSwgbihBU1RfU3ltYm9sSW1wb3J0LCBmdW5jdGlvbiAobikge3ZhciB0ID0gTyh0aGlzKSxlID0gdGhpcy5rZXk7ZS52YWx1ZSAmJiBlLnZhbHVlICE9IHQgJiYgKGwoZSwgbiksIG4uc3BhY2UoKSwgbi5wcmludCgiYXMiKSwgbi5zcGFjZSgpKSwgbi5wcmludF9uYW1lKHQpO30pLCBuKEFTVF9Ib2xlLCBub29wKSwgbihBU1RfVGVtcGxhdGUsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzO3QudGFnICYmIHQudGFnLnByaW50KG4pLCBuLnByaW50KCJgIik7Zm9yICh2YXIgZSA9IDA7IGUgPCB0LmV4cHJlc3Npb25zLmxlbmd0aDsgZSsrKSBuLnByaW50KHQuc3RyaW5nc1tlXSksIG4ucHJpbnQoIiR7IiksIHQuZXhwcmVzc2lvbnNbZV0ucHJpbnQobiksIG4ucHJpbnQoIn0iKTtuLnByaW50KHQuc3RyaW5nc1tlXSksIG4ucHJpbnQoImAiKTt9KSwgbihBU1RfQmlnSW50LCBmdW5jdGlvbiAobikge24ucHJpbnQodGhpcy52YWx1ZSArICJuIik7fSksIG4oQVNUX0NvbnN0YW50LCBmdW5jdGlvbiAobikge24ucHJpbnQoIiIgKyB0aGlzLnZhbHVlKTt9KSwgbihBU1RfU3RyaW5nLCBmdW5jdGlvbiAobikge24ucHJpbnRfc3RyaW5nKHRoaXMudmFsdWUsIHRoaXMucXVvdGUpO30pLCBuKEFTVF9OdW1iZXIsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzLnN0YXJ0O3MgJiYgdCAmJiBudWxsICE9IHQucmF3ID8gbi5wcmludCh0LnJhdykgOiBuLnByaW50KHEodGhpcy52YWx1ZSkpO30pLCBuKEFTVF9SZWdFeHAsIGZ1bmN0aW9uIChuKSB7dmFyIHQgPSB0aGlzLnZhbHVlLGUgPSB0LnRvU3RyaW5nKCksaSA9IGUubGFzdEluZGV4T2YoIi8iKTt0LnJhd19zb3VyY2UgPyBlID0gIi8iICsgdC5yYXdfc291cmNlICsgZS5zbGljZShpKSA6IDEgPT0gaSA/IGUgPSAiLyg/OikiICsgZS5zbGljZShpKSA6IGUuaW5kZXhPZigiLyIsIDEpIDwgaSAmJiAoZSA9ICIvIiArIGUuc2xpY2UoMSwgaSkucmVwbGFjZSgvXFxcXHxbXi9dP1wvL2csIGZ1bmN0aW9uIChuKSB7cmV0dXJuICJcXCIgPT0gblswXSA/IG4gOiBuLnNsaWNlKDAsIC0xKSArICJcXC8iO30pICsgZS5zbGljZShpKSksIG4ucHJpbnQobi50b191dGY4KGUpLnJlcGxhY2UoL1xcKD86XDAoPyFbMC05XSl8W15cMF0pL2csIGZ1bmN0aW9uIChuKSB7c3dpdGNoIChuWzFdKSB7Y2FzZSAiXG4iOnJldHVybiAiXFxuIjtjYXNlICJcciI6cmV0dXJuICJcXHIiO2Nhc2UgIlx0IjpyZXR1cm4gIlx0IjtjYXNlICJcYiI6cmV0dXJuICJcYiI7Y2FzZSAiXGYiOnJldHVybiAiXGYiO2Nhc2UgIlwwIjpyZXR1cm4gIlwwIjtjYXNlICJcdiI6cmV0dXJuICJcdiI7Y2FzZSAiXHUyMDI4IjpyZXR1cm4gIlxcdTIwMjgiO2Nhc2UgIlx1MjAyOSI6cmV0dXJuICJcXHUyMDI5IjtkZWZhdWx0OnJldHVybiBuO319KS5yZXBsYWNlKC9bXG5cclx1MjAyOFx1MjAyOV0vZywgZnVuY3Rpb24gKG4pIHtzd2l0Y2ggKG4pIHtjYXNlICJcbiI6cmV0dXJuICJcXG4iO2Nhc2UgIlxyIjpyZXR1cm4gIlxcciI7Y2FzZSAiXHUyMDI4IjpyZXR1cm4gIlxcdTIwMjgiO2Nhc2UgIlx1MjAyOSI6cmV0dXJuICJcXHUyMDI5Ijt9fSkpO30pLCBOKFtBU1RfTm9kZSwgQVNUX0xhYmVsZWRTdGF0ZW1lbnRdLCBub29wKSwgTihbQVNUX0FycmF5LCBBU1RfQXdhaXQsIEFTVF9CbG9ja1N0YXRlbWVudCwgQVNUX0NhdGNoLCBBU1RfQ29uc3RhbnQsIEFTVF9EZWJ1Z2dlciwgQVNUX0RlZmluaXRpb25zLCBBU1RfRGVzdHJ1Y3R1cmVkLCBBU1RfRGlyZWN0aXZlLCBBU1RfRmluYWxseSwgQVNUX0p1bXAsIEFTVF9MYW1iZGEsIEFTVF9OZXcsIEFTVF9PYmplY3QsIEFTVF9TcHJlYWQsIEFTVF9TdGF0ZW1lbnRXaXRoQm9keSwgQVNUX1N5bWJvbCwgQVNUX1N3aXRjaCwgQVNUX1N3aXRjaEJyYW5jaCwgQVNUX1RyeSwgQVNUX1VuYXJ5UHJlZml4LCBBU1RfWWllbGRdLCBmdW5jdGlvbiAobikge24uYWRkX21hcHBpbmcodGhpcy5zdGFydCk7fSksIE4oW0FTVF9DbGFzc1Byb3BlcnR5LCBBU1RfRGVzdHJ1Y3R1cmVkS2V5VmFsLCBBU1RfT2JqZWN0UHJvcGVydHldLCBmdW5jdGlvbiAobikgeyJzdHJpbmciID09IHR5cGVvZiB0aGlzLmtleSAmJiBuLmFkZF9tYXBwaW5nKHRoaXMuc3RhcnQsIHRoaXMua2V5KTt9KTt9KCk7CgogIC8vIGNvbXByZXNzLmpzCiAgLy8gcHJldHRpZXItaWdub3JlCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCiAgInVzZSBzdHJpY3QiO2Z1bmN0aW9uIENvbXByZXNzb3IoZSwgbikge2lmICghKHRoaXMgaW5zdGFuY2VvZiBDb21wcmVzc29yKSkgcmV0dXJuIG5ldyBDb21wcmVzc29yKGUsIG4pO1RyZWVUcmFuc2Zvcm1lci5jYWxsKHRoaXMsIHRoaXMuYmVmb3JlLCB0aGlzLmFmdGVyKSwgdGhpcy5vcHRpb25zID0gZGVmYXVsdHMoZSwgeyBhbm5vdGF0aW9uczogIW4sIGFyZ3VtZW50czogIW4sIGFycm93czogIW4sIGFzc2lnbm1lbnRzOiAhbiwgYXdhaXRzOiAhbiwgYm9vbGVhbnM6ICFuLCBjb2xsYXBzZV92YXJzOiAhbiwgY29tcGFyaXNvbnM6ICFuLCBjb25kaXRpb25hbHM6ICFuLCBkZWFkX2NvZGU6ICFuLCBkZWZhdWx0X3ZhbHVlczogIW4sIGRpcmVjdGl2ZXM6ICFuLCBkcm9wX2NvbnNvbGU6ICExLCBkcm9wX2RlYnVnZ2VyOiAhbiwgZXZhbHVhdGU6ICFuLCBleHByZXNzaW9uOiAhMSwgZnVuY3Rpb25zOiAhbiwgZ2xvYmFsX2RlZnM6ICExLCBob2lzdF9leHBvcnRzOiAhbiwgaG9pc3RfZnVuczogITEsIGhvaXN0X3Byb3BzOiAhbiwgaG9pc3RfdmFyczogITEsIGllOiAhMSwgaWZfcmV0dXJuOiAhbiwgaW1wb3J0czogIW4sIGlubGluZTogIW4sIGpvaW5fdmFyczogIW4sIGtlZXBfZmFyZ3M6IG4sIGtlZXBfZm5hbWVzOiAhMSwga2VlcF9pbmZpbml0eTogITEsIGxvb3BzOiAhbiwgbWVyZ2VfdmFyczogIW4sIG1vZHVsZTogITEsIG5lZ2F0ZV9paWZlOiAhbiwgb2JqZWN0czogIW4sIG9wdGlvbmFsX2NoYWluczogIW4sIHBhc3NlczogMSwgcHJvcGVydGllczogIW4sIHB1cmVfZnVuY3M6IG51bGwsIHB1cmVfZ2V0dGVyczogIW4gJiYgInN0cmljdCIsIHJlZHVjZV9mdW5jczogIW4sIHJlZHVjZV92YXJzOiAhbiwgcmVzdHM6ICFuLCBzZXF1ZW5jZXM6ICFuLCBzaWRlX2VmZmVjdHM6ICFuLCBzcHJlYWRzOiAhbiwgc3RyaW5nczogIW4sIHN3aXRjaGVzOiAhbiwgdGVtcGxhdGVzOiAhbiwgdG9wX3JldGFpbjogbnVsbCwgdG9wbGV2ZWw6ICEoIWUgfHwgZS5leHByZXNzaW9uIHx8ICFlLnRvcF9yZXRhaW4pLCB0eXBlb2ZzOiAhbiwgdW5zYWZlOiAhMSwgdW5zYWZlX2NvbXBzOiAhMSwgdW5zYWZlX0Z1bmN0aW9uOiAhMSwgdW5zYWZlX21hdGg6ICExLCB1bnNhZmVfcHJvdG86ICExLCB1bnNhZmVfcmVnZXhwOiAhMSwgdW5zYWZlX3VuZGVmaW5lZDogITEsIHVudXNlZDogIW4sIHZhcmlmeTogIW4sIHdlYmtpdDogITEsIHlpZWxkczogIW4gfSwgITApO3ZhciBlID0gdGhpcy5vcHRpb25zLmV2YWx1YXRlLHQgPSAodGhpcy5ldmFsX3RocmVzaG9sZCA9IC9lYWdlci8udGVzdChlKSA/IDEgLyAwIDogK2UsIHRoaXMub3B0aW9ucy5nbG9iYWxfZGVmcyk7aWYgKCJvYmplY3QiID09IHR5cGVvZiB0KSBmb3IgKHZhciBpIGluIHQpIC9eQC8udGVzdChpKSAmJiBIT1AodCwgaSkgJiYgKHRbaS5zbGljZSgxKV0gPSBwYXJzZSh0W2ldLCB7IGV4cHJlc3Npb246ICEwIH0pKTshMCA9PT0gdGhpcy5vcHRpb25zLmlubGluZSAmJiAodGhpcy5vcHRpb25zLmlubGluZSA9IDQpLCB0aGlzLmRyb3BfZmFyZ3MgPSB0aGlzLm9wdGlvbnMua2VlcF9mYXJncyA/IHJldHVybl9mYWxzZSA6IGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQ7cmV0dXJuICFlLmxlbmd0aF9yZWFkICYmICgodCA9IGUubmFtZSkgPyB0LmZpeGVkX3ZhbHVlKCkgPT09IGUgJiYgISh0ID0gdC5kZWZpbml0aW9uKCkpLmRpcmVjdF9hY2Nlc3MgJiYgKHQgPSB0LmVzY2FwZWQpICYmIDEgIT0gdC5kZXB0aCA6IG4gJiYgIkNhbGwiID09IG4uVFlQRSAmJiBuLmV4cHJlc3Npb24gPT09IGUpO30sIHRoaXMub3B0aW9ucy5tb2R1bGUgJiYgKHRoaXMuZGlyZWN0aXZlc1sidXNlIHN0cmljdCJdID0gITApO3ZhciByID0gdGhpcy5vcHRpb25zLnB1cmVfZnVuY3MsbiA9ICgiZnVuY3Rpb24iID09IHR5cGVvZiByID8gdGhpcy5wdXJlX2Z1bmNzID0gciA6ICJzdHJpbmciID09IHR5cGVvZiByID8gdGhpcy5wdXJlX2Z1bmNzID0gZnVuY3Rpb24gKGUpIHt2YXIgbjtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9DYWxsID8gbiA9IGUuZXhwcmVzc2lvbiA6IGUgaW5zdGFuY2VvZiBBU1RfVGVtcGxhdGUgJiYgKG4gPSBlLnRhZyksICEobiAmJiByID09PSBuLnByaW50X3RvX3N0cmluZygpKTt9IDogQXJyYXkuaXNBcnJheShyKSA/IHRoaXMucHVyZV9mdW5jcyA9IGZ1bmN0aW9uIChlKSB7dmFyIG47cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfQ2FsbCA/IG4gPSBlLmV4cHJlc3Npb24gOiBlIGluc3RhbmNlb2YgQVNUX1RlbXBsYXRlICYmIChuID0gZS50YWcpLCAhKG4gJiYgbWVtYmVyKG4ucHJpbnRfdG9fc3RyaW5nKCksIHIpKTt9IDogdGhpcy5wdXJlX2Z1bmNzID0gcmV0dXJuX3RydWUsIHRoaXMub3B0aW9ucy5zZXF1ZW5jZXMpLG8gPSAodGhpcy5zZXF1ZW5jZXNfbGltaXQgPSAxID09IG4gPyA4MDAgOiAwIHwgbiwgdGhpcy5vcHRpb25zLnRvcF9yZXRhaW4pLGUgPSAobyBpbnN0YW5jZW9mIFJlZ0V4cCA/IHRoaXMudG9wX3JldGFpbiA9IGZ1bmN0aW9uIChlKSB7cmV0dXJuIG8udGVzdChlLm5hbWUpO30gOiAiZnVuY3Rpb24iID09IHR5cGVvZiBvID8gdGhpcy50b3BfcmV0YWluID0gbyA6IG8gJiYgKCJzdHJpbmciID09IHR5cGVvZiBvICYmIChvID0gby5zcGxpdCgvLC8pKSwgdGhpcy50b3BfcmV0YWluID0gZnVuY3Rpb24gKGUpIHtyZXR1cm4gbWVtYmVyKGUubmFtZSwgbyk7fSksIHRoaXMub3B0aW9ucy50b3BsZXZlbCk7dGhpcy50b3BsZXZlbCA9ICJzdHJpbmciID09IHR5cGVvZiBlID8geyBmdW5jczogL2Z1bmNzLy50ZXN0KGUpLCB2YXJzOiAvdmFycy8udGVzdChlKSB9IDogeyBmdW5jczogZSwgdmFyczogZSB9O31Db21wcmVzc29yLnByb3RvdHlwZSA9IG5ldyBUcmVlVHJhbnNmb3JtZXIoZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCwgaTtyZXR1cm4gZS5fc3F1ZWV6ZWQgPyBlIDogKCh0ID0gZSBpbnN0YW5jZW9mIEFTVF9TY29wZSkgJiYgKHRoaXMub3B0aW9uKCJhcnJvd3MiKSAmJiBpc19hcnJvdyhlKSAmJiBlLnZhbHVlICYmIChlLmJvZHkgPSBbZS5maXJzdF9zdGF0ZW1lbnQoKV0sIGUudmFsdWUgPSBudWxsKSwgZS5ob2lzdF9wcm9wZXJ0aWVzKHRoaXMpLCBlLmhvaXN0X2RlY2xhcmF0aW9ucyh0aGlzKSwgZS5wcm9jZXNzX3JldHVybnModGhpcykpLCBuKGUsIHRoaXMpLCBuKGUsIHRoaXMpLCBpID0gZS5vcHRpbWl6ZSh0aGlzKSwgIXQgfHwgaSAhPT0gZSB8fCB0aGlzLmhhc19kaXJlY3RpdmUoInVzZSBhc20iKSB8fCBpLnBpbm5lZCgpIHx8IChpLmRyb3BfdW51c2VkKHRoaXMpLCBpLm1lcmdlX3ZhcmlhYmxlcyh0aGlzKSAmJiBpLmRyb3BfdW51c2VkKHRoaXMpLCBuKGksIHRoaXMpKSwgaSA9PT0gZSAmJiAoaS5fc3F1ZWV6ZWQgPSAhMCksIGkpO30pLCBDb21wcmVzc29yLnByb3RvdHlwZS5vcHRpb24gPSBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLm9wdGlvbnNbZV07fSwgQ29tcHJlc3Nvci5wcm90b3R5cGUuZXhwb3NlZCA9IGZ1bmN0aW9uIChlKSB7dmFyIG47cmV0dXJuICEhZS5leHBvcnRlZCB8fCAhIWUudW5kZWNsYXJlZCB8fCAhIShlLmdsb2JhbCB8fCBlLnNjb3BlLnJlc29sdmUoKSBpbnN0YW5jZW9mIEFTVF9Ub3BsZXZlbCkgJiYgKG4gPSB0aGlzLnRvcGxldmVsLCAhYWxsKGUub3JpZywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gbltlIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlZnVuID8gImZ1bmNzIiA6ICJ2YXJzIl07fSkpO30sIENvbXByZXNzb3IucHJvdG90eXBlLmNvbXByZXNzID0gZnVuY3Rpb24gKGUpIHsoZSA9IGUucmVzb2x2ZV9kZWZpbmVzKHRoaXMpKS5ob2lzdF9leHBvcnRzKHRoaXMpLCB0aGlzLm9wdGlvbigiZXhwcmVzc2lvbiIpICYmIGUucHJvY2Vzc19leHByZXNzaW9uKCEwKTtmb3IgKHZhciBuID0gdGhpcy5vcHRpb25zLm1lcmdlX3ZhcnMsIHQgPSArdGhpcy5vcHRpb25zLnBhc3NlcyB8fCAxLCBpID0gMSAvIDAsIHIgPSAhMSwgbyA9IHsgaWU6IHRoaXMub3B0aW9uKCJpZSIpIH0sIGEgPSAwOyBhIDwgdDsgYSsrKSBpZiAoZS5maWd1cmVfb3V0X3Njb3BlKG8pLCAoMCA8IGEgfHwgdGhpcy5vcHRpb24oInJlZHVjZV92YXJzIikpICYmIGUucmVzZXRfb3B0X2ZsYWdzKHRoaXMpLCB0aGlzLm9wdGlvbnMubWVyZ2VfdmFycyA9IG4gJiYgKHIgfHwgYSA9PSB0IC0gMSksIGUgPSBlLnRyYW5zZm9ybSh0aGlzKSwgMSA8IHQpIHt2YXIgcyA9IDA7aWYgKGUud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoKSB7cysrO30pKSwgQVNUX05vZGUuaW5mbygicGFzcyB7cGFzc306IGxhc3RfY291bnQ6IHttaW5fY291bnR9LCBjb3VudDoge2NvdW50fSIsIHsgcGFzczogYSwgbWluX2NvdW50OiBpLCBjb3VudDogcyB9KSwgcyA8IGkpIGkgPSBzLCByID0gITE7ZWxzZSB7aWYgKHIpIGJyZWFrO3IgPSAhMDt9fXJldHVybiB0aGlzLm9wdGlvbigiZXhwcmVzc2lvbiIpICYmIGUucHJvY2Vzc19leHByZXNzaW9uKCExKSwgZTt9LCBmdW5jdGlvbiAoZSkge2Z1bmN0aW9uIHUoZSwgbikge3ZhciB0LGkgPSBuLmdldF9wcm9wZXJ0eSgpO2lmICghKGkgaW5zdGFuY2VvZiBBU1RfTm9kZSkpIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9BcnJheSkge24gPSBlLmVsZW1lbnRzO2lmICgibGVuZ3RoIiA9PSBpKSByZXR1cm4gWihuLmxlbmd0aCwgZSk7Im51bWJlciIgPT0gdHlwZW9mIGkgJiYgaSBpbiBuICYmICh0ID0gbltpXSk7fSBlbHNlIGlmIChlIGluc3RhbmNlb2YgQVNUX0xhbWJkYSkge2lmICgibGVuZ3RoIiA9PSBpKSByZXR1cm4gZS5sZW5ndGhfcmVhZCA9ICEwLCBaKGUuYXJnbmFtZXMubGVuZ3RoLCBlKTt9IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBBU1RfT2JqZWN0KSBmb3IgKHZhciBpID0gIiIgKyBpLCByID0gZS5wcm9wZXJ0aWVzLCBvID0gci5sZW5ndGg7IDAgPD0gLS1vOykge2lmICghc3QocltvXSkpIHJldHVybjt0IHx8IHJbb10ua2V5ICE9PSBpIHx8ICh0ID0gcltvXS52YWx1ZSk7fXJldHVybiB0IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiB0LmZpeGVkX3ZhbHVlKCkgfHwgdDt9fWZ1bmN0aW9uIHllKGUsIG4sIHQsIGksIHIsIG8sIGEpIHt2YXIgcyA9IG4ucGFyZW50KHIpO2lmICghKGUub3B0aW9uKCJ1bnNhZmUiKSAmJiBzIGluc3RhbmNlb2YgQVNUX0RvdCAmJiAoZiA9IGksIGwgPSBzLnByb3BlcnR5LCBmIGluc3RhbmNlb2YgQVNUX0Jvb2xlYW4gPyBULkJvb2xlYW5bbF0gOiBmIGluc3RhbmNlb2YgQVNUX051bWJlciA/IFQuTnVtYmVyW2xdIDogZiBpbnN0YW5jZW9mIEFTVF9TdHJpbmcgPyBULlN0cmluZ1tsXSA6ICJ2YWx1ZU9mIiAhPSBsICYmIChmIGluc3RhbmNlb2YgQVNUX0FycmF5ID8gVC5BcnJheVtsXSA6IGYgaW5zdGFuY2VvZiBBU1RfTGFtYmRhID8gVC5GdW5jdGlvbltsXSA6IGYgaW5zdGFuY2VvZiBBU1RfT2JqZWN0ID8gVC5PYmplY3RbbF0gOiBmIGluc3RhbmNlb2YgQVNUX1JlZ0V4cCAmJiBULlJlZ0V4cFtsXSAmJiAhZi52YWx1ZS5nbG9iYWwpKSkpIHt2YXIgZixjLGwgPSBpc19saHModCwgcyk7aWYgKGwpIHJldHVybiBsO2lmICgwICE9IHIgfHwgIWkgfHwgIWkuaXNfY29uc3RhbnQoKSkge2lmIChzIGluc3RhbmNlb2YgQVNUX0FycmF5KSByZXR1cm4geWUoZSwgbiwgcywgcywgciArIDEpO2lmIChzIGluc3RhbmNlb2YgQVNUX0Fzc2lnbikgc3dpdGNoIChzLm9wZXJhdG9yKSB7Y2FzZSAiPSI6cmV0dXJuIHllKGUsIG4sIHMsIGksIHIgKyAxLCBvLCBhKTtjYXNlICImJj0iOmNhc2UgInx8PSI6Y2FzZSAiPz89IjpyZXR1cm4geWUoZSwgbiwgcywgcywgciArIDEpO2RlZmF1bHQ6cmV0dXJuO31yZXR1cm4gcyBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgPyBOZVtzLm9wZXJhdG9yXSA/IHllKGUsIG4sIHMsIHMsIHIgKyAxKSA6IHZvaWQgMCA6IHMgaW5zdGFuY2VvZiBBU1RfQ2FsbCA/ICFvICYmIHMuZXhwcmVzc2lvbiA9PT0gdCAmJiAhcy5pc19leHByX3B1cmUoZSkgJiYgKCEoaSBpbnN0YW5jZW9mIEFTVF9MYW1iZGFFeHByZXNzaW9uKSB8fCAhKHMgaW5zdGFuY2VvZiBBU1RfTmV3KSAmJiBpLmNvbnRhaW5zX3RoaXMoKSkgOiBzIGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsID8gcy5jb25kaXRpb24gPT09IHQgPyB2b2lkIDAgOiB5ZShlLCBuLCBzLCBzLCByICsgMSkgOiBzIGluc3RhbmNlb2YgQVNUX0ZvckVudW1lcmF0aW9uID8gcy5pbml0ID09PSB0IDogcyBpbnN0YW5jZW9mIEFTVF9PYmplY3RLZXlWYWwgPyBzLnZhbHVlICE9PSB0ID8gdm9pZCAwIDogKGYgPSBuLnBhcmVudChyICsgMSksIHllKGUsIG4sIGYsIGYsIHIgKyAyKSkgOiBzIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgPyBzLmV4cHJlc3Npb24gIT09IHQgPyB2b2lkIDAgOiAoYyA9IHUoaSwgcyksICghbyB8fCBhKSAmJiB5ZShlLCBuLCBzLCBjLCByICsgMSkpIDogcyBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSAmJiBzLnRhaWxfbm9kZSgpID09PSB0ID8geWUoZSwgbiwgcywgaSwgciArIDEsIG8sIGEpIDogdm9pZCAwO319fWZ1bmN0aW9uIHcoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0NsYXNzIHx8IGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhO31mdW5jdGlvbiBSZShlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfQ2xhc3MgfHwgZSBpbnN0YW5jZW9mIEFTVF9EZWZ1biB8fCBlIGluc3RhbmNlb2YgQVNUX0Z1bmN0aW9uO31mdW5jdGlvbiBnZShlKSB7cmV0dXJuICJhcmd1bWVudHMiID09IGUubmFtZSAmJiBlLnNjb3BlLnVzZXNfYXJndW1lbnRzO31mdW5jdGlvbiBiKGUsIG4pIHtkbyB7aWYgKGUgPT09IG4pIHJldHVybjtpZiAobiBpbnN0YW5jZW9mIEFTVF9TY29wZSkgcmV0dXJuIDE7fSB3aGlsZSAobiA9IG4ucGFyZW50X3Njb3BlKTt9ZnVuY3Rpb24gYmUoZSwgbiwgdCkge3ZhciBpID0gZS5yZWRlZiB8fCBlLmRlZmluaXRpb24oKTtyZXR1cm4gKCFlLmluX2FyZyB8fCAhaXNfZnVuYXJnKGkpKSAmJiBhbGwoaS5vcmlnLCBmdW5jdGlvbiAoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbENvbnN0IHx8IGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sTGV0ID8gZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xJbXBvcnQgfHwgbiAmJiBxbihuLCBlKSA6ICEodCAmJiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbExhbWJkYSk7fSk7fWZ1bmN0aW9uIE9lKGUsIG4sIHQsIGkpIHtyZXR1cm4gaSBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gPyAiPSIgPT0gaS5vcGVyYXRvciAmJiBpLnJpZ2h0ID09PSB0IDogaSBpbnN0YW5jZW9mIEFTVF9DYWxsID8gaS5leHByZXNzaW9uICE9PSB0IHx8IGkgaW5zdGFuY2VvZiBBU1RfTmV3IDogaSBpbnN0YW5jZW9mIEFTVF9DbGFzc0ZpZWxkID8gaS52YWx1ZSA9PT0gdCAmJiAhaS5zdGF0aWMgOiBpIGluc3RhbmNlb2YgQVNUX0V4aXQgPyBpLnZhbHVlID09PSB0ICYmIG4ucmVzb2x2ZSgpICE9PSBlLnNjb3BlLnJlc29sdmUoKSA6IGkgaW5zdGFuY2VvZiBBU1RfVmFyRGVmICYmIGkudmFsdWUgPT09IHQ7fWZ1bmN0aW9uIG0oZSwgbikge3ZhciB0ID0ga2UoQVNUX1N5bWJvbFJlZiwgZSk7cmV0dXJuIHQuZml4ZWQgPSBuIHx8IGtlKEFTVF9VbmRlZmluZWQsIGUpLCB0O31mdW5jdGlvbiB2KHQsIGkpIHtyZXR1cm4gZnVuY3Rpb24gKGUpIHt2YXIgbiA9IHQoZSksZSA9IG0obiwgaSksbiA9IG4uZGVmaW5pdGlvbigpO3JldHVybiBuLnJlZmVyZW5jZXMucHVzaChlKSwgbi5yZXBsYWNlZCsrLCBlO307fWUoQVNUX05vZGUsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGU7fSksIEFTVF9Ub3BsZXZlbC5ERUZNRVRIT0QoImhvaXN0X2V4cG9ydHMiLCBmdW5jdGlvbiAoZSkge2lmIChlLm9wdGlvbigiaG9pc3RfZXhwb3J0cyIpKSB7Zm9yICh2YXIgbiA9IHRoaXMuYm9keSwgdCA9IFtdLCBpID0gMDsgaSA8IG4ubGVuZ3RoOyBpKyspIHt2YXIgciA9IG5baV07ciBpbnN0YW5jZW9mIEFTVF9FeHBvcnREZWNsYXJhdGlvbiA/IChuW2ldID0gciA9IHIuYm9keSwgciBpbnN0YW5jZW9mIEFTVF9EZWZpbml0aW9ucyA/IHIuZGVmaW5pdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2UubmFtZS5tYXRjaF9zeW1ib2wobywgITApO30pIDogbyhyLm5hbWUpKSA6IHIgaW5zdGFuY2VvZiBBU1RfRXhwb3J0UmVmZXJlbmNlcyAmJiAobi5zcGxpY2UoaS0tLCAxKSwgW10ucHVzaC5hcHBseSh0LCByLnByb3BlcnRpZXMpKTt9dC5sZW5ndGggJiYgbi5wdXNoKGtlKEFTVF9FeHBvcnRSZWZlcmVuY2VzLCB0aGlzLCB7IHByb3BlcnRpZXM6IHQgfSkpO31mdW5jdGlvbiBvKGUpIHtlIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlY2xhcmF0aW9uICYmICgoZSA9IGtlKEFTVF9TeW1ib2xFeHBvcnQsIGUpKS5hbGlhcyA9IGtlKEFTVF9TdHJpbmcsIGUsIHsgdmFsdWU6IGUubmFtZSB9KSwgdC5wdXNoKGUpKTt9fSksIEFTVF9TY29wZS5ERUZNRVRIT0QoInByb2Nlc3NfZXhwcmVzc2lvbiIsIGZ1bmN0aW9uIChyLCBvKSB7dmFyIGEgPSB0aGlzLHMgPSBuZXcgVHJlZVRyYW5zZm9ybWVyKGZ1bmN0aW9uIChlKSB7dmFyIG47aWYgKHIpIHtpZiAoKGUgPSBlIGluc3RhbmNlb2YgQVNUX0RpcmVjdGl2ZSA/IGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUsIHsgYm9keToga2UoQVNUX1N0cmluZywgZSkgfSkgOiBlKSBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQpIHJldHVybiBvID8gbyhlKSA6IGtlKEFTVF9SZXR1cm4sIGUsIHsgdmFsdWU6IGUuYm9keSB9KTt9IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBBU1RfUmV0dXJuKSByZXR1cm4gbyA/IG8oZSkgOiAobiA9IGUudmFsdWUpIGluc3RhbmNlb2YgQVNUX1N0cmluZyA/IGtlKEFTVF9EaXJlY3RpdmUsIG4pIDoga2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgZSwgeyBib2R5OiBuIHx8IGtlKEFTVF9VbmFyeVByZWZpeCwgZSwgeyBvcGVyYXRvcjogInZvaWQiLCBleHByZXNzaW9uOiBrZShBU1RfTnVtYmVyLCBlLCB7IHZhbHVlOiAwIH0pIH0pIH0pO2lmIChlIGluc3RhbmNlb2YgQVNUX0Jsb2NrKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhKSB7aWYgKGUgIT09IGEpIHJldHVybiBlO30gZWxzZSBpZiAoImF3YWl0cyIgPT09IHIgJiYgZSBpbnN0YW5jZW9mIEFTVF9UcnkgJiYgZS5iZmluYWxseSkgcmV0dXJuIGU7Zm9yICh2YXIgdCA9IGUuYm9keS5sZW5ndGg7IDAgPD0gLS10Oykge3ZhciBpID0gZS5ib2R5W3RdO2lmICghRihpLCAhMCkpIHtlLmJvZHlbdF0gPSBpLnRyYW5zZm9ybShzKTticmVhazt9fX0gZWxzZSBlIGluc3RhbmNlb2YgQVNUX0lmID8gKGUuYm9keSA9IGUuYm9keS50cmFuc2Zvcm0ocyksIGUuYWx0ZXJuYXRpdmUgJiYgKGUuYWx0ZXJuYXRpdmUgPSBlLmFsdGVybmF0aXZlLnRyYW5zZm9ybShzKSkpIDogZSBpbnN0YW5jZW9mIEFTVF9XaXRoICYmIChlLmJvZHkgPSBlLmJvZHkudHJhbnNmb3JtKHMpKTtyZXR1cm4gZTt9KTthLnRyYW5zZm9ybShzKTt9KSwgQVNUX1RvcGxldmVsLkRFRk1FVEhPRCgidW53cmFwX2V4cHJlc3Npb24iLCBmdW5jdGlvbiAoKSB7dmFyIGUgPSB0aGlzO3N3aXRjaCAoZS5ib2R5Lmxlbmd0aCkge2Nhc2UgMDpyZXR1cm4ga2UoQVNUX1VuYXJ5UHJlZml4LCBlLCB7IG9wZXJhdG9yOiAidm9pZCIsIGV4cHJlc3Npb246IGtlKEFTVF9OdW1iZXIsIGUsIHsgdmFsdWU6IDAgfSkgfSk7Y2FzZSAxOnZhciBuID0gZS5ib2R5WzBdO2lmIChuIGluc3RhbmNlb2YgQVNUX0RpcmVjdGl2ZSkgcmV0dXJuIGtlKEFTVF9TdHJpbmcsIG4pO2lmIChuIGluc3RhbmNlb2YgQVNUX1NpbXBsZVN0YXRlbWVudCkgcmV0dXJuIG4uYm9keTtkZWZhdWx0OnJldHVybiBrZShBU1RfQ2FsbCwgZSwgeyBleHByZXNzaW9uOiBrZShBU1RfRnVuY3Rpb24sIGUsIHsgYXJnbmFtZXM6IFtdLCBib2R5OiBlLmJvZHkgfSkuaW5pdF92YXJzKGUsIGUpLCBhcmdzOiBbXSB9KTt9fSksIEFTVF9Ob2RlLkRFRk1FVEhPRCgid3JhcF9leHByZXNzaW9uIiwgZnVuY3Rpb24gKCkge3ZhciBlID0gdGhpcztyZXR1cm4gZSA9IChlID0gaXNfc3RhdGVtZW50KGUpID8gZSA6IGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUsIHsgYm9keTogZSB9KSkgaW5zdGFuY2VvZiBBU1RfVG9wbGV2ZWwgPyBlIDoga2UoQVNUX1RvcGxldmVsLCBlLCB7IGJvZHk6IFtlXSB9KTt9KTt2YXIgeSA9IC9eKDB8WzEtOV1bMC05XSopJC87ZnVuY3Rpb24gbyhlLCBuLCB0KSB7dC5hc3NpZ25tZW50cyA9IDAsIHQuYm9vbF9yZXR1cm4gPSAwLCB0LmNyb3NzX2xvb3AgPSAhMSwgdC5kaXJlY3RfYWNjZXNzID0gITEsIHQuZHJvcF9yZXR1cm4gPSAwLCB0LmVzY2FwZWQgPSBbXSwgdC5maXJzdF9kZWNsID0gbnVsbCwgdC5maXhlZCA9ICF0LmNvbnN0X3JlZGVmcyAmJiAhdC5zY29wZS5waW5uZWQoKSAmJiAhbi5leHBvc2VkKHQpICYmICEodC5pbml0IGluc3RhbmNlb2YgQVNUX0xhbWJkYUV4cHJlc3Npb24gJiYgdC5pbml0ICE9PSB0LnNjb3BlKSAmJiB0LmluaXQsIHQucmVhc3NpZ25lZCA9IDAsIHQucmVjdXJzaXZlX3JlZnMgPSAwLCB0LnJlZmVyZW5jZXMgPSBbXSwgdC5zaW5nbGVfdXNlID0gdm9pZCAwO31mdW5jdGlvbiBhKGUsIG4sIHQpIHt0LnZhcmlhYmxlcy5lYWNoKGZ1bmN0aW9uIChlKSB7bygwLCBuLCBlKTt9KTt9ZnVuY3Rpb24gZyh0LCBpLCByKSB7ci5mbl9kZWZzID0gW10sIHIudmFyaWFibGVzLmVhY2goZnVuY3Rpb24gKGUpIHtvKDAsIGksIGUpO3ZhciBuID0gZS5pbml0O24gaW5zdGFuY2VvZiBBU1RfTGFtYmRhRGVmaW5pdGlvbiAmJiAoci5mbl9kZWZzLnB1c2gobiksIG4uc2FmZV9pZHMgPSBudWxsKSwgbnVsbCA9PT0gZS5maXhlZCA/IChlLnNhZmVfaWRzID0gdC5zYWZlX2lkcywgZCh0LCBlKSkgOiBlLmZpeGVkICYmICh0Lmxvb3BfaWRzW2UuaWRdID0gdC5pbl9sb29wLCBkKHQsIGUpKTt9KSwgci5tYXlfY2FsbF90aGlzID0gZnVuY3Rpb24gKCkge3IubWF5X2NhbGxfdGhpcyA9IHIuY29udGFpbnNfdGhpcygpID8gcmV0dXJuX3RydWUgOiByZXR1cm5fZmFsc2U7fSwgci51c2VzX2FyZ3VtZW50cyAmJiByLmVhY2hfYXJnbmFtZShmdW5jdGlvbiAoZSkge2UuZGVmaW5pdGlvbigpLmxhc3RfcmVmID0gITE7fSksIGkub3B0aW9uKCJpZSIpICYmIHIudmFyaWFibGVzLmVhY2goZnVuY3Rpb24gKGUpIHt2YXIgbiA9IGUub3JpZ1swXS5kZWZpbml0aW9uKCk7biAhPT0gZSAmJiAobi5maXhlZCA9ICExKTt9KTt9ZnVuY3Rpb24gcyhlLCBuKSB7biA9IG4uc2FmZV9pZHM7cmV0dXJuIHZvaWQgMCA9PT0gbiB8fCBuID09PSBlLnNhZmVfaWRzO31mdW5jdGlvbiBjKGUsIG4pIHt2YXIgdCA9IGUuZm5fc2Nhbm5pbmc7KGUuZm5fc2Nhbm5pbmcgPSBuKS53YWxrKGUpLCBlLmZuX3NjYW5uaW5nID0gdDt9ZnVuY3Rpb24gbCh0LCBpKSB7aS5lbmNsb3NlZC5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7dmFyIG47aS52YXJpYWJsZXMuZ2V0KGUubmFtZSkgPT09IGUgfHwgUih0LCBlKSB8fCAoZS5zaW5nbGVfdXNlID0gITEsIChuID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgKG4gPSBlLmZpeGVkKSA/IG4oKSA6IG4pIGluc3RhbmNlb2YgQVNUX0xhbWJkYSAmJiB2b2lkIDAgIT09IG4uc2FmZV9pZHMpIHx8IChlLmZpeGVkID0gITEpO30pO31mdW5jdGlvbiB4KGUsIG4sIHQpIHt2YXIgaSxyID0gdC5zYWZlX2lkczt2b2lkIDAgIT09IHIgJiYgITEgIT09IHIgJiYgKHQucGFyZW50X3Njb3BlLnJlc29sdmUoKS5tYXlfY2FsbF90aGlzID09PSByZXR1cm5fdHJ1ZSA/IG1lbWJlcih0LCBlLmZuX3Zpc2l0ZWQpICYmIGwoZSwgdCkgOiByID8gKGkgPSBtZW1iZXIodCwgZS5mbl92aXNpdGVkKSwgciA9PT0gZS5zYWZlX2lkcyA/IGkgfHwgYyhlLCB0KSA6IGkgPyBsKGUsIHQpIDogdC5zYWZlX2lkcyA9ICExKSA6IGUuZm5fc2Nhbm5pbmcgJiYgZS5mbl9zY2FubmluZyAhPT0gbi5zY29wZS5yZXNvbHZlKCkgPyB0LnNhZmVfaWRzID0gITEgOiAodC5zYWZlX2lkcyA9IGUuc2FmZV9pZHMsIGMoZSwgdCkpKTt9ZnVuY3Rpb24gayhuLCBlKSB7cChuKTt2YXIgdCA9IGUuZm5fZGVmczt0LmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLnNhZmVfaWRzID0gbi5zYWZlX2lkcywgYyhuLCBlKTt9KSwgdC5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS5zYWZlX2lkcyA9IHZvaWQgMDt9KSwgZS5mbl9kZWZzID0gdm9pZCAwLCBlLm1heV9jYWxsX3RoaXMgPSB2b2lkIDA7fWZ1bmN0aW9uIFMoZSwgbikge3ZhciB0ID0gT2JqZWN0LmNyZWF0ZShlLmRlZmluZWRfaWRzKSxpID0gT2JqZWN0LmNyZWF0ZShlLnNhZmVfaWRzKTtuIHx8ICh0LnNlcSA9IHt9LCBpLnNlcSA9IHt9KSwgZS5kZWZpbmVkX2lkcyA9IHQsIGUuc2FmZV9pZHMgPSBpO31mdW5jdGlvbiBwKGUpIHtlLmRlZmluZWRfaWRzID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGUuZGVmaW5lZF9pZHMpLCBlLnNhZmVfaWRzID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGUuc2FmZV9pZHMpO31mdW5jdGlvbiByKGUsIG4pIHtlLmRlZmluZWRfaWRzW24uaWRdID0gZS5kZWZpbmVkX2lkcy5zZXE7fWZ1bmN0aW9uIEQoZSwgbikge2UuYXNzaWduZWRfaWRzW24uaWRdID0gZS5kZWZpbmVkX2lkcy5zZXEsIGUuZGVmaW5lZF9pZHNbbi5pZF0gPSAhMTt9ZnVuY3Rpb24gZChlLCBuKSB7ZS5zYWZlX2lkc1tuLmlkXSA9IHt9O31mdW5jdGlvbiBFKGUsIG4pIHtlLnJlZmVyZW5jZXMucHVzaChuKSwgITEgIT09IGUubGFzdF9yZWYgJiYgKGUubGFzdF9yZWYgPSBuKTt9ZnVuY3Rpb24gUihlLCBuKSB7dmFyIHQsIGksIHI7cmV0dXJuICJtIiAhPSBuLnNpbmdsZV91c2UgJiYgKCh0ID0gZS5zYWZlX2lkc1tuLmlkXSkgPyAoKGkgPSBIT1AoZS5zYWZlX2lkcywgbi5pZCkpIHx8IChyID0gZS5zYWZlX2lkcy5zZXEsIHQucmVhZCA/IHQucmVhZCAhPT0gciAmJiAodC5yZWFkID0gITApIDogdC5yZWFkID0gciksIG51bGwgPT0gbi5maXhlZCA/ICFnZShuKSAmJiAhKG4uZ2xvYmFsICYmICJhcmd1bWVudHMiID09IG4ubmFtZSB8fCAoZS5sb29wX2lkc1tuLmlkXSA9IG51bGwsIG4uZml4ZWQgPSBrZShBU1RfVW5kZWZpbmVkLCBuLm9yaWdbMF0pLCBpICYmIChuLnNhZmVfaWRzID0gdm9pZCAwKSwgMCkpIDogIXQuYXNzaWduIHx8IHQuYXNzaWduID09PSBlLnNhZmVfaWRzKSA6IG4uZml4ZWQgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRGVmaW5pdGlvbik7fWZ1bmN0aW9uIE8oZSwgbiwgdCkge2lmICghdCkge2lmIChpc19mdW5hcmcobikgJiYgbi5zY29wZS51c2VzX2FyZ3VtZW50cyAmJiAhZS5oYXNfZGlyZWN0aXZlKCJ1c2Ugc3RyaWN0IikpIHJldHVybjtpZiAoIWFsbChuLm9yaWcsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICEoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xDb25zdCk7fSkpIHJldHVybjt9aWYgKHZvaWQgMCA9PT0gbi5maXhlZCkgcmV0dXJuIHQgfHwgYWxsKG4ub3JpZywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX1N5bWJvbExldCk7fSk7aWYgKCExICE9PSBuLmZpeGVkICYmIDAgIT09IG4uZml4ZWQpIHt0ID0gZS5zYWZlX2lkc1tuLmlkXTtpZiAobi5zYWZlX2lkcykgcmV0dXJuIG4uc2FmZV9pZHNbbi5pZF0gPSAhMSwgbi5zYWZlX2lkcyA9IHZvaWQgMCwgbnVsbCA9PT0gbi5maXhlZCB8fCBIT1AoZS5zYWZlX2lkcywgbi5pZCkgJiYgIXQucmVhZDtpZiAoIUhPUChlLnNhZmVfaWRzLCBuLmlkKSkge2lmICghdCkgcmV0dXJuO2lmICh0LnJlYWQgfHwgZS5pbl9sb29wKSB7dmFyIGkgPSBlLmZpbmRfcGFyZW50KEFTVF9CbG9ja1Njb3BlKTtpZiAoaSBpbnN0YW5jZW9mIEFTVF9DbGFzcykgcmV0dXJuO2lmIChuLnNjb3BlLnJlc29sdmUoKSAhPT0gaS5yZXNvbHZlKCkpIHJldHVybjt9dC5hc3NpZ24gPSAhKCF0LmFzc2lnbiB8fCB0LmFzc2lnbiA9PT0gZS5zYWZlX2lkcykgfHwgZS5zYWZlX2lkczt9aWYgKG51bGwgIT0gbi5maXhlZCAmJiB0LnJlYWQpIHtpZiAodC5yZWFkICE9PSBlLnNhZmVfaWRzLnNlcSkgcmV0dXJuO2lmIChlLmxvb3BfaWRzW24uaWRdICE9PSBlLmluX2xvb3ApIHJldHVybjt9cmV0dXJuIFIoZSwgbikgJiYgYWxsKG4ub3JpZywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX1N5bWJvbExhbWJkYSk7fSk7fX1mdW5jdGlvbiBVKGUpIHt2YXIgbjtyZXR1cm4gISFlICYmIChlIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiA/ICI9IiA9PSAobiA9IGUub3BlcmF0b3IpID8gVShlLnJpZ2h0KSA6ICFOZVtuLnNsaWNlKDAsIC0xKV0gOiBlIGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlID8gVShlLnRhaWxfbm9kZSgpKSA6IGUuaXNfY29uc3RhbnQoKSB8fCB3KGUpIHx8IGUgaW5zdGFuY2VvZiBBU1RfT2JqZWN0SWRlbnRpdHkpO31mdW5jdGlvbiBqKGUsIG4sIHQsIGksIHIsIG8sIGEpIHt2YXIgcyxmID0gZS5wYXJlbnQobyk7aWYgKCFyIHx8ICFyLmlzX2NvbnN0YW50KCkpIGlmIChPZShuLCB0LCBpLCBmKSkgbi5lc2NhcGVkLnB1c2goZiksICEoMSA8IGEpIHx8IHIgJiYgci5pc19jb25zdGFudF9leHByZXNzaW9uKHQpIHx8IChhID0gMSksICghbi5lc2NhcGVkLmRlcHRoIHx8IG4uZXNjYXBlZC5kZXB0aCA+IGEpICYmIChuLmVzY2FwZWQuZGVwdGggPSBhKSwgbi5zY29wZS5yZXNvbHZlKCkgIT09IHQucmVzb2x2ZSgpICYmIChuLmVzY2FwZWQuY3Jvc3Nfc2NvcGUgPSAhMCksIG4uZml4ZWQgJiYgKG4uZml4ZWQuZXNjYXBlZCA9IG4uZXNjYXBlZCk7ZWxzZSB7aWYgKGMgPSBpLCAocyA9IGYpIGluc3RhbmNlb2YgQVNUX0FycmF5IHx8IChzIGluc3RhbmNlb2YgQVNUX0JpbmFyeSA/IE5lW3Mub3BlcmF0b3JdIDogcyBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCA/IHMuY29uZGl0aW9uICE9PSBjIDogcyBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSA/IHMudGFpbF9ub2RlKCkgPT09IGMgOiBzIGluc3RhbmNlb2YgQVNUX1NwcmVhZCkpIGooZSwgbiwgdCwgZiwgZiwgbyArIDEsIGEpO2Vsc2UgaWYgKGYgaW5zdGFuY2VvZiBBU1RfT2JqZWN0S2V5VmFsICYmIGYudmFsdWUgPT09IGkpIHt2YXIgYyA9IGUucGFyZW50KG8gKyAxKTtqKGUsIG4sIHQsIGMsIGMsIG8gKyAyLCBhKTt9IGVsc2UgaWYgKGYgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyAmJiBmLmV4cHJlc3Npb24gPT09IGkgJiYgKGooZSwgbiwgdCwgZiwgciA9IHUociwgZiksIG8gKyAxLCBhICsgMSksIHIpKSByZXR1cm47MCA8IG8gfHwgZiBpbnN0YW5jZW9mIEFTVF9DYWxsICYmIGYuZXhwcmVzc2lvbiA9PT0gaSB8fCBmIGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlICYmIGYudGFpbF9ub2RlKCkgIT09IGkgfHwgZiBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQgfHwgZiBpbnN0YW5jZW9mIEFTVF9VbmFyeSAmJiAhdW5hcnlfc2lkZV9lZmZlY3RzW2Yub3BlcmF0b3JdIHx8IChuLmRpcmVjdF9hY2Nlc3MgPSAhMCwgbi5maXhlZCAmJiAobi5maXhlZC5kaXJlY3RfYWNjZXNzID0gITApKTt9fWZ1bmN0aW9uIEwoZSkge3ZhciBuO2UgaW5zdGFuY2VvZiBBU1RfU3ViICYmIChuID0gZS5leHByZXNzaW9uKSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgZ2UobiA9IG4uZGVmaW5pdGlvbigpKSAmJiAoKGUgPSAoZSA9IGUucHJvcGVydHkpLmlzX2NvbnN0YW50KCkgPyBlLnZhbHVlIDogZSkgaW5zdGFuY2VvZiBBU1RfTm9kZSB8fCB5LnRlc3QoZSkpICYmIChuLnJlYXNzaWduZWQrKywgKGUgaW5zdGFuY2VvZiBBU1RfTm9kZSA/IG4uc2NvcGUuYXJnbmFtZXMgOiBbbi5zY29wZS5hcmduYW1lc1tlXV0pLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZyAmJiAoZS5kZWZpbml0aW9uKCkuZml4ZWQgPSAhMSk7fSkpO31mdW5jdGlvbiBWKG4sIHQpIHt2YXIgaSwgcjtyZXR1cm4gZnVuY3Rpb24gKCkge3ZhciBlID0gbigpO3JldHVybiByID0gaSAhPT0gZSA/IHQoaSA9IGUpIDogcjt9O31mdW5jdGlvbiBJKGMsIG4sIGUsIGwsIHUpIHt2YXIgXyA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChpKSB7dmFyIHQsIHIsIG8sIGEsIHMsIGYsIGU7cmV0dXJuIGkgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdFZhbHVlID8gKEEoaSksIFMoYywgITApLCBpLnZhbHVlLndhbGsoYyksIHAoYyksIChlID0gbCkgJiYgKHQgPSBuLCByID0gaSwgbyA9IGUsIGwgPSBmdW5jdGlvbiBsKCkge3ZhciBlLCBuO3JldHVybiBzID09PSByID8gciA6IChlID0gbygpLCAobiA9IE4odCwgZSwgITApKSBpbnN0YW5jZW9mIEFTVF9Ob2RlID8gcyA9IHIgOiBhICE9PSBlICYmIChhID0gZSwgcyA9IHZvaWQgMCA9PT0gbiA/IHdlKHIsIFtlLCByLnZhbHVlXSkgOiBlKSwgcyk7fSksIGkubmFtZS53YWxrKF8pLCBsID0gZSkgOiBpIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZEFycmF5ID8gKEEoaSksIGUgPSBsLCBpLmVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKG4sIHQpIHtpZiAobiBpbnN0YW5jZW9mIEFTVF9Ib2xlKSByZXR1cm4gQShuKTtlICYmIChsID0gVihlLCBmdW5jdGlvbiAoZSkge3JldHVybiBrZShBU1RfU3ViLCBuLCB7IGV4cHJlc3Npb246IGUsIHByb3BlcnR5OiBrZShBU1RfTnVtYmVyLCBuLCB7IHZhbHVlOiB0IH0pIH0pO30pKSwgbi53YWxrKF8pO30pLCBpLnJlc3QgJiYgKGUgJiYgKGwgPSBuLm9wdGlvbigicmVzdHMiKSAmJiBWKGUsIGZ1bmN0aW9uIChlKSB7aWYgKCEoZSBpbnN0YW5jZW9mIEFTVF9BcnJheSkpIHJldHVybiBpO2ZvciAodmFyIG4gPSAwLCB0ID0gaS5lbGVtZW50cy5sZW5ndGg7IG4gPCB0OyBuKyspIGlmIChlLmVsZW1lbnRzW25dIGluc3RhbmNlb2YgQVNUX1NwcmVhZCkgcmV0dXJuIGk7cmV0dXJuIChmID0gZiB8fCBrZShBU1RfQXJyYXksIGksIHt9KSkuZWxlbWVudHMgPSBlLmVsZW1lbnRzLnNsaWNlKHQpLCBmO30pKSwgaS5yZXN0LndhbGsoXykpLCBsID0gZSkgOiBpIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZE9iamVjdCA/IChBKGkpLCBlID0gbCwgaS5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGkpIHtBKGkpLCBpLmtleSBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmIChTKGMpLCBpLmtleS53YWxrKGMpLCBwKGMpKSwgZSAmJiAobCA9IFYoZSwgZnVuY3Rpb24gKGUpIHt2YXIgbiA9IGkua2V5LHQgPSBBU1RfU3ViO3JldHVybiAic3RyaW5nIiA9PSB0eXBlb2YgbiAmJiAoaXNfaWRlbnRpZmllcl9zdHJpbmcobikgPyB0ID0gQVNUX0RvdCA6IG4gPSBaKG4sIGkpKSwga2UodCwgaSwgeyBleHByZXNzaW9uOiBlLCBwcm9wZXJ0eTogbiB9KTt9KSksIGkudmFsdWUud2FsayhfKTt9KSwgaS5yZXN0ICYmIChsID0gITEsIGkucmVzdC53YWxrKF8pKSwgbCA9IGUpIDogdShpLCBsLCBmdW5jdGlvbiAoKSB7Zm9yICh2YXIgZSA9IGMuc3RhY2subGVuZ3RoLCBuID0gMCwgdCA9IF8uc3RhY2subGVuZ3RoIC0gMTsgbiA8IHQ7IG4rKykgYy5zdGFjay5wdXNoKF8uc3RhY2tbbl0pO2kud2FsayhjKSwgYy5zdGFjay5sZW5ndGggPSBlO30pLCAhMDt9KTtlLndhbGsoXyk7fWZ1bmN0aW9uIE0oaSwgZSwgcikge3ZhciBuLG8gPSB0aGlzLGEgPSAoby5pbmxpbmVkID0gITEsIGkucGFyZW50KCkpLHQgPSAhaXNfYXN5bmMobykgJiYgIWlzX2dlbmVyYXRvcihvKSxzID0gIXQsZiA9ICExLGMgPSAoby53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuIHMgPyBmID0gITAgOiBlIGluc3RhbmNlb2YgQVNUX1JldHVybiA/IHMgPSAhMCA6IGUgaW5zdGFuY2VvZiBBU1RfU2NvcGUgJiYgZSAhPT0gbyB8fCB2b2lkIDA7fSkpLCBmICYmIFMoaSwgdCksIGcoaSwgciwgbyksICFvLnVzZXNfYXJndW1lbnRzIHx8IGkuaGFzX2RpcmVjdGl2ZSgidXNlIHN0cmljdCIpKSxsID0gKG8uYXJnbmFtZXMuZm9yRWFjaChmdW5jdGlvbiAobiwgZSkge3ZhciB0ID0gYS5hcmdzW2VdO0koaSwgciwgbiwgZnVuY3Rpb24gKCkge3ZhciBlID0gby5hcmduYW1lcy5pbmRleE9mKG4pLGUgPSBlIDwgMCA/IHQgOiBhLmFyZ3NbZV07cmV0dXJuIChlID0gZSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSAmJiBlLmV4cHJlc3Npb25zLmxlbmd0aCA8IDIgPyBlLmV4cHJlc3Npb25zWzBdIDogZSkgfHwga2UoQVNUX1VuZGVmaW5lZCwgYSk7fSwgXyk7fSksIG8ucmVzdCksdCA9IChsICYmIEkoaSwgciwgbCwgci5vcHRpb24oInJlc3RzIikgJiYgZnVuY3Rpb24gKCkge3JldHVybiBvLnJlc3QgIT09IGwgPyBsIDogKChuID0gbiB8fCBrZShBU1RfQXJyYXksIG8sIHt9KSkuZWxlbWVudHMgPSBhLmFyZ3Muc2xpY2Uoby5hcmduYW1lcy5sZW5ndGgpLCBuKTt9LCBfKSwgd2Fsa19sYW1iZGEobywgaSksIGkuZGVmaW5lZF9pZHMpLHUgPSBpLnNhZmVfaWRzO3JldHVybiBrKGksIG8pLCBmIHx8IChpLmRlZmluZWRfaWRzID0gdCwgaS5zYWZlX2lkcyA9IHUpLCAhMDtmdW5jdGlvbiBfKGUsIG4pIHt2YXIgdCA9IGUuZGVmaW5pdGlvbigpO3QuZmlyc3RfZGVjbCB8fCAwICE9IHQucmVmZXJlbmNlcy5sZW5ndGggfHwgKHQuZmlyc3RfZGVjbCA9IGUpLCBuICYmIGMgJiYgdm9pZCAwID09PSB0LmZpeGVkID8gKGQoaSwgdCksIGkubG9vcF9pZHNbdC5pZF0gPSBpLmluX2xvb3AsIHQuZml4ZWQgPSBuLCB0LmZpeGVkLmFzc2lnbnMgPSBbZV0pIDogdC5maXhlZCA9ICExO319ZnVuY3Rpb24gQShlKSB7ZS5fc3F1ZWV6ZWQgPSAhMSwgZS5fb3B0aW1pemVkID0gITEsIGUuc2luZ2xlX3VzZSA9ICExLCBlIGluc3RhbmNlb2YgQVNUX0Jsb2NrU2NvcGUgJiYgKGUuX3Zhcl9uYW1lcyA9IHZvaWQgMCksIGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIChlLmZpeGVkID0gdm9pZCAwKTt9ZnVuY3Rpb24gSCh0LCBpKSB7cmV0dXJuIHRoaXMudHJhbnNmb3JtKG5ldyBUcmVlVHJhbnNmb3JtZXIoZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgPyAoKGUgPSBlLmNsb25lKCkpLm5hbWUgPSBlLm5hbWUudHJhbnNmb3JtKHRoaXMpLCBlKSA6IGUgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkID8gKG4oZSA9IGUuY2xvbmUoKSwgdGhpcyksIGUpIDogZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwgPyAoKGUgPSBlLmNsb25lKCkpLnZhbHVlID0gZS52YWx1ZS50cmFuc2Zvcm0odGhpcyksIGUpIDogZS5jb252ZXJ0X3N5bWJvbCh0LCBpKTt9KSk7fWZ1bmN0aW9uICQoZSwgbikge2UgPSBrZShlLCB0aGlzKTtyZXR1cm4gbihlLCB0aGlzKSB8fCBlO31mdW5jdGlvbiBYKGUpIHt2YXIgbiA9IGUuZGVmaW5pdGlvbigpO24uYXNzaWdubWVudHMrKywgbi5yZWZlcmVuY2VzLnB1c2goZSk7fWZ1bmN0aW9uIEoobiwgdCkge3ZhciBpID0gbmV3IFRyZWVXYWxrZXIoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgPyAoZS52YWx1ZS53YWxrKHQpLCBlLm5hbWUud2FsayhpKSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwgPyAoZS5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiBlLmtleS53YWxrKHQpLCBlLnZhbHVlLndhbGsoaSksICEwKSA6IG4oZSk7fSk7dGhpcy53YWxrKGkpO31mdW5jdGlvbiBRKGUpIHtyZXR1cm4gZSh0aGlzKTt9ZnVuY3Rpb24gbmUobiwgdCkge3ZhciBpID0gITEsciA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuICEhaSB8fCAoZSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgPyB0ID8gKGUubmFtZS53YWxrKHIpLCAhMCkgOiBpID0gITAgOiBlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZEtleVZhbCA/ICF0ICYmIGUua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgPyBpID0gITAgOiAoZS52YWx1ZS53YWxrKHIpLCAhMCkgOiBuKGUpID8gaSA9ICEwIDogdm9pZCAwKTt9KTtyZXR1cm4gdGhpcy53YWxrKHIpLCBpO31mdW5jdGlvbiBCKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9Bc3luY0dlbmVyYXRvckRlZnVuIHx8IGUgaW5zdGFuY2VvZiBBU1RfQXN5bmNHZW5lcmF0b3JGdW5jdGlvbjt9ZnVuY3Rpb24geGUoZSkge3ZhciBuID0gMCx0ID0gZS5zZWxmKCk7ZG8ge2lmICh0LnZhcmlhYmxlcykgcmV0dXJuIHQ7fSB3aGlsZSAodCA9IGUucGFyZW50KG4rKykpO31mdW5jdGlvbiBCZShlLCBuLCB0LCBpLCByLCBvKSB7Zm9yICh2YXIgYTsgYSA9IGUucGFyZW50KG4rKyk7IHQgPSBhKSB7aWYgKGEgPT09IGkpIHJldHVybiAhMTtpZiAobyAmJiBhIGluc3RhbmNlb2YgQVNUX0xhbWJkYSkge2lmIChhLm5hbWUgfHwgaXNfYXN5bmMoYSkgfHwgaXNfZ2VuZXJhdG9yKGEpKSByZXR1cm4gITA7fSBlbHNlIGlmIChhIGluc3RhbmNlb2YgQVNUX1RyeSkge2lmIChhLmJmaW5hbGx5ICYmIGEuYmZpbmFsbHkgIT09IHQpIHJldHVybiAhMDtpZiAociAmJiBhLmJjYXRjaCAmJiBhLmJjYXRjaCAhPT0gdCkgcmV0dXJuICEwO319cmV0dXJuICExO30obiA9IGZ1bmN0aW9uIG4oZSwgX24yKSB7ZS5ERUZNRVRIT0QoInJlZHVjZV92YXJzIiwgX24yKTt9KShBU1RfTm9kZSwgbm9vcCksIG4oQVNUX0Fzc2lnbiwgZnVuY3Rpb24gKG8sIGUsIG4pIHt2YXIgYSA9IHRoaXMscyA9IGEubGVmdCxmID0gYS5yaWdodCx0ID0gcyBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgcy5kZWZpbml0aW9uKCksaSA9IHQgfHwgcyBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQ7c3dpdGNoIChhLm9wZXJhdG9yKSB7Y2FzZSAiPSI6cmV0dXJuIHMuZXF1YWxzKGYpICYmICFzLmhhc19zaWRlX2VmZmVjdHMobikgPyAoZi53YWxrKG8pLCBmdW5jdGlvbiBlKG4pIHtBKG4pO3t2YXIgdDtuIGluc3RhbmNlb2YgQVNUX0RvdCA/IGUobi5leHByZXNzaW9uKSA6IG4gaW5zdGFuY2VvZiBBU1RfU3ViID8gKGUobi5leHByZXNzaW9uKSwgbi5wcm9wZXJ0eS53YWxrKG8pKSA6IG4gaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmID8gKEUodCA9IG4uZGVmaW5pdGlvbigpLCBuKSwgdC5maXhlZCAmJiAobi5maXhlZCA9IHQuZml4ZWQsIG4uZml4ZWQuYXNzaWducyA/IG4uZml4ZWQuYXNzaWducy5wdXNoKGEpIDogbi5maXhlZC5hc3NpZ25zID0gW2FdKSkgOiBuLndhbGsobyk7fX0ocyksICEwKSA6IHQgJiYgZiBpbnN0YW5jZW9mIEFTVF9MYW1iZGFFeHByZXNzaW9uID8gKHUoKSwgZi5wYXJlbnRfc2NvcGUucmVzb2x2ZSgpLmZuX2RlZnMucHVzaChmKSwgZi5zYWZlX2lkcyA9IG51bGwsIHQuZml4ZWQgJiYgYS53cml0ZV9vbmx5IHx8IHgobywgdCwgZiksICEwKSA6IGkgPyAoZi53YWxrKG8pLCB1KCksICEwKSA6IHZvaWQgTChzKTtjYXNlICImJj0iOmNhc2UgInx8PSI6Y2FzZSAiPz89Ijp2YXIgciA9ICEwO2RlZmF1bHQ6aWYgKCFpKSByZXR1cm4gTChzKSwgXygpO0QobywgdCksIHQuYXNzaWdubWVudHMrKzt2YXIgYyxsID0gdC5maXhlZDtyZXR1cm4geWUobiwgbywgYSwgYSwgMCkgPyAodC5maXhlZCA9ICExLCBfKCkpIDogKGMgPSBSKG8sIHQpLCByICYmIFMobywgITApLCBmLndhbGsobyksIHIgJiYgcChvKSwgYyAmJiAhcy5pbl9hcmcgJiYgTyhvLCB0KSA/IChFKHQsIHMpLCBkKG8sIHQpLCB0LnNpbmdsZV91c2UgJiYgKHQuc2luZ2xlX3VzZSA9ICExKSwgcy5maXhlZCA9IHQuZml4ZWQgPSBmdW5jdGlvbiAoKSB7cmV0dXJuIGtlKEFTVF9CaW5hcnksIGEsIHsgb3BlcmF0b3I6IGEub3BlcmF0b3Iuc2xpY2UoMCwgLTEpLCBsZWZ0OiBtKHMsIGwpLCByaWdodDogYS5yaWdodCB9KTt9LCBzLmZpeGVkLmFzc2lnbnMgPSBsICYmIGwuYXNzaWducyA/IGwuYXNzaWducy5zbGljZSgpIDogW3Qub3JpZ1swXV0sIHMuZml4ZWQuYXNzaWducy5wdXNoKGEpLCBzLmZpeGVkLnRvX2JpbmFyeSA9IHYoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZS5sZWZ0O30sIGwpKSA6IChzLndhbGsobyksIHQuZml4ZWQgPSAhMSksICEwKTt9ZnVuY3Rpb24gdSgpIHt2YXIgZSA9IHQgJiYgUW4obywgdCksciA9IHllKG4sIG8sIGEsIGYsIDAsIFUoZiksIGUpO0kobywgbiwgcywgZnVuY3Rpb24gKCkge3JldHVybiBhLnJpZ2h0O30sIGZ1bmN0aW9uIChlLCBuLCB0KSB7dmFyIGk7ZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyAoaSA9IGUuZGVmaW5pdGlvbigpLCBEKG8sIGkpLCBpLmFzc2lnbm1lbnRzKyssIG4gJiYgIWUuaW5fYXJnICYmIE8obywgaSkgPyAoRShpLCBlKSwgZChvLCBpKSwgKHMgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkIHx8IDEgPT0gaS5vcmlnLmxlbmd0aCAmJiBpLm9yaWdbMF0gaW5zdGFuY2VvZiBBU1RfU3ltYm9sRGVmdW4pICYmIChpLnNpbmdsZV91c2UgPSAhMSksIG8ubG9vcF9pZHNbaS5pZF0gPSBvLmluX2xvb3AsIGkuZml4ZWQgPSByID8gMCA6IG4sIGUuZml4ZWQgPSBuLCBlLmZpeGVkLmFzc2lnbnMgPSBbYV0sIGoobywgaSwgZS5zY29wZSwgYSwgZiwgMCwgMSkpIDogKHQoKSwgaS5maXhlZCA9ICExKSkgOiAoTChlKSwgdCgpKTt9KTt9ZnVuY3Rpb24gXygpIHtpZiAocikgcmV0dXJuIHMud2FsayhvKSwgUyhvLCAhMCksIGYud2FsayhvKSwgcChvKSwgITA7fX0pLCBuKEFTVF9CaW5hcnksIGZ1bmN0aW9uIChlKSB7aWYgKE5lW3RoaXMub3BlcmF0b3JdKSByZXR1cm4gdGhpcy5sZWZ0LndhbGsoZSksIFMoZSwgITApLCB0aGlzLnJpZ2h0LndhbGsoZSksIHAoZSksICEwO30pLCBuKEFTVF9CbG9ja1Njb3BlLCBmdW5jdGlvbiAoZSwgbiwgdCkge2EoMCwgdCwgdGhpcyk7fSksIG4oQVNUX0NhbGwsIGZ1bmN0aW9uIChuKSB7dmFyIHQsZSA9IHRoaXMsaSA9IGUuZXhwcmVzc2lvbjtpZiAoaSBpbnN0YW5jZW9mIEFTVF9MYW1iZGFFeHByZXNzaW9uKSB0ID0gRmUoZSksIGUuYXJncy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKG4pLCBlIGluc3RhbmNlb2YgQVNUX1NwcmVhZCAmJiAodCA9ICExKTt9KSwgdCAmJiAoaS5yZWR1Y2VfdmFycyA9IE0pLCBpLndhbGsobiksIHQgJiYgZGVsZXRlIGkucmVkdWNlX3ZhcnM7ZWxzZSB7aWYgKCJDYWxsIiA9PSBlLlRZUEUpIHN3aXRjaCAobi5pbl9ib29sZWFuX2NvbnRleHQoKSkge2Nhc2UgImQiOnZhciByID0gITA7Y2FzZSAhMDohZnVuY3Rpb24gZShuLCB0KSB7biBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gPyAiPSIgPT0gbi5vcGVyYXRvciAmJiAoZShuLmxlZnQsIHQpLCBlKG4ucmlnaHQsIHQpKSA6IG4gaW5zdGFuY2VvZiBBU1RfQmluYXJ5ID8gTmVbbi5vcGVyYXRvcl0gJiYgKGUobi5sZWZ0LCB0KSwgZShuLnJpZ2h0LCB0KSkgOiBuIGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsID8gKGUobi5jb25zZXF1ZW50LCB0KSwgZShuLmFsdGVybmF0aXZlLCB0KSkgOiBuIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiAoKG4gPSBuLmRlZmluaXRpb24oKSkuYm9vbF9yZXR1cm4rKywgdCkgJiYgbi5kcm9wX3JldHVybisrO30oaSwgcik7fWkud2FsayhuKTt2YXIgbyA9IGUub3B0aW9uYWwsZSA9IChvICYmIFMobiwgITApLCBlLmFyZ3MuZm9yRWFjaChmdW5jdGlvbiAoZSkge2Uud2FsayhuKTt9KSwgbyAmJiBwKG4pLCBpIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiBpLmZpeGVkX3ZhbHVlKCkpO2UgaW5zdGFuY2VvZiBBU1RfTGFtYmRhID8geChuLCBpLmRlZmluaXRpb24oKSwgZSkgOiAobi5kZWZpbmVkX2lkcy5zZXEgPSB7fSwgbi5maW5kX3BhcmVudChBU1RfU2NvcGUpLm1heV9jYWxsX3RoaXMoKSk7fXJldHVybiAhMDt9KSwgbihBU1RfQ2xhc3MsIGZ1bmN0aW9uIChuLCBlLCB0KSB7dmFyIGkscixvID0gdGhpcyx0ID0gKGEoMCwgdCwgbyksIG8uZXh0ZW5kcyAmJiBvLmV4dGVuZHMud2FsayhuKSwgby5wcm9wZXJ0aWVzLmZpbHRlcihmdW5jdGlvbiAoZSkge3JldHVybiBBKGUpLCBlLmtleSBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmIChuLnB1c2goZSksIGUua2V5LndhbGsobiksIG4ucG9wKCkpLCBlLnZhbHVlO30pKTtyZXR1cm4gby5uYW1lICYmIChpID0gby5uYW1lLmRlZmluaXRpb24oKSwgKChyID0gbi5wYXJlbnQoKSkgaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVjbGFyYXRpb24gfHwgciBpbnN0YW5jZW9mIEFTVF9FeHBvcnREZWZhdWx0KSAmJiAoaS5zaW5nbGVfdXNlID0gITEpLCBPKG4sIGksICEwKSA/IChkKG4sIGkpLCBuLmxvb3BfaWRzW2kuaWRdID0gbi5pbl9sb29wLCBpLmZpeGVkID0gZnVuY3Rpb24gKCkge3JldHVybiBvO30sIGkuZml4ZWQuYXNzaWducyA9IFtvXSwgT24oaSkgfHwgKGkuc2luZ2xlX3VzZSA9ICExKSkgOiBpLmZpeGVkID0gITEpLCB0LmZvckVhY2goZnVuY3Rpb24gKGUpIHtuLnB1c2goZSksICFlLnN0YXRpYyB8fCBoZShlKSAmJiBlLnZhbHVlLmNvbnRhaW5zX3RoaXMoKSA/IChTKG4pLCBlLnZhbHVlLndhbGsobiksIHAobikpIDogZS52YWx1ZS53YWxrKG4pLCBuLnBvcCgpO30pLCAhMDt9KSwgbihBU1RfQ2xhc3NJbml0QmxvY2ssIGZ1bmN0aW9uIChlLCBuLCB0KSB7cmV0dXJuIFMoZSwgITApLCBnKGUsIHQsIHRoaXMpLCBuKCksIGsoZSwgdGhpcyksICEwO30pLCBuKEFTVF9Db25kaXRpb25hbCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5jb25kaXRpb24ud2FsayhlKSwgUyhlLCAhMCksIHRoaXMuY29uc2VxdWVudC53YWxrKGUpLCBwKGUpLCBTKGUsICEwKSwgdGhpcy5hbHRlcm5hdGl2ZS53YWxrKGUpLCBwKGUpLCAhMDt9KSwgbihBU1RfRGVmYXVsdFZhbHVlLCBmdW5jdGlvbiAoZSkge3JldHVybiBTKGUsICEwKSwgdGhpcy52YWx1ZS53YWxrKGUpLCBwKGUpLCB0aGlzLm5hbWUud2FsayhlKSwgITA7fSksIG4oQVNUX0RvLCBmdW5jdGlvbiAoZSkge3ZhciBuID0gZS5pbl9sb29wO3JldHVybiBlLmluX2xvb3AgPSB0aGlzLCBTKGUpLCB0aGlzLmJvZHkud2FsayhlKSwgQ24odGhpcywgZS5wYXJlbnQoKSkgJiYgKHAoZSksIFMoZSkpLCB0aGlzLmNvbmRpdGlvbi53YWxrKGUpLCBwKGUpLCBlLmluX2xvb3AgPSBuLCAhMDt9KSwgbihBU1RfRG90LCBmdW5jdGlvbiAoZSwgbikge24oKTtuID0gdGhpcy5leHByZXNzaW9uO3JldHVybiAhdGhpcy5vcHRpb25hbCAmJiBuIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiByKGUsIG4uZGVmaW5pdGlvbigpKSwgITA7fSksIG4oQVNUX0ZvciwgZnVuY3Rpb24gKGUsIG4sIHQpIHt2YXIgaSA9IHRoaXMsdCA9IChhKDAsIHQsIGkpLCBpLmluaXQgJiYgaS5pbml0LndhbGsoZSksIGUuaW5fbG9vcCk7cmV0dXJuIGUuaW5fbG9vcCA9IGksIFMoZSksIGkuY29uZGl0aW9uICYmIGkuY29uZGl0aW9uLndhbGsoZSksIGkuYm9keS53YWxrKGUpLCBpLnN0ZXAgJiYgKENuKGksIGUucGFyZW50KCkpICYmIChwKGUpLCBTKGUpKSwgaS5zdGVwLndhbGsoZSkpLCBwKGUpLCBlLmluX2xvb3AgPSB0LCAhMDt9KSwgbihBU1RfRm9yRW51bWVyYXRpb24sIGZ1bmN0aW9uIChlLCBuLCB0KSB7dmFyIGkgPSB0aGlzLHQgPSAoYSgwLCB0LCBpKSwgaS5vYmplY3Qud2FsayhlKSwgZS5pbl9sb29wKSxyID0gKGUuaW5fbG9vcCA9IGksIFMoZSksIGkuaW5pdCk7cmV0dXJuIHIgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMgPyByLmRlZmluaXRpb25zWzBdLm5hbWUubWFya19zeW1ib2woZnVuY3Rpb24gKGUpIHtlIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlY2xhcmF0aW9uICYmICgoZSA9IGUuZGVmaW5pdGlvbigpKS5hc3NpZ25tZW50cysrLCBlLmZpeGVkID0gITEpO30sIGUpIDogciBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQgfHwgciBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyByLm1hcmtfc3ltYm9sKGZ1bmN0aW9uIChlKSB7dmFyIG47ZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgKEUobiA9IGUuZGVmaW5pdGlvbigpLCBlKSwgbi5hc3NpZ25tZW50cysrLCBlLmlzX2ltbXV0YWJsZSgpIHx8IChuLmZpeGVkID0gITEpKTt9LCBlKSA6IHIud2FsayhlKSwgaS5ib2R5LndhbGsoZSksIHAoZSksIGUuaW5fbG9vcCA9IHQsICEwO30pLCBuKEFTVF9JZiwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5jb25kaXRpb24ud2FsayhlKSwgUyhlLCAhMCksIHRoaXMuYm9keS53YWxrKGUpLCBwKGUpLCB0aGlzLmFsdGVybmF0aXZlICYmIChTKGUsICEwKSwgdGhpcy5hbHRlcm5hdGl2ZS53YWxrKGUpLCBwKGUpKSwgITA7fSksIG4oQVNUX0xhYmVsZWRTdGF0ZW1lbnQsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIFMoZSwgITApLCB0aGlzLmJvZHkud2FsayhlKSwgcChlKSwgITA7fSksIG4oQVNUX0xhbWJkYSwgZnVuY3Rpb24gKGUsIG4sIHQpIHt2YXIgaSA9IHRoaXM7cmV0dXJuIHMoZSwgaSkgJiYgcHVzaF91bmlxKGUuZm5fdmlzaXRlZCwgaSkgJiYgKGkuaW5saW5lZCA9ICExLCBTKGUpLCBnKGUsIHQsIGkpLCBuKCksIGsoZSwgaSksIGkubmFtZSkgJiYgaihlLCBpLm5hbWUuZGVmaW5pdGlvbigpLCBpLCBpLm5hbWUsIGksIDAsIDEpLCAhMDt9KSwgbihBU1RfTGFtYmRhRGVmaW5pdGlvbiwgZnVuY3Rpb24gKGUsIG4sIHQpIHt2YXIgaSA9IHRoaXMsciA9IGkubmFtZS5kZWZpbml0aW9uKCksbyA9IGUucGFyZW50KCk7cmV0dXJuIChvIGluc3RhbmNlb2YgQVNUX0V4cG9ydERlY2xhcmF0aW9uIHx8IG8gaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVmYXVsdCkgJiYgKHIuc2luZ2xlX3VzZSA9ICExKSwgcyhlLCBpKSAmJiBwdXNoX3VuaXEoZS5mbl92aXNpdGVkLCBpKSAmJiAoaS5pbmxpbmVkID0gITEsIFMoZSksIGcoZSwgdCwgaSksIG4oKSwgayhlLCBpKSksICEwO30pLCBuKEFTVF9TdWIsIGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQgPSB0aGlzLmV4cHJlc3Npb247cmV0dXJuIHRoaXMub3B0aW9uYWwgPyAodC53YWxrKGUpLCBTKGUsICEwKSwgdGhpcy5wcm9wZXJ0eS53YWxrKGUpLCBwKGUpKSA6IChuKCksIHQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIHIoZSwgdC5kZWZpbml0aW9uKCkpKSwgITA7fSksIG4oQVNUX1N3aXRjaCwgZnVuY3Rpb24gKG4sIGUsIHQpIHthKDAsIHQsIHRoaXMpLCB0aGlzLmV4cHJlc3Npb24ud2FsayhuKTt2YXIgaSA9ICEwO3JldHVybiB0aGlzLmJvZHkuZm9yRWFjaChmdW5jdGlvbiAoZSkge2UgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdCB8fCAoZS5leHByZXNzaW9uLndhbGsobiksIGkgJiYgUyhuLCAhKGkgPSAhMSkpKTt9KSwgaSB8fCBwKG4pLCB3YWxrX2JvZHkodGhpcywgbiksICEwO30pLCBuKEFTVF9Td2l0Y2hCcmFuY2gsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIFMoZSwgITApLCB3YWxrX2JvZHkodGhpcywgZSksIHAoZSksICEwO30pLCBuKEFTVF9TeW1ib2xDYXRjaCwgZnVuY3Rpb24gKCkge3ZhciBlID0gdGhpcy5kZWZpbml0aW9uKCk7ZS5maXJzdF9kZWNsIHx8IDAgIT0gZS5yZWZlcmVuY2VzLmxlbmd0aCB8fCAoZS5maXJzdF9kZWNsID0gdGhpcyksIGUuZml4ZWQgPSAhMTt9KSwgbihBU1RfU3ltYm9sRGVjbGFyYXRpb24sIGZ1bmN0aW9uICgpIHt2YXIgZSA9IHRoaXMuZGVmaW5pdGlvbigpO2UuZmlyc3RfZGVjbCB8fCAwICE9IGUucmVmZXJlbmNlcy5sZW5ndGggfHwgKGUuZmlyc3RfZGVjbCA9IHRoaXMpO30pLCBuKEFTVF9TeW1ib2xEZWZ1biwgZnVuY3Rpb24gKCkge3ZhciBlID0gdGhpcy5kZWZpbml0aW9uKCk7ZS5maXJzdF9kZWNsIHx8IDAgIT0gZS5yZWZlcmVuY2VzLmxlbmd0aCB8fCAoZS5maXJzdF9kZWNsID0gdGhpcyksIDEgPCBlLm9yaWcubGVuZ3RoICYmIGUuc2NvcGUucmVzb2x2ZSgpICE9PSB0aGlzLnNjb3BlICYmIChlLmZpeGVkID0gITEpO30pLCBuKEFTVF9TeW1ib2xJbXBvcnQsIGZ1bmN0aW9uICgpIHt2YXIgZSA9IHRoaXMuZGVmaW5pdGlvbigpO2UuZmlyc3RfZGVjbCA9IHRoaXMsIGUuZml4ZWQgPSAhMTt9KSwgbihBU1RfU3ltYm9sUmVmLCBmdW5jdGlvbiAodCwgZSwgbikge3ZhciBpLHIgPSB0aGlzLG8gPSByLmRlZmluaXRpb24oKSxhID0gby5maXhlZCB8fCBvLmxhc3RfcmVmICYmIG8ubGFzdF9yZWYuZml4ZWQscyA9IChFKG8sIHIpLCAhZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCA9IGUuZGVmaW5lZF9pZHMuc2VxLGkgPSBlLmRlZmluZWRfaWRzW24uaWRdO2lmIChpID09PSB0KSByZXR1cm4gIShpID0gZS5hc3NpZ25lZF9pZHNbbi5pZF0pIHx8IGkgPT09IHQ7fSh0LCBvKSB8fCAoci5kZWZpbmVkID0gITApLCAxID09IG8ucmVmZXJlbmNlcy5sZW5ndGggJiYgIW8uZml4ZWQgJiYgby5vcmlnWzBdIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlZnVuICYmICh0Lmxvb3BfaWRzW28uaWRdID0gdC5pbl9sb29wKSwgUW4odCwgbykpO3N3aXRjaCAocyAmJiBzLmVuY2xvc2VkLmZvckVhY2goZnVuY3Rpb24gKGUpIHt2YXIgbjtvID09PSBlIHx8IGUuc2NvcGUucmVzb2x2ZSgpID09PSBzIHx8ICEobiA9IGUuZml4ZWQgJiYgZS5maXhlZC5hc3NpZ25zKSB8fCBuW24ubGVuZ3RoIC0gMV0gaW5zdGFuY2VvZiBBU1RfVmFyRGVmIHx8IChuID0gdC5zYWZlX2lkc1tlLmlkXSkgJiYgKG4uYXNzaWduID0gITApO30pLCAibSIgPT0gby5zaW5nbGVfdXNlICYmIG8uZml4ZWQgJiYgKG8uZml4ZWQgPSAwLCBvLnNpbmdsZV91c2UgPSAhMSksIG8uZml4ZWQpIHtjYXNlIDA6Uih0LCBvKSB8fCAoby5maXhlZCA9ICExKTtjYXNlICExOnZhciBmID0gby5yZWRlZmluZWQoKTtmICYmIGIoby5zY29wZSwgci5zY29wZSkgJiYgKGYuc2luZ2xlX3VzZSA9ICExKTticmVhaztjYXNlIHZvaWQgMDpvLmZpeGVkID0gITE7YnJlYWs7ZGVmYXVsdDpSKHQsIG8pID8gKHIuaW5fYXJnICYmIG8ub3JpZ1swXSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xMYW1iZGEgJiYgKHIuZml4ZWQgPSBvLnNjb3BlKSwgaSA9IHIuZml4ZWRfdmFsdWUoKSwgcyA/IG8ucmVjdXJzaXZlX3JlZnMrKyA6ICFpIHx8IChmID0gbywgIW4ub3B0aW9uKCJ1bnVzZWQiKSkgfHwgZi5zY29wZS5waW5uZWQoKSB8fCAhMSA9PT0gZi5zaW5nbGVfdXNlIHx8IGYucmVmZXJlbmNlcy5sZW5ndGggLSBmLnJlY3Vyc2l2ZV9yZWZzICE9IDEgfHwgaXNfZnVuYXJnKGYpICYmIGYuc2NvcGUudXNlc19hcmd1bWVudHMgPyBvLnNpbmdsZV91c2UgPSAhMSA6IChvLmluX2xvb3AgPSB0Lmxvb3BfaWRzW28uaWRdICE9PSB0LmluX2xvb3AsIG8uc2luZ2xlX3VzZSA9IHcoaSkgJiYgIWkucGlubmVkKCkgJiYgKCFvLmluX2xvb3AgfHwgdC5wYXJlbnQoKSBpbnN0YW5jZW9mIEFTVF9DYWxsKSB8fCAhby5pbl9sb29wICYmIG8uc2NvcGUgPT09IHIuc2NvcGUucmVzb2x2ZSgpICYmIGkuaXNfY29uc3RhbnRfZXhwcmVzc2lvbigpKSwgeWUobiwgdCwgciwgaSwgMCwgVShpKSwgcykgJiYgKG8uc2luZ2xlX3VzZSA/IG8uc2luZ2xlX3VzZSA9ICJtIiA6IG8uZml4ZWQgPSAwKSwgby5maXhlZCAmJiB0Lmxvb3BfaWRzW28uaWRdICE9PSB0LmluX2xvb3AgJiYgKG8uY3Jvc3NfbG9vcCA9ICEwKSwgaih0LCBvLCByLnNjb3BlLCByLCBpLCAwLCAxKSkgOiBvLmZpeGVkID0gITE7fWlmIChyLmZpeGVkIHx8IChyLmZpeGVkID0gMCA9PT0gby5maXhlZCA/IGEgOiBvLmZpeGVkKSwgKGkgPSAhaSAmJiBhID8gYSBpbnN0YW5jZW9mIEFTVF9Ob2RlID8gYSA6IGEoKSA6IGkpIGluc3RhbmNlb2YgQVNUX0xhbWJkYSkge2lmIChvLmZpeGVkKSB7YSA9IHQucGFyZW50KCk7aWYgKGEgaW5zdGFuY2VvZiBBU1RfQ2FsbCAmJiBhLmV4cHJlc3Npb24gPT09IHIpIHJldHVybjt9eCh0LCBvLCBpKTt9fSksIG4oQVNUX1RlbXBsYXRlLCBmdW5jdGlvbiAobiwgZSkge3ZhciB0LGkgPSB0aGlzLnRhZztpZiAoaSkgcmV0dXJuIGkgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRXhwcmVzc2lvbiA/ICh0aGlzLmV4cHJlc3Npb25zLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLndhbGsobik7fSksIGkud2FsayhuKSkgOiAoaS53YWxrKG4pLCB0aGlzLmV4cHJlc3Npb25zLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLndhbGsobik7fSksICh0ID0gaSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgaS5maXhlZF92YWx1ZSgpKSBpbnN0YW5jZW9mIEFTVF9MYW1iZGEgPyB4KG4sIGkuZGVmaW5pdGlvbigpLCB0KSA6IG4uZmluZF9wYXJlbnQoQVNUX1Njb3BlKS5tYXlfY2FsbF90aGlzKCkpLCAhMDt9KSwgbihBU1RfVG9wbGV2ZWwsIGZ1bmN0aW9uIChlLCBuLCB0KSB7cmV0dXJuIHRoaXMuZ2xvYmFscy5lYWNoKGZ1bmN0aW9uIChlKSB7bygwLCB0LCBlKTt9KSwgUyhlLCAhMCksIGcoZSwgdCwgdGhpcyksIG4oKSwgayhlLCB0aGlzKSwgITA7fSksIG4oQVNUX1RyeSwgZnVuY3Rpb24gKGUsIG4sIHQpIHt2YXIgaSA9IHRoaXM7cmV0dXJuIGEoMCwgdCwgaSksIFMoZSwgITApLCB3YWxrX2JvZHkoaSwgZSksIHAoZSksIGkuYmNhdGNoICYmIChTKGUsICEwKSwgaS5iY2F0Y2gud2FsayhlKSwgcChlKSksIGkuYmZpbmFsbHkgJiYgaS5iZmluYWxseS53YWxrKGUpLCAhMDt9KSwgbihBU1RfVW5hcnksIGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQgPSB0aGlzO2lmIChVTkFSWV9QT1NURklYW3Qub3BlcmF0b3JdKSB7dmFyIGkscixvID0gdC5leHByZXNzaW9uO2lmIChvIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikgcmV0dXJuIChpID0gby5kZWZpbml0aW9uKCkpLmFzc2lnbm1lbnRzKyssIHIgPSBpLmZpeGVkLCBSKGUsIGkpICYmICFvLmluX2FyZyAmJiBPKGUsIGkpID8gKEUoaSwgbyksIGQoZSwgaSksIGkuc2luZ2xlX3VzZSAmJiAoaS5zaW5nbGVfdXNlID0gITEpLCBpLmZpeGVkID0gZnVuY3Rpb24gKCkge3JldHVybiBrZShBU1RfQmluYXJ5LCB0LCB7IG9wZXJhdG9yOiB0Lm9wZXJhdG9yLnNsaWNlKDAsIC0xKSwgbGVmdDoga2UoQVNUX1VuYXJ5UHJlZml4LCB0LCB7IG9wZXJhdG9yOiAiKyIsIGV4cHJlc3Npb246IG0obywgcikgfSksIHJpZ2h0OiBrZShBU1RfTnVtYmVyLCB0LCB7IHZhbHVlOiAxIH0pIH0pO30sIGkuZml4ZWQuYXNzaWducyA9IHIgJiYgci5hc3NpZ25zID8gci5hc3NpZ25zLnNsaWNlKCkgOiBbXSwgaS5maXhlZC5hc3NpZ25zLnB1c2godCksIHQgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggPyBvLmZpeGVkID0gaS5maXhlZCA6IChvLmZpeGVkID0gZnVuY3Rpb24gKCkge3JldHVybiBrZShBU1RfVW5hcnlQcmVmaXgsIHQsIHsgb3BlcmF0b3I6ICIrIiwgZXhwcmVzc2lvbjogbShvLCByKSB9KTt9LCBvLmZpeGVkLmFzc2lnbnMgPSByICYmIHIuYXNzaWducywgby5maXhlZC50b19wcmVmaXggPSB2KGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUuZXhwcmVzc2lvbjt9LCBpLmZpeGVkKSkpIDogKG8ud2FsayhlKSwgaS5maXhlZCA9ICExKSwgITA7TChvKTt9fSksIG4oQVNUX1ZhckRlZiwgZnVuY3Rpb24gKGksIGUsIG4pIHt2YXIgdCxyID0gdGhpcyxvID0gci52YWx1ZTtyZXR1cm4gbyBpbnN0YW5jZW9mIEFTVF9MYW1iZGFFeHByZXNzaW9uICYmIHIubmFtZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiA/IChhKCksIG8ucGFyZW50X3Njb3BlLnJlc29sdmUoKS5mbl9kZWZzLnB1c2gobyksIG8uc2FmZV9pZHMgPSBudWxsLCAodCA9IHIubmFtZS5kZWZpbml0aW9uKCkpLmZpeGVkIHx8IHgoaSwgdCwgbykpIDogbyA/IChvLndhbGsoaSksIGEoKSkgOiBpLnBhcmVudCgpIGluc3RhbmNlb2YgQVNUX0xldCA/IGEoKSA6IHIubmFtZS53YWxrKGkpLCAhMDtmdW5jdGlvbiBhKCkge0koaSwgbiwgci5uYW1lLCBmdW5jdGlvbiAoKSB7cmV0dXJuIHIudmFsdWUgfHwga2UoQVNUX1VuZGVmaW5lZCwgcik7fSwgZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCA9IGUuZGVmaW5pdGlvbigpO0QoaSwgdCksIHQuZmlyc3RfZGVjbCB8fCAwICE9IHQucmVmZXJlbmNlcy5sZW5ndGggfHwgKHQuZmlyc3RfZGVjbCA9IGUpLCBuICYmIE8oaSwgdCwgITApID8gKGQoaSwgdCksIGkubG9vcF9pZHNbdC5pZF0gPSBpLmluX2xvb3AsIHQuZml4ZWQgPSBuLCB0LmZpeGVkLmFzc2lnbnMgPSBbcl0sIChlIGluc3RhbmNlb2YgQVNUX1N5bWJvbENvbnN0ICYmIHQucmVkZWZpbmVkKCkgfHwgIWJlKGUpICYmICFPbih0KSkgJiYgKHQuc2luZ2xlX3VzZSA9ICExKSkgOiB0LmZpeGVkID0gITE7fSk7fX0pLCBuKEFTVF9XaGlsZSwgZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCA9IGUuaW5fbG9vcDtyZXR1cm4gZS5pbl9sb29wID0gdGhpcywgUyhlKSwgbigpLCBwKGUpLCBlLmluX2xvb3AgPSB0LCAhMDt9KSwgQVNUX1RvcGxldmVsLkRFRk1FVEhPRCgicmVzZXRfb3B0X2ZsYWdzIiwgZnVuY3Rpb24gKHQpIHt2YXIgaSA9IG5ldyBUcmVlV2Fsa2VyKHQub3B0aW9uKCJyZWR1Y2VfdmFycyIpID8gZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gQShlKSwgZS5yZWR1Y2VfdmFycyhpLCBuLCB0KTt9IDogQSk7aS5hc3NpZ25lZF9pZHMgPSBPYmplY3QuY3JlYXRlKG51bGwpLCBpLmRlZmluZWRfaWRzID0gT2JqZWN0LmNyZWF0ZShudWxsKSwgaS5kZWZpbmVkX2lkcy5zZXEgPSB7fSwgaS5mbl9zY2FubmluZyA9IG51bGwsIGkuZm5fdmlzaXRlZCA9IFtdLCBpLmluX2xvb3AgPSBudWxsLCBpLmxvb3BfaWRzID0gT2JqZWN0LmNyZWF0ZShudWxsKSwgaS5zYWZlX2lkcyA9IE9iamVjdC5jcmVhdGUobnVsbCksIGkuc2FmZV9pZHMuc2VxID0ge30sIHRoaXMud2FsayhpKTt9KSwgQVNUX1N5bWJvbC5ERUZNRVRIT0QoImZpeGVkX3ZhbHVlIiwgZnVuY3Rpb24gKGUpIHt2YXIgbiA9IHRoaXMuZGVmaW5pdGlvbigpLHQgPSBuLmZpeGVkO3JldHVybiB0ID8gKCh0ID0gdGhpcy5maXhlZCA/IHRoaXMuZml4ZWQgOiB0KSBpbnN0YW5jZW9mIEFTVF9Ob2RlID8gdCA6IHQoKSkudGFpbF9ub2RlKCkgOiAodCA9IDAgPT09IHQgJiYgdGhpcy5maXhlZCkgJiYgKHQgPSAodCBpbnN0YW5jZW9mIEFTVF9Ob2RlID8gdCA6IHQoKSkudGFpbF9ub2RlKCksIGUgJiYgMSAhPSBuLmVzY2FwZWQuZGVwdGggJiYgS24odCwgITApIHx8IHQuaXNfY29uc3RhbnQoKSA/IHQgOiB2b2lkIDApO30pLCBBU1RfU3ltYm9sUmVmLkRFRk1FVEhPRCgiaXNfaW1tdXRhYmxlIiwgZnVuY3Rpb24gKCkge3ZhciBlID0gdGhpcy5yZWRlZiB8fCB0aGlzLmRlZmluaXRpb24oKTtyZXR1cm4gZS5vcmlnWzBdIGluc3RhbmNlb2YgQVNUX1N5bWJvbExhbWJkYSAmJiAoMSA9PSBlLm9yaWcubGVuZ3RoIHx8ICEoIXRoaXMuaW5fYXJnIHx8IGUub3JpZ1sxXSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcpKTt9KSwgQVNUX05vZGUuREVGTUVUSE9EKCJjb252ZXJ0X3N5bWJvbCIsIG5vb3ApLCBBU1RfRGVmYXVsdFZhbHVlLkRFRk1FVEhPRCgiY29udmVydF9zeW1ib2wiLCBIKSwgQVNUX0Rlc3RydWN0dXJlZC5ERUZNRVRIT0QoImNvbnZlcnRfc3ltYm9sIiwgSCksIEFTVF9TeW1ib2xEZWNsYXJhdGlvbi5ERUZNRVRIT0QoImNvbnZlcnRfc3ltYm9sIiwgJCksIEFTVF9TeW1ib2xSZWYuREVGTUVUSE9EKCJjb252ZXJ0X3N5bWJvbCIsICQpLCBBU1RfRGVmYXVsdFZhbHVlLkRFRk1FVEhPRCgibWFya19zeW1ib2wiLCBKKSwgQVNUX0Rlc3RydWN0dXJlZC5ERUZNRVRIT0QoIm1hcmtfc3ltYm9sIiwgSiksIEFTVF9TeW1ib2xEZWNsYXJhdGlvbi5ERUZNRVRIT0QoIm1hcmtfc3ltYm9sIiwgUSksIEFTVF9TeW1ib2xSZWYuREVGTUVUSE9EKCJtYXJrX3N5bWJvbCIsIFEpLCBBU1RfTm9kZS5ERUZNRVRIT0QoIm1hdGNoX3N5bWJvbCIsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUodGhpcyk7fSksIEFTVF9EZWZhdWx0VmFsdWUuREVGTUVUSE9EKCJtYXRjaF9zeW1ib2wiLCBuZSksIEFTVF9EZXN0cnVjdHVyZWQuREVGTUVUSE9EKCJtYXRjaF9zeW1ib2wiLCBuZSk7dmFyIHRlID0gbWFrZVByZWRpY2F0ZSgiSW5maW5pdHkgTmFOIHVuZGVmaW5lZCIpO2Z1bmN0aW9uIFBlKGUsIG4pIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24pIHJldHVybiAiPSIgIT0gZS5vcGVyYXRvciB8fCAhIWUucmlnaHQudGFpbF9ub2RlKCkuaXNfY29uc3RhbnQoKSB8fCBQZShlLmxlZnQsIG4pO2lmIChlIGluc3RhbmNlb2YgQVNUX0F0b20pIHJldHVybiAhMDtpZiAoZSBpbnN0YW5jZW9mIEFTVF9PYmplY3RJZGVudGl0eSkgcmV0dXJuICEwO2lmIChlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpIHtpZiAoIl9fcHJvdG9fXyIgPT09IGUucHJvcGVydHkpIHJldHVybiAhMDtpZiAoKGUgPSBlLmV4cHJlc3Npb24pIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikge2lmIChlLmlzX2ltbXV0YWJsZSgpKSByZXR1cm4gITE7ZSA9IGUuZml4ZWRfdmFsdWUoKTt9cmV0dXJuIGUgPyAhIWUudGFpbF9ub2RlKCkuaXNfY29uc3RhbnQoKSB8fCBQZShlLCBuKSA6ICEwO31yZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgKCEhZS5pc19pbW11dGFibGUoKSB8fCAoZSA9IGUuZGVmaW5pdGlvbigpLCBuLmV4cG9zZWQoZSkgJiYgdGVbZS5uYW1lXSkpO31mdW5jdGlvbiBrZShlLCBuLCB0KSB7cmV0dXJuIHQgPyAodC5zdGFydCA9IG4uc3RhcnQsIHQuZW5kID0gbi5lbmQpIDogdCA9IG4sIG5ldyBlKHQpO31mdW5jdGlvbiB3ZShlLCBuKSB7cmV0dXJuIDEgPT0gbi5sZW5ndGggPyBuWzBdIDoga2UoQVNUX1NlcXVlbmNlLCBlLCB7IGV4cHJlc3Npb25zOiBuLnJlZHVjZShyZSwgW10pIH0pO31mdW5jdGlvbiBaKGUsIG4pIHtzd2l0Y2ggKHR5cGVvZiBlKSB7Y2FzZSAic3RyaW5nIjpyZXR1cm4ga2UoQVNUX1N0cmluZywgbiwgeyB2YWx1ZTogZSB9KTtjYXNlICJudW1iZXIiOnJldHVybiBpc05hTihlKSA/IGtlKEFTVF9OYU4sIG4pIDogaXNGaW5pdGUoZSkgPyAxIC8gZSA8IDAgPyBrZShBU1RfVW5hcnlQcmVmaXgsIG4sIHsgb3BlcmF0b3I6ICItIiwgZXhwcmVzc2lvbjoga2UoQVNUX051bWJlciwgbiwgeyB2YWx1ZTogLWUgfSkgfSkgOiBrZShBU1RfTnVtYmVyLCBuLCB7IHZhbHVlOiBlIH0pIDogZSA8IDAgPyBrZShBU1RfVW5hcnlQcmVmaXgsIG4sIHsgb3BlcmF0b3I6ICItIiwgZXhwcmVzc2lvbjoga2UoQVNUX0luZmluaXR5LCBuKSB9KSA6IGtlKEFTVF9JbmZpbml0eSwgbik7Y2FzZSAiYm9vbGVhbiI6cmV0dXJuIGtlKGUgPyBBU1RfVHJ1ZSA6IEFTVF9GYWxzZSwgbik7Y2FzZSAidW5kZWZpbmVkIjpyZXR1cm4ga2UoQVNUX1VuZGVmaW5lZCwgbik7ZGVmYXVsdDppZiAobnVsbCA9PT0gZSkgcmV0dXJuIGtlKEFTVF9OdWxsLCBuKTtpZiAoZSBpbnN0YW5jZW9mIFJlZ0V4cCkgcmV0dXJuIGtlKEFTVF9SZWdFeHAsIG4sIHsgdmFsdWU6IGUgfSk7dGhyb3cgbmV3IEVycm9yKHN0cmluZ190ZW1wbGF0ZSgiQ2FuJ3QgaGFuZGxlIGNvbnN0YW50IG9mIHR5cGU6IHt0eXBlfSIsIHsgdHlwZTogdHlwZW9mIGUgfSkpO319ZnVuY3Rpb24gaWUoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgfHwgRWUoZSkgJiYgImV2YWwiID09IGUubmFtZTt9ZnVuY3Rpb24gRGUoZSwgbiwgdCkge3ZhciBpID0gITE7cmV0dXJuICJDYWxsIiA9PSBlLlRZUEUgPyBpID0gZS5leHByZXNzaW9uID09PSBuICYmIGllKHQpIDogZSBpbnN0YW5jZW9mIEFTVF9UZW1wbGF0ZSA/IGkgPSBlLnRhZyA9PT0gbiAmJiBpZSh0KSA6IGUgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgKGkgPSAiZGVsZXRlIiA9PSBlLm9wZXJhdG9yIHx8ICJ0eXBlb2YiID09IGUub3BlcmF0b3IgJiYgRWUodCkpLCBpID8gd2UobiwgW2tlKEFTVF9OdW1iZXIsIG4sIHsgdmFsdWU6IDAgfSksIHRdKSA6IHQ7fWZ1bmN0aW9uIFAoZSwgbikge3ZhciBpID0gbmV3IERpY3Rpb25hcnkoKTtyZXR1cm4gZS53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7dmFyIG47ZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgKG4gPSBlLmRlZmluaXRpb24oKSwgKGUgPSBlLmZpeGVkKSAmJiBpLmhhcyhuLmlkKSA/IGkuZ2V0KG4uaWQpICE9PSBlICYmIGkuc2V0KG4uaWQsICExKSA6IGkuc2V0KG4uaWQsIGUpKTt9KSksIDAgPCBpLnNpemUoKSAmJiBuLndhbGsobmV3IFRyZWVXYWxrZXIoZnVuY3Rpb24gKGUpIHt2YXIgbiwgdDtlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiAobiA9IGUuZGVmaW5pdGlvbigpLCB0ID0gZS5maXhlZCkgJiYgaS5oYXMobi5pZCkgJiYgaS5nZXQobi5pZCkgIT09IHQgJiYgKGUuZml4ZWQgPSAhMSk7fSkpLCBuO31mdW5jdGlvbiByZShlLCBuKSB7cmV0dXJuIG4gaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgPyBbXS5wdXNoLmFwcGx5KGUsIG4uZXhwcmVzc2lvbnMpIDogZS5wdXNoKG4pLCBlO31mdW5jdGlvbiBvZShlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfQ29uc3QgfHwgZSBpbnN0YW5jZW9mIEFTVF9EZWZDbGFzcyB8fCBlIGluc3RhbmNlb2YgQVNUX0xldDt9ZnVuY3Rpb24gYWUoZSkge3ZhciBuLCB0O3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0xhbWJkYURlZmluaXRpb24gPyAobiA9IGUubmFtZS5kZWZpbml0aW9uKCksIHQgPSBlLm5hbWUuc2NvcGUsICEoMSA8IG4ub3JpZy5sZW5ndGggJiYgbi5zY29wZS5yZXNvbHZlKCkgIT09IHQpICYmIChuLnNjb3BlID09PSB0IHx8IGFsbChuLnJlZmVyZW5jZXMsIGZ1bmN0aW9uIChlKSB7dmFyIG4gPSBlLnNjb3BlO2RvIHtpZiAobiA9PT0gdCkgcmV0dXJuICEwO30gd2hpbGUgKG4gPSBuLnBhcmVudF9zY29wZSk7fSkpKSA6ICFvZShlKTt9ZnVuY3Rpb24gc2UoZSkge2lmIChudWxsID09PSBlKSByZXR1cm4gW107aWYgKGUgaW5zdGFuY2VvZiBBU1RfQmxvY2tTdGF0ZW1lbnQpIHJldHVybiBhbGwoZS5ib2R5LCBhZSkgPyBlLmJvZHkgOiBbZV07aWYgKGUgaW5zdGFuY2VvZiBBU1RfRW1wdHlTdGF0ZW1lbnQpIHJldHVybiBbXTtpZiAoaXNfc3RhdGVtZW50KGUpKSByZXR1cm4gW2VdO3Rocm93IG5ldyBFcnJvcigiQ2FuJ3QgY29udmVydCB0aGluZyB0byBzdGF0ZW1lbnQgYXJyYXkiKTt9ZnVuY3Rpb24gZWUoZSkge3JldHVybiBudWxsID09PSBlIHx8IGUgaW5zdGFuY2VvZiBBU1RfRW1wdHlTdGF0ZW1lbnQgfHwgZSBpbnN0YW5jZW9mIEFTVF9CbG9ja1N0YXRlbWVudCAmJiAwID09IGUuYm9keS5sZW5ndGg7fWZ1bmN0aW9uIGZlKGUpIHtyZXR1cm4gYWxsKGUuYm9keSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gZWUoZSkgfHwgZSBpbnN0YW5jZW9mIEFTVF9EZWZ1biB8fCBlIGluc3RhbmNlb2YgQVNUX1ZhciAmJiBXKGUpO30pO31mdW5jdGlvbiBjZShlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfSXRlcmF0aW9uU3RhdGVtZW50ICYmIGUuYm9keSBpbnN0YW5jZW9mIEFTVF9CbG9ja1N0YXRlbWVudCA/IGUuYm9keSA6IGU7fWZ1bmN0aW9uIGxlKGUpIHtpZiAoIkNhbGwiICE9IGUuVFlQRSkgcmV0dXJuICExO2ZvciAoOyAoZSA9IGUuZXhwcmVzc2lvbikgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzczspO3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0xhbWJkYUV4cHJlc3Npb24gPyAhaXNfYXJyb3coZSkgOiBsZShlKTt9ZnVuY3Rpb24gRmUoZSkge3ZhciBuLHQgPSBlLmV4cHJlc3Npb247cmV0dXJuICEodC5uYW1lIHx8IGUgaW5zdGFuY2VvZiBBU1RfTmV3ICYmIChuID0gITEsIHQud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3JldHVybiAhIW4gfHwgKGUgaW5zdGFuY2VvZiBBU1RfTmV3VGFyZ2V0ID8gbiA9ICEwIDogZSBpbnN0YW5jZW9mIEFTVF9TY29wZSAmJiBlICE9PSB0IHx8IHZvaWQgMCk7fSkpLCBuKSk7fWZ1bmN0aW9uIEVlKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgZS5kZWZpbml0aW9uKCkudW5kZWNsYXJlZDt9dmFyIHVlLF9lLFNlLHBlLGRlLEFlLFRlLHFlID0gbWFrZVByZWRpY2F0ZSgiQXJyYXkgQm9vbGVhbiBjbGVhckludGVydmFsIGNsZWFyVGltZW91dCBjb25zb2xlIERhdGUgZGVjb2RlVVJJIGRlY29kZVVSSUNvbXBvbmVudCBlbmNvZGVVUkkgZW5jb2RlVVJJQ29tcG9uZW50IEVycm9yIGVzY2FwZSBldmFsIEV2YWxFcnJvciBGdW5jdGlvbiBpc0Zpbml0ZSBpc05hTiBKU09OIE1hcCBNYXRoIE51bWJlciBwYXJzZUZsb2F0IHBhcnNlSW50IFJhbmdlRXJyb3IgUmVmZXJlbmNlRXJyb3IgUmVnRXhwIE9iamVjdCBTZXQgc2V0SW50ZXJ2YWwgc2V0VGltZW91dCBTdHJpbmcgU3ludGF4RXJyb3IgVHlwZUVycm9yIHVuZXNjYXBlIFVSSUVycm9yIFdlYWtNYXAgV2Vha1NldCIpO2Z1bmN0aW9uIGhlKGUpIHtyZXR1cm4gZS5zdGF0aWMgJiYgZS52YWx1ZSAmJiAoZSBpbnN0YW5jZW9mIEFTVF9DbGFzc0ZpZWxkIHx8IGUgaW5zdGFuY2VvZiBBU1RfQ2xhc3NJbml0KTt9ZnVuY3Rpb24gVyhlKSB7cmV0dXJuIGFsbChlLmRlZmluaXRpb25zLCBmdW5jdGlvbiAoZSkge3JldHVybiAhZS52YWx1ZTt9KTt9ZnVuY3Rpb24gRihlLCBuKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfRGVmQ2xhc3MgPyBuICYmICFlLmV4dGVuZHMgJiYgYWxsKGUucHJvcGVydGllcywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIShlLmtleSBpbnN0YW5jZW9mIEFTVF9Ob2RlIHx8IGhlKGUpKTt9KSA6IGUgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMgPyAobiB8fCBlIGluc3RhbmNlb2YgQVNUX1ZhcikgJiYgVyhlKSA6IGUgaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVjbGFyYXRpb24gfHwgZSBpbnN0YW5jZW9mIEFTVF9FeHBvcnREZWZhdWx0ID8gRihlLmJvZHksIG4pIDogZSBpbnN0YW5jZW9mIEFTVF9MYW1iZGFEZWZpbml0aW9uO31mdW5jdGlvbiB6ZShlLCBuKSB7dmFyIHQgPSBlLmxhc3RJbmRleE9mKG4pO2lmICh0IDwgMCkgcmV0dXJuICExO2ZvciAoOyArK3QgPCBlLmxlbmd0aDspIGlmICghRihlW3RdLCAhMCkpIHJldHVybiAhMTtyZXR1cm4gITA7fWZ1bmN0aW9uIFVlKGUsIG4pIHt2YXIgdDtpZiAoZS5pbml0IGluc3RhbmNlb2YgQVNUX0Jsb2NrU3RhdGVtZW50ICYmIChlLmluaXQgPSAodCA9IGUuaW5pdCkuYm9keS5wb3AoKSwgdC5ib2R5LnB1c2goZSkpLCBlLmluaXQgaW5zdGFuY2VvZiBBU1RfRGVmdW4gPyAoKHQgPSB0IHx8IGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgZSwgeyBib2R5OiBbZV0gfSkpLmJvZHkuc3BsaWNlKC0xLCAwLCBlLmluaXQpLCBlLmluaXQgPSBudWxsKSA6IGUuaW5pdCBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQgPyBlLmluaXQgPSBlLmluaXQuYm9keSA6IGVlKGUuaW5pdCkgJiYgKGUuaW5pdCA9IG51bGwpLCB0KSByZXR1cm4gbiA/IExpc3Quc3BsaWNlKHQuYm9keSkgOiB0O31mdW5jdGlvbiBtZShlLCBTKSB7dmFyIGRlLEFlLFRlLGhlLG1lLHZlLFIgPSBPKFMsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhO30pLG4gPSBTLnNlbGYoKSx0ID0gMDtkbyB7aWYgKCFkZSAmJiBuLnZhcmlhYmxlcyAmJiAoZGUgPSBuKSwgbiBpbnN0YW5jZW9mIEFTVF9DYXRjaCkgUy5wYXJlbnQodCkuYmZpbmFsbHkgJiYgKChtZSA9IG1lIHx8IHt9KS5iZmluYWxseSA9ICEwKSwgdCsrO2Vsc2UgaWYgKG4gaW5zdGFuY2VvZiBBU1RfRmluYWxseSkgdCsrO2Vsc2UgaWYgKG4gaW5zdGFuY2VvZiBBU1RfSXRlcmF0aW9uU3RhdGVtZW50KSBoZSA9ICEwO2Vsc2Uge2lmIChuIGluc3RhbmNlb2YgQVNUX1Njb3BlKSB7dmUgPSBuO2JyZWFrO31uIGluc3RhbmNlb2YgQVNUX1RyeSAmJiAobWUgPSBtZSB8fCB7fSwgbi5iY2F0Y2ggJiYgKG1lLmJjYXRjaCA9ICEwKSwgbi5iZmluYWxseSkgJiYgKG1lLmJmaW5hbGx5ID0gITApO319IHdoaWxlIChuID0gUy5wYXJlbnQodCsrKSk7dmFyIGkscixvID0gMTA7ZG8ge2lmIChyID0gaSwgaSA9IDAsICEoaSA9ICFmdW5jdGlvbiBlKG4pIHt2YXIgdCA9ICExLGkgPSBbXTtmb3IgKHZhciByID0gMDsgciA8IG4ubGVuZ3RoOykge3ZhciBvID0gbltyXTtpZiAobyBpbnN0YW5jZW9mIEFTVF9CbG9ja1N0YXRlbWVudCAmJiBhbGwoby5ib2R5LCBhZSkpIHQgPSAhMCwgZShvLmJvZHkpLCBbXS5zcGxpY2UuYXBwbHkobiwgW3IsIDFdLmNvbmNhdChvLmJvZHkpKSwgciArPSBvLmJvZHkubGVuZ3RoO2Vsc2Uge2lmIChvIGluc3RhbmNlb2YgQVNUX0RpcmVjdGl2ZSkge2lmIChtZW1iZXIoby52YWx1ZSwgaSkpIHt0ID0gITAsIG4uc3BsaWNlKHIsIDEpO2NvbnRpbnVlO31pLnB1c2goby52YWx1ZSk7fW8gaW5zdGFuY2VvZiBBU1RfRW1wdHlTdGF0ZW1lbnQgPyAodCA9ICEwLCBuLnNwbGljZShyLCAxKSkgOiByKys7fX1yZXR1cm4gdDt9KGUpID8gaSA6IDEpICYmIDEgPT0gcikgYnJlYWs7aWYgKFMub3B0aW9uKCJkZWFkX2NvZGUiKSAmJiAhKGkgPSAhZnVuY3Rpb24gKG4sIHQpIHt2YXIgZSxpID0gdC5zZWxmKCk7aSBpbnN0YW5jZW9mIEFTVF9DYXRjaCA/IGkgPSB0LnBhcmVudCgpIDogaSBpbnN0YW5jZW9mIEFTVF9MYWJlbGVkU3RhdGVtZW50ICYmIChpID0gaS5ib2R5KTtmb3IgKHZhciByID0gMCwgbyA9IDAsIGEgPSBuLmxlbmd0aDsgciA8IGE7IHIrKykge3ZhciBzLGYgPSBuW3JdO2lmICghKGYgaW5zdGFuY2VvZiBBU1RfTG9vcENvbnRyb2wpIHx8IGNlKHMgPSB0Lmxvb3Bjb250cm9sX3RhcmdldChmKSkgIT09IGkgfHwgZiBpbnN0YW5jZW9mIEFTVF9CcmVhayAmJiBzIGluc3RhbmNlb2YgQVNUX0l0ZXJhdGlvblN0YXRlbWVudCA/IG5bbysrXSA9IGYgOiBmLmxhYmVsICYmIHJlbW92ZShmLmxhYmVsLnRoZWRlZi5yZWZlcmVuY2VzLCBmKSwgcShmKSkge2UgPSBuLnNsaWNlKHIgKyAxKTticmVhazt9fW4ubGVuZ3RoID0gbywgZSAmJiBlLmZvckVhY2goZnVuY3Rpb24gKGUpIHtDKHQsIGUsIG4pO30pO3JldHVybiBuLmxlbmd0aCAhPSBhO30oZSwgUykgPyBpIDogMikgJiYgMiA9PSByKSBicmVhaztpZiAoUy5vcHRpb24oImlmX3JldHVybiIpICYmICEoaSA9ICFmdW5jdGlvbiAoYSwgaSkge2ZvciAodmFyIHIsIHMsIG8sIGYgPSAhMSwgYyA9IGkucGFyZW50KCksIGwgPSBpLnNlbGYoKSwgZSA9IFIgJiYgYyAmJiAiQ2FsbCIgPT0gYy5UWVBFICYmIGMuZXhwcmVzc2lvbiA9PT0gbCwgbiA9IFIgJiYgaS5vcHRpb24oImNvbmRpdGlvbmFscyIpICYmIGkub3B0aW9uKCJzZXF1ZW5jZXMiKSwgdSA9ICEobWUgJiYgbWUuYmZpbmFsbHkgJiYgQih2ZSkpLCB0ID0gZnVuY3Rpb24gKGUpIHtmb3IgKHZhciBuID0gMCwgdCA9IGUubGVuZ3RoOyAwIDw9IC0tdDspIHt2YXIgaSA9IGVbdF07aWYgKGkgaW5zdGFuY2VvZiBBU1RfSWYgJiYgaS5ib2R5IGluc3RhbmNlb2YgQVNUX1JldHVybiAmJiAxIDwgKytuKSByZXR1cm4gITA7fXJldHVybiAhMTt9KGEpLCBfID0gYS5sZW5ndGg7IDAgPD0gLS1fOykge3ZhciBTID0gYVtfXSxwID0gTihfKSxkID0gYVtwXTtpZiAoUiAmJiByICYmICFkICYmIFMgaW5zdGFuY2VvZiBBU1RfUmV0dXJuICYmIHUgJiYgIShsIGluc3RhbmNlb2YgQVNUX1N3aXRjaEJyYW5jaCkpIHtpZiAoIShtID0gUy52YWx1ZSkpIHtmID0gITAsIGEuc3BsaWNlKF8sIDEpO2NvbnRpbnVlO312YXIgQSA9IG0udGFpbF9ub2RlKCk7aWYgKENlKEEpKSB7ZiA9ICEwLCBtIGluc3RhbmNlb2YgQVNUX1VuYXJ5UHJlZml4ID8gbSA9IG0uZXhwcmVzc2lvbiA6IEEgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgKChtID0gbS5jbG9uZSgpKS5leHByZXNzaW9uc1ttLmV4cHJlc3Npb25zLmxlbmd0aCAtIDFdID0gQS5leHByZXNzaW9uKSwgYVtfXSA9IGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIFMsIHsgYm9keTogbSB9KTtjb250aW51ZTt9fWlmIChTIGluc3RhbmNlb2YgQVNUX0lmKSB7QSA9IHEoUy5ib2R5KTtpZiAoayhBKSkge0EubGFiZWwgJiYgcmVtb3ZlKEEubGFiZWwudGhlZGVmLnJlZmVyZW5jZXMsIEEpLCBmID0gITAsIChTID0gUy5jbG9uZSgpKS5ib2R5ID0ga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBTLCB7IGJvZHk6IEUoUy5ib2R5LCBBKSB9KSwgUy5hbHRlcm5hdGl2ZSA9IGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgUywgeyBib2R5OiBzZShTLmFsdGVybmF0aXZlKS5jb25jYXQodyhvLCBzKSkgfSksIEMoQS52YWx1ZSwgbyksIGFbX10gPSBTLCBhW19dID0gUy50cmFuc2Zvcm0oaSk7Y29udGludWU7fWlmIChBICYmICFTLmFsdGVybmF0aXZlICYmIGQgaW5zdGFuY2VvZiBBU1RfSnVtcCkge3ZhciBUID0gUy5jb25kaXRpb24saCA9IF8gKyAxID09IHAgJiYgUy5ib2R5IGluc3RhbmNlb2YgQVNUX0Jsb2NrU3RhdGVtZW50O2lmICgoVCA9IFkoVCwgVC5uZWdhdGUoaSksIGgpKSAhPT0gUy5jb25kaXRpb24pIHtmID0gITAsIChTID0gUy5jbG9uZSgpKS5jb25kaXRpb24gPSBUO3ZhciBtID0gUy5ib2R5O1MuYm9keSA9IGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgZCwgeyBib2R5OiB3KCEwLCBudWxsLCBwICsgMSkgfSksIGEuc3BsaWNlKF8sIDEsIFMsIG0pLCAoIVIgfHwgbCBpbnN0YW5jZW9mIEFTVF9CbG9jayAmJiBsLmJvZHkgPT09IGEpICYmIChhW19dID0gUy50cmFuc2Zvcm0oaSkpO2NvbnRpbnVlO319dmFyIHYsaCA9IHEoUy5hbHRlcm5hdGl2ZSk7aWYgKGsoaCkpIHtoLmxhYmVsICYmIHJlbW92ZShoLmxhYmVsLnRoZWRlZi5yZWZlcmVuY2VzLCBoKSwgZiA9ICEwLCAoUyA9IFMuY2xvbmUoKSkuYm9keSA9IGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgUy5ib2R5LCB7IGJvZHk6IHNlKFMuYm9keSkuY29uY2F0KHcobywgcykpIH0pLCBTLmFsdGVybmF0aXZlID0ga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBTLmFsdGVybmF0aXZlLCB7IGJvZHk6IEUoUy5hbHRlcm5hdGl2ZSwgaCkgfSksIEMoaC52YWx1ZSwgbyksIGFbX10gPSBTLCBhW19dID0gUy50cmFuc2Zvcm0oaSk7Y29udGludWU7fWkub3B0aW9uKCJ0eXBlb2ZzIikgJiYgKEEgJiYgIWggJiYgKHYgPSBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGwsIHsgYm9keTogYS5zbGljZShfICsgMSkgfSksIHooUy5jb25kaXRpb24sIG51bGwsIHYpKSwgIUEpICYmIGggJiYgKHYgPSBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGwsIHsgYm9keTogYS5zbGljZShfICsgMSkgfSksIHooUy5jb25kaXRpb24sIHYpKTt9aWYgKFMgaW5zdGFuY2VvZiBBU1RfSWYgJiYgUy5ib2R5IGluc3RhbmNlb2YgQVNUX1JldHVybikge3ZhciBUID0gUy5ib2R5LnZhbHVlLHkgPSBTLmJvZHkuaW5fYm9vbCB8fCBkIGluc3RhbmNlb2YgQVNUX1JldHVybiAmJiBkLmluX2Jvb2w7aWYgKCFTLmFsdGVybmF0aXZlICYmIGQgaW5zdGFuY2VvZiBBU1RfUmV0dXJuICYmICh1IHx8ICFUID09ICFkLnZhbHVlKSkge2YgPSAhMCwgKFMgPSBTLmNsb25lKCkpLmFsdGVybmF0aXZlID0ga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBkLCB7IGJvZHk6IHcoITAsIG51bGwsIHAgKyAxKSB9KSwgYVtfXSA9IFMsIGFbX10gPSBTLnRyYW5zZm9ybShpKTtjb250aW51ZTt9aWYgKFIgJiYgciAmJiAhZCAmJiAhUy5hbHRlcm5hdGl2ZSAmJiAoeSB8fCBUICYmIHQgfHwgVCBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCAmJiAoQ2UoVC5jb25zZXF1ZW50LCBpKSB8fCBDZShULmFsdGVybmF0aXZlLCBpKSkpKSB7ZiA9ICEwLCAoUyA9IFMuY2xvbmUoKSkuYWx0ZXJuYXRpdmUgPSBrZShBU1RfUmV0dXJuLCBTLCB7IHZhbHVlOiBudWxsIH0pLCBhW19dID0gUywgYVtfXSA9IFMudHJhbnNmb3JtKGkpO2NvbnRpbnVlO31pZiAobiAmJiAhUy5hbHRlcm5hdGl2ZSAmJiAoIShnID0gYVt5ID0gZnVuY3Rpb24gKGUpIHtmb3IgKHZhciBuID0gZTsgMCA8PSAtLW47KSB7dmFyIHQgPSBhW25dO2lmICghKHQgaW5zdGFuY2VvZiBBU1RfVmFyKSAmJiAhRih0KSkgYnJlYWs7fXJldHVybiBuO30oXyldKSAmJiBlIHx8IGcgaW5zdGFuY2VvZiBBU1RfSWYgJiYgZy5ib2R5IGluc3RhbmNlb2YgQVNUX1JldHVybikgJiYgKGQgPyBkIGluc3RhbmNlb2YgQVNUX1NpbXBsZVN0YXRlbWVudCAmJiBOKHApID09IGEubGVuZ3RoIDogIXIpKSB7ZiA9ICEwO3ZhciBnID0gW107UyA9IFMuY2xvbmUoKSwgZy5wdXNoKFMuY29uZGl0aW9uKSwgUy5jb25kaXRpb24gPSB3ZShTLCBnKSwgUy5hbHRlcm5hdGl2ZSA9IGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgbCwgeyBib2R5OiB3KCkuY29uY2F0KGtlKEFTVF9SZXR1cm4sIGwsIHsgdmFsdWU6IG51bGwgfSkpIH0pLCBhW19dID0gUy50cmFuc2Zvcm0oaSksIF8gPSB5ICsgMTtjb250aW51ZTt9fVMgaW5zdGFuY2VvZiBBU1RfQnJlYWsgfHwgUyBpbnN0YW5jZW9mIEFTVF9FeGl0ID8gcyA9IFMgOiByICYmIHMgJiYgcyA9PT0gZCAmJiBmdW5jdGlvbiBlKG4sIHQsIGkpIHtpZiAobiBpbnN0YW5jZW9mIEFTVF9FeGl0KSB7dmFyIHIgPSAhKHQgJiYgbiBpbnN0YW5jZW9mIEFTVF9UaHJvdykgJiYgeChuLCAhMCk7aWYgKHIpIHJldHVybiBmID0gITAsIChyID0gRChuLnZhbHVlLCByKSkgPyBrZShBU1RfU2ltcGxlU3RhdGVtZW50LCByLCB7IGJvZHk6IHIgfSkgOiBpID8gbnVsbCA6IGtlKEFTVF9FbXB0eVN0YXRlbWVudCwgbik7fSBlbHNlIHt2YXIgbztuIGluc3RhbmNlb2YgQVNUX0lmID8gKG4uYm9keSA9IGUobi5ib2R5LCB0KSwgbi5hbHRlcm5hdGl2ZSAmJiAobi5hbHRlcm5hdGl2ZSA9IGUobi5hbHRlcm5hdGl2ZSwgdCkpKSA6IG4gaW5zdGFuY2VvZiBBU1RfTGFiZWxlZFN0YXRlbWVudCA/IG4uYm9keSA9IGUobi5ib2R5LCB0KSA6IG4gaW5zdGFuY2VvZiBBU1RfVHJ5ID8gbi5iZmluYWxseSAmJiBzLnZhbHVlICYmICFzLnZhbHVlLmlzX2NvbnN0YW50KCkgfHwgKG4uYmNhdGNoICYmIGUobi5iY2F0Y2gsIHQpLCAobyA9IGUobi5ib2R5LnBvcCgpLCAhMCwgITApKSAmJiBuLmJvZHkucHVzaChvKSkgOiBuIGluc3RhbmNlb2YgQVNUX0Jsb2NrICYmICEobiBpbnN0YW5jZW9mIEFTVF9TY29wZSB8fCBuIGluc3RhbmNlb2YgQVNUX1N3aXRjaCkgJiYgKG8gPSBlKG4uYm9keS5wb3AoKSwgdCwgITApKSAmJiBuLmJvZHkucHVzaChvKTt9cmV0dXJuIG47fShTKTt9cmV0dXJuIGY7ZnVuY3Rpb24gYihuKSB7cmV0dXJuIE8oaSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSA9PT0gbjt9KTt9ZnVuY3Rpb24geChlLCBuKSB7dmFyIHQ7cmV0dXJuICEhcyAmJiBzLlRZUEUgPT0gZS5UWVBFICYmICEhKHQgPSBlLnZhbHVlKSAmJiAoIShlID0gIShlID0gcy5lcXVhbHMoZSkpICYmIHQgaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgJiYgKHQgPSB0LnRhaWxfbm9kZSgpLCBzLnZhbHVlKSAmJiBzLnZhbHVlLmVxdWFscyh0KSA/IDIgOiBlKSAmJiAhbiAmJiBzLnZhbHVlIGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlICYmIHMudmFsdWUudGFpbF9ub2RlKCkuZXF1YWxzKHQpID8gMyA6IGUpO31mdW5jdGlvbiBrKGUpIHtpZiAobyA9ICExLCBmdW5jdGlvbiAoZSkge2lmIChlIGluc3RhbmNlb2YgQVNUX0V4aXQpIHtpZiAoIShvID0geChlKSkpIHtpZiAoIVIpIHJldHVybjtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1JldHVybikpIHJldHVybjt2YXIgbiA9IGUudmFsdWU7aWYgKG4pIHtpZiAoIXUpIHJldHVybjtpZiAoIUNlKG4udGFpbF9ub2RlKCkpKSByZXR1cm47fWlmIChsIGluc3RhbmNlb2YgQVNUX1N3aXRjaEJyYW5jaCkge2lmICghcykgcmV0dXJuO2lmIChzIGluc3RhbmNlb2YgQVNUX0V4aXQgJiYgcy52YWx1ZSkgcmV0dXJuO28gPSA0O319cmV0dXJuIDE7fWlmIChlIGluc3RhbmNlb2YgQVNUX0xvb3BDb250cm9sKSB7aWYgKGwgaW5zdGFuY2VvZiBBU1RfU3dpdGNoQnJhbmNoKSBpZiAocyBpbnN0YW5jZW9mIEFTVF9FeGl0KSB7aWYgKCFSKSByZXR1cm47aWYgKHMudmFsdWUpIHJldHVybjtvID0gITA7fSBlbHNlIGlmIChzKSB7aWYgKGkubG9vcGNvbnRyb2xfdGFyZ2V0KHMpICE9PSBjKSByZXR1cm47byA9ICEwO30gZWxzZSBpZiAoITEgPT09IHMpIHJldHVybjtuID0gaS5sb29wY29udHJvbF90YXJnZXQoZSk7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfQ29udGludWUgPyBiKGNlKG4pKSA6ICEobiBpbnN0YW5jZW9mIEFTVF9JdGVyYXRpb25TdGF0ZW1lbnQpICYmIGIobik7fX0oZSkpIHtmb3IgKHZhciBuID0gYS5sZW5ndGg7IC0tbiA+IF87KSB7dmFyIHQgPSBhW25dO2lmICh0IGluc3RhbmNlb2YgQVNUX0RlZkNsYXNzKSB7aWYgKHQubmFtZS5kZWZpbml0aW9uKCkucHJlaW5pdCkgcmV0dXJuO30gZWxzZSBpZiAoKHQgaW5zdGFuY2VvZiBBU1RfQ29uc3QgfHwgdCBpbnN0YW5jZW9mIEFTVF9MZXQpICYmICFhbGwodC5kZWZpbml0aW9ucywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIWUubmFtZS5tYXRjaF9zeW1ib2woZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiAmJiBlLmRlZmluaXRpb24oKS5wcmVpbml0O30pO30pKSByZXR1cm47fXJldHVybiAxO319ZnVuY3Rpb24gdyhlLCBuLCB0KSB7dmFyIGkgPSBbXSxyID0gITEsbyA9IF8gKyAxLHQgPSAoZSA/IG4gPyB0ID0gYS5sYXN0SW5kZXhPZihuKSA6IChuID0gYVt0XSkgIT09IHMgJiYgKHMgPSAhMSkgOiAodCA9IGEubGVuZ3RoLCBzID0gbnVsbCksIGEuc3BsaWNlKG8sIHQgLSBvKS5maWx0ZXIoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9MYW1iZGFEZWZpbml0aW9uID8gKGkucHVzaChlKSwgITEpIDogKG9lKGUpICYmIChyID0gITApLCAhMCk7fSkpO3JldHVybiAzID09PSBlICYmICh0LnB1c2goa2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgbi52YWx1ZSwgeyBib2R5OiB3ZShuLnZhbHVlLCBuLnZhbHVlLmV4cHJlc3Npb25zLnNsaWNlKDAsIC0xKSkgfSkpLCBuLnZhbHVlID0gbi52YWx1ZS50YWlsX25vZGUoKSksIFtdLnB1c2guYXBwbHkociA/IHQgOiBhLCBpKSwgdDt9ZnVuY3Rpb24gRChlLCBuKSB7aWYgKGUpIHN3aXRjaCAobikge2Nhc2UgNDpyZXR1cm4gZTtjYXNlIDM6aWYgKCEoZSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSkpIGJyZWFrO2Nhc2UgMjpyZXR1cm4gd2UoZSwgZS5leHByZXNzaW9ucy5zbGljZSgwLCAtMSkpO319ZnVuY3Rpb24gRShlLCBuKSB7Zm9yICh2YXIgdCwgZSA9IHNlKGUpLCBpID0gZTsgKHQgPSBpW2kubGVuZ3RoIC0gMV0pICE9PSBuOykgaSA9IHQuYm9keTtpLnBvcCgpO3ZhciByID0gbi52YWx1ZTtyZXR1cm4gKHIgPSBvID8gRChyLCBvKSA6IHIpICYmIGkucHVzaChrZShBU1RfU2ltcGxlU3RhdGVtZW50LCByLCB7IGJvZHk6IHIgfSkpLCBlO31mdW5jdGlvbiBDKGUsIG4pIHtpZiAobiAmJiBlKSB7c3dpdGNoIChuKSB7Y2FzZSA0OnJldHVybjtjYXNlIDM6Y2FzZSAyOmUgPSBlLnRhaWxfbm9kZSgpO31QKGUsIHMudmFsdWUpO319ZnVuY3Rpb24gTihlKSB7ciA9ICEwO2ZvciAodmFyIG4gPSBlOyArK24gPCBhLmxlbmd0aDspIHt2YXIgdCA9IGFbbl07aWYgKCFGKHQpKSB7aWYgKCEodCBpbnN0YW5jZW9mIEFTVF9WYXIpKSBicmVhaztyID0gITE7fX1yZXR1cm4gbjt9fShlLCBTKSA/IGkgOiAzKSAmJiAzID09IHIpIGJyZWFrO2lmIChTLm9wdGlvbigiYXdhaXRzIikgJiYgUy5vcHRpb24oInNpZGVfZWZmZWN0cyIpICYmICEoaSA9ICFmdW5jdGlvbiAoZSwgbikge2lmICghKCFSIHx8IG1lICYmIG1lLmJmaW5hbGx5KSkge2ZvciAodmFyIHQgPSAhMSwgaSA9IGUubGVuZ3RoOyAwIDw9IC0taTspIHt2YXIgciA9IGVbaV07aWYgKCEociBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQpKSBicmVhazt2YXIgbyA9IHIuYm9keS50YWlsX25vZGUoKTtpZiAoIShvIGluc3RhbmNlb2YgQVNUX0F3YWl0KSkgYnJlYWs7byA9IG8uZXhwcmVzc2lvbjtpZiAoIWgobiwgbykpIGJyZWFrO2lmICh0ID0gITAsIG8gPSBvLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShuLCAhMCksIHIuYm9keSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSkge3ZhciBhID0gci5ib2R5LmV4cHJlc3Npb25zLnNsaWNlKCk7YS5wb3AoKSwgbyAmJiBhLnB1c2gobyksIHIuYm9keSA9IHdlKHIuYm9keSwgYSk7YnJlYWs7fWlmIChvKSB7ci5ib2R5ID0gbzticmVhazt9fXJldHVybiBlLmxlbmd0aCA9IGkgKyAxLCB0O319KGUsIFMpID8gaSA6IDQpICYmIDQgPT0gcikgYnJlYWs7aWYgKDQgPD0gUy5vcHRpb24oImlubGluZSIpICYmICEoaSA9ICFmdW5jdGlvbiAoZSwgbikge3ZhciB0ID0gITEsaSA9IGUubGVuZ3RoIC0gMTt7dmFyIHI7UiAmJiAwIDw9IGkgJiYgKHIgPSBtZSAmJiBtZS5iZmluYWxseSAmJiBCKHZlKSwgYSA9IGVbaV0udHJ5X2lubGluZShuLCBkZSwgcikpICYmIChlW2ktLV0gPSBhLCB0ID0gITApO31mb3IgKHZhciBvID0gaGUgJiYgbWUgJiYgbWUuYmZpbmFsbHkgPyAidHJ5IiA6IGhlOyAwIDw9IGk7IGktLSkge3ZhciBhOyhhID0gZVtpXS50cnlfaW5saW5lKG4sIGRlLCAhMCwgbykpICYmIChlW2ldID0gYSwgdCA9ICEwKTt9cmV0dXJuIHQ7fShlLCBTKSA/IGkgOiA1KSAmJiA1ID09IHIpIGJyZWFrO2lmICgwIDwgUy5zZXF1ZW5jZXNfbGltaXQpIHtpZiAoIShpID0gIWZ1bmN0aW9uIChuLCBlKSB7aWYgKCEobi5sZW5ndGggPCAyKSkge2ZvciAodmFyIHQgPSBbXSwgaSA9IDAsIHIgPSAwLCBvID0gbi5sZW5ndGg7IHIgPCBvOyByKyspIHt2YXIgYSA9IG5bcl07YSBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQgPyAodC5sZW5ndGggPj0gZS5zZXF1ZW5jZXNfbGltaXQgJiYgcygpLCByZSh0LCBhLmJvZHkpKSA6IChGKGEpIHx8IHMoKSwgbltpKytdID0gYSk7fXJldHVybiBzKCksIChuLmxlbmd0aCA9IGkpICE9IG87fWZ1bmN0aW9uIHMoKSB7dmFyIGU7dC5sZW5ndGggJiYgKGUgPSB3ZSh0WzBdLCB0KSwgbltpKytdID0ga2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgZSwgeyBib2R5OiBlIH0pLCB0ID0gW10pO319KGUsIFMpID8gaSA6IDYpICYmIDYgPT0gcikgYnJlYWs7aWYgKCEoaSA9ICFmdW5jdGlvbiAoZSwgbikge2ZvciAodmFyIHQsIGkgPSAhMSwgciA9IDAsIG8gPSAwOyBvIDwgZS5sZW5ndGg7IG8rKykge3ZhciBhLHMgPSBlW29dO2lmICh0ICYmIChzIGluc3RhbmNlb2YgQVNUX0V4aXQgPyAhcy52YWx1ZSAmJiBCKHZlKSB8fCAocy52YWx1ZSA9IF8ocy52YWx1ZSB8fCBrZShBU1RfVW5kZWZpbmVkLCBzKSkub3B0aW1pemUobikpIDogcyBpbnN0YW5jZW9mIEFTVF9Gb3IgPyBzLmluaXQgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMgfHwgKGEgPSAhMSwgdC5ib2R5LndhbGsobmV3IFRyZWVXYWxrZXIoZnVuY3Rpb24gKGUpIHtyZXR1cm4gISEoYSB8fCBlIGluc3RhbmNlb2YgQVNUX1Njb3BlKSB8fCAoZSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgImluIiA9PSBlLm9wZXJhdG9yID8gYSA9ICEwIDogdm9pZCAwKTt9KSksIGEpIHx8IChzLmluaXQgPyBzLmluaXQgPSBfKHMuaW5pdCkgOiAocy5pbml0ID0gdC5ib2R5LCByLS0sIGkgPSAhMCkpIDogcyBpbnN0YW5jZW9mIEFTVF9Gb3JJbiA/IG9lKHMuaW5pdCkgfHwgKHMub2JqZWN0ID0gXyhzLm9iamVjdCkpIDogcyBpbnN0YW5jZW9mIEFTVF9JZiA/IHMuY29uZGl0aW9uID0gXyhzLmNvbmRpdGlvbikgOiAocyBpbnN0YW5jZW9mIEFTVF9Td2l0Y2ggfHwgcyBpbnN0YW5jZW9mIEFTVF9XaXRoKSAmJiAocy5leHByZXNzaW9uID0gXyhzLmV4cHJlc3Npb24pKSksIG4ub3B0aW9uKCJjb25kaXRpb25hbHMiKSAmJiBzIGluc3RhbmNlb2YgQVNUX0lmKSB7dmFyIGYgPSBbXSxjID0gcChzLmJvZHksIGYpLGwgPSBwKHMuYWx0ZXJuYXRpdmUsIGYpO2lmICghMSAhPT0gYyAmJiAhMSAhPT0gbCAmJiAwIDwgZi5sZW5ndGgpIHt2YXIgdSA9IGYubGVuZ3RoO2YucHVzaChrZShBU1RfSWYsIHMsIHsgY29uZGl0aW9uOiBzLmNvbmRpdGlvbiwgYm9keTogYyB8fCBrZShBU1RfRW1wdHlTdGF0ZW1lbnQsIHMuYm9keSksIGFsdGVybmF0aXZlOiBsIH0pKSwgZi51bnNoaWZ0KHIsIDEpLCBbXS5zcGxpY2UuYXBwbHkoZSwgZiksIG8gKz0gdSwgciArPSB1ICsgMSwgaSA9ICEodCA9IG51bGwpO2NvbnRpbnVlO319ZVtyKytdID0gcywgdCA9IHMgaW5zdGFuY2VvZiBBU1RfU2ltcGxlU3RhdGVtZW50ID8gcyA6IG51bGw7fXJldHVybiBlLmxlbmd0aCA9IHIsIGk7ZnVuY3Rpb24gXyhlKSB7ci0tLCBpID0gITA7dmFyIG4gPSB0LmJvZHk7cmV0dXJuIHdlKG4sIFtuLCBlXSk7fX0oZSwgUykgPyBpIDogNykgJiYgNyA9PSByKSBicmVhazt9aWYgKFMub3B0aW9uKCJqb2luX3ZhcnMiKSAmJiAhKGkgPSAhZnVuY3Rpb24gKGUpIHtmb3IgKHZhciByLCBuLCBvID0gITEsIHQgPSAwLCBpID0gLTE7IHQgPCBlLmxlbmd0aDsgdCsrKSB7dmFyIGEscyxmLGMgPSBlW3RdLGwgPSBlW2ldO2lmIChjIGluc3RhbmNlb2YgQVNUX0RlZmluaXRpb25zKSBsICYmIGwuVFlQRSA9PSBjLlRZUEUgPyAobC5kZWZpbml0aW9ucyA9IGwuZGVmaW5pdGlvbnMuY29uY2F0KGMuZGVmaW5pdGlvbnMpLCBvID0gITApIDogYyAmJiBsIGluc3RhbmNlb2YgQVNUX0xldCAmJiBjLmNhbl9sZXRpZnkoUykgPyAobC5kZWZpbml0aW9ucyA9IGwuZGVmaW5pdGlvbnMuY29uY2F0KFBuKGMsIGRlKS5kZWZpbml0aW9ucyksIG8gPSAhMCkgOiBsICYmIGMgaW5zdGFuY2VvZiBBU1RfTGV0ICYmIGwuY2FuX2xldGlmeShTKSA/IChyID0gbiwgZVtpXSA9IGwgPSBQbihsLCBkZSksIGwuZGVmaW5pdGlvbnMgPSBsLmRlZmluaXRpb25zLmNvbmNhdChjLmRlZmluaXRpb25zKSwgbyA9ICEwKSA6IHIgJiYgci5UWVBFID09IGMuVFlQRSAmJiBXKGMpID8gKHIuZGVmaW5pdGlvbnMgPSByLmRlZmluaXRpb25zLmNvbmNhdChjLmRlZmluaXRpb25zKSwgbyA9ICEwKSA6IGMgaW5zdGFuY2VvZiBBU1RfVmFyID8gKChzID0gQShsLCBjKSkgPyAocy5sZW5ndGggJiYgKGwuYm9keSA9IHdlKGwsIHMpLCBpKyspLCBvID0gITApIDogaSsrLCBuID0gciwgZVtpXSA9IHIgPSBjKSA6IGVbKytpXSA9IGM7ZWxzZSB7aWYgKGMgaW5zdGFuY2VvZiBBU1RfRXhpdCkgYy52YWx1ZSA9IHUoYy52YWx1ZSk7ZWxzZSBpZiAoYyBpbnN0YW5jZW9mIEFTVF9Gb3IpIHtpZiAocyA9IGQobCwgYy5pbml0KSkgbyA9ICEwLCBjLmluaXQgPSBzLmxlbmd0aCA/IHdlKGMuaW5pdCwgcykgOiBudWxsO2Vsc2Uge2lmIChsIGluc3RhbmNlb2YgQVNUX1ZhciAmJiAoIWMuaW5pdCB8fCBjLmluaXQuVFlQRSA9PSBsLlRZUEUpKSB7Yy5pbml0ICYmIChsLmRlZmluaXRpb25zID0gbC5kZWZpbml0aW9ucy5jb25jYXQoYy5pbml0LmRlZmluaXRpb25zKSksIGMgPSBjLmNsb25lKCksIG4gPSByLCByID0gYy5pbml0ID0gbCwgZVtpXSA9IF8oYyksIG8gPSAhMDtjb250aW51ZTt9aWYgKHIgJiYgYy5pbml0ICYmIHIuVFlQRSA9PSBjLmluaXQuVFlQRSAmJiBXKGMuaW5pdCkpIHIuZGVmaW5pdGlvbnMgPSByLmRlZmluaXRpb25zLmNvbmNhdChjLmluaXQuZGVmaW5pdGlvbnMpLCBjLmluaXQgPSBudWxsLCBvID0gITA7ZWxzZSBpZiAoYy5pbml0IGluc3RhbmNlb2YgQVNUX1ZhciAmJiAobiA9IHIsIHIgPSBjLmluaXQsIHMgPSBBKGwsIGMuaW5pdCkpKSB7aWYgKG8gPSAhMCwgMCA9PSBzLmxlbmd0aCkge2VbaV0gPSBfKGMpO2NvbnRpbnVlO31sLmJvZHkgPSB3ZShsLCBzKTt9fX0gZWxzZSBpZiAoYyBpbnN0YW5jZW9mIEFTVF9Gb3JFbnVtZXJhdGlvbikgciAmJiByLlRZUEUgPT0gYy5pbml0LlRZUEUgJiYgKGEgPSByLmRlZmluaXRpb25zLnNsaWNlKCksIGMuaW5pdCA9IGMuaW5pdC5kZWZpbml0aW9uc1swXS5uYW1lLmNvbnZlcnRfc3ltYm9sKEFTVF9TeW1ib2xSZWYsIGZ1bmN0aW9uIChlLCBuKSB7YS5wdXNoKGtlKEFTVF9WYXJEZWYsIG4sIHsgbmFtZTogbiwgdmFsdWU6IG51bGwgfSkpLCBuLmRlZmluaXRpb24oKS5yZWZlcmVuY2VzLnB1c2goZSk7fSksIHIuZGVmaW5pdGlvbnMgPSBhLCBvID0gITApLCBjLm9iamVjdCA9IHUoYy5vYmplY3QpO2Vsc2UgaWYgKGMgaW5zdGFuY2VvZiBBU1RfSWYpIGMuY29uZGl0aW9uID0gdShjLmNvbmRpdGlvbik7ZWxzZSBpZiAoYyBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQpIHtpZiAocyA9IGQobCwgYy5ib2R5KSkge2lmIChvID0gITAsICFzLmxlbmd0aCkgY29udGludWU7Yy5ib2R5ID0gd2UoYy5ib2R5LCBzKTt9IGVsc2UgaWYgKGwgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMgJiYgKGYgPSBlW3QgKyAxXSkgJiYgbC5UWVBFID09IGYuVFlQRSAmJiAoZiA9IGYuZGVmaW5pdGlvbnNbMF0pLnZhbHVlKSB7byA9ICEwLCBmLnZhbHVlID0gd2UoYywgW2MuYm9keSwgZi52YWx1ZV0pO2NvbnRpbnVlO319IGVsc2UgKGMgaW5zdGFuY2VvZiBBU1RfU3dpdGNoIHx8IGMgaW5zdGFuY2VvZiBBU1RfV2l0aCkgJiYgKGMuZXhwcmVzc2lvbiA9IHUoYy5leHByZXNzaW9uKSk7ZVsrK2ldID0gciA/IF8oYykgOiBjO319cmV0dXJuIGUubGVuZ3RoID0gaSArIDEsIG87ZnVuY3Rpb24gdShlKSB7dmFyIG4gPSBkKGwsIGUsIDEpO2lmICghbikgcmV0dXJuIGU7byA9ICEwO3ZhciB0ID0gZS50YWlsX25vZGUoKTtyZXR1cm4gbltuLmxlbmd0aCAtIDFdICE9PSB0ICYmIG4ucHVzaCh0LmxlZnQpLCB3ZShlLCBuKTt9ZnVuY3Rpb24gXyhlKSB7cmV0dXJuIGUudHJhbnNmb3JtKG5ldyBUcmVlVHJhbnNmb3JtZXIoZnVuY3Rpb24gKGUsIG4sIHQpIHt2YXIgaTtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9EZWZpbml0aW9ucyA/IHIgIT09IGUgJiYgci5UWVBFID09IGUuVFlQRSAmJiAhKChpID0gdGhpcy5wYXJlbnQoKSkgaW5zdGFuY2VvZiBBU1RfRm9yRW51bWVyYXRpb24gJiYgaS5pbml0ID09PSBlKSAmJiBXKGUpID8gKHIuZGVmaW5pdGlvbnMgPSByLmRlZmluaXRpb25zLmNvbmNhdChlLmRlZmluaXRpb25zKSwgbyA9ICEwLCBpIGluc3RhbmNlb2YgQVNUX0ZvciAmJiBpLmluaXQgPT09IGUgPyBudWxsIDogdCA/IExpc3Quc2tpcCA6IGtlKEFTVF9FbXB0eVN0YXRlbWVudCwgZSkpIDogZSA6ICEoZSBpbnN0YW5jZW9mIEFTVF9FeHBvcnREZWNsYXJhdGlvbikgJiYgIShlIGluc3RhbmNlb2YgQVNUX1Njb3BlKSAmJiBpc19zdGF0ZW1lbnQoZSkgPyB2b2lkIDAgOiBlO30pKTt9fShlKSA/IGkgOiA4KSAmJiA4ID09IHIpIGJyZWFrOyFTLm9wdGlvbigiY29sbGFwc2VfdmFycyIpIHx8ICFmdW5jdGlvbiAoaSwgXykge2lmICghdmUucGlubmVkKCkpIHtmb3IgKHZhciBTLCB6LCBVID0gbmV3IERpY3Rpb25hcnkoKSwgcCA9IFtdLCBqID0gITEsIGQgPSBuZXcgRGljdGlvbmFyeSgpLCByID0gaS5sZW5ndGgsIGwgPSBuZXcgVHJlZVRyYW5zZm9ybWVyKGZ1bmN0aW9uIChlLCBuKSB7aWYgKEQpIHJldHVybiBlO2lmICghdykge2lmIChlID09PSBBW1RdKSB7aWYgKCsrVCA8IEEubGVuZ3RoKSByZXR1cm4gTyhlLCBsKTt3ID0gITAsICh1ID0gKGggPyBGIDogdGUpKGUsIDApKSA9PT0gZSAmJiAoRCA9ICEwKTt9cmV0dXJuIGU7fXZhciB0LGkscixvID0gbC5wYXJlbnQoKTtpZiAoIW0gJiYgZWUoZSwgbykgJiYgKG0gPSBvKSwgSSAmJiBWICYmIEMgJiYgIW0gJiYgZSBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gJiYgIj0iICE9IGUub3BlcmF0b3IgJiYgZS5sZWZ0LmVxdWFscyh2KSkgcmV0dXJuIEUrKywgaiA9ICEwLCBBU1RfTm9kZS5pbmZvKCJDYXNjYWRpbmcge3RoaXN9IFt7c3RhcnR9XSIsIGUpLCBDID0gITEsIGIgPSB1ZSh2KSwgZS5yaWdodC50cmFuc2Zvcm0obCksIGNlKHMpLCBpID0gRCA/IHMgOiAoRCA9ICEwLCBrZShBU1RfQmluYXJ5LCBzLCB7IG9wZXJhdG9yOiBJLCBsZWZ0OiB2LmZpeGVkICYmIHYuZGVmaW5pdGlvbigpLmZpeGVkID8gdi5maXhlZC50b19iaW5hcnkocykgOiB2LCByaWdodDogayB9KSksIGtlKEFTVF9Bc3NpZ24sIGUsIHsgb3BlcmF0b3I6ICI9IiwgbGVmdDogZS5sZWZ0LCByaWdodDoga2UoQVNUX0JpbmFyeSwgZSwgeyBvcGVyYXRvcjogZS5vcGVyYXRvci5zbGljZSgwLCAtMSksIGxlZnQ6IGksIHJpZ2h0OiBlLnJpZ2h0IH0pIH0pO2lmIChmdW5jdGlvbiAobiwgZSkge2lmIChuID09PSBrKSByZXR1cm4gMTtpZiAoZSBpbnN0YW5jZW9mIEFTVF9Gb3IgJiYgbiAhPT0gZS5pbml0KSByZXR1cm4gMTtpZiAobiBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24pIHJldHVybiAiPSIgIT0gbi5vcGVyYXRvciAmJiB2LmVxdWFscyhuLmxlZnQpO2lmIChuIGluc3RhbmNlb2YgQVNUX0Jsb2NrU3RhdGVtZW50KSByZXR1cm4gSyAmJiAhYWxsKEssIGZ1bmN0aW9uIChlKSB7cmV0dXJuIG4gIT09IGU7fSk7aWYgKG4gaW5zdGFuY2VvZiBBU1RfQ2FsbCkgcmV0dXJuIHYgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyAmJiB2LmVxdWFscyhuLmV4cHJlc3Npb24pICYmICghKGsgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRXhwcmVzc2lvbikgfHwgay5jb250YWluc190aGlzKCkpO3JldHVybiBuIGluc3RhbmNlb2YgQVNUX0NsYXNzID8gIV8uaGFzX2RpcmVjdGl2ZSgidXNlIHN0cmljdCIpIDogbiBpbnN0YW5jZW9mIEFTVF9EZWJ1Z2dlciB8fCAobiBpbnN0YW5jZW9mIEFTVF9EZWZ1biA/IE0gJiYgdi5uYW1lID09PSBuLm5hbWUubmFtZSA6IG4gaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkS2V5VmFsID8gbi5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSA6IG4gaW5zdGFuY2VvZiBBU1RfRFdMb29wIHx8IG4gaW5zdGFuY2VvZiBBU1RfTG9vcENvbnRyb2wgfHwgbiBpbnN0YW5jZW9mIEFTVF9UcnkgfHwgbiBpbnN0YW5jZW9mIEFTVF9XaXRoKTt9KGUsIG8pKSByZXR1cm4gRCA9ICEwLCBlO2lmIChlLnNpbmdsZV91c2UpIHJldHVybiBlO2lmIChlIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlY2xhcmF0aW9uIHx8ICEoViAmJiB2LmVxdWFscyhlKSB8fCBnICYmICh0ID0gZyhlLCB0aGlzKSkpKSByZXR1cm4gZnVuY3Rpb24gKGUsIG4pIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYpIHtpZiAoZS5pc19kZWNsYXJlZChfKSkge2lmIChlLmZpeGVkX3ZhbHVlKCkpIHJldHVybjtpZiAoYmUoZSkpIHJldHVybiAhKG4gaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyAmJiBuLmV4cHJlc3Npb24gPT09IGUpICYmIGdlKGUuZGVmaW5pdGlvbigpKTt9IGVsc2UgaWYgKFooZSwgbikpIHJldHVybjtpZiAoIVEpIHJldHVybiAxO2cgPSAhMTt9cmV0dXJuO30oZSwgbykgPyAoRCA9ICEwLCBlKSA6ICgobmUoZSwgbykgfHwgSChlKSkgJiYgKHUgPSBlKSBpbnN0YW5jZW9mIEFTVF9TY29wZSAmJiAoRCA9ICEwKSwgZSBpbnN0YW5jZW9mIEFTVF9BY2Nlc3NvciB8fCBlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCA/IChyID0gQywgQyA9ICExLCBuKGUsIGwpLCBDID0gciwgUihlKSkgOiBlIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSA/IChlLm5hbWUgPSBlLm5hbWUudHJhbnNmb3JtKGwpLCByID0gQywgQyA9ICExLCBlLnZhbHVlID0gZS52YWx1ZS50cmFuc2Zvcm0obCksIEMgPSByLCBSKGUpKSA6ICEoZSBpbnN0YW5jZW9mIEFTVF9CbG9ja1Njb3BlKSB8fCBlIGluc3RhbmNlb2YgQVNUX1Njb3BlIHx8IGUudmFyaWFibGVzICYmIGUudmFyaWFibGVzLmFsbChmdW5jdGlvbiAoZSkge3JldHVybiAhRy5oYXMoZS5uYW1lKSAmJiAhYi5oYXMoZS5uYW1lKTt9KSA/IE8oZSwgbCkgPyBSKGUpIDogdm9pZCAwIDogKHIgPSBDLCBDID0gITEsIE8oZSwgbCkgfHwgbihlLCBsKSwgQyA9IHIsIFIoZSkpKTtpZiAoIUMgfHwgbSAmJiAodCB8fCAhWCB8fCAhUSkpIHJldHVybiB0IHx8IGggfHwgKEQgPSAhMCksIGU7aWYgKGlzX2xocyhlLCBvKSkgcmV0dXJuIGggJiYgIXQgJiYgKGMgPSAhMCksIGU7aWYgKCF0ICYmIEwgJiYgZS5maXhlZCAhPT0gdi5maXhlZCkgcmV0dXJuIEQgPSAhMCwgZTtpZiAoaCkgcmV0dXJuIG0gJiYgMCA9PSBmICYmIChmID0gYSAtIEUpLCB0IHx8IEUrKywgZTtpZiAoRSsrLCBqID0gRCA9ICEwLCBBU1RfTm9kZS5pbmZvKCJDb2xsYXBzaW5nIHt0aGlzfSBbe3N0YXJ0fV0iLCBlKSwgIkJpbmFyeSIgPT0gcy5UWVBFKSByZXR1cm4gbGUocywgZSksIGtlKEFTVF9Bc3NpZ24sIHMsIHsgb3BlcmF0b3I6ICI9IiwgbGVmdDogcy5yaWdodC5sZWZ0LCByaWdodDoga2UoQVNUX0NvbmRpdGlvbmFsLCBzLCAiJiYiID09IHMub3BlcmF0b3IgPyB7IGNvbmRpdGlvbjogcy5sZWZ0LCBjb25zZXF1ZW50OiBzLnJpZ2h0LnJpZ2h0LCBhbHRlcm5hdGl2ZTogZSB9IDogeyBjb25kaXRpb246IHMubGVmdCwgY29uc2VxdWVudDogZSwgYWx0ZXJuYXRpdmU6IHMucmlnaHQucmlnaHQgfSkgfSk7aWYgKHMgaW5zdGFuY2VvZiBBU1RfVW5hcnlQb3N0Zml4KSByZXR1cm4ga2UoQVNUX1VuYXJ5UHJlZml4LCBzLCB7IG9wZXJhdG9yOiBzLm9wZXJhdG9yLCBleHByZXNzaW9uOiB2LmZpeGVkICYmIHYuZGVmaW5pdGlvbigpLmZpeGVkID8gdi5maXhlZC50b19wcmVmaXgocykgOiB2IH0pO2lmIChzIGluc3RhbmNlb2YgQVNUX1VuYXJ5UHJlZml4KSByZXR1cm4gY2UocyksIHM7aWYgKGxlKGssIGUpLCBzIGluc3RhbmNlb2YgQVNUX1ZhckRlZikgcmV0dXJuIChpID0gcy5uYW1lLmRlZmluaXRpb24oKSkucmVmZXJlbmNlcy5sZW5ndGggLSBpLnJlcGxhY2VkICE9IDEgfHwgXy5leHBvc2VkKGkpID8ga2UoQVNUX0Fzc2lnbiwgcywgeyBvcGVyYXRvcjogIj0iLCBsZWZ0OiBlLCByaWdodDogayB9KSA6IChpLnJlcGxhY2VkKyssIERlKG8sIGUsIGspKTtjZShrKTtuID0gcy5jbG9uZSgpO3JldHVybiBuLnJpZ2h0ID0gaywgbjt9LCBSKSwgbyA9IG5ldyBUcmVlVHJhbnNmb3JtZXIoZnVuY3Rpb24gKGUpIHtpZiAoRCkgcmV0dXJuIGU7aWYgKCF3KSB7aWYgKGUgIT09IEFbVF0pIHJldHVybiBlO3N3aXRjaCAoVCsrLCBBLmxlbmd0aCAtIFQpIHtjYXNlIDA6aWYgKHcgPSAhMCwgYykgcmV0dXJuIGU7aWYgKGUgIT09IHMpIHJldHVybiBlO2lmIChlIGluc3RhbmNlb2YgQVNUX1ZhckRlZikgcmV0dXJuIGU7Ti5yZXBsYWNlZCsrO3ZhciBuID0gby5wYXJlbnQoKTtyZXR1cm4gbiBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSAmJiBuLnRhaWxfbm9kZSgpICE9PSBlID8gKGgucmVwbGFjZWQrKywgayA9PT0geCA/IExpc3Quc2tpcCA6IHdlKHgsIHguZXhwcmVzc2lvbnMuc2xpY2UoMCwgLTEpKSkgOiBrO2Nhc2UgMTppZiAoIWMgJiYgZS5ib2R5ID09PSBzKSByZXR1cm4gdyA9ICEwLCBOLnJlcGxhY2VkKyssIGgucmVwbGFjZWQrKywgbnVsbDtkZWZhdWx0OnJldHVybiBPKGUsIG8pO319aWYgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIGUuZGVmaW5pdGlvbigpID09PSBOKSB7aWYgKGlzX2xocyhlLCBvLnBhcmVudCgpKSkgcmV0dXJuIGU7LS1FIHx8IChEID0gITApLCBBU1RfTm9kZS5pbmZvKCJSZXBsYWNpbmcge3RoaXN9IFt7c3RhcnR9XSIsIGUpO3ZhciB0ID0gay5jbG9uZSgpO3JldHVybiAodC5zY29wZSA9IGUuc2NvcGUsIHQucmVmZXJlbmNlKCksIEUgPT0gZikgPyAoRCA9ICEwLCBrZShBU1RfQXNzaWduLCBzLCB7IG9wZXJhdG9yOiAiPSIsIGxlZnQ6IGUsIHJpZ2h0OiB0IH0pKSA6IChOLnJlcGxhY2VkKyssIHQpO31yZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0IHx8IGUgaW5zdGFuY2VvZiBBU1RfU2NvcGUgPyBlIDogdm9pZCAwO30sIGZ1bmN0aW9uIChlKSB7cmV0dXJuIF9lKGUsIG8pO30pOyAwIDw9IC0tcjspIHswID09IHIgJiYgXy5vcHRpb24oInVudXNlZCIpICYmICFmdW5jdGlvbiAoKSB7aWYgKCExICE9PSBUZSkge3ZhciBlID0gXy5wYXJlbnQoKSxpID0gXy5zZWxmKCk7aWYgKHZvaWQgMCA9PT0gVGUpIHtpZiAoIShpIGluc3RhbmNlb2YgQVNUX0xhbWJkYUV4cHJlc3Npb24pIHx8IGlzX2dlbmVyYXRvcihpKSB8fCBpLnVzZXNfYXJndW1lbnRzIHx8IGkucGlubmVkKCkgfHwgIShlIGluc3RhbmNlb2YgQVNUX0NhbGwpIHx8IGUuZXhwcmVzc2lvbiAhPT0gaSB8fCAhYWxsKGUuYXJncywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX1NwcmVhZCk7fSkpIHJldHVybiBUZSA9ICExO2lmICghRmUoZSkpIHJldHVybjtUZSA9ICEwO31mb3IgKHZhciByLCBvID0gaS5pbl9zdHJpY3RfbW9kZShfKSAmJiAhaS5wYXJlbnRfc2NvcGUucmVzb2x2ZSghMCkuaW5fc3RyaWN0X21vZGUoXyksIGEgPSAoaXNfYXN5bmMoaSkgPyAociA9IGZ1bmN0aW9uIHIoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbCAmJiAiYXdhaXQiID09IGUubmFtZTt9LCBBZSA9ICEwKSA6IChyID0gZnVuY3Rpb24gcihlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfQXdhaXQgJiYgIW4uZmluZF9wYXJlbnQoQVNUX1Njb3BlKTt9LCB2b2lkIDAgPT09IEFlICYmIChBZSA9IEJlKF8sIDEsIGUsIG51bGwsICEwLCAhMCkpKSwgbnVsbCksIG4gPSBuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSwgbikge3ZhciB0O3JldHVybiAhbCB8fCAocihlKSB8fCBlIGluc3RhbmNlb2YgQVNUX1lpZWxkID8gIShsID0gbnVsbCkgOiBlIGluc3RhbmNlb2YgQVNUX09iamVjdElkZW50aXR5ID8gKCFvICYmIGEgfHwgKGwgPSBudWxsKSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyAoKGUuaW5fYXJnICYmICFPbihlLmRlZmluaXRpb24oKSkgfHwgKHQgPSBpLnZhcmlhYmxlcy5nZXQoZS5uYW1lKSkgJiYgdCAhPT0gZS5kZWZpbml0aW9uKCkpICYmIChsID0gbnVsbCksICEwKSA6IGUgaW5zdGFuY2VvZiBBU1RfU2NvcGUgJiYgIWlzX2Fycm93KGUpID8gKHQgPSBhLCBhID0gZSwgbigpLCBhID0gdCwgITApIDogdm9pZCAwKTt9KSwgdCA9IChTID0gZS5hcmdzLnNsaWNlKCkpLmxlbmd0aCwgcyA9IG5ldyBEaWN0aW9uYXJ5KCksIGYgPSBpLmFyZ25hbWVzLmxlbmd0aDsgMCA8PSAtLWY7KSB7dmFyIGMgPSBpLmFyZ25hbWVzW2ZdLGwgPSBTW2ZdLHUgPSBudWxsO2lmIChjIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSAmJiAodSA9IGMudmFsdWUsIGMgPSBjLm5hbWUsIFNbdCArIGZdID0gdSksIGMgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkKSB7aWYgKEFlICYmIEIoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZS5oYXNfc2lkZV9lZmZlY3RzKF8pO30sIGMsIGwpKSB7cC5sZW5ndGggPSAwO2JyZWFrO31TW3QgKyBmXSA9IGkuYXJnbmFtZXNbZl07fSBlbHNlIHMuaGFzKGMubmFtZSkgfHwgKHMuc2V0KGMubmFtZSwgITApLCAobCA9IHUgPyBDZShsKSA/IHUgOiBudWxsIDogbCkgfHwgdSA/IGwgaW5zdGFuY2VvZiBBU1RfTGFtYmRhICYmIGwucGlubmVkKCkgPyBsID0gbnVsbCA6IGwgJiYgbC53YWxrKG4pIDogbCA9IGtlKEFTVF9VbmRlZmluZWQsIGMpLnRyYW5zZm9ybShfKSwgbCAmJiAoKGMgPSBrZShBU1RfVmFyRGVmLCBjLCB7IG5hbWU6IGMsIHZhbHVlOiBsIH0pKS5uYW1lX2luZGV4ID0gZiwgYy5hcmdfaW5kZXggPSB1ID8gdCArIGYgOiBmLCBwLnVuc2hpZnQoW2NdKSkpO31pLnJlc3QgJiYgUy5wdXNoKGkucmVzdCk7fX0oKTt2YXIgQSA9IFtdO2ZvciAoUChpW3JdKTsgMCA8IHAubGVuZ3RoOykge0EgPSBwLnBvcCgpO3ZhciBhLFQgPSAwLHMgPSBBW0EubGVuZ3RoIC0gMV0sZiA9IC0xLGMgPSAhMSxMID0gITEsaCA9IG51bGwsdSA9IG51bGwsbSA9IG51bGwsdiA9IGZ1bmN0aW9uIChuKSB7aWYgKG4gaW5zdGFuY2VvZiBBU1RfQXNzaWduKSByZXR1cm4gKHQgPSBuLmxlZnQpIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiAoaSA9IHQuZGVmaW5pdGlvbigpLCB2ZS51c2VzX2FyZ3VtZW50cyAmJiBpc19mdW5hcmcoaSkgfHwgXy5leHBvc2VkKGkpIHx8IChhID0gYWUoaSksIGkuZml4ZWQgJiYgdC5maXhlZCAmJiAoZSA9IGkucmVmZXJlbmNlcy5maWx0ZXIoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZS5maXhlZCA9PT0gdC5maXhlZDt9KS5sZW5ndGggLSAxKSA8IGEgJiYgKGEgPSBlLCBMID0gIShmID0gMCkpLCAiPSIgPT0gbi5vcGVyYXRvciAmJiBvZShuLnJpZ2h0KSkpLCB0O2lmIChuIGluc3RhbmNlb2YgQVNUX0JpbmFyeSkgcmV0dXJuIG4ucmlnaHQubGVmdDtpZiAobiBpbnN0YW5jZW9mIEFTVF9VbmFyeSkgcmV0dXJuIG4uZXhwcmVzc2lvbjtpZiAobiBpbnN0YW5jZW9mIEFTVF9WYXJEZWYpIHt2YXIgdCxlLGkgPSAodCA9IG4ubmFtZSkuZGVmaW5pdGlvbigpO2lmICghaS5jb25zdF9yZWRlZnMpIGlmIChtZW1iZXIodCwgaS5vcmlnKSkgaWYgKCF2ZS51c2VzX2FyZ3VtZW50cyB8fCAhaXNfZnVuYXJnKGkpKSByZXR1cm4gZSA9IGkub3JpZy5sZW5ndGggLSBpLmVsaW1pbmF0ZWQgLSAoZC5nZXQoaS5uYW1lKSB8fCAwKSwgYSA9IGFlKGkpLCBpLmZpeGVkICYmIChhID0gTWF0aC5taW4oYSwgaS5yZWZlcmVuY2VzLmZpbHRlcihmdW5jdGlvbiAoZSkge3JldHVybiAhZS5maXhlZCB8fCAhZS5maXhlZC5hc3NpZ25zIHx8IChlID0gZS5maXhlZC5hc3NpZ25zWzBdKSA9PT0gdCB8fCBzZShlKSA9PT0gbi52YWx1ZTt9KS5sZW5ndGgpKSwgMSA8IGUgJiYgISh0IGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZykgPyAob2Uobi52YWx1ZSksIGtlKEFTVF9TeW1ib2xSZWYsIHQpKSA6IG9lKG4udmFsdWUpIHx8IDEgPT0gYSAmJiAhXy5leHBvc2VkKGkpID8ga2UoQVNUX1N5bWJvbFJlZiwgdCkgOiB2b2lkIDA7fX0ocykseSA9IHYgJiYgdi5oYXNfc2lkZV9lZmZlY3RzKF8pLFYgPSB2ICYmICgheSB8fCB2IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikgJiYgIVBlKHYsIF8pLGcgPSBmdW5jdGlvbiAobikge2lmICghKG4gaW5zdGFuY2VvZiBBU1RfQXNzaWduICYmIG4ucmlnaHQuc2luZ2xlX3VzZSkpIHtmb3IgKHZhciB0LCBpID0gT2JqZWN0LmNyZWF0ZShudWxsKSwgZSA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7ZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgKGlbZS5kZWZpbml0aW9uKCkuaWRdID0gITApO30pOyBuIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiAmJiAiPSIgPT0gbi5vcGVyYXRvcjspIG4ubGVmdC53YWxrKGUpLCBuID0gbi5yaWdodDtpZiAobiBpbnN0YW5jZW9mIEFTVF9PYmplY3RJZGVudGl0eSkgcmV0dXJuIG87aWYgKG4gaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmKSByZXR1cm4gKHIgPSBuLmV2YWx1YXRlKF8pKSA9PT0gbiA/IG8gOiBmZShyLCBvKTtpZiAobi5pc190cnV0aHkoKSkgcmV0dXJuIGZlKCEwLCByZXR1cm5fZmFsc2UpO2lmIChuLmlzX2NvbnN0YW50KCkpIHt2YXIgciA9IG4uZXZhbHVhdGUoXyk7aWYgKCEociBpbnN0YW5jZW9mIEFTVF9Ob2RlKSkgcmV0dXJuIGZlKHIsIG8pO31yZXR1cm4gdiBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyAhIWZ1bmN0aW9uIGUobikge2lmIChuIGluc3RhbmNlb2YgQVNUX0FycmF5KSByZXR1cm4gITE7aWYgKG4gaW5zdGFuY2VvZiBBU1RfQmluYXJ5ICYmIE5lW24ub3BlcmF0b3JdKSByZXR1cm4gZShuLmxlZnQpICYmIGUobi5yaWdodCk7aWYgKG4gaW5zdGFuY2VvZiBBU1RfQ2FsbCkgcmV0dXJuICExO2lmIChuIGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsKSByZXR1cm4gZShuLmNvbnNlcXVlbnQpICYmIGUobi5hbHRlcm5hdGl2ZSk7aWYgKG4gaW5zdGFuY2VvZiBBU1RfT2JqZWN0KSByZXR1cm4gITE7cmV0dXJuICFuLmhhc19zaWRlX2VmZmVjdHMoXyk7fShuKSAmJiAobi53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7aWYgKHQpIHJldHVybiAhMDtlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiBpW2UuZGVmaW5pdGlvbigpLmlkXSAmJiAodCA9ICEwKTt9KSksICF0KSAmJiBvIDogITE7fWZ1bmN0aW9uIG8oZSkge3JldHVybiBuLmVxdWFscyhlKTt9fShzKTtpZiAoViB8fCBnKSB7dmFyIEkgPSBzIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiAmJiBzLm9wZXJhdG9yLnNsaWNlKDAsIC0xKSxNID0gcy5uYW1lIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZyxIID0gcmV0dXJuX2ZhbHNlO2lmIChzLm1heV90aHJvdyhfKSkge2lmIChNICYmIGlzX2FzeW5jKHZlKSkgY29udGludWU7SCA9IG1lID8gZnVuY3Rpb24gKGUpIHtyZXR1cm4gZS5oYXNfc2lkZV9lZmZlY3RzKF8pO30gOiB0O312YXIgVyA9ICExLFkgPSAhMSxLID0gZnVuY3Rpb24gKGUpIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiB8fCBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiB8fCBlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCkge3ZhciBuID0gW107aWYgKGUubWFya19zeW1ib2woZnVuY3Rpb24gKGUpIHt2YXIgdCwgaTtlIGluc3RhbmNlb2YgQVNUX1N5bWJvbCAmJiAoZSA9IGUuZGVmaW5pdGlvbigpLCB0ID0gZS5zY29wZS5yZXNvbHZlKCksIGkgPSAhMSwgZSA9IGUub3JpZy5yZWR1Y2UoZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gbiBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWZ1biA/IG4uc2NvcGUgIT09IHQgJiYgcHVzaF91bmlxKGUsIG4uc2NvcGUpIDogaSA9ICEwLCBlO30sIFtdKSwgaSkgJiYgZS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7cHVzaF91bmlxKG4sIGUpO30pO30pLCAwICE9IG4ubGVuZ3RoKSByZXR1cm4gbjt9fSh2KSxHID0gbmV3IERpY3Rpb25hcnkoKSwkID0gITAsYiA9IHVlKHMpLFggPSBmdW5jdGlvbiAoZSkge3ZhciBuID0gcm9vdF9leHByKGUpO3JldHVybiBuIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiBuLmRlZmluaXRpb24oKS5zY29wZS5yZXNvbHZlKCkgPT09IHZlICYmICghaGUgfHwgIUkgJiYgIShzIGluc3RhbmNlb2YgQVNUX1VuYXJ5IHx8IChuID0gYi5nZXQobi5uYW1lKSkgJiYgblswXSAhPT0gZSkpO30odikseCA9IHNlKHMpLGsgPSB4LEogPSAoeSB8fCAoIUkgJiYgayBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSAmJiAoayA9IGsudGFpbF9ub2RlKCkpLCB5ID0gIShzIGluc3RhbmNlb2YgQVNUX1VuYXJ5KSAmJiBrLmhhc19zaWRlX2VmZmVjdHMoXykpLCBtZSB8fCAhWCA/IGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkO30gOiByZXR1cm5fZmFsc2UpLFEgPSBmdW5jdGlvbiAoZSkge2lmIChlIGluc3RhbmNlb2YgQVNUX1VuYXJ5KSByZXR1cm4gITE7aWYgKHkpIHJldHVybiAhMTtpZiAoIWgpIHtpZiAoISh2IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikpIHJldHVybiAhMTt2YXIgbjtpZiAoZSBpbnN0YW5jZW9mIEFTVF9WYXJEZWYpIG4gPSAxO2Vsc2Uge2lmICgiPSIgIT0gZS5vcGVyYXRvcikgcmV0dXJuICExO24gPSAyO31lID0gdi5kZWZpbml0aW9uKCk7aWYgKGUucmVmZXJlbmNlcy5sZW5ndGggLSBlLnJlcGxhY2VkICE9IG4pIHtpZiAoIWUuZml4ZWQpIHJldHVybiAhMTtpZiAoIXYuZml4ZWQpIHJldHVybiAhMTt2YXIgdCA9IHYuZml4ZWQuYXNzaWducyxpID0gMDtpZiAoIWFsbChlLnJlZmVyZW5jZXMsIGZ1bmN0aW9uIChlLCBuKSB7ZSA9IGUuZml4ZWQ7cmV0dXJuICEhZSAmJiAhZS50b19iaW5hcnkgJiYgIWUudG9fcHJlZml4ICYmIChlID09PSB2LmZpeGVkID8gKGkrKywgITApIDogdCAmJiBlLmFzc2lnbnMgJiYgdFswXSAhPT0gZS5hc3NpZ25zWzBdKTt9KSkgcmV0dXJuICExO2lmIChpICE9IG4pIHJldHVybiAhMTtMID0gITA7fX1yZXR1cm4gITA7fShzKSx3ID0gTSxEID0gITEsRSA9IDAsQyA9ICFTIHx8ICF3O2lmICghQykge2ZvciAodmFyIG4gPSBzLmFyZ19pbmRleCArIDE7ICFEICYmIG4gPCBTLmxlbmd0aDsgbisrKSBTW25dICYmIFNbbl0udHJhbnNmb3JtKGwpO0MgPSAhMDt9Zm9yICh2YXIgZSA9IHI7ICFEICYmIGUgPCBpLmxlbmd0aDsgZSsrKSBpW2VdLnRyYW5zZm9ybShsKTtpZiAoaCkge2lmICghRSB8fCBFICsgYyA8IGEpIHtwLnB1c2goQSksIHogPSAhMDtjb250aW51ZTt9RSA9PSBmICYmIChjID0gITApO3ZhciBOID0gdi5kZWZpbml0aW9uKCk7RCA9ICExLCBUID0gMCwgdyA9IE07Zm9yIChlID0gcjsgIUQgJiYgZSA8IGkubGVuZ3RoOyBlKyspIGlbZV0udHJhbnNmb3JtKG8pIHx8IGkuc3BsaWNlKGUtLSwgMSk7RSA9IHMgaW5zdGFuY2VvZiBBU1RfVmFyRGVmICYmIHMgPT09IEFbQS5sZW5ndGggLSAxXSAmJiBOLnJlZmVyZW5jZXMubGVuZ3RoID09IE4ucmVwbGFjZWQgJiYgIV8uZXhwb3NlZChOKSwgaC5sYXN0X3JlZiA9ICExLCBoLnNpbmdsZV91c2UgPSAhMSwgaiA9ICEwO31FICYmICFmdW5jdGlvbiAoZSkge3ZhciBuLHQsZixjLGwsdSA9IGsgPT09IHggPyBudWxsIDogd2UoeCwgeC5leHByZXNzaW9ucy5zbGljZSgwLCAtMSkpLGUgPSBlLm5hbWVfaW5kZXg7MCA8PSBlID8gKHQgPSB2ZS5hcmduYW1lc1tlXSkgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdFZhbHVlID8gKHZlLmFyZ25hbWVzW2VdID0gdCA9IHQuY2xvbmUoKSwgdC52YWx1ZSA9IHUgfHwga2UoQVNUX051bWJlciwgdCwgeyB2YWx1ZTogMCB9KSkgOiAobiA9IF8ucGFyZW50KCkuYXJncylbZV0gJiYgKHZlLmFyZ25hbWVzW2VdID0gdC5jbG9uZSgpLCBuW2VdID0gdSB8fCBrZShBU1RfTnVtYmVyLCBuW2VdLCB7IHZhbHVlOiAwIH0pKSA6IChmID0gQS5sZW5ndGggLSAxLCBjID0gQVtmXSwgKGMgaW5zdGFuY2VvZiBBU1RfVmFyRGVmIHx8IEFbZiAtIDFdLmJvZHkgPT09IGMpICYmIGYtLSwgbCA9IG5ldyBUcmVlVHJhbnNmb3JtZXIoZnVuY3Rpb24gKGUsIG4sIHQpIHt2YXIgaSwgciwgbywgYSwgcztyZXR1cm4gdyB8fCBlICE9PSBBW1RdID8gZSA6ICsrVCA8PSBmID8gTyhlLCBsKSA6ICh3ID0gITAsIGUgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMgPyAoZC5zZXQoYy5uYW1lLm5hbWUsIChkLmdldChjLm5hbWUubmFtZSkgfHwgMCkgKyAxKSwgaCAmJiBoLnJlcGxhY2VkKyssIHIgPSAoaSA9IGUuZGVmaW5pdGlvbnMpLmluZGV4T2YoYyksIChvID0gYy5jbG9uZSgpKS52YWx1ZSA9IG51bGwsIHUgPyAoYSA9IFtrZShBU1RfU2ltcGxlU3RhdGVtZW50LCB1LCB7IGJvZHk6IHUgfSldLCAwIDwgciAmJiAoKHMgPSBlLmNsb25lKCkpLmRlZmluaXRpb25zID0gaS5zbGljZSgwLCByKSwgYS51bnNoaWZ0KHMpLCAoZSA9IGUuY2xvbmUoKSkuZGVmaW5pdGlvbnMgPSBpLnNsaWNlKHIpKSwgYS5wdXNoKGUpLCBlLmRlZmluaXRpb25zWzBdID0gbywgdCA/IExpc3Quc3BsaWNlKGEpIDoga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBlLCB7IGJvZHk6IGEgfSkpIDogKGUuZGVmaW5pdGlvbnNbcl0gPSBvLCBlKSkgOiB1ID8gaXNfc3RhdGVtZW50KGUpID8ga2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgdSwgeyBib2R5OiB1IH0pIDogdSA6IHQgPyBMaXN0LnNraXAgOiBudWxsKTt9LCBmdW5jdGlvbiAoZSwgbikge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0ZvciA/IFVlKGUsIG4pIDogX2UoZSwgbCk7fSksIHcgPSBEID0gITEsIFQgPSAwLCAoaVtyXSA9IGlbcl0udHJhbnNmb3JtKGwpKSB8fCBpLnNwbGljZShyLCAxKSk7fShzKTt9fX1yZXR1cm4gajt9ZnVuY3Rpb24gUihlKSB7cmV0dXJuIEQgfHwgKHUgPT09IGUgJiYgKEQgPSAhMCksIG0gPT09IGUgJiYgKG0gPSBudWxsKSksIGU7fWZ1bmN0aW9uIE8oZSwgbikge2lmIChlIGluc3RhbmNlb2YgQVNUX0Jsb2NrU2NvcGUpIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9TY29wZSkgcmV0dXJuIGU7aWYgKGUgaW5zdGFuY2VvZiBBU1RfQ2xhc3MpIHtmb3IgKHZhciB0ID0gQywgaSA9IChDID0gITEsIGUubmFtZSAmJiBlLm5hbWUudHJhbnNmb3JtKG4pLCAhRCAmJiBlLmV4dGVuZHMgJiYgZS5leHRlbmRzLnRyYW5zZm9ybShuKSwgW10pLCByID0gW10sIG8gPSAwOyAhRCAmJiBvIDwgZS5wcm9wZXJ0aWVzLmxlbmd0aDsgbysrKSB7dmFyIGEgPSBlLnByb3BlcnRpZXNbb107YS5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiAoYS5rZXkgPSBhLmtleS50cmFuc2Zvcm0obikpLCBhLnN0YXRpYyAmJiAoYSBpbnN0YW5jZW9mIEFTVF9DbGFzc0ZpZWxkID8gYS52YWx1ZSAmJiBpLnB1c2goYSkgOiBhIGluc3RhbmNlb2YgQVNUX0NsYXNzSW5pdCAmJiBbXS5wdXNoLmFwcGx5KHIsIGEudmFsdWUuYm9keSkpO31mb3IgKG8gPSAwOyAhRCAmJiBvIDwgci5sZW5ndGg7IG8rKykgcltvXS50cmFuc2Zvcm0obik7Zm9yIChvID0gMDsgIUQgJiYgbyA8IGkubGVuZ3RoOyBvKyspIGlbb10udmFsdWUudHJhbnNmb3JtKG4pO3JldHVybiBDID0gdCwgZTt9aWYgKGUgaW5zdGFuY2VvZiBBU1RfRm9yRW51bWVyYXRpb24pIHJldHVybiBlLm9iamVjdCA9IGUub2JqZWN0LnRyYW5zZm9ybShuKSwgRCA9ICEwLCBlO2lmIChlIGluc3RhbmNlb2YgQVNUX1N3aXRjaCkge2UuZXhwcmVzc2lvbiA9IGUuZXhwcmVzc2lvbi50cmFuc2Zvcm0obik7Zm9yIChvID0gMDsgIUQgJiYgbyA8IGUuYm9keS5sZW5ndGg7IG8rKykge3ZhciBzID0gZS5ib2R5W29dO2lmIChzIGluc3RhbmNlb2YgQVNUX0Nhc2UpIHtpZiAoIXcpIHtpZiAocyAhPT0gQVtUXSkgY29udGludWU7VCsrO31pZiAocy5leHByZXNzaW9uID0gcy5leHByZXNzaW9uLnRyYW5zZm9ybShuKSwgIVEgfHwgTCkgYnJlYWs7ZyA9ICExO319cmV0dXJuIEQgPSAhMCwgZTt9fX1mdW5jdGlvbiBaKGUsIG4pIHtyZXR1cm4gbiBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gPyAiPSIgPT0gbi5vcGVyYXRvciAmJiBuLmxlZnQgPT09IGUgOiBuIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSA/IG4ubmFtZSA9PT0gZSA6IG4gaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkQXJyYXkgfHwgbiBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwgJiYgbi52YWx1ZSA9PT0gZTt9ZnVuY3Rpb24gZWUoZSwgbikge3JldHVybiBuIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiA/IG4ubGVmdCAhPT0gZSAmJiBOZVtuLm9wZXJhdG9yLnNsaWNlKDAsIC0xKV0gOiBuIGluc3RhbmNlb2YgQVNUX0JpbmFyeSA/IG4ubGVmdCAhPT0gZSAmJiBOZVtuLm9wZXJhdG9yXSA6IG4gaW5zdGFuY2VvZiBBU1RfQ2FsbCA/IG4ub3B0aW9uYWwgJiYgbi5leHByZXNzaW9uICE9PSBlIDogbiBpbnN0YW5jZW9mIEFTVF9DYXNlID8gbi5leHByZXNzaW9uICE9PSBlIDogbiBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCB8fCBuIGluc3RhbmNlb2YgQVNUX0lmID8gbi5jb25kaXRpb24gIT09IGUgOiBuIGluc3RhbmNlb2YgQVNUX1N1YiAmJiBuLm9wdGlvbmFsICYmIG4uZXhwcmVzc2lvbiAhPT0gZTt9ZnVuY3Rpb24gbmUoZSwgbikge2lmIChlIGluc3RhbmNlb2YgQVNUX0F3YWl0KSByZXR1cm4gMTtpZiAoIkJpbmFyeSIgPT0gZS5UWVBFKSByZXR1cm4gIUduKGUsIF8pO2lmIChlIGluc3RhbmNlb2YgQVNUX0NhbGwpIHt2YXIgdCA9IGUuZXhwcmVzc2lvbjtpZiAodCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgKGYgPSB0LmRlZmluaXRpb24oKSwgdCA9IHQuZml4ZWRfdmFsdWUoKSksICEodCBpbnN0YW5jZW9mIEFTVF9MYW1iZGEpKSByZXR1cm4gIWUuaXNfZXhwcl9wdXJlKF8pO2lmICghZiB8fCAhUW4oXywgZiwgdCkpIHtpZiAodC5jb2xsYXBzZV9zY2FubmluZykgcmV0dXJuO3QuY29sbGFwc2Vfc2Nhbm5pbmcgPSAhMDtmb3IgKHZhciBpID0gQywgciA9IChDID0gITEsIHUpLCBvID0gbSwgYSA9IDA7ICFEICYmIGEgPCB0LmFyZ25hbWVzLmxlbmd0aDsgYSsrKSBCKGMsIHQuYXJnbmFtZXNbYV0sIGUuYXJnc1thXSkgJiYgKEQgPSAhMCk7aWYgKCFEKSBpZiAodC5yZXN0ICYmIEIoYywgdC5yZXN0LCBrZShBU1RfQXJyYXksIGUsIHsgZWxlbWVudHM6IGUuYXJncy5zbGljZShhKSB9KSkpIEQgPSAhMDtlbHNlIGlmIChpc19hcnJvdyh0KSAmJiB0LnZhbHVlKSB0LnZhbHVlLnRyYW5zZm9ybShsKTtlbHNlIGZvciAoYSA9IDA7ICFEICYmIGEgPCB0LmJvZHkubGVuZ3RoOyBhKyspIHt2YXIgcyA9IHQuYm9keVthXTtpZiAocyBpbnN0YW5jZW9mIEFTVF9SZXR1cm4pIHtzLnZhbHVlICYmIHMudmFsdWUudHJhbnNmb3JtKGwpO2JyZWFrO31zLnRyYW5zZm9ybShsKTt9aWYgKG0gPSBvLCB1ID0gciwgQyA9IGksIHQuY29sbGFwc2Vfc2Nhbm5pbmcgPSAhMSwgIUQpIHJldHVybjtEID0gITE7fXJldHVybiAxO312YXIgZjtpZiAoZSBpbnN0YW5jZW9mIEFTVF9DbGFzcykgcmV0dXJuIG1lICYmIChvID0gZS5leHRlbmRzKSAmJiAhUmUobyA9IG8gaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmID8gby5maXhlZF92YWx1ZSgpIDogbyk7aWYgKGUgaW5zdGFuY2VvZiBBU1RfRXhpdCkge2lmIChtZSkge2lmIChtZS5iZmluYWxseSkgcmV0dXJuIDE7aWYgKG1lLmJjYXRjaCAmJiBlIGluc3RhbmNlb2YgQVNUX1Rocm93KSByZXR1cm4gMTt9cmV0dXJuIHkgfHwgdiBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzIHx8IHBlKHYpO31pZiAoZSBpbnN0YW5jZW9mIEFTVF9GdW5jdGlvbikgcmV0dXJuIF8ub3B0aW9uKCJpZSIpICYmIGUubmFtZSAmJiBiLmhhcyhlLm5hbWUubmFtZSk7aWYgKGUgaW5zdGFuY2VvZiBBU1RfT2JqZWN0SWRlbnRpdHkpIHJldHVybiBTZShlKTtpZiAoZSBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzKSB7ciA9IGUuZXhwcmVzc2lvbjtpZiAoXy5vcHRpb24oInVuc2FmZSIpKSB7aWYgKEVlKHIpICYmIHFlW3IubmFtZV0pIHJldHVybjtpZiAobm4ocikpIHJldHVybjt9cmV0dXJuIHIgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIGdlKHIuZGVmaW5pdGlvbigpKSA/IDEgOiB5IHx8ICEkIHx8ICFoICYmIChtZSB8fCAhWCkgJiYgIWUub3B0aW9uYWwgJiYgci5tYXlfdGhyb3dfb25fYWNjZXNzKF8pO31yZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQgfHwgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmID8gKCFFZShlKSB8fCAhZS5pc19kZWNsYXJlZChfKSkgJiYgKFNlKGUpID8gIVooZSwgbikgOiB5ICYmIHBlKGUpIHx8IChmID0gZS5kZWZpbml0aW9uKCksIChtZSB8fCBmLnNjb3BlLnJlc29sdmUoKSAhPT0gdmUpICYmICFiZShlKSkpIDogZSBpbnN0YW5jZW9mIEFTVF9UZW1wbGF0ZSA/ICFlLmlzX2V4cHJfcHVyZShfKSA6IGUgaW5zdGFuY2VvZiBBU1RfVmFyRGVmID8gSihlLm5hbWUpIHx8IChlLnZhbHVlIHx8IG4gaW5zdGFuY2VvZiBBU1RfTGV0KSAmJiBlLm5hbWUubWF0Y2hfc3ltYm9sKGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRGVjbGFyYXRpb24gJiYgKGIuaGFzKGUubmFtZSkgfHwgeSAmJiBwZShlKSk7fSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9ZaWVsZCB8fCAoaSA9IGlzX2xocyhlLmxlZnQsIGUpKSAmJiAoaSBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzIHx8IEooaSkgfHwgaS5tYXRjaF9zeW1ib2woZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzIHx8IChlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IGIuaGFzKGUubmFtZSkgfHwgVyAmJiBfLmV4cG9zZWQoZS5kZWZpbml0aW9uKCkpIDogdm9pZCAwKTt9LCAhMCkpKTtmdW5jdGlvbiBjKGUpIHtyZXR1cm4gZS50cmFuc2Zvcm0obCksIEQ7fX1mdW5jdGlvbiBCKHQsIGUsIGkpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgPyB0KGUudmFsdWUpIHx8IEIodCwgZS5uYW1lLCBlLnZhbHVlKSB8fCAhQ2UoaSkgJiYgQih0LCBlLm5hbWUsIGkpIDogaSA/IGUgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkID8gISghZS5yZXN0IHx8ICFCKHQsIGUucmVzdCkpIHx8IChlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZEFycmF5ID8gaSBpbnN0YW5jZW9mIEFTVF9BcnJheSA/ICFhbGwoZS5lbGVtZW50cywgZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gIUIodCwgZSwgaVtuXSk7fSkgOiAhaS5pc19zdHJpbmcoXykgfHwgIWFsbChlLmVsZW1lbnRzLCBmdW5jdGlvbiAoZSkge3JldHVybiAhQih0LCBlKTt9KSA6IGUgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkT2JqZWN0ID8gISFpLm1heV90aHJvd19vbl9hY2Nlc3MoXykgfHwgIWFsbChlLnByb3BlcnRpZXMsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICEoZS5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiB0KGUua2V5KSB8fCBCKHQsIGUudmFsdWUpKTt9KSA6IHZvaWQgMCkgOiB2b2lkIDAgOiAhKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sKTt9ZnVuY3Rpb24gUChlLCBuKSB7dmFyIHQsIGk7QS5wdXNoKGUpLCBlIGluc3RhbmNlb2YgQVNUX0FycmF5ID8gZS5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7UChlLCBuKTt9KSA6IGUgaW5zdGFuY2VvZiBBU1RfQXNzaWduID8gKChpID0gZS5sZWZ0KSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQgfHwgcC5wdXNoKEEuc2xpY2UoKSksIFAoaSksIFAoZS5yaWdodCksIGkgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmICI9IiA9PSBlLm9wZXJhdG9yICYmIFUuc2V0KGkubmFtZSwgKFUuZ2V0KGkubmFtZSkgfHwgMCkgKyAxKSkgOiBlIGluc3RhbmNlb2YgQVNUX0F3YWl0ID8gUChlLmV4cHJlc3Npb24sIG4pIDogZSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgPyAoaSA9IE5lW2Uub3BlcmF0b3JdLCBuICYmIGkgJiYgIj8/IiAhPSBlLm9wZXJhdG9yICYmIGUucmlnaHQgaW5zdGFuY2VvZiBBU1RfQXNzaWduICYmICI9IiA9PSBlLnJpZ2h0Lm9wZXJhdG9yICYmICEoZS5yaWdodC5sZWZ0IGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCkgJiYgcC5wdXNoKEEuc2xpY2UoKSksIFAoZS5sZWZ0LCAhaSAmJiBuKSwgUChlLnJpZ2h0LCBuKSkgOiBlIGluc3RhbmNlb2YgQVNUX0NhbGwgPyAoUChlLmV4cHJlc3Npb24pLCBlLmFyZ3MuZm9yRWFjaChQKSkgOiBlIGluc3RhbmNlb2YgQVNUX0Nhc2UgPyBQKGUuZXhwcmVzc2lvbikgOiBlIGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsID8gKFAoZS5jb25kaXRpb24pLCBQKGUuY29uc2VxdWVudCwgbiksIFAoZS5hbHRlcm5hdGl2ZSwgbikpIDogZSBpbnN0YW5jZW9mIEFTVF9EZWZpbml0aW9ucyA/IGUuZGVmaW5pdGlvbnMuZm9yRWFjaChQKSA6IGUgaW5zdGFuY2VvZiBBU1RfRG90ID8gUChlLmV4cHJlc3Npb24pIDogZSBpbnN0YW5jZW9mIEFTVF9EV0xvb3AgPyAoUChlLmNvbmRpdGlvbiksIGUuYm9keSBpbnN0YW5jZW9mIEFTVF9CbG9jayB8fCBQKGUuYm9keSkpIDogZSBpbnN0YW5jZW9mIEFTVF9FeGl0ID8gZS52YWx1ZSAmJiBQKGUudmFsdWUpIDogZSBpbnN0YW5jZW9mIEFTVF9Gb3IgPyAoZS5pbml0ICYmIFAoZS5pbml0LCAhMCksIGUuY29uZGl0aW9uICYmIFAoZS5jb25kaXRpb24pLCBlLnN0ZXAgJiYgUChlLnN0ZXAsICEwKSwgZS5ib2R5IGluc3RhbmNlb2YgQVNUX0Jsb2NrIHx8IFAoZS5ib2R5KSkgOiBlIGluc3RhbmNlb2YgQVNUX0ZvckVudW1lcmF0aW9uID8gKFAoZS5vYmplY3QpLCBlLmJvZHkgaW5zdGFuY2VvZiBBU1RfQmxvY2sgfHwgUChlLmJvZHkpKSA6IGUgaW5zdGFuY2VvZiBBU1RfSWYgPyAoUChlLmNvbmRpdGlvbiksIGUuYm9keSBpbnN0YW5jZW9mIEFTVF9CbG9jayB8fCBQKGUuYm9keSksICFlLmFsdGVybmF0aXZlIHx8IGUuYWx0ZXJuYXRpdmUgaW5zdGFuY2VvZiBBU1RfQmxvY2sgfHwgUChlLmFsdGVybmF0aXZlKSkgOiBlIGluc3RhbmNlb2YgQVNUX09iamVjdCA/IGUucHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7QS5wdXNoKGUpLCBlLmtleSBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmIFAoZS5rZXkpLCBlIGluc3RhbmNlb2YgQVNUX09iamVjdEtleVZhbCAmJiBQKGUudmFsdWUsIG4pLCBBLnBvcCgpO30pIDogZSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSA/ICh0ID0gZS5leHByZXNzaW9ucy5sZW5ndGggLSAobiA/IDAgOiAxKSwgZS5leHByZXNzaW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlLCBuKSB7UChlLCBuIDwgdCk7fSkpIDogZSBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQgPyBQKGUuYm9keSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQgPyBQKGUuZXhwcmVzc2lvbikgOiBlIGluc3RhbmNlb2YgQVNUX1N1YiA/IChQKGUuZXhwcmVzc2lvbiksIFAoZS5wcm9wZXJ0eSkpIDogZSBpbnN0YW5jZW9mIEFTVF9Td2l0Y2ggPyAoUChlLmV4cHJlc3Npb24pLCBlLmJvZHkuZm9yRWFjaChQKSkgOiBlIGluc3RhbmNlb2YgQVNUX1VuYXJ5ID8gVU5BUllfUE9TVEZJWFtlLm9wZXJhdG9yXSA/IHAucHVzaChBLnNsaWNlKCkpIDogUChlLmV4cHJlc3Npb24pIDogZSBpbnN0YW5jZW9mIEFTVF9WYXJEZWYgPyAoZS5uYW1lIGluc3RhbmNlb2YgQVNUX1N5bWJvbFZhciAmJiAoZS52YWx1ZSA/IChpID0gZS5uYW1lLmRlZmluaXRpb24oKSkucmVmZXJlbmNlcy5sZW5ndGggPiBpLnJlcGxhY2VkICYmIHAucHVzaChBLnNsaWNlKCkpIDogZC5zZXQoZS5uYW1lLm5hbWUsIChkLmdldChlLm5hbWUubmFtZSkgfHwgMCkgKyAxKSksIGUudmFsdWUgJiYgUChlLnZhbHVlKSkgOiBlIGluc3RhbmNlb2YgQVNUX1lpZWxkICYmIGUuZXhwcmVzc2lvbiAmJiBQKGUuZXhwcmVzc2lvbiksIEEucG9wKCk7fWZ1bmN0aW9uIHRlKGUsIG4pIHt2YXIgdCA9IGwucGFyZW50KG4pO3JldHVybiB0IGluc3RhbmNlb2YgQVNUX0FycmF5IHx8IHQgaW5zdGFuY2VvZiBBU1RfQXNzaWduIHx8IHQgaW5zdGFuY2VvZiBBU1RfQXdhaXQgfHwgdCBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgfHwgdCBpbnN0YW5jZW9mIEFTVF9DYWxsIHx8IHQgaW5zdGFuY2VvZiBBU1RfQ2FzZSB8fCB0IGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsID8gZSA6IHQgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMgPyBxKHQsIG4gKyAxKSA6IHQgaW5zdGFuY2VvZiBBU1RfRXhpdCB8fCB0IGluc3RhbmNlb2YgQVNUX0lmIHx8IHQgaW5zdGFuY2VvZiBBU1RfSXRlcmF0aW9uU3RhdGVtZW50IHx8IHQgaW5zdGFuY2VvZiBBU1RfT2JqZWN0UHJvcGVydHkgfHwgdCBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzID8gZSA6IHQgaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgPyAodC50YWlsX25vZGUoKSA9PT0gZSA/IHRlIDogcSkodCwgbiArIDEpIDogdCBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQgPyBxKHQsIG4gKyAxKSA6IHQgaW5zdGFuY2VvZiBBU1RfU3ByZWFkIHx8IHQgaW5zdGFuY2VvZiBBU1RfU3dpdGNoIHx8IHQgaW5zdGFuY2VvZiBBU1RfVW5hcnkgfHwgdCBpbnN0YW5jZW9mIEFTVF9WYXJEZWYgfHwgdCBpbnN0YW5jZW9mIEFTVF9ZaWVsZCA/IGUgOiBudWxsO31mdW5jdGlvbiBpZShlLCBuLCB0KSB7Zm9yICh2YXIgaTsgaSA9IGUsIChlID0gbC5wYXJlbnQoKyt0KSkgaW5zdGFuY2VvZiBBU1RfQXNzaWduICYmIGUub3BlcmF0b3Iuc2xpY2UoMCwgLTEpID09IG4gfHwgZSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgZS5vcGVyYXRvciA9PSBuOyk7cmV0dXJuIGk7fWZ1bmN0aW9uIHJlKGUsIG4sIHQsIGksIHIpIHt2YXIgbyA9IEMsYSA9IChDID0gITEsIHUpLHMgPSBtLGYgPSBsLnN0YWNrO3JldHVybiBsLnN0YWNrID0gW2ldLCBlLnRyYW5zZm9ybShsKSwgbC5zdGFjayA9IGYsIG0gPSBzLCB1ID0gYSwgQyA9IG8sIEQgPyAoRCA9ICExLCB0KSA6IG4oaSwgciArIDEpO31mdW5jdGlvbiBGKGUsIG4pIHt2YXIgdCxpID0gbC5wYXJlbnQobik7cmV0dXJuIGkgaW5zdGFuY2VvZiBBU1RfQXJyYXkgPyBGKGksIG4gKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfQXNzaWduID8gSChpKSB8fCBpLmxlZnQubWF0Y2hfc3ltYm9sKGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmICh2Lm5hbWUgPT0gZS5uYW1lIHx8IGgubmFtZSA9PSBlLm5hbWUpO30pID8gZSA6IGkubGVmdCAhPT0gZSAmJiBOZVt0ID0gaS5vcGVyYXRvci5zbGljZSgwLCAtMSldID8gaWUoaSwgdCwgbikgOiBGKGksIG4gKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfQXdhaXQgPyBGKGksIG4gKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfQmluYXJ5ID8gaS5sZWZ0ICE9PSBlICYmIE5lW3QgPSBpLm9wZXJhdG9yXSA/IGllKGksIHQsIG4pIDogRihpLCBuICsgMSkgOiBpIGluc3RhbmNlb2YgQVNUX0NhbGwgPyBpIDogaSBpbnN0YW5jZW9mIEFTVF9DYXNlID8gaS5leHByZXNzaW9uICE9PSBlID8gZSA6IEYoaSwgbiArIDEpIDogaSBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCA/IGkuY29uZGl0aW9uICE9PSBlID8gZSA6IEYoaSwgbiArIDEpIDogaSBpbnN0YW5jZW9mIEFTVF9EZWZpbml0aW9ucyA/IHEoaSwgbiArIDEpIDogaSBpbnN0YW5jZW9mIEFTVF9EbyA/IGUgOiBpIGluc3RhbmNlb2YgQVNUX0V4aXQgPyBxKGksIG4gKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfRm9yID8gaS5pbml0ICE9PSBlICYmIGkuY29uZGl0aW9uICE9PSBlID8gZSA6IEYoaSwgbiArIDEpIDogaSBpbnN0YW5jZW9mIEFTVF9Gb3JFbnVtZXJhdGlvbiA/IGkuaW5pdCAhPT0gZSA/IGUgOiBGKGksIG4gKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfSWYgPyBpLmNvbmRpdGlvbiAhPT0gZSA/IGUgOiBGKGksIG4gKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfT2JqZWN0UHJvcGVydHkgPyAodCA9IGwucGFyZW50KG4gKyAxKSwgYWxsKHQucHJvcGVydGllcywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9PYmplY3RLZXlWYWw7fSkgPyBGKHQsIG4gKyAyKSA6IHQpIDogaSBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzID8gaS5leHByZXNzaW9uID09PSBlID8gRihpLCBuICsgMSkgOiBlIDogaSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSA/IChpLnRhaWxfbm9kZSgpID09PSBlID8gRiA6IHEpKGksIG4gKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfU2ltcGxlU3RhdGVtZW50ID8gcShpLCBuICsgMSkgOiBpIGluc3RhbmNlb2YgQVNUX1NwcmVhZCA/IEYoaSwgbiArIDEpIDogaSBpbnN0YW5jZW9mIEFTVF9Td2l0Y2ggPyBpLmV4cHJlc3Npb24gIT09IGUgPyBlIDogRihpLCBuICsgMSkgOiBpIGluc3RhbmNlb2YgQVNUX1VuYXJ5ID8gImRlbGV0ZSIgPT0gaS5vcGVyYXRvciA/IGUgOiBGKGksIG4gKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfVmFyRGVmID8gaS5uYW1lLm1hdGNoX3N5bWJvbChmdW5jdGlvbiAoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlY2xhcmF0aW9uICYmICh2Lm5hbWUgPT0gZS5uYW1lIHx8IGgubmFtZSA9PSBlLm5hbWUpO30pID8gZSA6IEYoaSwgbiArIDEpIDogaSBpbnN0YW5jZW9mIEFTVF9XaGlsZSA/IGkuY29uZGl0aW9uICE9PSBlID8gZSA6IEYoaSwgbiArIDEpIDogaSBpbnN0YW5jZW9mIEFTVF9ZaWVsZCA/IEYoaSwgbiArIDEpIDogbnVsbDt9ZnVuY3Rpb24gcShuLCB0KSB7dmFyIGUsaSA9IGwucGFyZW50KHQpO3JldHVybiBuZShuLCBpKSB8fCBlZShuLCBpKSA/IG4gOiBpIGluc3RhbmNlb2YgQVNUX0FycmF5ID8gcShpLCB0ICsgMSkgOiBpIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiA/IHIoaS5sZWZ0KSA6IGkgaW5zdGFuY2VvZiBBU1RfQXdhaXQgPyBuIDogaSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgfHwgaSBpbnN0YW5jZW9mIEFTVF9DYWxsIHx8IGkgaW5zdGFuY2VvZiBBU1RfQ2FzZSB8fCBpIGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsIHx8IGkgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMgfHwgaSBpbnN0YW5jZW9mIEFTVF9FeGl0IHx8IGkgaW5zdGFuY2VvZiBBU1RfSWYgPyBxKGksIHQgKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfSXRlcmF0aW9uU3RhdGVtZW50ID8gbiA6IGkgaW5zdGFuY2VvZiBBU1RfT2JqZWN0UHJvcGVydHkgPyAoZSA9IGwucGFyZW50KHQgKyAxKSwgYWxsKGUucHJvcGVydGllcywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9PYmplY3RLZXlWYWw7fSkgPyBxKGUsIHQgKyAyKSA6IGUpIDogaSBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzID8gKGUgPSBpLmV4cHJlc3Npb24pID09PSBuID8gcShpLCB0ICsgMSkgOiByZShlLCBxLCBuLCBpLCB0KSA6IGkgaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgfHwgaSBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQgPyBxKGksIHQgKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfU3ByZWFkID8gbiA6IGkgaW5zdGFuY2VvZiBBU1RfU3dpdGNoIHx8IGkgaW5zdGFuY2VvZiBBU1RfVW5hcnkgPyBxKGksIHQgKyAxKSA6IGkgaW5zdGFuY2VvZiBBU1RfVmFyRGVmID8gcihpLm5hbWUpIDogaSBpbnN0YW5jZW9mIEFTVF9ZaWVsZCA/IG4gOiBudWxsO2Z1bmN0aW9uIHIoZSkge3JldHVybiBIKGkpID8gbiA6IGUgIT09IG4gJiYgZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQgPyByZShlLCBxLCBuLCBpLCB0KSA6IHEoaSwgdCArIDEpO319ZnVuY3Rpb24gb2UoZSkge2lmICh6KSB6ID0gITE7ZWxzZSBpZiAoIShhIDwgMSkpIHt2YXIgbiA9IChlID0gZS50YWlsX25vZGUoKSkgaW5zdGFuY2VvZiBBU1RfQXNzaWduICYmICI9IiA9PSBlLm9wZXJhdG9yID8gZS5sZWZ0IDogZTtpZiAobiBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYpIHt2YXIgdCA9IG4uZGVmaW5pdGlvbigpO2lmICghdC51bmRlY2xhcmVkICYmICFnZSh0KSkge2lmIChuICE9PSBlKSB7aWYgKFBlKG4sIF8pKSByZXR1cm47aWYgKHQucmVmZXJlbmNlcy5sZW5ndGggLSB0LnJlcGxhY2VkIDwgMikgcmV0dXJuO2UgPSBzLmNsb25lKCk7ZVtlIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiA/ICJyaWdodCIgOiAidmFsdWUiXSA9IG4sIDAgPD0gcy5uYW1lX2luZGV4ICYmIChlLm5hbWVfaW5kZXggPSBzLm5hbWVfaW5kZXgsIGUuYXJnX2luZGV4ID0gcy5hcmdfaW5kZXgpLCBzID0gZTt9cmV0dXJuIGggPSB0O319fX1mdW5jdGlvbiBhZShlKSB7cmV0dXJuIGUucmVmZXJlbmNlcy5sZW5ndGggLSBlLnJlcGxhY2VkIC0gKFUuZ2V0KGUubmFtZSkgfHwgMCk7fWZ1bmN0aW9uIHNlKGUpIHt2YXIgbjtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gPyBlLnJpZ2h0IDogZSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgPyAoKG4gPSBlLmNsb25lKCkpLnJpZ2h0ID0gZS5yaWdodC5yaWdodCwgbikgOiBlIGluc3RhbmNlb2YgQVNUX1ZhckRlZiA/IGUudmFsdWUgOiB2b2lkIDA7fWZ1bmN0aW9uIGZlKHQsIGkpIHtyZXR1cm4gZnVuY3Rpb24gKGUsIG4pIHtpZiAobi5pbl9ib29sZWFuX2NvbnRleHQoKSkge2lmICh0ICYmIGUuaXNfdHJ1dGh5KCkgJiYgIWUuaGFzX3NpZGVfZWZmZWN0cyhfKSkgcmV0dXJuICEwO2lmIChlLmlzX2NvbnN0YW50KCkpIHtuID0gZS5ldmFsdWF0ZShfKTtpZiAoIShuIGluc3RhbmNlb2YgQVNUX05vZGUpKSByZXR1cm4gIW4gPT0gIXQ7fX1yZXR1cm4gaShlKTt9O31mdW5jdGlvbiBjZShlKSB7Zm9yICg7IGUud3JpdGVfb25seSAmJiAoZS53cml0ZV9vbmx5ID0gITEsIGUgaW5zdGFuY2VvZiBBU1RfQXNzaWduKTspIGUgPSBlLnJpZ2h0O31mdW5jdGlvbiBsZShlLCBuKSB7dmFyIHQgPSBuIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiAhbi5kZWZpbmVkLGkgPSBuLnNjb3BlIHx8IHhlKGwpIHx8IGRlO2Uud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge2lmIChlIGluc3RhbmNlb2YgQVNUX0Jsb2NrU2NvcGUpIHJldHVybiAhMDtlIGluc3RhbmNlb2YgQVNUX1N5bWJvbCAmJiAodCAmJiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiAoZS5kZWZpbmVkID0gITEpLCBlLnNjb3BlID0gaSk7fSkpO31mdW5jdGlvbiB1ZShzKSB7dmFyIGYgPSBuZXcgRGljdGlvbmFyeSgpLGMgPSAocyBpbnN0YW5jZW9mIEFTVF9WYXJEZWYgJiYgKHMubmFtZS5kZWZpbml0aW9uKCkuZml4ZWQgfHwgKCQgPSAhMSksIGYuYWRkKHMubmFtZS5uYW1lLCB2KSksIHZlLnVzZXNfYXJndW1lbnRzICYmICFfLmhhc19kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSksbCA9IHZlIGluc3RhbmNlb2YgQVNUX1RvcGxldmVsLHUgPSBuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAobikge3ZhciBlLCB0LCBpO2lmIChuIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IChlID0gbi5maXhlZF92YWx1ZSgpKSB8fCAodCA9IChlID0gbikuZGVmaW5pdGlvbigpLCBpID0gbi5maXhlZCAmJiBuLmZpeGVkLmVzY2FwZWQgfHwgdC5lc2NhcGVkLCB0LnVuZGVjbGFyZWQpIHx8ICF0LmFzc2lnbm1lbnRzICYmIGkgJiYgIWkuY3Jvc3Nfc2NvcGUgfHwgIU9lKHQsIG4uc2NvcGUsIG4sIHUucGFyZW50KCkpICYmIFpuKHQpIHx8ICgkID0gITEpIDogbiBpbnN0YW5jZW9mIEFTVF9PYmplY3RJZGVudGl0eSAmJiAoZSA9IG4pLCBlKSBmLmFkZChuLm5hbWUsIHllKF8sIHUsIG4sIGUsIDApKTtlbHNlIHtpZiAobiBpbnN0YW5jZW9mIEFTVF9MYW1iZGEpIHtmb3IgKHZhciByLCBvID0gMCwgYSA9IG47IHIgPSB1LnBhcmVudChvKyspOyBhID0gcikge2lmIChyIGluc3RhbmNlb2YgQVNUX0Fzc2lnbikge2lmIChyLmxlZnQgPT09IGEpIGJyZWFrO2lmICgiPSIgPT0gci5vcGVyYXRvcikgY29udGludWU7aWYgKE5lW3Iub3BlcmF0b3Iuc2xpY2UoMCwgLTEpXSkgY29udGludWU7YnJlYWs7fWlmIChyIGluc3RhbmNlb2YgQVNUX0JpbmFyeSkge2lmIChOZVtyLm9wZXJhdG9yXSkgY29udGludWU7YnJlYWs7fWlmIChyIGluc3RhbmNlb2YgQVNUX0NhbGwpIHJldHVybjtpZiAociBpbnN0YW5jZW9mIEFTVF9TY29wZSkgcmV0dXJuO2lmIChyIGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlKSB7aWYgKHIudGFpbF9ub2RlKCkgPT09IGEpIGNvbnRpbnVlO2JyZWFrO31pZiAociBpbnN0YW5jZW9mIEFTVF9UZW1wbGF0ZSkge2lmIChyLnRhZykgcmV0dXJuO2JyZWFrO319cmV0dXJuIG4uZW5jbG9zZWQuZm9yRWFjaChmdW5jdGlvbiAoZSkge2Uuc2NvcGUgIT09IG4gJiYgRy5zZXQoZS5uYW1lLCAhMCk7fSksICEwO31jICYmIG4gaW5zdGFuY2VvZiBBU1RfU3ViICYmICh2ZS5lYWNoX2FyZ25hbWUoZnVuY3Rpb24gKGUpIHtfLm9wdGlvbigicmVkdWNlX3ZhcnMiKSAmJiAhZS5kZWZpbml0aW9uKCkuYXNzaWdubWVudHMgfHwgKGUuZGVmaW5pdGlvbigpLmZpeGVkIHx8ICgkID0gITEpLCBmLmFkZChlLm5hbWUsICEwKSk7fSksIGMgPSAhMSk7fWwgJiYgKCJDYWxsIiA9PSBuLlRZUEUgPyBZIHx8IChpID0gbi5leHByZXNzaW9uKSBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzIHx8IGkgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRXhwcmVzc2lvbiAmJiAhaS5jb250YWluc190aGlzKCkgfHwgKFkgPSAhMCkgOiBuIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgJiYgZnVuY3Rpb24gZShuKSB7cmV0dXJuIG4gaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmICEobiA9IG4uZml4ZWRfdmFsdWUoKSkgfHwgKG4gaW5zdGFuY2VvZiBBU1RfQXNzaWduID8gIj0iID09IG4ub3BlcmF0b3IgJiYgZShuLnJpZ2h0KSA6IG4gaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyB8fCBuIGluc3RhbmNlb2YgQVNUX09iamVjdElkZW50aXR5KTt9KG4uZXhwcmVzc2lvbikgJiYgKG4gIT09IHYgfHwgcyBpbnN0YW5jZW9mIEFTVF9VbmFyeSA/IFcgPSAhMCA6IFkgPSAhMCkpO30pO3JldHVybiBzLndhbGsodSksIGY7fWZ1bmN0aW9uIF9lKGUsIG4pIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSkgc3dpdGNoIChlLmV4cHJlc3Npb25zLmxlbmd0aCkge2Nhc2UgMDpyZXR1cm4gbnVsbDtjYXNlIDE6cmV0dXJuIERlKG4ucGFyZW50KCksIGUsIGUuZXhwcmVzc2lvbnNbMF0pO319ZnVuY3Rpb24gU2UoZSkge2UgPSBiLmdldChlLm5hbWUpO2lmIChlICYmICFhbGwoZSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIWU7fSkpIHJldHVybiBlWzBdICE9PSB2IHx8IHZvaWQgKGcgPSAhMSk7fWZ1bmN0aW9uIHBlKGUpIHtlID0gZS5kZWZpbml0aW9uKCk7cmV0dXJuICEoMSA9PSBlLm9yaWcubGVuZ3RoICYmIGUub3JpZ1swXSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWZ1biB8fCBlLnNjb3BlLnJlc29sdmUoKSA9PT0gdmUgJiYgKCFZIHx8ICFfLmV4cG9zZWQoZSkpICYmIGFsbChlLnJlZmVyZW5jZXMsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUuc2NvcGUucmVzb2x2ZSghMCkgPT09IHZlO30pKTt9ZnVuY3Rpb24gdChlLCBuKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfQXNzaWduKSByZXR1cm4gdChlLmxlZnQsICEwKTtpZiAoZSBpbnN0YW5jZW9mIEFTVF9VbmFyeSkgcmV0dXJuIHQoZS5leHByZXNzaW9uLCAhMCk7aWYgKGUgaW5zdGFuY2VvZiBBU1RfVmFyRGVmKSByZXR1cm4gZS52YWx1ZSAmJiB0KGUudmFsdWUpO2lmIChuKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfRG90KSByZXR1cm4gdChlLmV4cHJlc3Npb24sICEwKTtpZiAoZSBpbnN0YW5jZW9mIEFTVF9TdWIpIHJldHVybiB0KGUuZXhwcmVzc2lvbiwgITApO2lmIChlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikgcmV0dXJuIGUuZGVmaW5pdGlvbigpLnNjb3BlLnJlc29sdmUoKSAhPT0gdmU7fXJldHVybiAhMTt9fShlLCBTKSB8fCAoaSA9IDkpO30gd2hpbGUgKGkgJiYgMCA8IG8tLSk7cmV0dXJuIGU7ZnVuY3Rpb24gTyhlLCBuKSB7dmFyIHQsaSxyID0gZS5zZWxmKCksbyA9IDA7ZG8ge3IgaW5zdGFuY2VvZiBBU1RfQ2F0Y2ggPyByID0gZS5wYXJlbnQobysrKSA6IHIgaW5zdGFuY2VvZiBBU1RfTGFiZWxlZFN0YXRlbWVudCA/IHIgPSByLmJvZHkgOiByIGluc3RhbmNlb2YgQVNUX1N3aXRjaEJyYW5jaCAmJiAoKGkgPSBlLnBhcmVudChvKSkuYm9keVtpLmJvZHkubGVuZ3RoIC0gMV0gIT09IHIgJiYgIWZ1bmN0aW9uIChlKSB7Zm9yICh2YXIgbiA9IGUubGVuZ3RoOyAwIDw9IC0tbjspIGlmIChlW25dIGluc3RhbmNlb2YgQVNUX0JyZWFrKSByZXR1cm4gMTtyZXR1cm47fShyLmJvZHkpIHx8IChvKyssIHIgPSBpKSk7ZG8ge2lmIChuKHQgPSByKSkgcmV0dXJuIHQ7fSB3aGlsZSAoKHIgPSBlLnBhcmVudChvKyspKSBpbnN0YW5jZW9mIEFTVF9JZik7fSB3aGlsZSAodCAmJiAociBpbnN0YW5jZW9mIEFTVF9CbG9ja1N0YXRlbWVudCB8fCByIGluc3RhbmNlb2YgQVNUX0NhdGNoIHx8IHIgaW5zdGFuY2VvZiBBU1RfU2NvcGUgfHwgciBpbnN0YW5jZW9mIEFTVF9Td2l0Y2hCcmFuY2ggfHwgciBpbnN0YW5jZW9mIEFTVF9UcnkpICYmIHplKHIuYm9keSwgdCkpO31mdW5jdGlvbiBwKGUsIG4pIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX0Jsb2NrU3RhdGVtZW50KSkgcmV0dXJuIGU7Zm9yICh2YXIgdCA9IG51bGwsIGkgPSAwOyBpIDwgZS5ib2R5Lmxlbmd0aDsgaSsrKSB7dmFyIHIgPSBlLmJvZHlbaV07aWYgKHIgaW5zdGFuY2VvZiBBU1RfVmFyICYmIFcocikpIG4ucHVzaChyKTtlbHNlIHtpZiAodCB8fCBvZShyKSkgcmV0dXJuICExO3QgPSByO319cmV0dXJuIHQ7fWZ1bmN0aW9uIHUoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiA/IFtlXSA6IGUgaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgPyBlLmV4cHJlc3Npb25zLnNsaWNlKCkgOiB2b2lkIDA7fWZ1bmN0aW9uIGQoZSwgbiwgdCkge3ZhciBpID0gdShuKTtpZiAoaSkge2ZvciAodmFyIHIgPSAhMSwgbyA9IGkubGVuZ3RoIC0gKHQgPSB0IHx8IDApOyAwIDw9IC0tbzspIGlmIChsKGYgPSBpW29dKSkge2lmIChmLmxlZnQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmKSBhID0gaS5zbGljZShvICsgMSk7ZWxzZSB7aWYgKCEoZi5sZWZ0IGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgJiYgbChmLmxlZnQuZXhwcmVzc2lvbikpKSBjb250aW51ZTt2YXIgYSA9IGkuc2xpY2UobyArIDEpLHMgPSBmLmNsb25lKCksZiA9IGYubGVmdC5leHByZXNzaW9uO3MubGVmdCA9IHMubGVmdC5jbG9uZSgpLCBzLmxlZnQuZXhwcmVzc2lvbiA9IGYubGVmdC5jbG9uZSgpLCBhLnVuc2hpZnQocyk7fTAgIT0gYS5sZW5ndGggJiYgVChmLmxlZnQsIGYucmlnaHQsIGEpICYmIChyID0gITAsIGkgPSBpLnNsaWNlKDAsIG8pLmNvbmNhdChmLCBhKSk7fWlmIChlIGluc3RhbmNlb2YgQVNUX0RlZmluaXRpb25zKSB7Zm9yIChvID0gZS5kZWZpbml0aW9ucy5sZW5ndGg7IDAgPD0gLS1vOykge3ZhciBjID0gZS5kZWZpbml0aW9uc1tvXTtpZiAoYy52YWx1ZSkge1QoYy5uYW1lLCBjLnZhbHVlLCBpKSAmJiAociA9ICEwKSwgIWZ1bmN0aW9uIChlLCBuLCB0KSB7aWYgKFMub3B0aW9uKCJjb25kaXRpb25hbHMiKSAmJiAhKGUubmFtZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQpKSB7Zm9yICh2YXIgaSA9ICExLCByID0gZS5uYW1lLmRlZmluaXRpb24oKTsgbi5sZW5ndGggPiB0Oykge3ZhciBvID0gSW4oUywgciwgZS52YWx1ZSwgblswXSk7aWYgKCFvKSBicmVhaztlLnZhbHVlID0gbywgbi5zaGlmdCgpLCBpID0gITA7fXJldHVybiBpO319KGMsIGksIHQpIHx8IChyID0gITApO2JyZWFrO319ZSBpbnN0YW5jZW9mIEFTVF9WYXIgJiYgXyhlLmRlZmluaXRpb25zLCBpLCB0KSAmJiAociA9ICEwKTt9cmV0dXJuIHIgJiYgaTt9ZnVuY3Rpb24gbChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfQXNzaWduICYmICI9IiA9PSBlLm9wZXJhdG9yO319ZnVuY3Rpb24gQShlLCBuKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfU2ltcGxlU3RhdGVtZW50ICYmICFXKG4pKSB7ZSA9IHUoZS5ib2R5KTtpZiAoZSkge3ZhciB0ID0gW107aWYgKF8odCwgZS5yZXZlcnNlKCksIDApKSByZXR1cm4gbi5kZWZpbml0aW9ucyA9IHQucmV2ZXJzZSgpLmNvbmNhdChuLmRlZmluaXRpb25zKSwgZS5yZXZlcnNlKCk7fX19ZnVuY3Rpb24gXyhlLCBuLCB0KSB7Zm9yICh2YXIgaSA9ICExOyBuLmxlbmd0aCA+IHQ7KSB7dmFyIHIgPSBuWzBdO2lmICghKHIgaW5zdGFuY2VvZiBBU1RfQXNzaWduKSkgYnJlYWs7aWYgKCI9IiAhPSByLm9wZXJhdG9yKSBicmVhazt2YXIgbyA9IHIubGVmdDtpZiAoIShvIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikpIGJyZWFrO2lmIChFZShvKSkgYnJlYWs7aWYgKG8uc2NvcGUucmVzb2x2ZSgpICE9PSB2ZSkgYnJlYWs7dmFyIGEgPSBvLmRlZmluaXRpb24oKTtpZiAoYS5zY29wZSAhPT0gdmUpIGJyZWFrO2lmIChhLm9yaWcubGVuZ3RoID4gYS5lbGltaW5hdGVkICsgMSkgYnJlYWs7aWYgKCJTeW1ib2xWYXIiICE9IGEub3JpZ1swXS5UWVBFKSBicmVhaztvID0ga2UoQVNUX1N5bWJvbFZhciwgbyk7ZS5wdXNoKGtlKEFTVF9WYXJEZWYsIHIsIHsgbmFtZTogbywgdmFsdWU6IHIucmlnaHQgfSkpLCBhLm9yaWcucHVzaChvKSwgYS5yZXBsYWNlZCsrLCBuLnNoaWZ0KCksIGkgPSAhMDt9cmV0dXJuIGk7fWZ1bmN0aW9uIFQoZSwgcywgbikge3ZhciBmID0gbmV3IERpY3Rpb25hcnkoKTtmb3IgKGYuc2V0KGUubmFtZSwgITApOyBzIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiAmJiAiPSIgPT0gcy5vcGVyYXRvcjspIHMubGVmdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgZi5zZXQocy5sZWZ0Lm5hbWUsICEwKSwgcyA9IHMucmlnaHQ7aWYgKHMgaW5zdGFuY2VvZiBBU1RfQXJyYXkpIHt2YXIgdCA9ICExO2RvIHtpZiAoIWZ1bmN0aW9uIGUobikge2lmICghKG4gaW5zdGFuY2VvZiBBU1RfQXNzaWduKSkgcmV0dXJuO2lmICgiPSIgIT0gbi5vcGVyYXRvcikgcmV0dXJuO2lmICghKG4ubGVmdCBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzKSkgcmV0dXJuO3ZhciB0ID0gbi5sZWZ0LmV4cHJlc3Npb247aWYgKCEodCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYpKSByZXR1cm47aWYgKCFmLmhhcyh0Lm5hbWUpKSByZXR1cm47aWYgKCFuLnJpZ2h0LmlzX2NvbnN0YW50X2V4cHJlc3Npb24odmUpKSByZXR1cm47dmFyIGkgPSBuLmxlZnQucHJvcGVydHk7aSBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmIChpID0gKGkgPSBlKGkpID8gbi5sZWZ0LnByb3BlcnR5ID0gaS5yaWdodC5jbG9uZSgpIDogaSkuZXZhbHVhdGUoUykpO2lmIChpIGluc3RhbmNlb2YgQVNUX05vZGUpIHJldHVybjtpZiAoIXkudGVzdCgiIiArIGkpKSByZXR1cm47aSA9ICtpO3ZhciByID0gcy5lbGVtZW50czt2YXIgbyA9IHIubGVuZ3RoO2lmIChvICsgNCA8IGkpIHJldHVybjtmb3IgKHZhciBhID0gTWF0aC5taW4obywgaSArIDEpOyAwIDw9IC0tYTspIGlmIChyW2FdIGluc3RhbmNlb2YgQVNUX1NwcmVhZCkgcmV0dXJuO2lmIChpIDwgbykge3QgPSByW2ldLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShTKTtyW2ldID0gdCA/IHdlKG4sIFt0LCBuLnJpZ2h0XSkgOiBuLnJpZ2h0O30gZWxzZSB7Zm9yICg7IG8gPCBpOykgcltvKytdID0ga2UoQVNUX0hvbGUsIHMpO3JbaV0gPSBuLnJpZ2h0O31yZXR1cm4gITA7fShuWzBdKSkgYnJlYWs7fSB3aGlsZSAobi5zaGlmdCgpLCB0ID0gITAsIG4ubGVuZ3RoKTtyZXR1cm4gdDt9aWYgKHMgaW5zdGFuY2VvZiBBU1RfT2JqZWN0KSB7dCA9ICExO2RvIHtpZiAoIWZ1bmN0aW9uIGUobikge2lmICghKG4gaW5zdGFuY2VvZiBBU1RfQXNzaWduKSkgcmV0dXJuO2lmICgiPSIgIT0gbi5vcGVyYXRvcikgcmV0dXJuO2lmICghKG4ubGVmdCBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzKSkgcmV0dXJuO3ZhciB0ID0gbi5sZWZ0LmV4cHJlc3Npb247aWYgKCEodCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYpKSByZXR1cm47aWYgKCFmLmhhcyh0Lm5hbWUpKSByZXR1cm47aWYgKCFuLnJpZ2h0LmlzX2NvbnN0YW50X2V4cHJlc3Npb24odmUpKSByZXR1cm47dmFyIGkgPSBuLmxlZnQucHJvcGVydHk7aSBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmIChpID0gKGkgPSBlKGkpID8gbi5sZWZ0LnByb3BlcnR5ID0gaS5yaWdodC5jbG9uZSgpIDogaSkuZXZhbHVhdGUoUykpO2lmIChpIGluc3RhbmNlb2YgQVNUX05vZGUpIHJldHVybjtpID0gIiIgKyBpO3QgPSAiX19wcm90b19fIiA9PSBpIHx8IFMuaGFzX2RpcmVjdGl2ZSgidXNlIHN0cmljdCIpID8gZnVuY3Rpb24gKGUpIHtlID0gZS5rZXk7cmV0dXJuICJzdHJpbmciID09IHR5cGVvZiBlICYmIGUgIT0gaSAmJiAiX19wcm90b19fIiAhPSBlO30gOiBmdW5jdGlvbiAoZSkge3ZhciBuID0gZS5rZXk7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfT2JqZWN0R2V0dGVyIHx8IGUgaW5zdGFuY2VvZiBBU1RfT2JqZWN0U2V0dGVyID8gInN0cmluZyIgPT0gdHlwZW9mIG4gJiYgbiAhPSBpIDogIl9fcHJvdG9fXyIgIT09IG47fTtpZiAoIWFsbChzLnByb3BlcnRpZXMsIHQpKSByZXR1cm47cy5wcm9wZXJ0aWVzLnB1c2goa2UoQVNUX09iamVjdEtleVZhbCwgbiwgeyBrZXk6IGksIHZhbHVlOiBuLnJpZ2h0IH0pKTtyZXR1cm4gITA7fShuWzBdKSkgYnJlYWs7fSB3aGlsZSAobi5zaGlmdCgpLCB0ID0gITAsIG4ubGVuZ3RoKTtyZXR1cm4gdDt9fX1mdW5jdGlvbiBDKGksIHIsIG8pIHt2YXIgYSxzID0gITE7ZnVuY3Rpb24gZihlKSB7YSA/IChhLnB1c2goZSksIGFlKGUpIHx8IChhLnJlcXVpcmVkID0gITApKSA6IG8ucHVzaChlKTt9ci53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQ7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfRGVmQ2xhc3MgPyAoZS5leHRlbmRzID0gbnVsbCwgZS5wcm9wZXJ0aWVzID0gW10sIGYoZSksICEwKSA6IGUgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMgPyAoZS5yZW1vdmVfaW5pdGlhbGl6ZXJzKGksIHQgPSBbXSkgJiYgQVNUX05vZGUud2FybigiRHJvcHBpbmcgaW5pdGlhbGl6YXRpb24gaW4gdW5yZWFjaGFibGUgY29kZSBbe3N0YXJ0fV0iLCBlKSwgMCA8IHQubGVuZ3RoICYmIChlLmRlZmluaXRpb25zID0gdCwgZihlKSksICEwKSA6IGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRGVmaW5pdGlvbiA/IChmKGUpLCAhMCkgOiBlIGluc3RhbmNlb2YgQVNUX1Njb3BlIHx8IChlIGluc3RhbmNlb2YgQVNUX0Jsb2NrU2NvcGUgPyAodCA9IGEsIGEgPSBbXSwgbigpLCBhLnJlcXVpcmVkID8gby5wdXNoKGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgciwgeyBib2R5OiBhIH0pKSA6IGEubGVuZ3RoICYmIFtdLnB1c2guYXBwbHkobywgYSksIGEgPSB0LCAhMCkgOiB2b2lkIChlIGluc3RhbmNlb2YgQVNUX0xvb3BDb250cm9sIHx8IChzID0gITApKSk7fSkpLCBzICYmIEFTVF9Ob2RlLndhcm4oIkRyb3BwaW5nIHVucmVhY2hhYmxlIGNvZGUgW3tzdGFydH1dIiwgcik7fWZ1bmN0aW9uIENlKGUsIG4pIHtyZXR1cm4gbnVsbCA9PSBlIHx8IGUuaXNfdW5kZWZpbmVkIHx8IGUgaW5zdGFuY2VvZiBBU1RfVW5kZWZpbmVkIHx8IGUgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgInZvaWQiID09IGUub3BlcmF0b3IgJiYgKCFuIHx8ICFlLmV4cHJlc3Npb24uaGFzX3NpZGVfZWZmZWN0cyhuKSk7fWZ1bmN0aW9uIHZlKGUsIG4sIHQpIHtzd2l0Y2ggKGUpIHtjYXNlICItIjpyZXR1cm4gbi5pc19uZWdhdGl2ZV96ZXJvKCkgJiYgKCEodCBpbnN0YW5jZW9mIEFTVF9Db25zdGFudCkgfHwgMCA9PSB0LnZhbHVlKTtjYXNlICImJiI6Y2FzZSAifHwiOnJldHVybiBuLmlzX25lZ2F0aXZlX3plcm8oKSB8fCB0LmlzX25lZ2F0aXZlX3plcm8oKTtjYXNlICIqIjpjYXNlICIvIjpjYXNlICIlIjpjYXNlICIqKiI6cmV0dXJuICEwO2RlZmF1bHQ6cmV0dXJuICExO319ZnVuY3Rpb24gamUoZSwgbikge3JldHVybiBuIHx8IC9zdHJpY3QvLnRlc3QoZS5vcHRpb24oInB1cmVfZ2V0dGVycyIpKTt9ZnVuY3Rpb24gTGUoZSwgbiwgdCkge3N3aXRjaCAobikge2Nhc2UgIiYmIjpyZXR1cm4gdC5sZWZ0LmlzX2RlZmluZWQoZSkgJiYgdC5yaWdodC5pc19kZWZpbmVkKGUpO2Nhc2UgInx8IjpyZXR1cm4gdC5sZWZ0LmlzX3RydXRoeSgpIHx8IHQucmlnaHQuaXNfZGVmaW5lZChlKTtjYXNlICI/PyI6cmV0dXJuIHQubGVmdC5pc19kZWZpbmVkKGUpIHx8IHQucmlnaHQuaXNfZGVmaW5lZChlKTtkZWZhdWx0OnJldHVybiAhMDt9fUFTVF9TeW1ib2xSZWYuREVGTUVUSE9EKCJpc19kZWNsYXJlZCIsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMuZGVmaW5lZCB8fCAhdGhpcy5kZWZpbml0aW9uKCkudW5kZWNsYXJlZCB8fCBlLm9wdGlvbigidW5zYWZlIikgJiYgcWVbdGhpcy5uYW1lXTt9KSwgKG4gPSBmdW5jdGlvbiBuKGUsIF9uMykge2UuREVGTUVUSE9EKCJpbl9zdHJpY3RfbW9kZSIsIF9uMyk7fSkoQVNUX0NsYXNzLCByZXR1cm5fdHJ1ZSksIG4oQVNUX1Njb3BlLCBmdW5jdGlvbiAoZSkge2ZvciAodmFyIG4gPSB0aGlzLmJvZHksIHQgPSAwOyB0IDwgbi5sZW5ndGg7IHQrKykge3ZhciBpID0gblt0XTtpZiAoIShpIGluc3RhbmNlb2YgQVNUX0RpcmVjdGl2ZSkpIGJyZWFrO2lmICgidXNlIHN0cmljdCIgPT0gaS52YWx1ZSkgcmV0dXJuICEwO312YXIgciA9IHRoaXMucGFyZW50X3Njb3BlO3JldHVybiByID8gci5yZXNvbHZlKCEwKS5pbl9zdHJpY3RfbW9kZShlKSA6IGUub3B0aW9uKCJtb2R1bGUiKTt9KSwgKG4gPSBmdW5jdGlvbiBuKGUsIF9uNCkge2UuREVGTUVUSE9EKCJpc190cnV0aHkiLCBfbjQpO30pKEFTVF9Ob2RlLCByZXR1cm5fZmFsc2UpLCBuKEFTVF9BcnJheSwgcmV0dXJuX3RydWUpLCBuKEFTVF9Bc3NpZ24sIGZ1bmN0aW9uICgpIHtyZXR1cm4gIj0iID09IHRoaXMub3BlcmF0b3IgJiYgdGhpcy5yaWdodC5pc190cnV0aHkoKTt9KSwgbihBU1RfTGFtYmRhLCByZXR1cm5fdHJ1ZSksIG4oQVNUX09iamVjdCwgcmV0dXJuX3RydWUpLCBuKEFTVF9SZWdFeHAsIHJldHVybl90cnVlKSwgbihBU1RfU2VxdWVuY2UsIGZ1bmN0aW9uICgpIHtyZXR1cm4gdGhpcy50YWlsX25vZGUoKS5pc190cnV0aHkoKTt9KSwgbihBU1RfU3ltYm9sUmVmLCBmdW5jdGlvbiAoKSB7dmFyIGUgPSB0aGlzLmZpeGVkX3ZhbHVlKCk7aWYgKCFlKSByZXR1cm4gITE7dGhpcy5pc190cnV0aHkgPSByZXR1cm5fZmFsc2U7ZSA9IGUuaXNfdHJ1dGh5KCk7cmV0dXJuIGRlbGV0ZSB0aGlzLmlzX3RydXRoeSwgZTt9KSwgKG4gPSBmdW5jdGlvbiBuKGUsIF9uNSkge2UuREVGTUVUSE9EKCJpc19uZWdhdGl2ZV96ZXJvIiwgX241KTt9KShBU1RfTm9kZSwgcmV0dXJuX3RydWUpLCBuKEFTVF9BcnJheSwgcmV0dXJuX2ZhbHNlKSwgbihBU1RfQXNzaWduLCBmdW5jdGlvbiAoKSB7dmFyIGUgPSB0aGlzLm9wZXJhdG9yO3JldHVybiAiPSIgPT0gZSA/IHRoaXMucmlnaHQuaXNfbmVnYXRpdmVfemVybygpIDogdmUoZS5zbGljZSgwLCAtMSksIHRoaXMubGVmdCwgdGhpcy5yaWdodCk7fSksIG4oQVNUX0JpbmFyeSwgZnVuY3Rpb24gKCkge3JldHVybiB2ZSh0aGlzLm9wZXJhdG9yLCB0aGlzLmxlZnQsIHRoaXMucmlnaHQpO30pLCBuKEFTVF9Db25zdGFudCwgZnVuY3Rpb24gKCkge3JldHVybiAwID09IHRoaXMudmFsdWUgJiYgMSAvIHRoaXMudmFsdWUgPCAwO30pLCBuKEFTVF9MYW1iZGEsIHJldHVybl9mYWxzZSksIG4oQVNUX09iamVjdCwgcmV0dXJuX2ZhbHNlKSwgbihBU1RfUmVnRXhwLCByZXR1cm5fZmFsc2UpLCBuKEFTVF9TZXF1ZW5jZSwgZnVuY3Rpb24gKCkge3JldHVybiB0aGlzLnRhaWxfbm9kZSgpLmlzX25lZ2F0aXZlX3plcm8oKTt9KSwgbihBU1RfU3ltYm9sUmVmLCBmdW5jdGlvbiAoKSB7dmFyIGUgPSB0aGlzLmZpeGVkX3ZhbHVlKCk7aWYgKCFlKSByZXR1cm4gITA7dGhpcy5pc19uZWdhdGl2ZV96ZXJvID0gcmV0dXJuX3RydWU7ZSA9IGUuaXNfbmVnYXRpdmVfemVybygpO3JldHVybiBkZWxldGUgdGhpcy5pc19uZWdhdGl2ZV96ZXJvLCBlO30pLCBuKEFTVF9VbmFyeVByZWZpeCwgZnVuY3Rpb24gKCkge3JldHVybiAiKyIgPT0gdGhpcy5vcGVyYXRvciAmJiB0aGlzLmV4cHJlc3Npb24uaXNfbmVnYXRpdmVfemVybygpIHx8ICItIiA9PSB0aGlzLm9wZXJhdG9yO30pLCBuID0gZnVuY3Rpb24gbihlLCBfbjYpIHtlLkRFRk1FVEhPRCgiX2RvdF90aHJvdyIsIF9uNik7fSwgQVNUX05vZGUuREVGTUVUSE9EKCJtYXlfdGhyb3dfb25fYWNjZXNzIiwgZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gIWUub3B0aW9uKCJwdXJlX2dldHRlcnMiKSB8fCB0aGlzLl9kb3RfdGhyb3coZSwgbik7fSksIG4oQVNUX05vZGUsIGplKSwgbihBU1RfQXJyYXksIHJldHVybl9mYWxzZSksIG4oQVNUX0Fzc2lnbiwgZnVuY3Rpb24gKGUpIHt2YXIgbiA9IHRoaXMub3BlcmF0b3IsdCA9IHRoaXMubGVmdCxpID0gdGhpcy5yaWdodDtyZXR1cm4gIj0iICE9IG4gPyBOZVtuLnNsaWNlKDAsIC0xKV0gJiYgKHQuX2RvdF90aHJvdyhlKSB8fCBpLl9kb3RfdGhyb3coZSkpIDogISFpLl9kb3RfdGhyb3coZSkgJiYgKCEodCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgaSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgInx8IiA9PSBpLm9wZXJhdG9yICYmIHQubmFtZSA9PSBpLmxlZnQubmFtZSkgfHwgaS5yaWdodC5fZG90X3Rocm93KGUpKTt9KSwgbihBU1RfQmluYXJ5LCBmdW5jdGlvbiAoZSkge3JldHVybiBOZVt0aGlzLm9wZXJhdG9yXSAmJiAodGhpcy5sZWZ0Ll9kb3RfdGhyb3coZSkgfHwgdGhpcy5yaWdodC5fZG90X3Rocm93KGUpKTt9KSwgbihBU1RfQ2xhc3MsIGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuIGplKGUsIG4pICYmICFhbGwodGhpcy5wcm9wZXJ0aWVzLCBmdW5jdGlvbiAoZSkge3JldHVybiAhIWUucHJpdmF0ZSB8fCAhZS5zdGF0aWMgfHwgIShlIGluc3RhbmNlb2YgQVNUX0NsYXNzR2V0dGVyIHx8IGUgaW5zdGFuY2VvZiBBU1RfQ2xhc3NTZXR0ZXIpO30pO30pLCBuKEFTVF9Db25kaXRpb25hbCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5jb25zZXF1ZW50Ll9kb3RfdGhyb3coZSkgfHwgdGhpcy5hbHRlcm5hdGl2ZS5fZG90X3Rocm93KGUpO30pLCBuKEFTVF9Db25zdGFudCwgcmV0dXJuX2ZhbHNlKSwgbihBU1RfRG90LCBmdW5jdGlvbiAoZSwgbikge3JldHVybiAhKCFqZShlLCBuKSB8fCAoKGUgPSB0aGlzLmV4cHJlc3Npb24pIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiAoZSA9IGUuZml4ZWRfdmFsdWUoKSksICJwcm90b3R5cGUiID09IHRoaXMucHJvcGVydHkgJiYgdyhlKSkpO30pLCBuKEFTVF9MYW1iZGEsIHJldHVybl9mYWxzZSksIG4oQVNUX051bGwsIHJldHVybl90cnVlKSwgbihBU1RfT2JqZWN0LCBmdW5jdGlvbiAobiwgdCkge3JldHVybiBqZShuLCB0KSAmJiAhYWxsKHRoaXMucHJvcGVydGllcywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX09iamVjdEdldHRlciB8fCBlIGluc3RhbmNlb2YgQVNUX09iamVjdFNldHRlciB8fCAiX19wcm90b19fIiA9PT0gZS5rZXkgJiYgZS52YWx1ZS5fZG90X3Rocm93KG4sIHQpKTt9KTt9KSwgbihBU1RfT2JqZWN0SWRlbnRpdHksIGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuIGplKGUsIG4pICYmICF0aGlzLnNjb3BlLnJlc29sdmUoKS5uZXc7fSksIG4oQVNUX1NlcXVlbmNlLCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLnRhaWxfbm9kZSgpLl9kb3RfdGhyb3coZSk7fSksIG4oQVNUX1N5bWJvbFJlZiwgZnVuY3Rpb24gKGUsIG4pIHtpZiAoIXRoaXMuZGVmaW5lZCkge2lmICh0aGlzLmlzX3VuZGVmaW5lZCkgcmV0dXJuICEwO2lmIChqZShlLCBuKSAmJiAhKEVlKHRoaXMpICYmIHRoaXMuaXNfZGVjbGFyZWQoZSkgfHwgdGhpcy5pc19pbW11dGFibGUoKSkpIHtuID0gdGhpcy5kZWZpbml0aW9uKCk7aWYgKGdlKG4pICYmICFuLnNjb3BlLnJlc3QgJiYgYWxsKG4uc2NvcGUuYXJnbmFtZXMsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnO30pKSByZXR1cm4gMiA8IG4uc2NvcGUudXNlc19hcmd1bWVudHM7biA9IHRoaXMuZml4ZWRfdmFsdWUoITApO2lmICghbikgcmV0dXJuICEwO2lmICh0aGlzLl9kb3RfdGhyb3cgPSByZXR1cm5fdHJ1ZSwgbi5fZG90X3Rocm93KGUpKSByZXR1cm4gZGVsZXRlIHRoaXMuX2RvdF90aHJvdywgITA7dGhpcy5fZG90X3Rocm93ID0gcmV0dXJuX2ZhbHNlO319cmV0dXJuICExO30pLCBuKEFTVF9VbmFyeVByZWZpeCwgZnVuY3Rpb24gKCkge3JldHVybiAidm9pZCIgPT0gdGhpcy5vcGVyYXRvcjt9KSwgbihBU1RfVW5hcnlQb3N0Zml4LCByZXR1cm5fZmFsc2UpLCBuKEFTVF9VbmRlZmluZWQsIHJldHVybl90cnVlKSwgKG4gPSBmdW5jdGlvbiBuKGUsIF9uNykge2UuREVGTUVUSE9EKCJpc19kZWZpbmVkIiwgX243KTt9KShBU1RfTm9kZSwgcmV0dXJuX2ZhbHNlKSwgbihBU1RfQXJyYXksIHJldHVybl90cnVlKSwgbihBU1RfQXNzaWduLCBmdW5jdGlvbiAoZSkge3ZhciBuID0gdGhpcy5vcGVyYXRvcjtyZXR1cm4gIj0iID09IG4gPyB0aGlzLnJpZ2h0LmlzX2RlZmluZWQoZSkgOiBMZShlLCBuLnNsaWNlKDAsIC0xKSwgdGhpcyk7fSksIG4oQVNUX0JpbmFyeSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gTGUoZSwgdGhpcy5vcGVyYXRvciwgdGhpcyk7fSksIG4oQVNUX0NvbmRpdGlvbmFsLCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLmNvbnNlcXVlbnQuaXNfZGVmaW5lZChlKSAmJiB0aGlzLmFsdGVybmF0aXZlLmlzX2RlZmluZWQoZSk7fSksIG4oQVNUX0NvbnN0YW50LCByZXR1cm5fdHJ1ZSksIG4oQVNUX0hvbGUsIHJldHVybl9mYWxzZSksIG4oQVNUX0xhbWJkYSwgcmV0dXJuX3RydWUpLCBuKEFTVF9PYmplY3QsIHJldHVybl90cnVlKSwgbihBU1RfU2VxdWVuY2UsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMudGFpbF9ub2RlKCkuaXNfZGVmaW5lZChlKTt9KSwgbihBU1RfU3ltYm9sUmVmLCBmdW5jdGlvbiAoZSkge2lmICh0aGlzLmlzX3VuZGVmaW5lZCkgcmV0dXJuICExO2lmIChFZSh0aGlzKSAmJiB0aGlzLmlzX2RlY2xhcmVkKGUpKSByZXR1cm4gITA7aWYgKHRoaXMuaXNfaW1tdXRhYmxlKCkpIHJldHVybiAhMDt2YXIgbiA9IHRoaXMuZml4ZWRfdmFsdWUoKTtpZiAoIW4pIHJldHVybiAhMTt0aGlzLmlzX2RlZmluZWQgPSByZXR1cm5fZmFsc2U7biA9IG4uaXNfZGVmaW5lZChlKTtyZXR1cm4gZGVsZXRlIHRoaXMuaXNfZGVmaW5lZCwgbjt9KSwgbihBU1RfVW5hcnlQcmVmaXgsIGZ1bmN0aW9uICgpIHtyZXR1cm4gInZvaWQiICE9IHRoaXMub3BlcmF0b3I7fSksIG4oQVNUX1VuYXJ5UG9zdGZpeCwgcmV0dXJuX3RydWUpLCBuKEFTVF9VbmRlZmluZWQsIHJldHVybl9mYWxzZSksIChuID0gZnVuY3Rpb24gbihlLCBfbjgpIHtlLkRFRk1FVEhPRCgiaXNfYm9vbGVhbiIsIF9uOCk7fSkoQVNUX05vZGUsIHJldHVybl9mYWxzZSksIG4oQVNUX0Fzc2lnbiwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIj0iID09IHRoaXMub3BlcmF0b3IgJiYgdGhpcy5yaWdodC5pc19ib29sZWFuKGUpO30pLCB1ZSA9IG1ha2VQcmVkaWNhdGUoImluIGluc3RhbmNlb2YgPT0gIT0gPT09ICE9PSA8IDw9ID49ID4iKSwgbihBU1RfQmluYXJ5LCBmdW5jdGlvbiAoZSkge3JldHVybiB1ZVt0aGlzLm9wZXJhdG9yXSB8fCBOZVt0aGlzLm9wZXJhdG9yXSAmJiB0aGlzLmxlZnQuaXNfYm9vbGVhbihlKSAmJiB0aGlzLnJpZ2h0LmlzX2Jvb2xlYW4oZSk7fSksIG4oQVNUX0Jvb2xlYW4sIHJldHVybl90cnVlKSwgX2UgPSBtYWtlUHJlZGljYXRlKCJldmVyeSBoYXNPd25Qcm9wZXJ0eSBpc1Byb3RvdHlwZU9mIHByb3BlcnR5SXNFbnVtZXJhYmxlIHNvbWUiKSwgbihBU1RfQ2FsbCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gISFlLm9wdGlvbigidW5zYWZlIikgJiYgKGUgPSB0aGlzLmV4cHJlc3Npb24pIGluc3RhbmNlb2YgQVNUX0RvdCAmJiAoX2VbZS5wcm9wZXJ0eV0gfHwgInRlc3QiID09IGUucHJvcGVydHkgJiYgZS5leHByZXNzaW9uIGluc3RhbmNlb2YgQVNUX1JlZ0V4cCk7fSksIG4oQVNUX0NvbmRpdGlvbmFsLCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLmNvbnNlcXVlbnQuaXNfYm9vbGVhbihlKSAmJiB0aGlzLmFsdGVybmF0aXZlLmlzX2Jvb2xlYW4oZSk7fSksIG4oQVNUX05ldywgcmV0dXJuX2ZhbHNlKSwgbihBU1RfU2VxdWVuY2UsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMudGFpbF9ub2RlKCkuaXNfYm9vbGVhbihlKTt9KSwgbihBU1RfU3ltYm9sUmVmLCBmdW5jdGlvbiAoZSkge3ZhciBuID0gdGhpcy5maXhlZF92YWx1ZSgpO2lmICghbikgcmV0dXJuICExO3RoaXMuaXNfYm9vbGVhbiA9IHJldHVybl9mYWxzZTtuID0gbi5pc19ib29sZWFuKGUpO3JldHVybiBkZWxldGUgdGhpcy5pc19ib29sZWFuLCBuO30pLCBTZSA9IG1ha2VQcmVkaWNhdGUoIiEgZGVsZXRlIiksIG4oQVNUX1VuYXJ5UHJlZml4LCBmdW5jdGlvbiAoKSB7cmV0dXJuIFNlW3RoaXMub3BlcmF0b3JdO30pLCAobiA9IGZ1bmN0aW9uIG4oZSwgX245KSB7ZS5ERUZNRVRIT0QoImlzX251bWJlciIsIF9uOSk7fSkoQVNUX05vZGUsIHJldHVybl9mYWxzZSksIHBlID0gbWFrZVByZWRpY2F0ZSgiLSAqIC8gJSAqKiAmIHwgXiA8PCA+PiA+Pj4iKSwgbihBU1RfQXNzaWduLCBmdW5jdGlvbiAoZSkge3JldHVybiBwZVt0aGlzLm9wZXJhdG9yLnNsaWNlKDAsIC0xKV0gfHwgIj0iID09IHRoaXMub3BlcmF0b3IgJiYgdGhpcy5yaWdodC5pc19udW1iZXIoZSk7fSksIG4oQVNUX0JpbmFyeSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gISFwZVt0aGlzLm9wZXJhdG9yXSB8fCAiKyIgPT0gdGhpcy5vcGVyYXRvciAmJiAodGhpcy5sZWZ0LmlzX2Jvb2xlYW4oZSkgfHwgdGhpcy5sZWZ0LmlzX251bWJlcihlKSkgJiYgKHRoaXMucmlnaHQuaXNfYm9vbGVhbihlKSB8fCB0aGlzLnJpZ2h0LmlzX251bWJlcihlKSk7fSksIGRlID0gbWFrZVByZWRpY2F0ZShbImNoYXJDb2RlQXQiLCAiZ2V0RGF0ZSIsICJnZXREYXkiLCAiZ2V0RnVsbFllYXIiLCAiZ2V0SG91cnMiLCAiZ2V0TWlsbGlzZWNvbmRzIiwgImdldE1pbnV0ZXMiLCAiZ2V0TW9udGgiLCAiZ2V0U2Vjb25kcyIsICJnZXRUaW1lIiwgImdldFRpbWV6b25lT2Zmc2V0IiwgImdldFVUQ0RhdGUiLCAiZ2V0VVRDRGF5IiwgImdldFVUQ0Z1bGxZZWFyIiwgImdldFVUQ0hvdXJzIiwgImdldFVUQ01pbGxpc2Vjb25kcyIsICJnZXRVVENNaW51dGVzIiwgImdldFVUQ01vbnRoIiwgImdldFVUQ1NlY29uZHMiLCAiZ2V0WWVhciIsICJpbmRleE9mIiwgImxhc3RJbmRleE9mIiwgImxvY2FsZUNvbXBhcmUiLCAicHVzaCIsICJzZWFyY2giLCAic2V0RGF0ZSIsICJzZXRGdWxsWWVhciIsICJzZXRIb3VycyIsICJzZXRNaWxsaXNlY29uZHMiLCAic2V0TWludXRlcyIsICJzZXRNb250aCIsICJzZXRTZWNvbmRzIiwgInNldFRpbWUiLCAic2V0VVRDRGF0ZSIsICJzZXRVVENGdWxsWWVhciIsICJzZXRVVENIb3VycyIsICJzZXRVVENNaWxsaXNlY29uZHMiLCAic2V0VVRDTWludXRlcyIsICJzZXRVVENNb250aCIsICJzZXRVVENTZWNvbmRzIiwgInNldFllYXIiXSksIG4oQVNUX0NhbGwsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICEhZS5vcHRpb24oInVuc2FmZSIpICYmIChlID0gdGhpcy5leHByZXNzaW9uKSBpbnN0YW5jZW9mIEFTVF9Eb3QgJiYgKGRlW2UucHJvcGVydHldIHx8IEVlKGUuZXhwcmVzc2lvbikgJiYgIk1hdGgiID09IGUuZXhwcmVzc2lvbi5uYW1lKTt9KSwgbihBU1RfQ29uZGl0aW9uYWwsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMuY29uc2VxdWVudC5pc19udW1iZXIoZSkgJiYgdGhpcy5hbHRlcm5hdGl2ZS5pc19udW1iZXIoZSk7fSksIG4oQVNUX05ldywgcmV0dXJuX2ZhbHNlKSwgbihBU1RfTnVtYmVyLCByZXR1cm5fdHJ1ZSksIG4oQVNUX1NlcXVlbmNlLCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLnRhaWxfbm9kZSgpLmlzX251bWJlcihlKTt9KSwgbihBU1RfU3ltYm9sUmVmLCBmdW5jdGlvbiAoZSwgbikge3ZhciB0ID0gdGhpcy5maXhlZF92YWx1ZSgpO2lmICghdCkgcmV0dXJuICExO2lmIChuICYmIHQgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgIisiID09IHQub3BlcmF0b3IgJiYgdC5leHByZXNzaW9uLmVxdWFscyh0aGlzKSkgcmV0dXJuICExO3RoaXMuaXNfbnVtYmVyID0gcmV0dXJuX2ZhbHNlO24gPSB0LmlzX251bWJlcihlKTtyZXR1cm4gZGVsZXRlIHRoaXMuaXNfbnVtYmVyLCBuO30pLCBBZSA9IG1ha2VQcmVkaWNhdGUoIisgLSB+ICsrIC0tIiksIG4oQVNUX1VuYXJ5LCBmdW5jdGlvbiAoKSB7cmV0dXJuIEFlW3RoaXMub3BlcmF0b3JdO30pLCAobiA9IGZ1bmN0aW9uIG4oZSwgX24wKSB7ZS5ERUZNRVRIT0QoImlzX3N0cmluZyIsIF9uMCk7fSkoQVNUX05vZGUsIHJldHVybl9mYWxzZSksIG4oQVNUX0Fzc2lnbiwgZnVuY3Rpb24gKGUpIHtzd2l0Y2ggKHRoaXMub3BlcmF0b3IpIHtjYXNlICIrPSI6aWYgKHRoaXMubGVmdC5pc19zdHJpbmcoZSkpIHJldHVybiAhMDtjYXNlICI9IjpyZXR1cm4gdGhpcy5yaWdodC5pc19zdHJpbmcoZSk7fX0pLCBuKEFTVF9CaW5hcnksIGZ1bmN0aW9uIChlKSB7cmV0dXJuICIrIiA9PSB0aGlzLm9wZXJhdG9yICYmICh0aGlzLmxlZnQuaXNfc3RyaW5nKGUpIHx8IHRoaXMucmlnaHQuaXNfc3RyaW5nKGUpKTt9KSwgVGUgPSBtYWtlUHJlZGljYXRlKFsiY2hhckF0IiwgInN1YnN0ciIsICJzdWJzdHJpbmciLCAidG9FeHBvbmVudGlhbCIsICJ0b0ZpeGVkIiwgInRvTG93ZXJDYXNlIiwgInRvUHJlY2lzaW9uIiwgInRvU3RyaW5nIiwgInRvVXBwZXJDYXNlIiwgInRyaW0iXSksIG4oQVNUX0NhbGwsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICEhZS5vcHRpb24oInVuc2FmZSIpICYmIChlID0gdGhpcy5leHByZXNzaW9uKSBpbnN0YW5jZW9mIEFTVF9Eb3QgJiYgVGVbZS5wcm9wZXJ0eV07fSksIG4oQVNUX0NvbmRpdGlvbmFsLCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLmNvbnNlcXVlbnQuaXNfc3RyaW5nKGUpICYmIHRoaXMuYWx0ZXJuYXRpdmUuaXNfc3RyaW5nKGUpO30pLCBuKEFTVF9TZXF1ZW5jZSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy50YWlsX25vZGUoKS5pc19zdHJpbmcoZSk7fSksIG4oQVNUX1N0cmluZywgcmV0dXJuX3RydWUpLCBuKEFTVF9TeW1ib2xSZWYsIGZ1bmN0aW9uIChlKSB7dmFyIG4gPSB0aGlzLmZpeGVkX3ZhbHVlKCk7aWYgKCFuKSByZXR1cm4gITE7dGhpcy5pc19zdHJpbmcgPSByZXR1cm5fZmFsc2U7biA9IG4uaXNfc3RyaW5nKGUpO3JldHVybiBkZWxldGUgdGhpcy5pc19zdHJpbmcsIG47fSksIG4oQVNUX1RlbXBsYXRlLCBmdW5jdGlvbiAoZSkge3JldHVybiAhdGhpcy50YWcgfHwgZXQoZSwgdGhpcy50YWcpO30pLCBuKEFTVF9VbmFyeVByZWZpeCwgZnVuY3Rpb24gKCkge3JldHVybiAidHlwZW9mIiA9PSB0aGlzLm9wZXJhdG9yO30pO3ZhciBOZSA9IG1ha2VQcmVkaWNhdGUoIiYmIHx8ID8/Iik7ZnVuY3Rpb24gVmUoZSkge0FTVF9Ob2RlLndhcm4oImdsb2JhbF9kZWZzIHt0aGlzfSByZWRlZmluZWQgW3tzdGFydH1dIiwgZSk7fWZ1bmN0aW9uIFkoZSwgbiwgdCkge3JldHVybiBuLnByaW50X3RvX3N0cmluZygpLmxlbmd0aCAtIGUucHJpbnRfdG9fc3RyaW5nKCkubGVuZ3RoIDwgKHQgfHwgMCkgPyBuIDogZTt9ZnVuY3Rpb24gSWUoZSwgbiwgdCkge3JldHVybiBZKGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUsIHsgYm9keTogZSB9KSwga2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgbiwgeyBib2R5OiBuIH0pLCB0KS5ib2R5O31mdW5jdGlvbiBNZShlLCBuLCB0LCBpKSB7cmV0dXJuIChmaXJzdF9pbl9zdGF0ZW1lbnQoZSkgPyBJZSA6IFkpKG4sIHQsIGkpO31mdW5jdGlvbiBIZShuKSB7dmFyIHQgPSBPYmplY3QuY3JlYXRlKG51bGwpO3JldHVybiBPYmplY3Qua2V5cyhuKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7dFtlXSA9IG1ha2VQcmVkaWNhdGUobltlXSk7fSksIHQ7fWZ1bmN0aW9uIFdlKGUpIHtmb3IgKHZhciBuID0gMDsgbiA8IGUubGVuZ3RoOyBuKyspIHt2YXIgdCA9IGVbbl07aWYgKCEodCBpbnN0YW5jZW9mIEFTVF9EaXJlY3RpdmUpKSByZXR1cm4gdDt9fWZ1bmN0aW9uIFllKCkge3JldHVybiB0aGlzLnZhbHVlID8ga2UoQVNUX1JldHVybiwgdGhpcy52YWx1ZSwgeyB2YWx1ZTogdGhpcy52YWx1ZSB9KSA6IFdlKHRoaXMuYm9keSk7fWZ1bmN0aW9uIEsoZSwgbikge3ZhciB0ID0gbi5ldmFsdWF0ZShlKTtyZXR1cm4gdCA9PT0gbiA/IG4gOiBNZShlLCBuLCBaKHQsIG4pLm9wdGltaXplKGUpLCBlLmV2YWxfdGhyZXNob2xkKTt9biA9IGZ1bmN0aW9uIG4oZSwgX24xKSB7ZS5ERUZNRVRIT0QoIl9maW5kX2RlZnMiLCBfbjEpO30sIEFTVF9Ub3BsZXZlbC5ERUZNRVRIT0QoInJlc29sdmVfZGVmaW5lcyIsIGZ1bmN0aW9uIChvKSB7cmV0dXJuIG8ub3B0aW9uKCJnbG9iYWxfZGVmcyIpID8gKHRoaXMuZmlndXJlX291dF9zY29wZSh7IGllOiBvLm9wdGlvbigiaWUiKSB9KSwgdGhpcy50cmFuc2Zvcm0obmV3IFRyZWVUcmFuc2Zvcm1lcihmdW5jdGlvbiAoZSkge3ZhciBuID0gZS5fZmluZF9kZWZzKG8sICIiKTtpZiAobikge2ZvciAodmFyIHQsIGkgPSAwLCByID0gZTsgKHQgPSB0aGlzLnBhcmVudChpKyspKSAmJiB0IGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgJiYgdC5leHByZXNzaW9uID09PSByOykgciA9IHQ7aWYgKCFpc19saHMociwgdCkpIHJldHVybiBuO1ZlKGUpO319KSkpIDogdGhpczt9KSwgbihBU1RfTm9kZSwgbm9vcCksIG4oQVNUX0RvdCwgZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gdGhpcy5leHByZXNzaW9uLl9maW5kX2RlZnMoZSwgIi4iICsgdGhpcy5wcm9wZXJ0eSArIG4pO30pLCBuKEFTVF9TeW1ib2xEZWNsYXJhdGlvbiwgZnVuY3Rpb24gKGUpIHt0aGlzLmRlZmluaXRpb24oKS5nbG9iYWwgJiYgSE9QKGUub3B0aW9uKCJnbG9iYWxfZGVmcyIpLCB0aGlzLm5hbWUpICYmIFZlKHRoaXMpO30pLCBuKEFTVF9TeW1ib2xSZWYsIGZ1bmN0aW9uIChlLCBuKSB7aWYgKHRoaXMuZGVmaW5pdGlvbigpLmdsb2JhbCkgcmV0dXJuIGUgPSBlLm9wdGlvbigiZ2xvYmFsX2RlZnMiKSwgbiA9IHRoaXMubmFtZSArIG4sIEhPUChlLCBuKSA/IGZ1bmN0aW9uIG4oZSwgdCkge2lmIChlIGluc3RhbmNlb2YgQVNUX05vZGUpIHJldHVybiBlLmNsb25lKCEwKTtpZiAoQXJyYXkuaXNBcnJheShlKSkgcmV0dXJuIGtlKEFTVF9BcnJheSwgdCwgeyBlbGVtZW50czogZS5tYXAoZnVuY3Rpb24gKGUpIHtyZXR1cm4gbihlLCB0KTt9KSB9KTtpZiAoZSAmJiAib2JqZWN0IiA9PSB0eXBlb2YgZSkge3ZhciBpLHIgPSBbXTtmb3IgKGkgaW4gZSkgSE9QKGUsIGkpICYmIHIucHVzaChrZShBU1RfT2JqZWN0S2V5VmFsLCB0LCB7IGtleTogaSwgdmFsdWU6IG4oZVtpXSwgdCkgfSkpO3JldHVybiBrZShBU1RfT2JqZWN0LCB0LCB7IHByb3BlcnRpZXM6IHIgfSk7fXJldHVybiBaKGUsIHQpO30oZVtuXSwgdGhpcykgOiB2b2lkIDA7fSksIEFTVF9BcnJvdy5ERUZNRVRIT0QoImZpcnN0X3N0YXRlbWVudCIsIFllKSwgQVNUX0FzeW5jQXJyb3cuREVGTUVUSE9EKCJmaXJzdF9zdGF0ZW1lbnQiLCBZZSksIEFTVF9MYW1iZGEuREVGTUVUSE9EKCJmaXJzdF9zdGF0ZW1lbnQiLCBmdW5jdGlvbiAoKSB7cmV0dXJuIFdlKHRoaXMuYm9keSk7fSksIEFTVF9MYW1iZGEuREVGTUVUSE9EKCJsZW5ndGgiLCBmdW5jdGlvbiAoKSB7Zm9yICh2YXIgZSA9IHRoaXMuYXJnbmFtZXMsIG4gPSAwOyBuIDwgZS5sZW5ndGggJiYgIShlW25dIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSk7IG4rKyk7cmV0dXJuIG47fSk7dmFyIEtlLEdlLCRlLFhlLEplLFFlLFplLG4gPSBbImNvbnN0cnVjdG9yIiwgInRvU3RyaW5nIiwgInZhbHVlT2YiXSxUID0gSGUoeyBBcnJheTogWyJpbmRleE9mIiwgImpvaW4iLCAibGFzdEluZGV4T2YiLCAic2xpY2UiXS5jb25jYXQobiksIEJvb2xlYW46IG4sIEZ1bmN0aW9uOiBuLCBOdW1iZXI6IFsidG9FeHBvbmVudGlhbCIsICJ0b0ZpeGVkIiwgInRvUHJlY2lzaW9uIl0uY29uY2F0KG4pLCBPYmplY3Q6IG4sIFJlZ0V4cDogWyJleGVjIiwgInRlc3QiXS5jb25jYXQobiksIFN0cmluZzogWyJjaGFyQXQiLCAiY2hhckNvZGVBdCIsICJjb25jYXQiLCAiaW5kZXhPZiIsICJpdGFsaWNzIiwgImxhc3RJbmRleE9mIiwgIm1hdGNoIiwgInJlcGxhY2UiLCAic2VhcmNoIiwgInNsaWNlIiwgInNwbGl0IiwgInN1YnN0ciIsICJzdWJzdHJpbmciLCAidG9Mb3dlckNhc2UiLCAidG9VcHBlckNhc2UiLCAidHJpbSJdLmNvbmNhdChuKSB9KSxlbiA9IEhlKHsgQXJyYXk6IFsiaXNBcnJheSJdLCBNYXRoOiBbImFicyIsICJhY29zIiwgImFzaW4iLCAiYXRhbiIsICJjZWlsIiwgImNvcyIsICJleHAiLCAiZmxvb3IiLCAibG9nIiwgInJvdW5kIiwgInNpbiIsICJzcXJ0IiwgInRhbiIsICJhdGFuMiIsICJwb3ciLCAibWF4IiwgIm1pbiJdLCBOdW1iZXI6IFsiaXNGaW5pdGUiLCAiaXNOYU4iXSwgT2JqZWN0OiBbImNyZWF0ZSIsICJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCAiZ2V0T3duUHJvcGVydHlOYW1lcyIsICJnZXRQcm90b3R5cGVPZiIsICJpc0V4dGVuc2libGUiLCAiaXNGcm96ZW4iLCAiaXNTZWFsZWQiLCAia2V5cyJdLCBTdHJpbmc6IFsiZnJvbUNoYXJDb2RlIiwgInJhdyJdIH0pO2Z1bmN0aW9uIG5uKGUpIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9Eb3QpIHt2YXIgbix0ID0gZS5leHByZXNzaW9uO2lmIChFZSh0KSkgcmV0dXJuIChuID0gZW5bdC5uYW1lXSkgJiYgKG5bZS5wcm9wZXJ0eV0gfHwgIk1hdGgiID09IHQubmFtZSAmJiAicmFuZG9tIiA9PSBlLnByb3BlcnR5KTt9fWZ1bmN0aW9uIGYoZSkge2UgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkQXJyYXkgPyBlLmVsZW1lbnRzLmZvckVhY2goZikgOiBlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZE9iamVjdCA/IGUucHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZihlLnZhbHVlKTt9KSA6IGUgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyA/IGYoZS5leHByZXNzaW9uKSA6IGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIGUuZGVmaW5pdGlvbigpLnJlZmVyZW5jZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2RlbGV0ZSBlLl9ldmFsO30pO31mdW5jdGlvbiB0bihlLCBuLCB0LCBpLCByKSB7Zm9yICh2YXIgbyA9IFtdLCBhID0gMDsgYSA8IGUubGVuZ3RoOyBhKyspIHt2YXIgcyA9IGVbYV0sZiA9IHMuX2V2YWwobiwgdCwgaSwgcik7aWYgKHMgPT09IGYpIHJldHVybjtvLnB1c2goZik7fXJldHVybiBvO31mdW5jdGlvbiBybihlKSB7cmV0dXJuIGtlKEFTVF9VbmFyeVByZWZpeCwgZSwgeyBvcGVyYXRvcjogIiEiLCBleHByZXNzaW9uOiBlIH0pO31mdW5jdGlvbiBvbihlLCBuLCB0KSB7ZSA9IHJuKGUpO3JldHVybiB0ID8gWShlLCBrZShBU1RfU2ltcGxlU3RhdGVtZW50LCBuLCB7IGJvZHk6IG4gfSkpID09PSBlID8gZSA6IG4gOiBZKGUsIG4pO30obiA9IGZ1bmN0aW9uIG4oZSwgX24xMCkge2UuREVGTUVUSE9EKCJpc19jb25zdGFudCIsIF9uMTApO30pKEFTVF9Ob2RlLCByZXR1cm5fZmFsc2UpLCBuKEFTVF9Db25zdGFudCwgcmV0dXJuX3RydWUpLCBuKEFTVF9SZWdFeHAsIHJldHVybl9mYWxzZSksIEtlID0gbWFrZVByZWRpY2F0ZSgiISB+IC0gKyB2b2lkIiksIG4oQVNUX1VuYXJ5UHJlZml4LCBmdW5jdGlvbiAoKSB7cmV0dXJuIEtlW3RoaXMub3BlcmF0b3JdICYmIHRoaXMuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9Db25zdGFudDt9KSwgbiA9IGZ1bmN0aW9uIG4oZSwgX24xMSkge2UuREVGTUVUSE9EKCJfZXZhbCIsIF9uMTEpO30sIEFTVF9Ob2RlLkRFRk1FVEhPRCgiZXZhbHVhdGUiLCBmdW5jdGlvbiAoZSwgbikge3ZhciB0O3JldHVybiAhZS5vcHRpb24oImV2YWx1YXRlIikgfHwgKHQgPSB0aGlzLl9ldmFsKGUsIG4sIGUgPSBbXSwgMSksIGUuZm9yRWFjaChmdW5jdGlvbiAoZSkge2RlbGV0ZSBlLl9ldmFsO30pLCAhbiAmJiB0ICYmICEodCBpbnN0YW5jZW9mIFJlZ0V4cCkgJiYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIHQgfHwgIm9iamVjdCIgPT0gdHlwZW9mIHQpKSA/IHRoaXMgOiB0O30pLCBHZSA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7ZSBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gJiYgZihlLmxlZnQpLCBlIGluc3RhbmNlb2YgQVNUX0ZvckVudW1lcmF0aW9uICYmIGYoZS5pbml0KSwgZSBpbnN0YW5jZW9mIEFTVF9VbmFyeSAmJiBVTkFSWV9QT1NURklYW2Uub3BlcmF0b3JdICYmIGYoZS5leHByZXNzaW9uKTt9KSwgbihBU1RfU3RhdGVtZW50LCBmdW5jdGlvbiAoKSB7dGhyb3cgbmV3IEVycm9yKHN0cmluZ190ZW1wbGF0ZSgiQ2Fubm90IGV2YWx1YXRlIGEgc3RhdGVtZW50IFt7c3RhcnR9XSIsIHRoaXMpKTt9KSwgbihBU1RfQWNjZXNzb3IsIHJldHVybl90aGlzKSwgbihBU1RfQmlnSW50LCByZXR1cm5fdGhpcyksIG4oQVNUX0NsYXNzLCByZXR1cm5fdGhpcyksIG4oQVNUX05vZGUsIHJldHVybl90aGlzKSwgbihBU1RfQ29uc3RhbnQsIGZ1bmN0aW9uICgpIHtyZXR1cm4gdGhpcy52YWx1ZTt9KSwgbihBU1RfQXNzaWduLCBmdW5jdGlvbiAoZSwgbiwgdCwgaSkge3ZhciByID0gdGhpcy5sZWZ0O2lmICghbikge2lmICghKHIgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmKSkgcmV0dXJuIHRoaXM7aWYgKCFIT1AociwgIl9ldmFsIikpIHtpZiAoIXIuZml4ZWQpIHJldHVybiB0aGlzO3ZhciBvID0gci5kZWZpbml0aW9uKCk7aWYgKCFvLmZpeGVkKSByZXR1cm4gdGhpcztpZiAoby51bmRlY2xhcmVkKSByZXR1cm4gdGhpcztpZiAoby5sYXN0X3JlZiAhPT0gcikgcmV0dXJuIHRoaXM7aWYgKCJtIiA9PSBvLnNpbmdsZV91c2UpIHJldHVybiB0aGlzO2lmICh0aGlzLnJpZ2h0Lmhhc19zaWRlX2VmZmVjdHMoZSkpIHJldHVybiB0aGlzO319byA9IHRoaXMub3BlcmF0b3IsIG8gPSAhSE9QKHIsICJfZXZhbCIpICYmIHIgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIHIuZml4ZWQgJiYgci5kZWZpbml0aW9uKCkuZml4ZWQgPyByIDogIj0iID09IG8gPyB0aGlzLnJpZ2h0IDoga2UoQVNUX0JpbmFyeSwgdGhpcywgeyBvcGVyYXRvcjogby5zbGljZSgwLCAtMSksIGxlZnQ6IHIsIHJpZ2h0OiB0aGlzLnJpZ2h0IH0pLCByLndhbGsoR2UpLCBvID0gby5fZXZhbChlLCBuLCB0LCBpKTtyZXR1cm4gIm9iamVjdCIgPT0gdHlwZW9mIG8gPyB0aGlzIDogKGYociksIG8pO30pLCBuKEFTVF9TZXF1ZW5jZSwgZnVuY3Rpb24gKGUsIG4sIHQsIGkpIHtpZiAoIW4pIHJldHVybiB0aGlzO2ZvciAodmFyIHIgPSB0aGlzLmV4cHJlc3Npb25zLCBvID0gMCwgYSA9IHIubGVuZ3RoIC0gMTsgbyA8IGE7IG8rKykgcltvXS53YWxrKEdlKTt2YXIgcyA9IHJbYV0sZSA9IHMuX2V2YWwoZSwgbiwgdCwgaSk7cmV0dXJuIGUgPT09IHMgPyB0aGlzIDogZTt9KSwgbihBU1RfTGFtYmRhLCBmdW5jdGlvbiAoZSkge3JldHVybiBlLm9wdGlvbigidW5zYWZlIikgPyAoKGUgPSBmdW5jdGlvbiBlKCkge30pLm5vZGUgPSB0aGlzLCBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge3JldHVybiAiZnVuY3Rpb24oKXt9Ijt9LCBlKSA6IHRoaXM7fSksIG4oQVNUX0FycmF5LCBmdW5jdGlvbiAoZSwgbiwgdCwgaSkge2lmIChlLm9wdGlvbigidW5zYWZlIikpIHtmb3IgKHZhciByID0gW10sIG8gPSAwOyBvIDwgdGhpcy5lbGVtZW50cy5sZW5ndGg7IG8rKykge3ZhciBhID0gdGhpcy5lbGVtZW50c1tvXTtpZiAoYSBpbnN0YW5jZW9mIEFTVF9Ib2xlKSByZXR1cm4gdGhpczt2YXIgcyA9IGEuX2V2YWwoZSwgbiwgdCwgaSk7aWYgKGEgPT09IHMpIHJldHVybiB0aGlzO3IucHVzaChzKTt9cmV0dXJuIHI7fXJldHVybiB0aGlzO30pLCBuKEFTVF9PYmplY3QsIGZ1bmN0aW9uIChlLCBuLCB0LCBpKSB7aWYgKGUub3B0aW9uKCJ1bnNhZmUiKSkge2ZvciAodmFyIHIgPSB7fSwgbyA9IDA7IG8gPCB0aGlzLnByb3BlcnRpZXMubGVuZ3RoOyBvKyspIHt2YXIgYSA9IHRoaXMucHJvcGVydGllc1tvXTtpZiAoIShhIGluc3RhbmNlb2YgQVNUX09iamVjdEtleVZhbCkpIHJldHVybiB0aGlzO3ZhciBzID0gYS5rZXk7aWYgKHMgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiAocyA9IHMuX2V2YWwoZSwgbiwgdCwgaSkpID09PSBhLmtleSkgcmV0dXJuIHRoaXM7c3dpdGNoIChzKSB7Y2FzZSAiX19wcm90b19fIjpjYXNlICJ0b1N0cmluZyI6Y2FzZSAidmFsdWVPZiI6cmV0dXJuIHRoaXM7fWlmIChyW3NdID0gYS52YWx1ZS5fZXZhbChlLCBuLCB0LCBpKSwgcltzXSA9PT0gYS52YWx1ZSkgcmV0dXJuIHRoaXM7fXJldHVybiByO31yZXR1cm4gdGhpczt9KSwgJGUgPSBtYWtlUHJlZGljYXRlKCIhIHR5cGVvZiB2b2lkIiksIG4oQVNUX1VuYXJ5UHJlZml4LCBmdW5jdGlvbiAoZSwgbiwgdCwgaSkge3ZhciByID0gdGhpcy5leHByZXNzaW9uLG8gPSB0aGlzLm9wZXJhdG9yO2lmIChlLm9wdGlvbigidHlwZW9mcyIpICYmICJ0eXBlb2YiID09IG8gJiYgKHIgaW5zdGFuY2VvZiBBU1RfTGFtYmRhIHx8IHIgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIHIuZml4ZWRfdmFsdWUoKSBpbnN0YW5jZW9mIEFTVF9MYW1iZGEpKSByZXR1cm4gImZ1bmN0aW9uIjt2YXIgYSA9IHIgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIHIuZGVmaW5pdGlvbigpLHMgPSAoJGVbb10gfHwgYSAmJiBhLmZpeGVkIHx8IGkrKywgci53YWxrKEdlKSwgci5fZXZhbChlLCBuLCB0LCBpKSk7aWYgKHMgPT09IHIpIHJldHVybiBuICYmICJ2b2lkIiA9PSBvID8gdm9pZCAwIDogdGhpcztzd2l0Y2ggKG8pIHtjYXNlICIhIjpyZXR1cm4gIXM7Y2FzZSAidHlwZW9mIjpyZXR1cm4gcyBpbnN0YW5jZW9mIFJlZ0V4cCA/IHRoaXMgOiB0eXBlb2YgcztjYXNlICJ2b2lkIjpyZXR1cm47Y2FzZSAifiI6cmV0dXJuIH5zO2Nhc2UgIi0iOnJldHVybiAtcztjYXNlICIrIjpyZXR1cm4gK3M7Y2FzZSAiKysiOmNhc2UgIi0tIjppZiAoIWEpIHJldHVybiB0aGlzO2lmICghbikge2lmIChhLnVuZGVjbGFyZWQpIHJldHVybiB0aGlzO2lmIChhLmxhc3RfcmVmICE9PSByKSByZXR1cm4gdGhpczt9cmV0dXJuIEhPUChyLCAiX2V2YWwiKSAmJiAocyA9ICsob1swXSArIDEpICsgK3MpLCBmKHIpLCBzO31yZXR1cm4gdGhpczt9KSwgbihBU1RfVW5hcnlQb3N0Zml4LCBmdW5jdGlvbiAoZSwgbiwgdCwgaSkge3ZhciByID0gdGhpcy5leHByZXNzaW9uO2lmIChyIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikge2lmICghSE9QKHIsICJfZXZhbCIpKSB7aWYgKCFyLmZpeGVkKSByZXR1cm4gdGhpcztpZiAoIW4pIHt2YXIgbyA9IHIuZGVmaW5pdGlvbigpO2lmICghby5maXhlZCkgcmV0dXJuIHRoaXM7aWYgKG8udW5kZWNsYXJlZCkgcmV0dXJuIHRoaXM7aWYgKG8ubGFzdF9yZWYgIT09IHIpIHJldHVybiB0aGlzO319fSBlbHNlIGlmICghbikgcmV0dXJuIHRoaXM7ciBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgci5kZWZpbml0aW9uKCkuZml4ZWQgfHwgaSsrLCByLndhbGsoR2UpO28gPSByLl9ldmFsKGUsIG4sIHQsIGkpO3JldHVybiBvID09PSByID8gdGhpcyA6IChmKHIpLCArbyk7fSksIFhlID0gbWFrZVByZWRpY2F0ZSgiJiYgfHwgPT09ICE9PSIpLCBuKEFTVF9CaW5hcnksIGZ1bmN0aW9uIChlLCBuLCB0LCBpKSB7WGVbdGhpcy5vcGVyYXRvcl0gfHwgaSsrO3ZhciByID0gdGhpcy5sZWZ0Ll9ldmFsKGUsIG4sIHQsIGkpO2lmIChyID09PSB0aGlzLmxlZnQpIHJldHVybiB0aGlzO2lmICh0aGlzLm9wZXJhdG9yID09IChyID8gInx8IiA6ICImJiIpKSByZXR1cm4gcjt2YXIgbyxhID0gdGhpcy5yaWdodC5fZXZhbChlLCBuICYmICEociAmJiAib2JqZWN0IiA9PSB0eXBlb2YgciksIHQsIGkpO2lmIChhID09PSB0aGlzLnJpZ2h0KSByZXR1cm4gdGhpcztzd2l0Y2ggKHRoaXMub3BlcmF0b3IpIHtjYXNlICImJiI6byA9IHIgJiYgYTticmVhaztjYXNlICJ8fCI6byA9IHIgfHwgYTticmVhaztjYXNlICI/PyI6byA9IG51bGwgPT0gciA/IGEgOiByO2JyZWFrO2Nhc2UgInwiOm8gPSByIHwgYTticmVhaztjYXNlICImIjpvID0gciAmIGE7YnJlYWs7Y2FzZSAiXiI6byA9IHIgXiBhO2JyZWFrO2Nhc2UgIisiOm8gPSByICsgYTticmVhaztjYXNlICItIjpvID0gciAtIGE7YnJlYWs7Y2FzZSAiKiI6byA9IHIgKiBhO2JyZWFrO2Nhc2UgIi8iOm8gPSByIC8gYTticmVhaztjYXNlICIlIjpvID0gciAlIGE7YnJlYWs7Y2FzZSAiPDwiOm8gPSByIDw8IGE7YnJlYWs7Y2FzZSAiPj4iOm8gPSByID4+IGE7YnJlYWs7Y2FzZSAiPj4+IjpvID0gciA+Pj4gYTticmVhaztjYXNlICI9PSI6byA9IHIgPT0gYTticmVhaztjYXNlICI9PT0iOm8gPSByID09PSBhO2JyZWFrO2Nhc2UgIiE9IjpvID0gciAhPSBhO2JyZWFrO2Nhc2UgIiE9PSI6byA9IHIgIT09IGE7YnJlYWs7Y2FzZSAiPCI6byA9IHIgPCBhO2JyZWFrO2Nhc2UgIjw9IjpvID0gciA8PSBhO2JyZWFrO2Nhc2UgIj4iOm8gPSBhIDwgcjticmVhaztjYXNlICI+PSI6byA9IGEgPD0gcjticmVhaztjYXNlICIqKiI6byA9IE1hdGgucG93KHIsIGEpO2JyZWFrO2Nhc2UgImluIjppZiAoYSAmJiAib2JqZWN0IiA9PSB0eXBlb2YgYSAmJiBIT1AoYSwgcikpIHtvID0gITA7YnJlYWs7fWRlZmF1bHQ6cmV0dXJuIHRoaXM7fWlmIChpc05hTihvKSkgcmV0dXJuIGUuZmluZF9wYXJlbnQoQVNUX1dpdGgpID8gdGhpcyA6IG87aWYgKGUub3B0aW9uKCJ1bnNhZmVfbWF0aCIpICYmICFuICYmIG8gJiYgIm51bWJlciIgPT0gdHlwZW9mIG8gJiYgKCIrIiA9PSB0aGlzLm9wZXJhdG9yIHx8ICItIiA9PSB0aGlzLm9wZXJhdG9yKSkge3QgPSBNYXRoLm1heCgwLCBzKHIpLCBzKGEpKTtpZiAodCA8IDE2KSByZXR1cm4gK28udG9GaXhlZCh0KTt9cmV0dXJuIG87ZnVuY3Rpb24gcyhlKSB7ZSA9IC8oXC5bMC05XSopPyhlW15lXSspPyQvLmV4ZWMoK2UpO3JldHVybiAoZVsxXSB8fCAiLiIpLmxlbmd0aCAtIDEgLSAoZVsyXSB8fCAiIikuc2xpY2UoMSk7fX0pLCBuKEFTVF9Db25kaXRpb25hbCwgZnVuY3Rpb24gKGUsIG4sIHQsIGkpIHt2YXIgciA9IHRoaXMuY29uZGl0aW9uLl9ldmFsKGUsIG4sIHQsIGkpO3JldHVybiByID09PSB0aGlzLmNvbmRpdGlvbiB8fCAoZSA9IChyID0gciA/IHRoaXMuY29uc2VxdWVudCA6IHRoaXMuYWx0ZXJuYXRpdmUpLl9ldmFsKGUsIG4sIHQsIGkpKSA9PT0gciA/IHRoaXMgOiBlO30pLCBuKEFTVF9TeW1ib2xSZWYsIGZ1bmN0aW9uIChlLCBuLCB0LCBpKSB7dGhpcy5fZXZhbCA9IHJldHVybl90aGlzO3RyeSB7dmFyIHIsbyA9IHRoaXMuZml4ZWRfdmFsdWUoKTtpZiAoIW8pIHJldHVybiB0aGlzO2lmIChIT1AobywgIl9ldmFsIikpIHIgPSBvLl9ldmFsKCk7ZWxzZSB7aWYgKChyID0gby5fZXZhbChlLCBuLCB0LCBpKSkgPT09IG8pIHJldHVybiB0aGlzO28uX2V2YWwgPSBmdW5jdGlvbiAoKSB7cmV0dXJuIHI7fSwgdC5wdXNoKG8pO31yZXR1cm4gciAmJiAib2JqZWN0IiA9PSB0eXBlb2YgciAmJiAhZnVuY3Rpb24gKG4sIGUpIHt2YXIgdCA9IG4uZGVmaW5pdGlvbigpLmVzY2FwZWQ7c3dpdGNoICh0Lmxlbmd0aCkge2Nhc2UgMDpyZXR1cm4gMTtjYXNlIDE6dmFyIGkgPSAhMTtyZXR1cm4gdFswXS53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuICEhaSB8fCAoZSA9PT0gbiA/IGkgPSAhMCA6IGUgaW5zdGFuY2VvZiBBU1RfU2NvcGUgfHwgdm9pZCAwKTt9KSksIGk7ZGVmYXVsdDpyZXR1cm4gZSA8PSB0LmRlcHRoO319KHRoaXMsIGkpID8gdGhpcyA6IHI7fSBmaW5hbGx5IHtkZWxldGUgdGhpcy5fZXZhbDt9fSksIEplID0geyBBcnJheTogQXJyYXksIE1hdGg6IE1hdGgsIE51bWJlcjogTnVtYmVyLCBPYmplY3Q6IE9iamVjdCwgU3RyaW5nOiBTdHJpbmcgfSwgUWUgPSBIZSh7IE1hdGg6IFsiRSIsICJMTjEwIiwgIkxOMiIsICJMT0cyRSIsICJMT0cxMEUiLCAiUEkiLCAiU1FSVDFfMiIsICJTUVJUMiJdLCBOdW1iZXI6IFsiTUFYX1ZBTFVFIiwgIk1JTl9WQUxVRSIsICJOYU4iLCAiTkVHQVRJVkVfSU5GSU5JVFkiLCAiUE9TSVRJVkVfSU5GSU5JVFkiXSB9KSwgWmUgPSBtYWtlUHJlZGljYXRlKCJnbG9iYWwgaWdub3JlQ2FzZSBtdWx0aWxpbmUgc291cmNlIiksIG4oQVNUX1Byb3BBY2Nlc3MsIGZ1bmN0aW9uIChlLCBuLCB0LCBpKSB7aWYgKGUub3B0aW9uKCJ1bnNhZmUiKSkge3ZhciByLG8gPSB0aGlzLmV4cHJlc3Npb247aWYgKCFFZShvKSAmJiAobnVsbCA9PSAociA9IG8uX2V2YWwoZSwgbiwgdCwgaSArIDEpKSB8fCByID09PSBvKSkgcmV0dXJuIHRoaXM7dmFyIGEgPSB0aGlzLnByb3BlcnR5O2lmIChhIGluc3RhbmNlb2YgQVNUX05vZGUgJiYgKGEgPSBhLl9ldmFsKGUsIG4sIHQsIGkpKSA9PT0gdGhpcy5wcm9wZXJ0eSkgcmV0dXJuIHRoaXM7aWYgKHZvaWQgMCA9PT0gcikge2UgPSBRZVtvLm5hbWVdO2lmICghZSB8fCAhZVthXSkgcmV0dXJuIHRoaXM7ciA9IEplW28ubmFtZV07fSBlbHNlIGlmIChyIGluc3RhbmNlb2YgUmVnRXhwKSB7aWYgKCFaZVthXSkgcmV0dXJuIHRoaXM7fSBlbHNlIGlmICgib2JqZWN0IiA9PSB0eXBlb2Ygcikge2lmICghSE9QKHIsIGEpKSByZXR1cm4gdGhpczt9IGVsc2UgaWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIHIpIHN3aXRjaCAoYSkge2Nhc2UgIm5hbWUiOnJldHVybiByLm5vZGUubmFtZSA/IHIubm9kZS5uYW1lLm5hbWUgOiAiIjtjYXNlICJsZW5ndGgiOnJldHVybiByLm5vZGUubGVuZ3RoKCk7ZGVmYXVsdDpyZXR1cm4gdGhpczt9cmV0dXJuIHJbYV07fXJldHVybiB0aGlzO30pLCBuKEFTVF9DYWxsLCBmdW5jdGlvbiAoaSwgciwgbywgYSkge3ZhciBlID0gdGhpcy5leHByZXNzaW9uLG4gPSBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IGUuZml4ZWRfdmFsdWUoKSA6IGU7aWYgKG4gaW5zdGFuY2VvZiBBU1RfQXJyb3cgfHwgbiBpbnN0YW5jZW9mIEFTVF9EZWZ1biB8fCBuIGluc3RhbmNlb2YgQVNUX0Z1bmN0aW9uKSB7aWYgKCFuLmV2YWx1YXRpbmcgJiYgIShuLm5hbWUgJiYgMCA8IG4ubmFtZS5kZWZpbml0aW9uKCkucmVjdXJzaXZlX3JlZnMgfHwgdGhpcy5pc19leHByX3B1cmUoaSkpKSB7dmFyIHMgPSB0bih0aGlzLmFyZ3MsIGksIHIsIG8sIGEpO2lmIChhbGwobi5hcmduYW1lcywgZnVuY3Rpb24gKGUsIG4pIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUpIHtpZiAoIXMpIHJldHVybiAhMTtpZiAodm9pZCAwID09PSBzW25dKSB7dmFyIHQgPSBlLnZhbHVlLl9ldmFsKGksIHIsIG8sIGEpO2lmICh0ID09PSBlLnZhbHVlKSByZXR1cm4gITE7c1tuXSA9IHQ7fWUgPSBlLm5hbWU7fXJldHVybiAhKGUgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkKTt9KSAmJiAhKG4ucmVzdCBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQpICYmIChzIHx8IHIpKSB7dmFyIGYsdCA9IG4uZmlyc3Rfc3RhdGVtZW50KCk7aWYgKHQgaW5zdGFuY2VvZiBBU1RfUmV0dXJuKSByZXR1cm4gKGwgPSB0LnZhbHVlKSA/IChmID0gW10sIHMgJiYgKCFhbGwobi5hcmduYW1lcywgZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gXyhlLCBzW25dKTt9KSB8fCBuLnJlc3QgJiYgIV8obi5yZXN0LCBzLnNsaWNlKG4uYXJnbmFtZXMubGVuZ3RoKSkpICYmICFyIHx8IChyICYmIG4uYXJnbmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2UgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdFZhbHVlICYmIGUudmFsdWUud2FsayhHZSk7fSksIG4uZXZhbHVhdGluZyA9ICEwLCBsID0gbC5fZXZhbChpLCByLCBvLCBhKSwgbi5ldmFsdWF0aW5nID0gITEpLCBmLmZvckVhY2goZnVuY3Rpb24gKGUpIHtkZWxldGUgZS5fZXZhbDt9KSwgbCA9PT0gdC52YWx1ZSA/IHRoaXMgOiBsKSA6IHZvaWQgMDtpZiAocikge24ud2FsayhHZSk7dmFyIGMgPSAhMTtpZiAobi5ldmFsdWF0aW5nID0gITAsIHdhbGtfYm9keShuLCBuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3JldHVybiAhIWMgfHwgKGUgaW5zdGFuY2VvZiBBU1RfUmV0dXJuID8gKGUudmFsdWUgJiYgdm9pZCAwICE9PSBlLnZhbHVlLl9ldmFsKGksICEwLCBvLCBhKSAmJiAoYyA9ICEwKSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9TY29wZSAmJiBlICE9PSBuIHx8IHZvaWQgMCk7fSkpLCBuLmV2YWx1YXRpbmcgPSAhMSwgIWMpIHJldHVybjt9fX19IGVsc2UgaWYgKGkub3B0aW9uKCJ1bnNhZmUiKSAmJiBlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpIHt2YXIgbCx0ID0gZS5wcm9wZXJ0eTtpZiAodCBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmICh0ID0gdC5fZXZhbChpLCByLCBvLCBhKSkgPT09IGUucHJvcGVydHkpIHJldHVybiB0aGlzO2UgPSBlLmV4cHJlc3Npb247aWYgKEVlKGUpKSB7dmFyIHUgPSBlbltlLm5hbWVdO2lmICghdSB8fCAhdVt0XSkgcmV0dXJuIHRoaXM7bCA9IEplW2UubmFtZV07fSBlbHNlIHtpZiAobnVsbCA9PSAobCA9IGUuX2V2YWwoaSwgciwgbywgYSArIDEpKSB8fCBsID09PSBlKSByZXR1cm4gdGhpczt1ID0gVFtsLmNvbnN0cnVjdG9yLm5hbWVdO2lmICghdSB8fCAhdVt0XSkgcmV0dXJuIHRoaXM7aWYgKGwgaW5zdGFuY2VvZiBSZWdFeHAgJiYgbC5nbG9iYWwgJiYgIShlIGluc3RhbmNlb2YgQVNUX1JlZ0V4cCkpIHJldHVybiB0aGlzO31pZiAoIShzID0gdG4odGhpcy5hcmdzLCBpLCByLCBvLCBhKSkpIHJldHVybiB0aGlzO2lmICgicmVwbGFjZSIgPT0gdCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBzWzFdKSByZXR1cm4gdGhpczt0cnkge3JldHVybiBsW3RdLmFwcGx5KGwsIHMpO30gY2F0Y2ggKGUpIHtBU1RfTm9kZS53YXJuKCJFcnJvciBldmFsdWF0aW5nIHt0aGlzfSBbe3N0YXJ0fV0iLCB0aGlzKTt9IGZpbmFsbHkge2wgaW5zdGFuY2VvZiBSZWdFeHAgJiYgKGwubGFzdEluZGV4ID0gMCk7fX1yZXR1cm4gdGhpcztmdW5jdGlvbiBfKGUsIG4pIHt2YXIgdCxpID0gKGUgPSBlIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSA/IGUubmFtZSA6IGUpLmRlZmluaXRpb24oKTtyZXR1cm4gaS5vcmlnW2kub3JpZy5sZW5ndGggLSAxXSA9PT0gZSAmJiAodCA9IG4sIGkucmVmZXJlbmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS5fZXZhbCA9IGZ1bmN0aW9uICgpIHtyZXR1cm4gdDt9LCBmLnB1c2goZSk7fSksICEwKTt9fSksIG4oQVNUX05ldywgcmV0dXJuX3RoaXMpLCBuKEFTVF9UZW1wbGF0ZSwgZnVuY3Rpb24gKGUsIG4sIHQsIGkpIHtpZiAoZS5vcHRpb24oInRlbXBsYXRlcyIpKSB7aWYgKHRoaXMudGFnKSB7aWYgKCFldChlLCB0aGlzLnRhZykpIHJldHVybiB0aGlzO2YgPSBmdW5jdGlvbiBmKGUpIHtyZXR1cm4gZTt9O312YXIgciA9IHRuKHRoaXMuZXhwcmVzc2lvbnMsIGUsIG4sIHQsIGkpO2lmIChyKSB7Zm9yICh2YXIgbyA9ICExLCBhID0gZih0aGlzLnN0cmluZ3NbMF0pLCBzID0gMDsgcyA8IHIubGVuZ3RoOyBzKyspIGEgKz0gcltzXSArIGYodGhpcy5zdHJpbmdzW3MgKyAxXSk7aWYgKCFvKSByZXR1cm4gYTt0aGlzLl9ldmFsID0gcmV0dXJuX3RoaXM7fX1yZXR1cm4gdGhpcztmdW5jdGlvbiBmKGUpIHtyZXR1cm4gInN0cmluZyIgIT0gdHlwZW9mIChlID0gbnQoZSkpICYmIChvID0gITApLCBlO319KSwgKG4gPSBmdW5jdGlvbiBuKGUsIHQpIHtlLkRFRk1FVEhPRCgibmVnYXRlIiwgZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gdC5jYWxsKHRoaXMsIGUsIG4pO30pO30pKEFTVF9Ob2RlLCBmdW5jdGlvbiAoKSB7cmV0dXJuIHJuKHRoaXMpO30pLCBuKEFTVF9TdGF0ZW1lbnQsIGZ1bmN0aW9uICgpIHt0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBuZWdhdGUgYSBzdGF0ZW1lbnQiKTt9KSwgbihBU1RfQmluYXJ5LCBmdW5jdGlvbiAoZSwgbikge3ZhciB0ID0gdGhpcy5jbG9uZSgpLGkgPSB0aGlzLm9wZXJhdG9yO2lmIChlLm9wdGlvbigidW5zYWZlX2NvbXBzIikpIHN3aXRjaCAoaSkge2Nhc2UgIjw9IjpyZXR1cm4gdC5vcGVyYXRvciA9ICI+IiwgdDtjYXNlICI8IjpyZXR1cm4gdC5vcGVyYXRvciA9ICI+PSIsIHQ7Y2FzZSAiPj0iOnJldHVybiB0Lm9wZXJhdG9yID0gIjwiLCB0O2Nhc2UgIj4iOnJldHVybiB0Lm9wZXJhdG9yID0gIjw9IiwgdDt9c3dpdGNoIChpKSB7Y2FzZSAiPT0iOnJldHVybiB0Lm9wZXJhdG9yID0gIiE9IiwgdDtjYXNlICIhPSI6cmV0dXJuIHQub3BlcmF0b3IgPSAiPT0iLCB0O2Nhc2UgIj09PSI6cmV0dXJuIHQub3BlcmF0b3IgPSAiIT09IiwgdDtjYXNlICIhPT0iOnJldHVybiB0Lm9wZXJhdG9yID0gIj09PSIsIHQ7Y2FzZSAiJiYiOnJldHVybiB0Lm9wZXJhdG9yID0gInx8IiwgdC5sZWZ0ID0gdC5sZWZ0Lm5lZ2F0ZShlLCBuKSwgdC5yaWdodCA9IHQucmlnaHQubmVnYXRlKGUpLCBvbih0aGlzLCB0LCBuKTtjYXNlICJ8fCI6cmV0dXJuIHQub3BlcmF0b3IgPSAiJiYiLCB0LmxlZnQgPSB0LmxlZnQubmVnYXRlKGUsIG4pLCB0LnJpZ2h0ID0gdC5yaWdodC5uZWdhdGUoZSksIG9uKHRoaXMsIHQsIG4pO31yZXR1cm4gcm4odGhpcyk7fSksIG4oQVNUX0NsYXNzRXhwcmVzc2lvbiwgZnVuY3Rpb24gKCkge3JldHVybiBybih0aGlzKTt9KSwgbihBU1RfQ29uZGl0aW9uYWwsIGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQgPSB0aGlzLmNsb25lKCk7cmV0dXJuIHQuY29uc2VxdWVudCA9IHQuY29uc2VxdWVudC5uZWdhdGUoZSksIHQuYWx0ZXJuYXRpdmUgPSB0LmFsdGVybmF0aXZlLm5lZ2F0ZShlKSwgb24odGhpcywgdCwgbik7fSksIG4oQVNUX0xhbWJkYUV4cHJlc3Npb24sIGZ1bmN0aW9uICgpIHtyZXR1cm4gcm4odGhpcyk7fSksIG4oQVNUX1NlcXVlbmNlLCBmdW5jdGlvbiAoZSkge3ZhciBuID0gdGhpcy5leHByZXNzaW9ucy5zbGljZSgpO3JldHVybiBuLnB1c2gobi5wb3AoKS5uZWdhdGUoZSkpLCB3ZSh0aGlzLCBuKTt9KSwgbihBU1RfVW5hcnlQcmVmaXgsIGZ1bmN0aW9uICgpIHtyZXR1cm4gIiEiID09IHRoaXMub3BlcmF0b3IgPyB0aGlzLmV4cHJlc3Npb24gOiBybih0aGlzKTt9KTt2YXIgYW4gPSBtYWtlUHJlZGljYXRlKCJCb29sZWFuIGRlY29kZVVSSSBkZWNvZGVVUklDb21wb25lbnQgRGF0ZSBlbmNvZGVVUkkgZW5jb2RlVVJJQ29tcG9uZW50IEVycm9yIGVzY2FwZSBFdmFsRXJyb3IgaXNGaW5pdGUgaXNOYU4gTnVtYmVyIE9iamVjdCBwYXJzZUZsb2F0IHBhcnNlSW50IFJhbmdlRXJyb3IgUmVmZXJlbmNlRXJyb3IgU3RyaW5nIFN5bnRheEVycm9yIFR5cGVFcnJvciB1bmVzY2FwZSBVUklFcnJvciIpLHNuID0gbWFrZVByZWRpY2F0ZSgiTWFwIFNldCBXZWFrTWFwIFdlYWtTZXQiKTtmdW5jdGlvbiB0KGUsIG4sIHQpIHtyZXR1cm4gIWFsbChlLCB0ID8gZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQgPyAhdChlLCBuKSA6ICFlLmhhc19zaWRlX2VmZmVjdHMobik7fSA6IGZ1bmN0aW9uIChlKSB7cmV0dXJuICFlLmhhc19zaWRlX2VmZmVjdHMobik7fSk7fWZ1bmN0aW9uIGZuKGUsIG4pIHtlID0gZS5leHByZXNzaW9uO3JldHVybiAhZS5pc19zdHJpbmcobikgfHwgZS5oYXNfc2lkZV9lZmZlY3RzKG4pO31mdW5jdGlvbiBpKGUsIG4pIHtmb3IgKHZhciB0ID0gZS5sZW5ndGg7IDAgPD0gLS10OykgaWYgKGVbdF0ubWF5X3Rocm93KG4pKSByZXR1cm4gITA7cmV0dXJuICExO31mdW5jdGlvbiBjbihlLCBuKSB7cmV0dXJuICEhZS5tYXlfdGhyb3cobikgfHwgISgoZSA9IGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmID8gZS5maXhlZF92YWx1ZSgpIDogZSkgaW5zdGFuY2VvZiBBU1RfTGFtYmRhICYmICFpKGUuYXJnbmFtZXMsIG4pICYmICFpKGUuYm9keSwgbikpIHx8IGlzX2Fycm93KGUpICYmIGUudmFsdWUgJiYgZS52YWx1ZS5tYXlfdGhyb3cobik7fWZ1bmN0aW9uIGxuKGUsIG4pIHtmb3IgKHZhciB0ID0gZS5sZW5ndGg7IDAgPD0gLS10OykgaWYgKCFlW3RdLmlzX2NvbnN0YW50X2V4cHJlc3Npb24obikpIHJldHVybiAhMTtyZXR1cm4gITA7fWZ1bmN0aW9uIHVuKGksIHIpIHt2YXIgbyA9ICEwLGEgPSBbXTtyZXR1cm4gaS53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlLCBuKSB7aWYgKCFvKSByZXR1cm4gITA7aWYgKGUgaW5zdGFuY2VvZiBBU1RfQmxvY2tTY29wZSkgcmV0dXJuIGUgPT09IGkgPyB2b2lkIDAgOiAoYS5wdXNoKGUpLCBuKCksIGEucG9wKCksICEwKTtpZiAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYpIHtpZiAoaS5pbmxpbmVkIHx8IGUucmVkZWYgfHwgZS5pbl9hcmcpIHJldHVybiAhKG8gPSAhMSk7aWYgKCFpLnZhcmlhYmxlcyB8fCAhaS52YXJpYWJsZXMuaGFzKGUubmFtZSkpIHtuID0gZS5kZWZpbml0aW9uKCk7aWYgKCFtZW1iZXIobi5zY29wZSwgYSkpIHtpZiAociAmJiAhbi5yZWRlZmluZWQoKSkge3ZhciB0ID0gci5maW5kX3ZhcmlhYmxlKGUubmFtZSk7aWYgKHQgPyB0ID09PSBuIDogbi51bmRlY2xhcmVkKSByZXR1cm4gbyA9ICJmIiwgITA7fW8gPSAhMTt9fXJldHVybiAhMDt9cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfT2JqZWN0SWRlbnRpdHkgPyAoaXNfYXJyb3coaSkgJiYgYWxsKGEsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICEoZSBpbnN0YW5jZW9mIEFTVF9TY29wZSkgfHwgaXNfYXJyb3coZSk7fSkgJiYgKG8gPSAhMSksICEwKSA6IHZvaWQgMDt9KSksIG87fWZ1bmN0aW9uIHEoZSkge3JldHVybiBlICYmIGUuYWJvcnRzKCk7fWZ1bmN0aW9uIF9uKCkge3ZhciBlID0gdGhpcy5ib2R5Lmxlbmd0aDtyZXR1cm4gMCA8IGUgJiYgcSh0aGlzLmJvZHlbZSAtIDFdKTt9QVNUX0NhbGwuREVGTUVUSE9EKCJpc19leHByX3B1cmUiLCBmdW5jdGlvbiAoZSkge2lmIChlLm9wdGlvbigidW5zYWZlIikpIHt2YXIgbiA9IHRoaXMuZXhwcmVzc2lvbjtpZiAoRWUobikpIHtpZiAoYW5bbi5uYW1lXSkgcmV0dXJuICEwO2lmICh0aGlzIGluc3RhbmNlb2YgQVNUX05ldyAmJiBzbltuLm5hbWVdKSByZXR1cm4gITA7fWlmIChubihuKSkgcmV0dXJuICEwO31yZXR1cm4gZS5vcHRpb24oImFubm90YXRpb25zIikgJiYgdGhpcy5wdXJlIHx8ICFlLnB1cmVfZnVuY3ModGhpcyk7fSksIEFTVF9UZW1wbGF0ZS5ERUZNRVRIT0QoImlzX2V4cHJfcHVyZSIsIGZ1bmN0aW9uIChlKSB7dmFyIG4sdCA9IHRoaXMudGFnO2lmICghdCkgcmV0dXJuICEwO2lmIChlLm9wdGlvbigidW5zYWZlIikpIHtpZiAoRWUodCkgJiYgYW5bdC5uYW1lXSkgcmV0dXJuICEwO2lmICh0IGluc3RhbmNlb2YgQVNUX0RvdCAmJiBFZSh0LmV4cHJlc3Npb24pKSByZXR1cm4gKG4gPSBlblt0LmV4cHJlc3Npb24ubmFtZV0pICYmIChuW3QucHJvcGVydHldIHx8ICJNYXRoIiA9PSB0LmV4cHJlc3Npb24ubmFtZSAmJiAicmFuZG9tIiA9PSB0LnByb3BlcnR5KTt9cmV0dXJuICFlLnB1cmVfZnVuY3ModGhpcyk7fSksIEFTVF9Ob2RlLkRFRk1FVEhPRCgiaXNfY2FsbF9wdXJlIiwgcmV0dXJuX2ZhbHNlKSwgQVNUX0NhbGwuREVGTUVUSE9EKCJpc19jYWxsX3B1cmUiLCBmdW5jdGlvbiAoZSkge2lmICghZS5vcHRpb24oInVuc2FmZSIpKSByZXR1cm4gITE7dmFyIG4gPSB0aGlzLmV4cHJlc3Npb247aWYgKCEobiBpbnN0YW5jZW9mIEFTVF9Eb3QpKSByZXR1cm4gITE7dmFyIHQsaSA9IG4uZXhwcmVzc2lvbixyID0gbi5wcm9wZXJ0eTtpZiAoaSBpbnN0YW5jZW9mIEFTVF9BcnJheSkgdCA9IFQuQXJyYXk7ZWxzZSBpZiAoaS5pc19ib29sZWFuKGUpKSB0ID0gVC5Cb29sZWFuO2Vsc2UgaWYgKGkuaXNfbnVtYmVyKGUpKSB0ID0gVC5OdW1iZXI7ZWxzZSBpZiAoaSBpbnN0YW5jZW9mIEFTVF9SZWdFeHApIHQgPSBULlJlZ0V4cDtlbHNlIGlmIChpLmlzX3N0cmluZyhlKSkge2lmICh0ID0gVC5TdHJpbmcsICJyZXBsYWNlIiA9PSByKSB7aSA9IHRoaXMuYXJnc1sxXTtpZiAoaSAmJiAhaS5pc19zdHJpbmcoZSkpIHJldHVybiAhMTt9fSBlbHNlIG4ubWF5X3Rocm93X29uX2FjY2VzcyhlKSB8fCAodCA9IFQuT2JqZWN0KTtyZXR1cm4gdCAmJiB0W3JdO30pLCAobiA9IGZ1bmN0aW9uIG4oZSwgX24xMikge2UuREVGTUVUSE9EKCJzYWZlX3RvX3NwcmVhZCIsIF9uMTIpO30pKEFTVF9Ob2RlLCByZXR1cm5fZmFsc2UpLCBuKEFTVF9BcnJheSwgcmV0dXJuX3RydWUpLCBuKEFTVF9Bc3NpZ24sIGZ1bmN0aW9uICgpIHtzd2l0Y2ggKHRoaXMub3BlcmF0b3IpIHtjYXNlICI9IjpyZXR1cm4gdGhpcy5yaWdodC5zYWZlX3RvX3NwcmVhZCgpO2Nhc2UgIiYmPSI6Y2FzZSAifHw9IjpjYXNlICI/Pz0iOnJldHVybiB0aGlzLmxlZnQuc2FmZV90b19zcHJlYWQoKSAmJiB0aGlzLnJpZ2h0LnNhZmVfdG9fc3ByZWFkKCk7fXJldHVybiAhMDt9KSwgbihBU1RfQmluYXJ5LCBmdW5jdGlvbiAoKSB7cmV0dXJuICFOZVt0aGlzLm9wZXJhdG9yXSB8fCB0aGlzLmxlZnQuc2FmZV90b19zcHJlYWQoKSAmJiB0aGlzLnJpZ2h0LnNhZmVfdG9fc3ByZWFkKCk7fSksIG4oQVNUX0NvbnN0YW50LCByZXR1cm5fdHJ1ZSksIG4oQVNUX0xhbWJkYSwgcmV0dXJuX3RydWUpLCBuKEFTVF9PYmplY3QsIGZ1bmN0aW9uICgpIHtyZXR1cm4gYWxsKHRoaXMucHJvcGVydGllcywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX09iamVjdEdldHRlciB8fCBlIGluc3RhbmNlb2YgQVNUX1NwcmVhZCk7fSk7fSksIG4oQVNUX1NlcXVlbmNlLCBmdW5jdGlvbiAoKSB7cmV0dXJuIHRoaXMudGFpbF9ub2RlKCkuc2FmZV90b19zcHJlYWQoKTt9KSwgbihBU1RfU3ltYm9sUmVmLCBmdW5jdGlvbiAoKSB7dmFyIGUgPSB0aGlzLmZpeGVkX3ZhbHVlKCk7cmV0dXJuIGUgJiYgZS5zYWZlX3RvX3NwcmVhZCgpO30pLCBuKEFTVF9VbmFyeSwgcmV0dXJuX3RydWUpLCAobiA9IGZ1bmN0aW9uIG4oZSwgX24xMykge2UuREVGTUVUSE9EKCJoYXNfc2lkZV9lZmZlY3RzIiwgX24xMyk7fSkoQVNUX05vZGUsIHJldHVybl90cnVlKSwgbihBU1RfQXJyYXksIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHQodGhpcy5lbGVtZW50cywgZSwgZm4pO30pLCBuKEFTVF9Bc3NpZ24sIGZ1bmN0aW9uIChlKSB7dmFyIG4sdCA9IHRoaXMubGVmdDtyZXR1cm4gISh0IGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpIHx8ICEoKG4gPSB0LmV4cHJlc3Npb24pIGluc3RhbmNlb2YgQVNUX09iamVjdElkZW50aXR5KSB8fCAhbi5zY29wZS5yZXNvbHZlKCkubmV3IHx8IHQgaW5zdGFuY2VvZiBBU1RfU3ViICYmIHQucHJvcGVydHkuaGFzX3NpZGVfZWZmZWN0cyhlKSB8fCB0aGlzLnJpZ2h0Lmhhc19zaWRlX2VmZmVjdHMoZSk7fSksIG4oQVNUX0JpbmFyeSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5sZWZ0Lmhhc19zaWRlX2VmZmVjdHMoZSkgfHwgdGhpcy5yaWdodC5oYXNfc2lkZV9lZmZlY3RzKGUpIHx8ICFHbih0aGlzLCBlKTt9KSwgbihBU1RfQmxvY2ssIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHQodGhpcy5ib2R5LCBlKTt9KSwgbihBU1RfQ2FsbCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gISh0aGlzLmlzX2V4cHJfcHVyZShlKSB8fCB0aGlzLmlzX2NhbGxfcHVyZShlKSAmJiAhdGhpcy5leHByZXNzaW9uLmhhc19zaWRlX2VmZmVjdHMoZSkpIHx8IHQodGhpcy5hcmdzLCBlLCBmbik7fSksIG4oQVNUX0Nhc2UsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5oYXNfc2lkZV9lZmZlY3RzKGUpIHx8IHQodGhpcy5ib2R5LCBlKTt9KSwgbihBU1RfQ2xhc3MsIGZ1bmN0aW9uIChlKSB7dmFyIG4gPSB0aGlzLmV4dGVuZHM7cmV0dXJuICEoIW4gfHwgUmUobiA9IG4gaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmID8gbi5maXhlZF92YWx1ZSgpIDogbikpIHx8IHQodGhpcy5wcm9wZXJ0aWVzLCBlKTt9KSwgbihBU1RfQ2xhc3NQcm9wZXJ0eSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiB0aGlzLmtleS5oYXNfc2lkZV9lZmZlY3RzKGUpIHx8IHRoaXMuc3RhdGljICYmIHRoaXMudmFsdWUgJiYgdGhpcy52YWx1ZS5oYXNfc2lkZV9lZmZlY3RzKGUpO30pLCBuKEFTVF9Db25kaXRpb25hbCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5jb25kaXRpb24uaGFzX3NpZGVfZWZmZWN0cyhlKSB8fCB0aGlzLmNvbnNlcXVlbnQuaGFzX3NpZGVfZWZmZWN0cyhlKSB8fCB0aGlzLmFsdGVybmF0aXZlLmhhc19zaWRlX2VmZmVjdHMoZSk7fSksIG4oQVNUX0NvbnN0YW50LCByZXR1cm5fZmFsc2UpLCBuKEFTVF9EZWZpbml0aW9ucywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdCh0aGlzLmRlZmluaXRpb25zLCBlKTt9KSwgbihBU1RfRGVzdHJ1Y3R1cmVkQXJyYXksIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHQodGhpcy5lbGVtZW50cywgZSk7fSksIG4oQVNUX0Rlc3RydWN0dXJlZEtleVZhbCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiB0aGlzLmtleS5oYXNfc2lkZV9lZmZlY3RzKGUpIHx8IHRoaXMudmFsdWUuaGFzX3NpZGVfZWZmZWN0cyhlKTt9KSwgbihBU1RfRGVzdHJ1Y3R1cmVkT2JqZWN0LCBmdW5jdGlvbiAoZSkge3JldHVybiB0KHRoaXMucHJvcGVydGllcywgZSk7fSksIG4oQVNUX0RvdCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5leHByZXNzaW9uLm1heV90aHJvd19vbl9hY2Nlc3MoZSkgfHwgdGhpcy5leHByZXNzaW9uLmhhc19zaWRlX2VmZmVjdHMoZSk7fSksIG4oQVNUX0VtcHR5U3RhdGVtZW50LCByZXR1cm5fZmFsc2UpLCBuKEFTVF9JZiwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5jb25kaXRpb24uaGFzX3NpZGVfZWZmZWN0cyhlKSB8fCB0aGlzLmJvZHkgJiYgdGhpcy5ib2R5Lmhhc19zaWRlX2VmZmVjdHMoZSkgfHwgdGhpcy5hbHRlcm5hdGl2ZSAmJiB0aGlzLmFsdGVybmF0aXZlLmhhc19zaWRlX2VmZmVjdHMoZSk7fSksIG4oQVNUX0xhYmVsZWRTdGF0ZW1lbnQsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMuYm9keS5oYXNfc2lkZV9lZmZlY3RzKGUpO30pLCBuKEFTVF9MYW1iZGEsIHJldHVybl9mYWxzZSksIG4oQVNUX09iamVjdCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdCh0aGlzLnByb3BlcnRpZXMsIGUsIGZ1bmN0aW9uIChlLCBuKSB7ZSA9IGUuZXhwcmVzc2lvbjtyZXR1cm4gIWUuc2FmZV90b19zcHJlYWQoKSB8fCBlLmhhc19zaWRlX2VmZmVjdHMobik7fSk7fSksIG4oQVNUX09iamVjdElkZW50aXR5LCByZXR1cm5fZmFsc2UpLCBuKEFTVF9PYmplY3RQcm9wZXJ0eSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiB0aGlzLmtleS5oYXNfc2lkZV9lZmZlY3RzKGUpIHx8IHRoaXMudmFsdWUuaGFzX3NpZGVfZWZmZWN0cyhlKTt9KSwgbihBU1RfU2VxdWVuY2UsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHQodGhpcy5leHByZXNzaW9ucywgZSk7fSksIG4oQVNUX1NpbXBsZVN0YXRlbWVudCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5ib2R5Lmhhc19zaWRlX2VmZmVjdHMoZSk7fSksIG4oQVNUX1N1YiwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5leHByZXNzaW9uLm1heV90aHJvd19vbl9hY2Nlc3MoZSkgfHwgdGhpcy5leHByZXNzaW9uLmhhc19zaWRlX2VmZmVjdHMoZSkgfHwgdGhpcy5wcm9wZXJ0eS5oYXNfc2lkZV9lZmZlY3RzKGUpO30pLCBuKEFTVF9Td2l0Y2gsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5oYXNfc2lkZV9lZmZlY3RzKGUpIHx8IHQodGhpcy5ib2R5LCBlKTt9KSwgbihBU1RfU3ltYm9sRGVjbGFyYXRpb24sIHJldHVybl9mYWxzZSksIG4oQVNUX1N5bWJvbFJlZiwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIXRoaXMuaXNfZGVjbGFyZWQoZSkgfHwgIWJlKHRoaXMsIGUpO30pLCBuKEFTVF9UZW1wbGF0ZSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIXRoaXMuaXNfZXhwcl9wdXJlKGUpIHx8IHQodGhpcy5leHByZXNzaW9ucywgZSk7fSksIG4oQVNUX1RyeSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdCh0aGlzLmJvZHksIGUpIHx8IHRoaXMuYmNhdGNoICYmIHRoaXMuYmNhdGNoLmhhc19zaWRlX2VmZmVjdHMoZSkgfHwgdGhpcy5iZmluYWxseSAmJiB0aGlzLmJmaW5hbGx5Lmhhc19zaWRlX2VmZmVjdHMoZSk7fSksIG4oQVNUX1VuYXJ5LCBmdW5jdGlvbiAoZSkge3JldHVybiB1bmFyeV9zaWRlX2VmZmVjdHNbdGhpcy5vcGVyYXRvcl0gfHwgdGhpcy5leHByZXNzaW9uLmhhc19zaWRlX2VmZmVjdHMoZSk7fSksIG4oQVNUX1ZhckRlZiwgZnVuY3Rpb24gKCkge3JldHVybiB0aGlzLnZhbHVlO30pLCAobiA9IGZ1bmN0aW9uIG4oZSwgX24xNCkge2UuREVGTUVUSE9EKCJtYXlfdGhyb3ciLCBfbjE0KTt9KShBU1RfTm9kZSwgcmV0dXJuX3RydWUpLCBuKEFTVF9Db25zdGFudCwgcmV0dXJuX2ZhbHNlKSwgbihBU1RfRW1wdHlTdGF0ZW1lbnQsIHJldHVybl9mYWxzZSksIG4oQVNUX0xhbWJkYSwgcmV0dXJuX2ZhbHNlKSwgbihBU1RfT2JqZWN0SWRlbnRpdHksIHJldHVybl9mYWxzZSksIG4oQVNUX1N5bWJvbERlY2xhcmF0aW9uLCByZXR1cm5fZmFsc2UpLCBuKEFTVF9BcnJheSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gaSh0aGlzLmVsZW1lbnRzLCBlKTt9KSwgbihBU1RfQXNzaWduLCBmdW5jdGlvbiAoZSkge3JldHVybiAhIXRoaXMucmlnaHQubWF5X3Rocm93KGUpIHx8ICEoIWUuaGFzX2RpcmVjdGl2ZSgidXNlIHN0cmljdCIpICYmICI9IiA9PSB0aGlzLm9wZXJhdG9yICYmIHRoaXMubGVmdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYpICYmIHRoaXMubGVmdC5tYXlfdGhyb3coZSk7fSksIG4oQVNUX0F3YWl0LCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLmV4cHJlc3Npb24ubWF5X3Rocm93KGUpO30pLCBuKEFTVF9CaW5hcnksIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMubGVmdC5tYXlfdGhyb3coZSkgfHwgdGhpcy5yaWdodC5tYXlfdGhyb3coZSkgfHwgIUduKHRoaXMsIGUpO30pLCBuKEFTVF9CbG9jaywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gaSh0aGlzLmJvZHksIGUpO30pLCBuKEFTVF9DYWxsLCBmdW5jdGlvbiAoZSkge2lmIChpKHRoaXMuYXJncywgZSkpIHJldHVybiAhMDtpZiAodGhpcy5pc19leHByX3B1cmUoZSkpIHJldHVybiAhMTt0aGlzLm1heV90aHJvdyA9IHJldHVybl90cnVlO2UgPSBjbih0aGlzLmV4cHJlc3Npb24sIGUpO3JldHVybiBkZWxldGUgdGhpcy5tYXlfdGhyb3csIGU7fSksIG4oQVNUX0Nhc2UsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5tYXlfdGhyb3coZSkgfHwgaSh0aGlzLmJvZHksIGUpO30pLCBuKEFTVF9Db25kaXRpb25hbCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5jb25kaXRpb24ubWF5X3Rocm93KGUpIHx8IHRoaXMuY29uc2VxdWVudC5tYXlfdGhyb3coZSkgfHwgdGhpcy5hbHRlcm5hdGl2ZS5tYXlfdGhyb3coZSk7fSksIG4oQVNUX0RlZmF1bHRWYWx1ZSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5uYW1lLm1heV90aHJvdyhlKSB8fCB0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUubWF5X3Rocm93KGUpO30pLCBuKEFTVF9EZWZpbml0aW9ucywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gaSh0aGlzLmRlZmluaXRpb25zLCBlKTt9KSwgbihBU1RfRG90LCBmdW5jdGlvbiAoZSkge3JldHVybiAhdGhpcy5vcHRpb25hbCAmJiB0aGlzLmV4cHJlc3Npb24ubWF5X3Rocm93X29uX2FjY2VzcyhlKSB8fCB0aGlzLmV4cHJlc3Npb24ubWF5X3Rocm93KGUpO30pLCBuKEFTVF9Gb3JFbnVtZXJhdGlvbiwgZnVuY3Rpb24gKGUpIHt2YXIgbjtyZXR1cm4gISF0aGlzLmluaXQubWF5X3Rocm93KGUpIHx8ICEhKG4gPSB0aGlzLm9iamVjdCkubWF5X3Rocm93KGUpIHx8ICEoKG4gPSBuLnRhaWxfbm9kZSgpKSBpbnN0YW5jZW9mIEFTVF9BcnJheSB8fCBuLmlzX3N0cmluZyhlKSkgfHwgdGhpcy5ib2R5Lm1heV90aHJvdyhlKTt9KSwgbihBU1RfSWYsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMuY29uZGl0aW9uLm1heV90aHJvdyhlKSB8fCB0aGlzLmJvZHkgJiYgdGhpcy5ib2R5Lm1heV90aHJvdyhlKSB8fCB0aGlzLmFsdGVybmF0aXZlICYmIHRoaXMuYWx0ZXJuYXRpdmUubWF5X3Rocm93KGUpO30pLCBuKEFTVF9MYWJlbGVkU3RhdGVtZW50LCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLmJvZHkubWF5X3Rocm93KGUpO30pLCBuKEFTVF9PYmplY3QsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGkodGhpcy5wcm9wZXJ0aWVzLCBlKTt9KSwgbihBU1RfT2JqZWN0UHJvcGVydHksIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMudmFsdWUubWF5X3Rocm93KGUpIHx8IHRoaXMua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgJiYgdGhpcy5rZXkubWF5X3Rocm93KGUpO30pLCBuKEFTVF9SZXR1cm4sIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMudmFsdWUgJiYgdGhpcy52YWx1ZS5tYXlfdGhyb3coZSk7fSksIG4oQVNUX1NlcXVlbmNlLCBmdW5jdGlvbiAoZSkge3JldHVybiBpKHRoaXMuZXhwcmVzc2lvbnMsIGUpO30pLCBuKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMuYm9keS5tYXlfdGhyb3coZSk7fSksIG4oQVNUX1N1YiwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIXRoaXMub3B0aW9uYWwgJiYgdGhpcy5leHByZXNzaW9uLm1heV90aHJvd19vbl9hY2Nlc3MoZSkgfHwgdGhpcy5leHByZXNzaW9uLm1heV90aHJvdyhlKSB8fCB0aGlzLnByb3BlcnR5Lm1heV90aHJvdyhlKTt9KSwgbihBU1RfU3dpdGNoLCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLmV4cHJlc3Npb24ubWF5X3Rocm93KGUpIHx8IGkodGhpcy5ib2R5LCBlKTt9KSwgbihBU1RfU3ltYm9sUmVmLCBmdW5jdGlvbiAoZSkge3JldHVybiAhdGhpcy5pc19kZWNsYXJlZChlKSB8fCAhYmUodGhpcywgZSk7fSksIG4oQVNUX1RlbXBsYXRlLCBmdW5jdGlvbiAoZSkge2lmIChpKHRoaXMuZXhwcmVzc2lvbnMsIGUpKSByZXR1cm4gITA7aWYgKHRoaXMuaXNfZXhwcl9wdXJlKGUpKSByZXR1cm4gITE7aWYgKCF0aGlzLnRhZykgcmV0dXJuICExO3RoaXMubWF5X3Rocm93ID0gcmV0dXJuX3RydWU7ZSA9IGNuKHRoaXMudGFnLCBlKTtyZXR1cm4gZGVsZXRlIHRoaXMubWF5X3Rocm93LCBlO30pLCBuKEFTVF9UcnksIGZ1bmN0aW9uIChlKSB7cmV0dXJuICh0aGlzLmJjYXRjaCA/IHRoaXMuYmNhdGNoLm1heV90aHJvdyhlKSA6IGkodGhpcy5ib2R5LCBlKSkgfHwgdGhpcy5iZmluYWxseSAmJiB0aGlzLmJmaW5hbGx5Lm1heV90aHJvdyhlKTt9KSwgbihBU1RfVW5hcnksIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5tYXlfdGhyb3coZSkgJiYgISgidHlwZW9mIiA9PSB0aGlzLm9wZXJhdG9yICYmIHRoaXMuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYpO30pLCBuKEFTVF9WYXJEZWYsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMubmFtZS5tYXlfdGhyb3coZSkgfHwgdGhpcy52YWx1ZSAmJiB0aGlzLnZhbHVlLm1heV90aHJvdyhlKTt9KSwgKG4gPSBmdW5jdGlvbiBuKGUsIF9uMTUpIHtlLkRFRk1FVEhPRCgiaXNfY29uc3RhbnRfZXhwcmVzc2lvbiIsIF9uMTUpO30pKEFTVF9Ob2RlLCByZXR1cm5fZmFsc2UpLCBuKEFTVF9BcnJheSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gbG4odGhpcy5lbGVtZW50cywgZSk7fSksIG4oQVNUX0JpbmFyeSwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5sZWZ0LmlzX2NvbnN0YW50X2V4cHJlc3Npb24oZSkgJiYgdGhpcy5yaWdodC5pc19jb25zdGFudF9leHByZXNzaW9uKGUpICYmIEduKHRoaXMpO30pLCBuKEFTVF9DbGFzcywgZnVuY3Rpb24gKGUpIHt2YXIgbiA9IHRoaXMuZXh0ZW5kcztyZXR1cm4gIShuICYmICFSZShuKSkgJiYgbG4odGhpcy5wcm9wZXJ0aWVzLCBlKTt9KSwgbihBU1RfQ2xhc3NQcm9wZXJ0eSwgZnVuY3Rpb24gKGUpIHt2YXIgbjtyZXR1cm4gInN0cmluZyIgPT0gdHlwZW9mIHRoaXMua2V5ICYmICghKG4gPSB0aGlzLnZhbHVlKSB8fCAodGhpcy5zdGF0aWMgPyBuLmlzX2NvbnN0YW50X2V4cHJlc3Npb24oZSkgOiB1bihuLCBlKSkpO30pLCBuKEFTVF9Db25zdGFudCwgcmV0dXJuX3RydWUpLCBuKEFTVF9MYW1iZGEsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHVuKHRoaXMsIGUpO30pLCBuKEFTVF9PYmplY3QsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGxuKHRoaXMucHJvcGVydGllcywgZSk7fSksIG4oQVNUX09iamVjdElkZW50aXR5LCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLnNjb3BlLnJlc29sdmUoKSA9PT0gZTt9KSwgbihBU1RfT2JqZWN0UHJvcGVydHksIGZ1bmN0aW9uIChlKSB7cmV0dXJuICJzdHJpbmciID09IHR5cGVvZiB0aGlzLmtleSAmJiB0aGlzLnZhbHVlLmlzX2NvbnN0YW50X2V4cHJlc3Npb24oZSk7fSksIG4oQVNUX1VuYXJ5LCBmdW5jdGlvbiAoZSkge3JldHVybiB0aGlzLmV4cHJlc3Npb24uaXNfY29uc3RhbnRfZXhwcmVzc2lvbihlKTt9KSwgKG4gPSBmdW5jdGlvbiBuKGUsIF9uMTYpIHtlLkRFRk1FVEhPRCgiYWJvcnRzIiwgX24xNik7fSkoQVNUX1N0YXRlbWVudCwgcmV0dXJuX251bGwpLCBuKEFTVF9KdW1wLCByZXR1cm5fdGhpcyksIG4oQVNUX0Jsb2NrU3RhdGVtZW50LCBfbiksIG4oQVNUX1N3aXRjaEJyYW5jaCwgX24pLCBuKEFTVF9JZiwgZnVuY3Rpb24gKCkge3JldHVybiB0aGlzLmFsdGVybmF0aXZlICYmIHEodGhpcy5ib2R5KSAmJiBxKHRoaXMuYWx0ZXJuYXRpdmUpICYmIHRoaXM7fSk7dmFyIFNuID0gbWFrZVByZWRpY2F0ZShbInVzZSBhc20iLCAidXNlIHN0cmljdCJdKTtmdW5jdGlvbiBwbihlLCBuLCB0KSB7c3dpdGNoIChlLmJvZHkubGVuZ3RoKSB7Y2FzZSAwOnJldHVybiB0ID8gTGlzdC5za2lwIDoga2UoQVNUX0VtcHR5U3RhdGVtZW50LCBlKTtjYXNlIDE6dmFyIGkgPSBlLmJvZHlbMF07cmV0dXJuIGFlKGkpID8gbiBpbnN0YW5jZW9mIEFTVF9JdGVyYXRpb25TdGF0ZW1lbnQgJiYgaSBpbnN0YW5jZW9mIEFTVF9MYW1iZGFEZWZpbml0aW9uID8gZSA6IGkgOiBlO31yZXR1cm4gZTt9ZnVuY3Rpb24gZG4oZSwgbikgeyFuLm9wdGlvbigicmVzdHMiKSB8fCBlLnVzZXNfYXJndW1lbnRzIHx8IGUucmVzdCBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRBcnJheSAmJiBuLmRyb3BfZmFyZ3MoZSwgbi5wYXJlbnQoKSkgJiYgKGUuYXJnbmFtZXMgPSBlLmFyZ25hbWVzLmNvbmNhdChlLnJlc3QuZWxlbWVudHMpLCBlLnJlc3QgPSBlLnJlc3QucmVzdCk7fWZ1bmN0aW9uIEFuKGUsIG4pIHtpZiAobi5vcHRpb24oImFycm93cyIpKSB7ZG4oZSwgbiksIGUudmFsdWUgJiYgKGUuYm9keSA9IFtlLmZpcnN0X3N0YXRlbWVudCgpXSk7dmFyIHQgPSBtZShlLmJvZHksIG4pO3N3aXRjaCAodC5sZW5ndGgpIHtjYXNlIDE6dmFyIGkgPSB0WzBdO2lmIChpIGluc3RhbmNlb2YgQVNUX1JldHVybikge2UuYm9keS5sZW5ndGggPSAwLCBlLnZhbHVlID0gaS52YWx1ZTticmVhazt9ZGVmYXVsdDplLmJvZHkgPSB0LCBlLnZhbHVlID0gbnVsbDt9fXJldHVybiBlO31lKEFTVF9EaXJlY3RpdmUsIGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuICFuLm9wdGlvbigiZGlyZWN0aXZlcyIpIHx8IFNuW2UudmFsdWVdICYmIG4uaGFzX2RpcmVjdGl2ZShlLnZhbHVlKSA9PT0gZSA/IGUgOiBrZShBU1RfRW1wdHlTdGF0ZW1lbnQsIGUpO30pLCBlKEFTVF9EZWJ1Z2dlciwgZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gbi5vcHRpb24oImRyb3BfZGVidWdnZXIiKSA/IGtlKEFTVF9FbXB0eVN0YXRlbWVudCwgZSkgOiBlO30pLCBlKEFTVF9MYWJlbGVkU3RhdGVtZW50LCBmdW5jdGlvbiAoZSwgbikge2lmIChlLmJvZHkgaW5zdGFuY2VvZiBBU1RfSWYgfHwgZS5ib2R5IGluc3RhbmNlb2YgQVNUX0JyZWFrKSB7dmFyIHQgPSBtZShbZS5ib2R5XSwgbik7c3dpdGNoICh0Lmxlbmd0aCkge2Nhc2UgMDplLmJvZHkgPSBrZShBU1RfRW1wdHlTdGF0ZW1lbnQsIGUpO2JyZWFrO2Nhc2UgMTplLmJvZHkgPSB0WzBdO2JyZWFrO2RlZmF1bHQ6ZS5ib2R5ID0ga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBlLCB7IGJvZHk6IHQgfSk7fX1yZXR1cm4gbi5vcHRpb24oInVudXNlZCIpICYmIDAgPT0gZS5sYWJlbC5yZWZlcmVuY2VzLmxlbmd0aCA/IGUuYm9keSA6IGU7fSksIGUoQVNUX0xvb3BDb250cm9sLCBmdW5jdGlvbiAoZSwgbikge3ZhciB0LCBpO3JldHVybiBuLm9wdGlvbigiZGVhZF9jb2RlIikgJiYgKHQgPSBlLmxhYmVsKSAmJiAoaSA9IG4ubG9vcGNvbnRyb2xfdGFyZ2V0KGUpLCBlLmxhYmVsID0gbnVsbCwgbi5sb29wY29udHJvbF90YXJnZXQoZSkgPT09IGkgPyByZW1vdmUodC50aGVkZWYucmVmZXJlbmNlcywgZSkgOiBlLmxhYmVsID0gdCksIGU7fSksIGUoQVNUX0Jsb2NrLCBmdW5jdGlvbiAoZSwgbikge3JldHVybiBlLmJvZHkgPSBtZShlLmJvZHksIG4pLCBlO30pLCBlKEFTVF9CbG9ja1N0YXRlbWVudCwgZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gZS5ib2R5ID0gbWUoZS5ib2R5LCBuKSwgcG4oZSwgbi5wYXJlbnQoKSk7fSksIGUoQVNUX0xhbWJkYSwgZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gZG4oZSwgbiksIGUuYm9keSA9IG1lKGUuYm9keSwgbiksIGU7fSksIGUoQVNUX0Fycm93LCBBbiksIGUoQVNUX0FzeW5jQXJyb3csIEFuKSwgZShBU1RfRnVuY3Rpb24sIGZ1bmN0aW9uIChuLCBlKSB7ZG4obiwgZSksIG4uYm9keSA9IG1lKG4uYm9keSwgZSk7dmFyIHQgPSBlLnBhcmVudCgpO2lmIChlLm9wdGlvbigiaW5saW5lIikpIGZvciAodmFyIGkgPSAwOyBpIDwgbi5ib2R5Lmxlbmd0aDsgaSsrKSB7dmFyIHIgPSBuLmJvZHlbaV07aWYgKCEociBpbnN0YW5jZW9mIEFTVF9EaXJlY3RpdmUpKSB7aWYgKHIgaW5zdGFuY2VvZiBBU1RfUmV0dXJuKSB7aWYgKGkgIT0gbi5ib2R5Lmxlbmd0aCAtIDEpIGJyZWFrO3ZhciBvID0gci52YWx1ZTtpZiAoIW8gfHwgIkNhbGwiICE9IG8uVFlQRSkgYnJlYWs7aWYgKG8uaXNfZXhwcl9wdXJlKGUpKSBicmVhazt2YXIgYSxyID0gby5leHByZXNzaW9uO2lmIChyIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikge2lmIChuLm5hbWUgJiYgbi5uYW1lLmRlZmluaXRpb24oKSA9PT0gci5kZWZpbml0aW9uKCkpIGJyZWFrO2EgPSByLmZpeGVkX3ZhbHVlKCk7fSBlbHNlIGEgPSByO2lmICghKGEgaW5zdGFuY2VvZiBBU1RfRGVmdW4gfHwgYSBpbnN0YW5jZW9mIEFTVF9GdW5jdGlvbikpIGJyZWFrO2lmIChhLnJlc3QpIGJyZWFrO2lmIChhLnVzZXNfYXJndW1lbnRzKSBicmVhaztpZiAoYSA9PT0gcikge2lmIChhLnBhcmVudF9zY29wZSAhPT0gbikgYnJlYWs7aWYgKCFhbGwoYS5lbmNsb3NlZCwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gZS5zY29wZSAhPT0gbjt9KSkgYnJlYWs7fWlmICgoYSAhPT0gciB8fCBhLm5hbWUpICYmICh0IGluc3RhbmNlb2YgQVNUX0NsYXNzTWV0aG9kIHx8IHQgaW5zdGFuY2VvZiBBU1RfT2JqZWN0TWV0aG9kKSAmJiB0LnZhbHVlID09PSBlLnNlbGYoKSkgYnJlYWs7aWYgKGEuY29udGFpbnNfdGhpcygpKSBicmVhazt2YXIgcyA9IGEuYXJnbmFtZXMubGVuZ3RoO2lmICgwIDwgcyAmJiBlLm9wdGlvbigiaW5saW5lIikgPCAyKSBicmVhaztpZiAocyA+IG4uYXJnbmFtZXMubGVuZ3RoKSBicmVhaztpZiAoIWFsbChuLmFyZ25hbWVzLCBmdW5jdGlvbiAoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZzt9KSkgYnJlYWs7aWYgKCFhbGwoby5hcmdzLCBmdW5jdGlvbiAoZSkge3JldHVybiAhKGUgaW5zdGFuY2VvZiBBU1RfU3ByZWFkKTt9KSkgYnJlYWs7Zm9yICh2YXIgZiA9IDA7IGYgPCBzOyBmKyspIHt2YXIgYyA9IG8uYXJnc1tmXTtpZiAoIShjIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikpIGJyZWFrO2lmIChjLmRlZmluaXRpb24oKSAhPT0gbi5hcmduYW1lc1tmXS5kZWZpbml0aW9uKCkpIGJyZWFrO31pZiAoZiA8IHMpIGJyZWFrO2ZvciAoOyBmIDwgby5hcmdzLmxlbmd0aCAmJiAhby5hcmdzW2ZdLmhhc19zaWRlX2VmZmVjdHMoZSk7IGYrKyk7aWYgKGYgPCBvLmFyZ3MubGVuZ3RoKSBicmVhaztpZiAocyA8IG4uYXJnbmFtZXMubGVuZ3RoICYmICFlLmRyb3BfZmFyZ3MobiwgdCkpIHtpZiAoIWUuZHJvcF9mYXJncyhhLCBvKSkgYnJlYWs7Zm9yICg7IGEuYXJnbmFtZXMucHVzaChhLm1ha2VfdmFyKEFTVF9TeW1ib2xGdW5hcmcsIGEsICJhcmd1bWVudF8iICsgcykpLCArK3MgPCBuLmFyZ25hbWVzLmxlbmd0aDspO31yZXR1cm4gcjt9YnJlYWs7fX1yZXR1cm4gbjt9KTt2YXIgVG4gPSBtYWtlUHJlZGljYXRlKCJhcmd1bWVudHMgYXdhaXQgeWllbGQiKTtmdW5jdGlvbiBobihlLCBuKSB7Zm9yICh2YXIgdCA9IG4ubGVuZ3RoOyAwIDw9IC0tdDspIG5bdF0gfHwgKG5bdF0gPSBrZShBU1RfSG9sZSwgZSkpO31mdW5jdGlvbiBtbihlLCBuKSB7ZSA9IGtlKEFTVF9DbGFzc0V4cHJlc3Npb24sIGUpO3JldHVybiBlLm5hbWUgJiYgKGUubmFtZSA9IG4gPyBudWxsIDoga2UoQVNUX1N5bWJvbENsYXNzLCBlLm5hbWUpKSwgZTt9ZnVuY3Rpb24gdm4oZSwgbikge3ZhciB0O3N3aXRjaCAoZS5DVE9SKSB7Y2FzZSBBU1RfQXN5bmNEZWZ1bjp0ID0gQVNUX0FzeW5jRnVuY3Rpb247YnJlYWs7Y2FzZSBBU1RfQXN5bmNHZW5lcmF0b3JEZWZ1bjp0ID0gQVNUX0FzeW5jR2VuZXJhdG9yRnVuY3Rpb247YnJlYWs7Y2FzZSBBU1RfRGVmdW46dCA9IEFTVF9GdW5jdGlvbjticmVhaztjYXNlIEFTVF9HZW5lcmF0b3JEZWZ1bjp0ID0gQVNUX0dlbmVyYXRvckZ1bmN0aW9uO312YXIgaSA9IGtlKHQsIGUpO3JldHVybiBpLm5hbWUgPSBuID8gbnVsbCA6IGtlKEFTVF9TeW1ib2xMYW1iZGEsIGUubmFtZSksIGk7fWZ1bmN0aW9uIHluKG4sIHQpIHtuLndhbGsobmV3IFRyZWVXYWxrZXIoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9SZXR1cm4gPyAodChlKSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9TY29wZSAmJiBlICE9PSBuIHx8IHZvaWQgMDt9KSk7fWZ1bmN0aW9uIGduKGUpIHt2YXIgbiA9IE9iamVjdC5jcmVhdGUobnVsbCk7cmV0dXJuIHluKGUsIGZ1bmN0aW9uIChlKSB7dmFyIGUgPSBlLnZhbHVlOyhlID0gZSAmJiBlLnRhaWxfbm9kZSgpKSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgKGUgPSBlLmRlZmluaXRpb24oKS5pZCwgbltlXSA9IChuW2VdIHx8IDApICsgMSk7fSksIG47fWZ1bmN0aW9uIGJuKGUsIG4sIHQpIHtpZiAodC5leHBvc2VkKGUpKSByZXR1cm4gITE7c3dpdGNoIChlLnJlZmVyZW5jZXMubGVuZ3RoIC0gZS5yZXBsYWNlZCAtIChuW2UuaWRdIHx8IDApKSB7Y2FzZSBlLmRyb3BfcmV0dXJuOnJldHVybiAiZCI7Y2FzZSBlLmJvb2xfcmV0dXJuOnJldHVybiAhMDt9fWZ1bmN0aW9uIHhuKGUsIGkpIHt5bihlLCBmdW5jdGlvbiAoZSkge2UuaW5fYm9vbCA9ICEwO3ZhciBuLHQgPSBlLnZhbHVlO3QgJiYgKChuID0gTihpLCB0KSkgPyBuIGluc3RhbmNlb2YgQVNUX05vZGUgfHwgKHQgPSB0LmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShpKSwgZS52YWx1ZSA9IHQgPyB3ZShlLnZhbHVlLCBbdCwga2UoQVNUX051bWJlciwgZS52YWx1ZSwgeyB2YWx1ZTogMSB9KV0pIDoga2UoQVNUX051bWJlciwgZS52YWx1ZSwgeyB2YWx1ZTogMSB9KSkgOiAodCA9IHQuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKGkpLCBlLnZhbHVlID0gdCA/IHdlKGUudmFsdWUsIFt0LCBrZShBU1RfTnVtYmVyLCBlLnZhbHVlLCB7IHZhbHVlOiAwIH0pXSkgOiBudWxsKSk7fSk7fWZ1bmN0aW9uIGtuKGUsIG4pIHtyZXR1cm4gIWUubmFtZSB8fCAhbi5vcHRpb24oImllIikgfHwgKGUgPSBlLm5hbWUuZGVmaW5pdGlvbigpLCAhbi5leHBvc2VkKGUpICYmIGFsbChlLnJlZmVyZW5jZXMsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICEoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYpO30pKTt9ZnVuY3Rpb24gd24obywgbiwgZSkge2lmIChuIGluc3RhbmNlb2YgQVNUX0xhbWJkYSkge3ZhciB0LGkgPSBpc19hcnJvdyhuKSxyID0gaXNfYXN5bmMobiksYSA9ICExLHMgPSAhMTtpZiAoaSAmJiBvLm9wdGlvbigiYXJyb3dzIikgPyBuLnZhbHVlID8gciAmJiAhaChvLCBuLnZhbHVlKSB8fCAodCA9IG4udmFsdWUuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKG8pKSAhPT0gbi52YWx1ZSAmJiAoYSA9ICEwLCBuLnZhbHVlID0gdCkgOiBzID0gITAgOiBpc19nZW5lcmF0b3IobikgfHwgKHMgPSAhKCFlICYmIG4ubmFtZSkgfHwgKHQgPSBuLm5hbWUuZGVmaW5pdGlvbigpKS5yZWZlcmVuY2VzLmxlbmd0aCA9PSB0LnJlcGxhY2VkKSwgcyAmJiAobi5wcm9jZXNzX2V4cHJlc3Npb24oITEsIGZ1bmN0aW9uIChlKSB7dmFyIG4gPSBlLnZhbHVlO2lmIChuKSB7aWYgKHIgJiYgIWgobywgbikpIHJldHVybiBlO24gPSBuLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShvLCAhMCk7fXJldHVybiBhID0gITAsIG4gPyBrZShBU1RfU2ltcGxlU3RhdGVtZW50LCBlLCB7IGJvZHk6IG4gfSkgOiBrZShBU1RfRW1wdHlTdGF0ZW1lbnQsIGUpO30pLCB5bihuLCBmdW5jdGlvbiAoZSkge3ZhciBuLHQgPSBlLnZhbHVlOyF0IHx8IHIgJiYgIWgobywgdCkgfHwgKG4gPSB0LmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShvKSkgIT09IHQgJiYgKGEgPSAhMCwgbiAmJiByICYmICFoKG8sIG4pICYmIChuID0gbi5uZWdhdGUobykpLCBlLnZhbHVlID0gbik7fSkpLCByICYmIG8ub3B0aW9uKCJhd2FpdHMiKSkge3MgJiYgbi5wcm9jZXNzX2V4cHJlc3Npb24oImF3YWl0cyIsIGZ1bmN0aW9uIChlKSB7dmFyIG4gPSBlLmJvZHk7aWYgKG4gaW5zdGFuY2VvZiBBU1RfQXdhaXQpIHtpZiAoaChvLCBuLmV4cHJlc3Npb24pKSB7aWYgKGEgPSAhMCwgIShuID0gbi5leHByZXNzaW9uLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShvLCAhMCkpKSByZXR1cm4ga2UoQVNUX0VtcHR5U3RhdGVtZW50LCBlKTtlLmJvZHkgPSBuO319IGVsc2UgaWYgKG4gaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UpIHtmb3IgKHZhciB0ID0gbi5leHByZXNzaW9ucywgaSA9IHQubGVuZ3RoOyAwIDw9IC0taTspIHt2YXIgciA9IHRbaV07aWYgKCEociBpbnN0YW5jZW9mIEFTVF9Bd2FpdCkpIGJyZWFrO3IgPSByLmV4cHJlc3Npb247aWYgKCFoKG8sIHIpKSBicmVhaztpZiAoYSA9ICEwLCB0W2ldID0gci5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUobykpIGJyZWFrO31zd2l0Y2ggKGkpIHtjYXNlIC0xOnJldHVybiBrZShBU1RfRW1wdHlTdGF0ZW1lbnQsIGUpO2Nhc2UgMDplLmJvZHkgPSB0WzBdO2JyZWFrO2RlZmF1bHQ6dC5sZW5ndGggPSBpICsgMTt9fXJldHVybiBlO30pO3ZhciBmLGMgPSAhcyAmJiBuLm5hbWUgfHwgaSAmJiBuLnZhbHVlICYmICFoKG8sIG4udmFsdWUpLGwgPSBuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3JldHVybiAhIWMgfHwgKGwucGFyZW50KCkgPT09IG4gJiYgZS5tYXlfdGhyb3cobykgfHwgZSBpbnN0YW5jZW9mIEFTVF9Bd2FpdCB8fCBlIGluc3RhbmNlb2YgQVNUX0ZvckF3YWl0T2YgPyBjID0gITAgOiBlIGluc3RhbmNlb2YgQVNUX1JldHVybiA/IGUudmFsdWUgJiYgIWgobywgZS52YWx1ZSkgPyBjID0gITAgOiB2b2lkIDAgOiBlIGluc3RhbmNlb2YgQVNUX1Njb3BlICYmIGUgIT09IG4gfHwgdm9pZCAwKTt9KTtpZiAobi53YWxrKGwpLCAhYykge3N3aXRjaCAobi5DVE9SKSB7Y2FzZSBBU1RfQXN5bmNBcnJvdzpmID0gQVNUX0Fycm93O2JyZWFrO2Nhc2UgQVNUX0FzeW5jRnVuY3Rpb246ZiA9IEFTVF9GdW5jdGlvbjticmVhaztjYXNlIEFTVF9Bc3luY0dlbmVyYXRvckZ1bmN0aW9uOmYgPSBBU1RfR2VuZXJhdG9yRnVuY3Rpb247fXJldHVybiBrZShmLCBuKTt9fXJldHVybiBhICYmIG4uY2xvbmUoKTt9fWZ1bmN0aW9uIF8oZSwgbiwgdCwgaSkge2ZvciAodmFyIHIgPSBlLmxlbmd0aCwgbyA9IFtdLCBhID0gITEsIHMgPSAwOyBzIDwgcjsgcysrKSB7dmFyIGYgPSBlW3NdLGMgPSBpICYmIGYgaW5zdGFuY2VvZiBBU1RfU3ByZWFkID8gaShmLCBuLCB0KSA6IGYuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKG4sIHQpO2MgIT09IGYgJiYgKGEgPSAhMCksIGMgJiYgKG8ucHVzaChjKSwgdCA9ICExKTt9cmV0dXJuIG8ubGVuZ3RoID8gYSA/IG8gOiBlIDogbnVsbDt9ZnVuY3Rpb24gRG4oZSwgbiwgdCkge3ZhciBpID0gZS5leHByZXNzaW9uO3JldHVybiBpLmlzX3N0cmluZyhuKSA/IGkuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKG4sIHQpIDogZTt9ZnVuY3Rpb24gRW4oZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1NwcmVhZCA/IGtlKEFTVF9BcnJheSwgZSwgeyBlbGVtZW50czogW2VdIH0pIDogZTt9ZnVuY3Rpb24gQ24obiwgZSwgdCkge3QgPSB0IHx8IEFTVF9Mb29wQ29udHJvbDt2YXIgaSA9ICExLHIgPSBuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3JldHVybiAhIShpIHx8IGUgaW5zdGFuY2VvZiBBU1RfU2NvcGUpIHx8IChlIGluc3RhbmNlb2YgdCAmJiByLmxvb3Bjb250cm9sX3RhcmdldChlKSA9PT0gbiA/IGkgPSAhMCA6IHZvaWQgMCk7fSk7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfTGFiZWxlZFN0YXRlbWVudCAmJiByLnB1c2goZSksIHIucHVzaChuKSwgbi5ib2R5LndhbGsociksIGk7fWZ1bmN0aW9uIHooZSwgbiwgdCkge2lmICgoZSA9IGUgaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgPyBlLnRhaWxfbm9kZSgpIDogZSkgaW5zdGFuY2VvZiBBU1RfQmluYXJ5KSBpZiAoZS5sZWZ0IGluc3RhbmNlb2YgQVNUX1N0cmluZykge2lmIChlLnJpZ2h0IGluc3RhbmNlb2YgQVNUX1VuYXJ5UHJlZml4ICYmICJ0eXBlb2YiID09IGUucmlnaHQub3BlcmF0b3IpIHt2YXIgaSA9IGUucmlnaHQuZXhwcmVzc2lvbjtpZiAoRWUoaSkpIHt2YXIgcixvLGEscyxmLGMsbCx1ID0gInVuZGVmaW5lZCIgPT0gZS5sZWZ0LnZhbHVlO3N3aXRjaCAoZS5vcGVyYXRvcikge2Nhc2UgIj09IjpyID0gdSA/IHQgOiBuO2JyZWFrO2Nhc2UgIiE9IjpyID0gdSA/IG4gOiB0O2JyZWFrO2RlZmF1bHQ6cmV0dXJuO31yICYmIChvID0gITEsIGEgPSBpLmRlZmluaXRpb24oKSwgZiA9IFtdLCBjID0gW10sIGwgPSBuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSwgbikge2lmIChvKSByZXR1cm4gITA7aWYgKGUgaW5zdGFuY2VvZiBBU1RfQXNzaWduKSB7dmFyIHQgPSBlLmxlZnQ7aWYgKCEodCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgdC5kZWZpbml0aW9uKCkgPT09IGEpKSByZXR1cm47c3dpdGNoIChlLnJpZ2h0LndhbGsobCksIGUub3BlcmF0b3IpIHtjYXNlICI9IjpjYXNlICImJj0iOm8gPSAhMDt9cmV0dXJuICEwO312YXIgaTtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9DYWxsID8gKG4oKSwgKHMgPSBlLmV4cHJlc3Npb24udGFpbF9ub2RlKCkpIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiAocyA9IHMuZml4ZWRfdmFsdWUoKSwgaSA9IGYubGVuZ3RoKSwgcyBpbnN0YW5jZW9mIEFTVF9MYW1iZGEgPyBwdXNoX3VuaXEoYywgcykgJiYgcy53YWxrKGwpIDogbyA9ICEwLCAwIDw9IGkgJiYgKGYubGVuZ3RoID0gaSksICEwKSA6IGUgaW5zdGFuY2VvZiBBU1RfRFdMb29wID8gKGkgPSBmLmxlbmd0aCwgbigpLCBvICYmIChmLmxlbmd0aCA9IGkpLCAhMCkgOiBlIGluc3RhbmNlb2YgQVNUX0ZvciA/IChlLmluaXQgJiYgZS5pbml0LndhbGsobCksIGkgPSBmLmxlbmd0aCwgZS5jb25kaXRpb24gJiYgZS5jb25kaXRpb24ud2FsayhsKSwgZS5ib2R5LndhbGsobCksIGUuc3RlcCAmJiBlLnN0ZXAud2FsayhsKSwgbyAmJiAoZi5sZW5ndGggPSBpKSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9Gb3JFbnVtZXJhdGlvbiA/IChlLm9iamVjdC53YWxrKGwpLCBpID0gZi5sZW5ndGgsIGUuaW5pdC53YWxrKGwpLCBlLmJvZHkud2FsayhsKSwgbyAmJiAoZi5sZW5ndGggPSBpKSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9TY29wZSA/IGUgIT09IHMgfHwgdm9pZCAwIDogZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyAoZS5kZWZpbml0aW9uKCkgPT09IGEgJiYgZi5wdXNoKGUpLCAhMCkgOiB2b2lkIDA7fSksIHIud2FsayhsKSwgZi5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS5kZWZpbmVkID0gITA7fSkpO319fSBlbHNlIHN3aXRjaCAoZS5vcGVyYXRvcikge2Nhc2UgIiYmIjp6KGUubGVmdCwgbiksIHooZS5yaWdodCwgbik7YnJlYWs7Y2FzZSAifHwiOnooXyhlLmxlZnQpLCB0KSwgeihfKGUucmlnaHQpLCB0KTt9ZnVuY3Rpb24gXyhlKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfQmluYXJ5KSBzd2l0Y2ggKGUub3BlcmF0b3IpIHtjYXNlICI9PSI6cmV0dXJuIChlID0gZS5jbG9uZSgpKS5vcGVyYXRvciA9ICIhPSIsIGU7Y2FzZSAiIT0iOnJldHVybiAoZSA9IGUuY2xvbmUoKSkub3BlcmF0b3IgPSAiPT0iLCBlO319fWZ1bmN0aW9uIE4oZSwgbiwgdCkge3JldHVybiAhIW4udHJ1dGh5IHx8IChDZShuKSA/IHZvaWQgMCA6ICEobi5mYWxzeSAmJiAhdCkgJiYgKCEhbi5pc190cnV0aHkoKSB8fCBuLmV2YWx1YXRlKGUsICEwKSkpO31mdW5jdGlvbiBObihlLCBuKSB7dmFyIHQsaSA9IDAsciA9ICExLG8gPSBlLnNlbGYoKTtpZiAoIWlzX3N0YXRlbWVudChvKSkgZm9yICg7Oykge2lmICh0ID0gbywgKG8gPSBlLnBhcmVudChpKyspKSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkpIHN3aXRjaCAodCkge2Nhc2Ugby5sZWZ0OmlmIChOZVtvLm9wZXJhdG9yXSkgY29udGludWU7YnJlYWs7Y2FzZSBvLnJpZ2h0OmlmIChzKG8ubGVmdCkpIHN3aXRjaCAoby5vcGVyYXRvcikge2Nhc2UgIiYmIjpuW3IgPyAiZmFsc3kiIDogInRydXRoeSJdID0gITA7YnJlYWs7Y2FzZSAifHwiOmNhc2UgIj8/IjpuW3IgPyAidHJ1dGh5IiA6ICJmYWxzeSJdID0gITA7fX0gZWxzZSBpZiAobyBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCkge3ZhciBhID0gby5jb25kaXRpb247aWYgKGEgPT09IHQpIGNvbnRpbnVlO2lmIChzKGEpKSBzd2l0Y2ggKHQpIHtjYXNlIG8uY29uc2VxdWVudDpuW3IgPyAiZmFsc3kiIDogInRydXRoeSJdID0gITA7YnJlYWs7Y2FzZSBvLmFsdGVybmF0aXZlOm5bciA/ICJ0cnV0aHkiIDogImZhbHN5Il0gPSAhMDt9fSBlbHNlIHtpZiAobyBpbnN0YW5jZW9mIEFTVF9FeGl0KSBicmVhaztpZiAobyBpbnN0YW5jZW9mIEFTVF9JZikgYnJlYWs7aWYgKG8gaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UpIHtpZiAoby5leHByZXNzaW9uc1swXSA9PT0gdCkgY29udGludWU7fSBlbHNlIGlmIChvIGluc3RhbmNlb2YgQVNUX1NpbXBsZVN0YXRlbWVudCkgYnJlYWs7fXJldHVybjt9Zm9yICg7Oykge2lmICh0ID0gbywgKG8gPSBlLnBhcmVudChpKyspKSBpbnN0YW5jZW9mIEFTVF9CbG9ja1N0YXRlbWVudCkge2lmIChvLmJvZHlbMF0gPT09IHQpIGNvbnRpbnVlO30gZWxzZSBpZiAobyBpbnN0YW5jZW9mIEFTVF9JZiAmJiBzKG8uY29uZGl0aW9uKSkgc3dpdGNoICh0KSB7Y2FzZSBvLmJvZHk6bltyID8gImZhbHN5IiA6ICJ0cnV0aHkiXSA9ICEwO2JyZWFrO2Nhc2Ugby5hbHRlcm5hdGl2ZTpuW3IgPyAidHJ1dGh5IiA6ICJmYWxzeSJdID0gITA7fXJldHVybjt9ZnVuY3Rpb24gcyhlKSB7cmV0dXJuIG4uZXF1YWxzKGUpIHx8IGUgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgIiEiID09IGUub3BlcmF0b3IgJiYgbi5lcXVhbHMoZS5leHByZXNzaW9uKSAmJiAociA9ICEwKTt9fWZ1bmN0aW9uIFJuKHIpIHtyZXR1cm4gZnVuY3Rpb24gKG4sIHQpIHt2YXIgaSA9ICExO3JldHVybiB0aGlzLmRlZmluaXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLnZhbHVlICYmIChpID0gITApLCBlLm5hbWUubWF0Y2hfc3ltYm9sKGZ1bmN0aW9uIChlKSB7ZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiAmJiB0LnB1c2goa2UoQVNUX1ZhckRlZiwgZSwgeyBuYW1lOiBlLCB2YWx1ZTogcihuLCBlKSB9KSk7fSwgITApO30pLCBpO307fWZ1bmN0aW9uIE9uKGUpIHtyZXR1cm4gImFyZ3VtZW50cyIgIT0gZS5uYW1lICYmIGUub3JpZy5sZW5ndGggPCAoZS5vcmlnWzBdIGluc3RhbmNlb2YgQVNUX1N5bWJvbExhbWJkYSA/IDMgOiAyKTt9ZnVuY3Rpb24gQm4oZSwgbikge2lmIChlLmV4cG9zZWQobikpIHJldHVybiAhMDtmb3IgKHZhciB0ID0gbi5zY29wZS5yZXNvbHZlKCksIGkgPSBuLnNjb3BlOyBpICE9PSB0OykgaWYgKChpID0gaS5wYXJlbnRfc2NvcGUpLnZhcl9uYW1lcygpLmhhcyhuLm5hbWUpKSByZXR1cm4gITA7fWZ1bmN0aW9uIFBuKGUsIHIpIHtyZXR1cm4ga2UoQVNUX0xldCwgZSwgeyBkZWZpbml0aW9uczogZS5kZWZpbml0aW9ucy5tYXAoZnVuY3Rpb24gKGUpIHtyZXR1cm4ga2UoQVNUX1ZhckRlZiwgZSwgeyBuYW1lOiBlLm5hbWUuY29udmVydF9zeW1ib2woQVNUX1N5bWJvbExldCwgZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCA9IGUuZGVmaW5pdGlvbigpO3Qub3JpZ1t0Lm9yaWcuaW5kZXhPZihuKV0gPSBlO2ZvciAodmFyIGkgPSByOyBpICE9PSB0LnNjb3BlICYmIChpID0gaS5wYXJlbnRfc2NvcGUpOykgcmVtb3ZlKGkuZW5jbG9zZWQsIHQpOyh0LnNjb3BlID0gcikudmFyaWFibGVzLnNldCh0Lm5hbWUsIHQpO30pLCB2YWx1ZTogZS52YWx1ZSB9KTt9KSB9KTt9ZnVuY3Rpb24gRm4oZSwgaSkge3JldHVybiBrZShBU1RfVmFyLCBlLCB7IGRlZmluaXRpb25zOiBlLmRlZmluaXRpb25zLm1hcChmdW5jdGlvbiAoZSkge3JldHVybiBrZShBU1RfVmFyRGVmLCBlLCB7IG5hbWU6IGUubmFtZS5jb252ZXJ0X3N5bWJvbChBU1RfU3ltYm9sVmFyLCBmdW5jdGlvbiAoZSwgbikge3ZhciB0ID0gZS5kZWZpbml0aW9uKCk7dC5vcmlnW3Qub3JpZy5pbmRleE9mKG4pXSA9IGUsIHQuc2NvcGUgIT09IGkgJiYgKCh0LnNjb3BlID0gaSkudmFyaWFibGVzLnNldCh0Lm5hbWUsIHQpLCBpLmVuY2xvc2VkLnB1c2godCksIGkudmFyX25hbWVzKCkuc2V0KHQubmFtZSwgITApKTt9KSwgdmFsdWU6IGUudmFsdWUgfSk7fSkgfSk7fWZ1bmN0aW9uIHFuKGUsIG4pIHtuID0gbi5kZWZpbml0aW9uKCk7cmV0dXJuIChuLmZpeGVkIHx8IDAgPT09IG4uZml4ZWQpICYmIE9uKG4pICYmIFpuKG4pICYmICFCbihlLCBuKTt9ZnVuY3Rpb24gem4oZSwgbikge2lmIChuLm9wdGlvbigib3B0aW9uYWxfY2hhaW5zIikgJiYgZS50ZXJtaW5hbCkgZG8ge3ZhciB0ID0gZS5leHByZXNzaW9uO2lmIChlLm9wdGlvbmFsKSB7dmFyIGkgPSBOKG4sIHQsICEwKTtpZiAobnVsbCA9PSBpKSByZXR1cm4ga2UoQVNUX1VuYXJ5UHJlZml4LCBlLCB7IG9wZXJhdG9yOiAidm9pZCIsIGV4cHJlc3Npb246IHQgfSkub3B0aW1pemUobik7aSBpbnN0YW5jZW9mIEFTVF9Ob2RlIHx8IChlLm9wdGlvbmFsID0gITEpO319IHdoaWxlICgoIkNhbGwiID09IChlID0gdCkuVFlQRSB8fCBlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpICYmICFlLnRlcm1pbmFsKTt9ZnVuY3Rpb24gRyhlKSB7dmFyIG4sdCA9IGUuZXhwcmVzc2lvbjtyZXR1cm4gdCBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSA/ICh0ID0gdC5leHByZXNzaW9ucy5zbGljZSgpLCAobiA9IGUuY2xvbmUoKSkuZXhwcmVzc2lvbiA9IHQucG9wKCksIHQucHVzaChuKSwgd2UoZSwgdCkpIDogZTt9ZnVuY3Rpb24gVW4oZSwgdCwgbikge3ZhciBpID0gZS5leHByZXNzaW9uLHIgPSBpIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IGkuZml4ZWRfdmFsdWUoKSA6IGk7aWYgKHIgaW5zdGFuY2VvZiBBU1RfTGFtYmRhICYmICFyLnVzZXNfYXJndW1lbnRzICYmICEoci5waW5uZWQoKSB8fCBuICYmIG4uaW5kZXhPZihyKSA8IDApKSB7dmFyIG8gPSBlLmFyZ3M7aWYgKGFsbChvLCBmdW5jdGlvbiAoZSkge3JldHVybiAhKGUgaW5zdGFuY2VvZiBBU1RfU3ByZWFkKTt9KSkge3ZhciBhID0gci5hcmduYW1lcyxuID0gciA9PT0gaSAmJiAhci5uYW1lO2lmIChyLnJlc3QpIHtpZiAoIW4gfHwgIXQub3B0aW9uKCJyZXN0cyIpKSByZXR1cm47Zm9yICh2YXIgcyA9IGEubGVuZ3RoLCBvID0gby5zbGljZSgwLCBzKTsgby5sZW5ndGggPCBzOykgby5wdXNoKGtlKEFTVF9VbmRlZmluZWQsIGUpLm9wdGltaXplKHQpKTtvLnB1c2goa2UoQVNUX0FycmF5LCBlLCB7IGVsZW1lbnRzOiBlLmFyZ3Muc2xpY2UocykgfSkpLCBhID0gYS5jb25jYXQoci5yZXN0KSwgci5yZXN0ID0gbnVsbDt9IGVsc2UgbyA9IG8uc2xpY2UoKSwgYSA9IGEuc2xpY2UoKTtmb3IgKHZhciBmID0gMCwgYyA9IDAsIGwgPSBuICYmIHQub3B0aW9uKCJkZWZhdWx0X3ZhbHVlcyIpLCB1ID0gbiAmJiB0LmRyb3BfZmFyZ3MociwgZSkgPyBmdW5jdGlvbiAoZSwgbikge3JldHVybiAhZSB8fCAoZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRBcnJheSA/IDAgPT0gZS5lbGVtZW50cy5sZW5ndGggJiYgIWUucmVzdCAmJiBuIGluc3RhbmNlb2YgQVNUX0FycmF5IDogZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRPYmplY3QgPyAwID09IGUucHJvcGVydGllcy5sZW5ndGggJiYgIWUucmVzdCAmJiBuICYmICFuLm1heV90aHJvd19vbl9hY2Nlc3ModCkgOiBlLnVudXNlZCk7fSA6IHJldHVybl9mYWxzZSwgXyA9IFtdLCBTID0gMDsgUyA8IG8ubGVuZ3RoOyBTKyspIHt2YXIgcCA9IGFbU107aWYgKGwgJiYgcCBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgJiYgb1tTXS5pc19kZWZpbmVkKHQpICYmIChhW1NdID0gcCA9IHAubmFtZSksIHAgJiYgdm9pZCAwID09PSBwLnVudXNlZCkge2lmICh1KHAsIG9bU10pKSB7ZCA9IG9bU10uZHJvcF9zaWRlX2VmZmVjdF9mcmVlKHQpO2Euc3BsaWNlKFMsIDEpLCBvLnNwbGljZShTLCAxKSwgZCAmJiBfLnB1c2goZCksIFMtLTtjb250aW51ZTt9Xy5wdXNoKG9bU10pLCBvW2YrK10gPSB3ZShlLCBfKSwgXyA9IFtdO30gZWxzZSB7dmFyIGQgPSBvW1NdLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZSh0KTtpZiAodShwKSkge3AgJiYgYS5zcGxpY2UoUywgMSksIG8uc3BsaWNlKFMsIDEpLCBkICYmIF8ucHVzaChkKSwgUy0tO2NvbnRpbnVlO31pZiAoZCkgXy5wdXNoKGQpLCBvW2YrK10gPSB3ZShlLCBfKSwgXyA9IFtdO2Vsc2UgaWYgKHApIHtpZiAoIV8ubGVuZ3RoKSB7b1tmKytdID0ga2UoQVNUX051bWJlciwgb1tTXSwgeyB2YWx1ZTogMCB9KTtjb250aW51ZTt9b1tmKytdID0gd2UoZSwgXyksIF8gPSBbXTt9fWMgPSBmO31mb3IgKDsgUyA8IGEubGVuZ3RoOyBTKyspIHUoYVtTXSkgJiYgYS5zcGxpY2UoUy0tLCAxKTtyLmFyZ25hbWVzID0gYSwgby5sZW5ndGggPSBjLCBlLmFyZ3MgPSBvLCBfLmxlbmd0aCAmJiAoaSA9IHdlKGUsIF8pLCBvLnB1c2goby5sZW5ndGggPCBhLmxlbmd0aCA/IGtlKEFTVF9VbmFyeVByZWZpeCwgZSwgeyBvcGVyYXRvcjogInZvaWQiLCBleHByZXNzaW9uOiBpIH0pIDogaSkpO319fWZ1bmN0aW9uIGpuKGUsIG4pIHtuID0gbiB8fCBlLmZpbmRfcGFyZW50KEFTVF9TY29wZSk7dmFyIHQgPSBbXTtyZXR1cm4gKGlzX2FzeW5jKG4pIHx8IG4gaW5zdGFuY2VvZiBBU1RfVG9wbGV2ZWwgJiYgZS5vcHRpb24oIm1vZHVsZSIpKSAmJiB0LnB1c2goImF3YWl0IiksIGlzX2dlbmVyYXRvcihuKSAmJiB0LnB1c2goInlpZWxkIiksIHQubGVuZ3RoICYmIG1ha2VQcmVkaWNhdGUodCk7fWZ1bmN0aW9uIExuKHQsIGkpIHt2YXIgciwgbztyZXR1cm4gIWkgfHwgKHIgPSAhMCwgbyA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7aWYgKCFyKSByZXR1cm4gITA7aWYgKGUgaW5zdGFuY2VvZiBBU1RfU2NvcGUpIHtpZiAoZSA9PT0gdCkgcmV0dXJuO2lmIChpc19hcnJvdyhlKSkgZm9yICh2YXIgbiA9IDA7IHIgJiYgbiA8IGUuYXJnbmFtZXMubGVuZ3RoOyBuKyspIGUuYXJnbmFtZXNbbl0ud2FsayhvKTtlbHNlIGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRGVmaW5pdGlvbiAmJiBpW2UubmFtZS5uYW1lXSAmJiAociA9ICExKTtyZXR1cm4gITA7fWUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sICYmIGlbZS5uYW1lXSAmJiBlICE9PSB0Lm5hbWUgJiYgKHIgPSAhMSk7fSksIHQud2FsayhvKSwgcik7fWZ1bmN0aW9uIFZuKGUsIG4pIHtyZXR1cm4gZS5pbl9zdHJpY3RfbW9kZShuKSB8fCAhbi5oYXNfZGlyZWN0aXZlKCJ1c2Ugc3RyaWN0Iik7fWZ1bmN0aW9uIEluKHQsIGksIGUsIG4pIHtpZiAobiBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgKCImJiIgPT0gbi5vcGVyYXRvciB8fCAifHwiID09IG4ub3BlcmF0b3IpICYmIG4ucmlnaHQgaW5zdGFuY2VvZiBBU1RfQXNzaWduICYmICI9IiA9PSBuLnJpZ2h0Lm9wZXJhdG9yICYmIG4ucmlnaHQubGVmdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgbi5yaWdodC5sZWZ0LmRlZmluaXRpb24oKSA9PT0gaSAmJiAhZS5oYXNfc2lkZV9lZmZlY3RzKHQpICYmIHIobi5sZWZ0KSAmJiByKG4ucmlnaHQucmlnaHQpKSByZXR1cm4gaS5yZXBsYWNlZCsrLCBrZShBU1RfQ29uZGl0aW9uYWwsIG4sICImJiIgPT0gbi5vcGVyYXRvciA/IHsgY29uZGl0aW9uOiBuLmxlZnQsIGNvbnNlcXVlbnQ6IG4ucmlnaHQucmlnaHQsIGFsdGVybmF0aXZlOiBlIH0gOiB7IGNvbmRpdGlvbjogbi5sZWZ0LCBjb25zZXF1ZW50OiBlLCBhbHRlcm5hdGl2ZTogbi5yaWdodC5yaWdodCB9KTtmdW5jdGlvbiByKGUpIHt2YXIgbjtpZiAoIWUuaGFzX3NpZGVfZWZmZWN0cyh0KSkgcmV0dXJuIG4gPSAhMSwgZS53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuICEhbiB8fCAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgZS5kZWZpbml0aW9uKCkgPT09IGkgPyBuID0gITAgOiB2b2lkIDApO30pKSwgIW47fX1BU1RfU2NvcGUuREVGTUVUSE9EKCJtZXJnZV92YXJpYWJsZXMiLCBmdW5jdGlvbiAobCkge2lmIChsLm9wdGlvbigibWVyZ2VfdmFycyIpKSB7Zm9yICh2YXIgdSwgXywgUyA9IFtdLCBwID0ge30sIGQgPSB0aGlzLCBzID0gW10sIGYgPSBbXSwgYyA9IDAsIEEgPSBuZXcgRGljdGlvbmFyeSgpLCBUID0gT2JqZWN0LmNyZWF0ZShudWxsKSwgaCA9IE9iamVjdC5jcmVhdGUobnVsbCksIG0gPSBuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAodCwgZSkge3ZhciBuLCBpLCByLCBvLCBhLCBzO3JldHVybiB0IGluc3RhbmNlb2YgQVNUX0Fzc2lnbiA/IChhID0gdC5sZWZ0LCBvID0gdC5yaWdodCwgYSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWQgPyAoby53YWxrKG0pLCB4KEFTVF9TeW1ib2xSZWYsIGssIGEpLCAhMCkgOiBOZVt0Lm9wZXJhdG9yLnNsaWNlKDAsIC0xKV0gPyAoYS53YWxrKG0pLCBnKCksIG8ud2FsayhtKSwgYSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgayhhKSwgYigpLCAhMCkgOiBhIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/ICgiPSIgIT0gdC5vcGVyYXRvciAmJiBrKGEsICEwKSwgby53YWxrKG0pLCBrKGEpLCAhMCkgOiB2b2lkIDApIDogdCBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgPyBOZVt0Lm9wZXJhdG9yXSA/IChjKHQpLCAhMCkgOiB2b2lkIDAgOiB0IGluc3RhbmNlb2YgQVNUX0JyZWFrID8gKChzID0gbS5sb29wY29udHJvbF90YXJnZXQodCkpIGluc3RhbmNlb2YgQVNUX0l0ZXJhdGlvblN0YXRlbWVudCB8fCB3KHMpLCAhMCkgOiB0IGluc3RhbmNlb2YgQVNUX0NhbGwgPyAoKGkgPSB0LmV4cHJlc3Npb24pIGluc3RhbmNlb2YgQVNUX0xhbWJkYUV4cHJlc3Npb24gPyAodC5hcmdzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLndhbGsobSk7fSksIGkud2FsayhtKSkgOiAoZSgpLCBmKGkpKSwgITApIDogdCBpbnN0YW5jZW9mIEFTVF9DbGFzcyA/ICh0Lm5hbWUgJiYgdC5uYW1lLndhbGsobSksIHQuZXh0ZW5kcyAmJiB0LmV4dGVuZHMud2FsayhtKSwgdC5wcm9wZXJ0aWVzLmZpbHRlcihmdW5jdGlvbiAoZSkge3JldHVybiBlLmtleSBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmIGUua2V5LndhbGsobSksIGUudmFsdWU7fSkuZm9yRWFjaChmdW5jdGlvbiAoZSkge2Uuc3RhdGljID8gZS52YWx1ZS53YWxrKG0pIDogKGcoKSwgcC5ibG9jayA9IHQsIGUudmFsdWUud2FsayhtKSwgYigpKTt9KSwgITApIDogdCBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCA/IChjKHQuY29uZGl0aW9uLCB0LmNvbnNlcXVlbnQsIHQuYWx0ZXJuYXRpdmUpLCAhMCkgOiB0IGluc3RhbmNlb2YgQVNUX0NvbnRpbnVlID8gKChzID0gbS5sb29wY29udHJvbF90YXJnZXQodCkpIGluc3RhbmNlb2YgQVNUX0RvICYmIHcocyksICEwKSA6IHQgaW5zdGFuY2VvZiBBU1RfRG8gPyAoZygpLCBwLmJsb2NrID0gdCwgcC5sb29wID0gITAsIHIgPSBwLCB0LmJvZHkud2FsayhtKSwgcC5pbnNlcnRlZCA9PT0gdCAmJiAocCA9IHIpLCB0LmNvbmRpdGlvbi53YWxrKG0pLCBiKCksICEwKSA6IHQgaW5zdGFuY2VvZiBBU1RfRm9yID8gKHQuaW5pdCAmJiB0LmluaXQud2FsayhtKSwgZygpLCBwLmJsb2NrID0gdCwgcC5sb29wID0gITAsIHQuY29uZGl0aW9uICYmIHQuY29uZGl0aW9uLndhbGsobSksIHQuYm9keS53YWxrKG0pLCB0LnN0ZXAgJiYgdC5zdGVwLndhbGsobSksIGIoKSwgITApIDogdCBpbnN0YW5jZW9mIEFTVF9Gb3JFbnVtZXJhdGlvbiA/ICh0Lm9iamVjdC53YWxrKG0pLCBnKCksIHAuYmxvY2sgPSB0LCBwLmxvb3AgPSAhMCwgdC5pbml0LndhbGsobSksIHQuYm9keS53YWxrKG0pLCBiKCksICEwKSA6IHQgaW5zdGFuY2VvZiBBU1RfSWYgPyAoYyh0LmNvbmRpdGlvbiwgdC5ib2R5LCB0LmFsdGVybmF0aXZlKSwgITApIDogdCBpbnN0YW5jZW9mIEFTVF9MYWJlbGVkU3RhdGVtZW50ID8gKGcoKSwgcC5ibG9jayA9IHQsIHIgPSBwLCB0LmJvZHkud2FsayhtKSwgcC5pbnNlcnRlZCA9PT0gdCAmJiAocCA9IHIpLCBiKCksICEwKSA6IHQgaW5zdGFuY2VvZiBBU1RfU2NvcGUgPyAoZygpLCAocC5ibG9jayA9IHQpID09PSBkICYmIChfID0gcCksIHQgaW5zdGFuY2VvZiBBU1RfTGFtYmRhICYmICh0Lm5hbWUgJiYgKFRbdC5uYW1lLmRlZmluaXRpb24oKS5pZF0gPSAhMSksIG4gPSB0LnVzZXNfYXJndW1lbnRzICYmICFtLmhhc19kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSA/IGZ1bmN0aW9uIChlKSB7VFtlLmRlZmluaXRpb24oKS5pZF0gPSAhMTt9IDogZnVuY3Rpb24gKGUpIHtrKGUpO30sIFMucHVzaCh0KSwgdC5hcmduYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7eChBU1RfU3ltYm9sRnVuYXJnLCBuLCBlKTt9KSwgdC5yZXN0ICYmIHgoQVNUX1N5bWJvbEZ1bmFyZywgbiwgdC5yZXN0KSwgUy5wb3AoKSksIHdhbGtfbGFtYmRhKHQsIG0pLCBiKCksICEwKSA6IHQgaW5zdGFuY2VvZiBBU1RfU3ViID8gKGkgPSB0LmV4cHJlc3Npb24sICh0Lm9wdGlvbmFsID8gKGkud2FsayhtKSwgZygpLCB0LnByb3BlcnR5LndhbGsobSksIGIpIDogZSkoKSwgZihpKSwgITApIDogdCBpbnN0YW5jZW9mIEFTVF9Td2l0Y2ggPyAodC5leHByZXNzaW9uLndhbGsobSksIHIgPSBwLCB0LmJvZHkuZm9yRWFjaChmdW5jdGlvbiAoZSkge2UgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdCB8fCAoZS5leHByZXNzaW9uLndhbGsobSksIHIgPT09IHAgJiYgZygpKTt9KSwgcCA9IHIsIHQuYm9keS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZygpLCBwLmJsb2NrID0gdDt2YXIgbiA9IHA7d2Fsa19ib2R5KGUsIG0pLCBwLmluc2VydGVkID09PSB0ICYmIChwID0gbiksIGIoKTt9KSwgITApIDogdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiA/ICEoVFt0LmRlZmluaXRpb24oKS5pZF0gPSAhMSkgOiB0IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IChrKHQsICEwKSwgITApIDogdCBpbnN0YW5jZW9mIEFTVF9UcnkgPyAobyA9IHUsIHUgPSB0LCB3YWxrX2JvZHkodCwgbSksIHQuYmNhdGNoICYmICh0LmJjYXRjaC5hcmduYW1lICYmIHQuYmNhdGNoLmFyZ25hbWUubWFya19zeW1ib2woZnVuY3Rpb24gKGUpIHtlIGluc3RhbmNlb2YgQVNUX1N5bWJvbENhdGNoICYmIChlID0gZS5kZWZpbml0aW9uKCksIFRbZS5pZF0gPSAhMSwgZSA9IGUucmVkZWZpbmVkKCkpICYmIChUW2UuaWRdID0gITEpO30sIG0pLCB0LmJmaW5hbGx5IHx8ICh1ID0gbykgPyB3YWxrX2JvZHkodC5iY2F0Y2gsIG0pIDogKGcoKSwgd2Fsa19ib2R5KHQuYmNhdGNoLCBtKSwgYigpKSksIHUgPSBvLCB0LmJmaW5hbGx5ICYmIHQuYmZpbmFsbHkud2FsayhtKSwgITApIDogdCBpbnN0YW5jZW9mIEFTVF9VbmFyeSA/IFVOQVJZX1BPU1RGSVhbdC5vcGVyYXRvcl0gJiYgKGEgPSB0LmV4cHJlc3Npb24pIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IChrKGEsICEwKSwgITApIDogdm9pZCAwIDogdCBpbnN0YW5jZW9mIEFTVF9WYXJEZWYgPyAoKHMgPSB0LnZhbHVlKSA/IHMud2FsayhtKSA6IHMgPSBwLmJsb2NrIGluc3RhbmNlb2YgQVNUX0ZvckVudW1lcmF0aW9uICYmIHAuYmxvY2suaW5pdCA9PT0gbS5wYXJlbnQoKSwgeChBU1RfU3ltYm9sRGVjbGFyYXRpb24sIHMgPyBmdW5jdGlvbiAoZSkge2UgaW5zdGFuY2VvZiBBU1RfU3ltYm9sVmFyID8gayhlKSA6IGUud2FsayhtKTt9IDogZnVuY3Rpb24gKGUpIHt2YXIgbiwgdDtlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFZhciA/IChuID0gZS5kZWZpbml0aW9uKCkuaWQsICh0ID0gVFtuXSkgPyB0LnB1c2goZSkgOiBuIGluIFQgfHwgQS5hZGQobiwgZSkpIDogZS53YWxrKG0pO30sIHQubmFtZSksICEwKSA6IHQgaW5zdGFuY2VvZiBBU1RfV2hpbGUgPyAoZygpLCBwLmJsb2NrID0gdCwgcC5sb29wID0gITAsIGUoKSwgYigpLCAhMCkgOiB2b2lkIDA7ZnVuY3Rpb24gZihlKSB7bC5vcHRpb24oImllIikgJiYgKGUgPSByb290X2V4cHIoZSkpIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiBlLndhbGsobSk7fWZ1bmN0aW9uIGMoZSwgbiwgdCkge3ZhciBpID0gcCxlID0gZnVuY3Rpb24gZShuLCB0LCBpLCByKSB7dmFyIG8gPSB7IGNvbnNlcXVlbnQ6IHsgc2VnbWVudDogcCwgbGV2ZWw6IG4gfSwgYWx0ZXJuYXRpdmU6IHsgc2VnbWVudDogcCwgbGV2ZWw6IG4gfSB9O2lmICh0IGluc3RhbmNlb2YgQVNUX0JpbmFyeSkgc3dpdGNoICh0Lm9wZXJhdG9yKSB7Y2FzZSAiJiYiOm8uY29uc2VxdWVudCA9IGUobiArIDEsIHQubGVmdCwgdC5yaWdodCkuY29uc2VxdWVudDticmVhaztjYXNlICJ8fCI6by5hbHRlcm5hdGl2ZSA9IGUobiArIDEsIHQubGVmdCwgbnVsbCwgdC5yaWdodCkuYWx0ZXJuYXRpdmU7YnJlYWs7Y2FzZSAiPz8iOm8uYWx0ZXJuYXRpdmUgPSBlKG4gKyAxLCB0LmxlZnQsIHQucmlnaHQsIHQucmlnaHQpLmFsdGVybmF0aXZlO2JyZWFrO2RlZmF1bHQ6dC53YWxrKG0pO30gZWxzZSB0IGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsID8gZShuICsgMSwgdC5jb25kaXRpb24sIHQuY29uc2VxdWVudCwgdC5hbHRlcm5hdGl2ZSkgOiB0LndhbGsobSk7aSAmJiAocCA9IG8uY29uc2VxdWVudC5zZWdtZW50LCBnKCksIGkud2FsayhtKSwgby5jb25zZXF1ZW50LnNlZ21lbnQgPSBwKTtyICYmIChwID0gby5hbHRlcm5hdGl2ZS5zZWdtZW50LCBnKCksIHIud2FsayhtKSwgby5hbHRlcm5hdGl2ZS5zZWdtZW50ID0gcCk7cmV0dXJuIG87fSgxLCBlLCBuLCB0KTtpZiAobikge3AgPSBlLmNvbnNlcXVlbnQuc2VnbWVudDtmb3IgKHZhciByID0gZS5jb25zZXF1ZW50LmxldmVsOyAwIDw9IC0tcjspIGIoKTtpZiAocCAhPT0gaSkgcmV0dXJuO31pZiAodCkge3AgPSBlLmFsdGVybmF0aXZlLnNlZ21lbnQ7Zm9yIChyID0gZS5hbHRlcm5hdGl2ZS5sZXZlbDsgMCA8PSAtLXI7KSBiKCk7aWYgKHAgIT09IGkpIHJldHVybjt9cCA9IGk7fX0pLCBlID0gKG0uZGlyZWN0aXZlcyA9IE9iamVjdC5jcmVhdGUobC5kaXJlY3RpdmVzKSwgZC53YWxrKG0pLCAhMSksIG4gPSBPYmplY3QuY3JlYXRlKG51bGwpOyBzLmxlbmd0aCAmJiBmLmxlbmd0aDspIHt2YXIgdCA9IGYuc2hpZnQoKTtpZiAodCkge3ZhciBpID0gdC5kZWZpbml0aW9uLHIgPSBUW2kuaWRdO2lmIChyKSB7Zm9yIChyID0geyBlbmQ6IHIuZW5kIH07IGkuaWQgaW4gbjspIGkgPSBuW2kuaWRdO3Iuc3RhcnQgPSBUW2kuaWRdLnN0YXJ0O3ZhciBvID0gW107ZG8ge3ZhciBhID0gcy5zaGlmdCgpO2lmICghKHQuaW5kZXggPiBhLmluZGV4KSkge3ZhciB2ID0gYS5kZWZpbml0aW9uO2lmICh2LmlkIGluIGgpIHt2YXIgeSA9IFRbdi5pZF07aWYgKHkpIHtpZiAoeS5zdGFydC5ibG9jayA9PT0gci5zdGFydC5ibG9jayAmJiBFKHksIHIpICYmICgheS5zdGFydC5sb29wICYmIFpuKGkpIHx8IEUociwgeSkpICYmICghbC5vcHRpb24oIndlYmtpdCIpIHx8IGlzX2Z1bmFyZyhpKSA9PT0gaXNfZnVuYXJnKHYpKSAmJiAhdi5jb25zdF9yZWRlZnMgJiYgYWxsKHkuc2NvcGVzLCBmdW5jdGlvbiAoZSkge3JldHVybiBlLmZpbmRfdmFyaWFibGUoaS5uYW1lKSA9PT0gaTt9KSkge3kuZm9yRWFjaChmdW5jdGlvbiAoZSkge2UudGhlZGVmID0gaSwgZS5uYW1lID0gaS5uYW1lLCBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IChpLnJlZmVyZW5jZXMucHVzaChlKSwgdi5yZXBsYWNlZCsrKSA6IChpLm9yaWcucHVzaChlKSwgdi5lbGltaW5hdGVkKyspO30pLCB2LmZpeGVkIHx8IChpLmZpeGVkID0gITEpLCBuW3YuaWRdID0gaSwgZSA9ICEwO2JyZWFrO31vLnB1c2goYSk7fX19fSB3aGlsZSAocy5sZW5ndGgpO28ubGVuZ3RoICYmIChzID0gby5jb25jYXQocykpO319fXJldHVybiBlO31mdW5jdGlvbiBnKCkge3AgPSBPYmplY3QuY3JlYXRlKHApO31mdW5jdGlvbiBiKCkge3AgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YocCk7fWZ1bmN0aW9uIHgobiwgdCwgZSkge3ZhciBpID0gbmV3IFRyZWVXYWxrZXIoZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCkpIHJldHVybiBlIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSA/IChnKCksIGUudmFsdWUud2FsayhtKSwgYigpLCBlLm5hbWUud2FsayhpKSkgOiBlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZEtleVZhbCA/IGUua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgPyBlLnZhbHVlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgPyAoZygpLCAocC5ibG9jayA9IGUpLmtleS53YWxrKG0pLCBlLnZhbHVlLndhbGsoaSksIGIoKSkgOiAoZS5rZXkud2FsayhtKSwgZS52YWx1ZS53YWxrKGkpKSA6IGUudmFsdWUud2FsayhpKSA6IGUgaW5zdGFuY2VvZiBuID8gdChlKSA6IGUud2FsayhtKSwgITA7fSk7ZS53YWxrKGkpO31mdW5jdGlvbiBrKG4sIGUpIHt2YXIgdCxpID0gbi5kZWZpbml0aW9uKCk7aWYgKGUgJiYgIWFsbChTLCBmdW5jdGlvbiAoZSkge3JldHVybiAhKHQgPSBlLnZhcmlhYmxlcy5nZXQobi5uYW1lKSkgfHwgIWlzX2Z1bmFyZyh0KSB8fCB0ICE9PSBpICYmICFpLnVuZGVjbGFyZWQgJiYgZS5wYXJlbnRfc2NvcGUuZmluZF92YXJpYWJsZShuLm5hbWUpICE9PSBpO30pKSByZXR1cm4gVFtpLmlkXSA9IFRbdC5pZF0gPSAhMTt2YXIgcixvID0gcDtpZiAodSAmJiAoZygpLCBvID0gcCwgYigpKSwgaS5pZCBpbiBUKSB7aWYgKCEociA9IFRbaS5pZF0pKSByZXR1cm47aWYgKHIuc3RhcnQuYmxvY2sgIT09IG8uYmxvY2spIHJldHVybiBUW2kuaWRdID0gITE7aWYgKGEobiksIHIuZW5kID0gbywgaS5pZCBpbiBoKSBmW2hbaS5pZF1dID0gbnVsbDtlbHNlIGlmICghZSkgcmV0dXJuO30gZWxzZSB7aWYgKCh0ID0gZC52YXJpYWJsZXMuZ2V0KGkubmFtZSkpICE9PSBpKSByZXR1cm4gdCAmJiBfID09PSBvICYmIChUW3QuaWRdID0gITEpLCBUW2kuaWRdID0gITE7aWYgKGwuZXhwb3NlZChpKSB8fCBUbltuLm5hbWVdKSByZXR1cm4gVFtpLmlkXSA9ICExO2lmICgociA9IEEuZ2V0KGkuaWQpIHx8IFtdKS5zY29wZXMgPSBbXSwgYShuKSwgVFtpLmlkXSA9IHIsICFlKSByZXR1cm4gci5zdGFydCA9IG8sIHMucHVzaCh7IGluZGV4OiBjKyssIGRlZmluaXRpb246IGkgfSk7aWYgKG8uYmxvY2sgIT09IGQpIHJldHVybiBUW2kuaWRdID0gITE7ci5zdGFydCA9IF87fWZ1bmN0aW9uIGEoZSkge3IucHVzaChlKSwgcHVzaF91bmlxKHIuc2NvcGVzLCBlLnNjb3BlKTt2YXIgbiA9IHhlKG0pO24gIT09IGUuc2NvcGUgJiYgcHVzaF91bmlxKHIuc2NvcGVzLCBuKTt9aFtpLmlkXSA9IGYubGVuZ3RoLCBmLnB1c2goeyBpbmRleDogYysrLCBkZWZpbml0aW9uOiBpIH0pO31mdW5jdGlvbiB3KGUpIHtmb3IgKHZhciBuID0gW107Oykge2lmIChIT1AocCwgImJsb2NrIikpIHt2YXIgdCA9IHAuYmxvY2s7aWYgKCh0ID0gdCBpbnN0YW5jZW9mIEFTVF9MYWJlbGVkU3RhdGVtZW50ID8gdC5ib2R5IDogdCkgPT09IGUpIGJyZWFrO31uLnB1c2gocCksIGIoKTt9Zm9yIChwLmluc2VydGVkID0gcC5ibG9jaywgZygpOyBuLmxlbmd0aDspIHt2YXIgaSA9IG4ucG9wKCk7ZygpLCBIT1AoaSwgImJsb2NrIikgJiYgKHAuYmxvY2sgPSBpLmJsb2NrKSwgSE9QKGksICJsb29wIikgJiYgKHAubG9vcCA9IGkubG9vcCk7fX1mdW5jdGlvbiBEKGUsIG4pIHtyZXR1cm4gZSA9PT0gbiB8fCBlLmlzUHJvdG90eXBlT2Yobik7fWZ1bmN0aW9uIEUoZSwgbikge3JldHVybiBEKGUuc3RhcnQsIGUuZW5kKSB8fCBEKGUuc3RhcnQsIG4uc3RhcnQpO319KSwgQVNUX1Njb3BlLkRFRk1FVEhPRCgiZHJvcF91bnVzZWQiLCBmdW5jdGlvbiAoUikge2lmIChSLm9wdGlvbigidW51c2VkIikpIHt2YXIgTyA9IHRoaXMsQiA9ICEoTyBpbnN0YW5jZW9mIEFTVF9Ub3BsZXZlbCkgfHwgUi50b3BsZXZlbC5mdW5jcyxQID0gIShPIGluc3RhbmNlb2YgQVNUX1RvcGxldmVsKSB8fCBSLnRvcGxldmVsLnZhcnMsRiA9IC9rZWVwX2Fzc2lnbi8udGVzdChSLm9wdGlvbigidW51c2VkIikpID8gcmV0dXJuX2ZhbHNlIDogZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCxpID0gITE7aWYgKGUgaW5zdGFuY2VvZiBBU1RfQXNzaWduID8gIWUud3JpdGVfb25seSAmJiAiPSIgIT0gZS5vcGVyYXRvciB8fCAodCA9IHIoZS5sZWZ0LCBuKSkgOiBlIGluc3RhbmNlb2YgQVNUX1VuYXJ5ICYmIGUud3JpdGVfb25seSAmJiAodCA9IHIoZS5leHByZXNzaW9uLCBuKSksIHQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmKSB7ZSA9IHQuZGVmaW5pdGlvbigpO2lmICghYVtlLmlkXSAmJiAhUi5leHBvc2VkKGUpICYmIGJlKHQsIFIsIGkpKSByZXR1cm4gdDt9ZnVuY3Rpb24gcihlLCBuKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2Vzcykge3ZhciB0ID0gZS5leHByZXNzaW9uO2lmICghdC5tYXlfdGhyb3dfb25fYWNjZXNzKFIsICEwKSkgcmV0dXJuIGkgPSAhMCwgbiAmJiBlIGluc3RhbmNlb2YgQVNUX1N1YiAmJiBuLnVuc2hpZnQoZS5wcm9wZXJ0eSksIHIodCwgbik7fSBlbHNlIGlmIChlIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiAmJiAiPSIgPT0gZS5vcGVyYXRvcikgcmV0dXJuIGUud3JpdGVfb25seSA9ICJwIiwgdCA9IHIoZS5yaWdodCksICFuIHx8IChuLmFzc2lnbiA9IGUsIHQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmKSA/IHQgOiBlLmxlZnQ7cmV0dXJuIGU7fX0scSA9IE9iamVjdC5jcmVhdGUobnVsbCksYSA9IE9iamVjdC5jcmVhdGUobnVsbCksX2wgPSBmdW5jdGlvbiBsKGUpIHtyZXR1cm4gKF9sID0gZnVuY3Rpb24gZShuLCB0LCBpKSB7dmFyIHIgPSBSLnBhcmVudCh0KTtpZiAoIXIpIHJldHVybiBpO24gPSByIGluc3RhbmNlb2YgQVNUX0xhbWJkYSAmJiBtZW1iZXIobiwgci5hcmduYW1lcyk7cmV0dXJuIGUociwgdCArIDEsIG4gPyBmdW5jdGlvbiAoZSkge3ZhciBuID0gaShlKTtpZiAobikgcmV0dXJuIG47aWYgKG4gPSByLnZhcmlhYmxlcy5nZXQoZSkpIHtlID0gbi5vcmlnWzBdO2lmIChlIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZyB8fCBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbExhbWJkYSkgcmV0dXJuIG47fX0gOiByLnZhcmlhYmxlcyA/IGZ1bmN0aW9uIChlKSB7cmV0dXJuIGkoZSkgfHwgci52YXJpYWJsZXMuZ2V0KGUpO30gOiBpKTt9KE8sIDAsIG5vb3ApKShlKTt9LHogPSBPYmplY3QuY3JlYXRlKG51bGwpLHUgPSBbXSxVID0gT2JqZWN0LmNyZWF0ZShudWxsKSxfID0gT2JqZWN0LmNyZWF0ZShudWxsKSxTID0gT2JqZWN0LmNyZWF0ZShudWxsKSxwID0gT2JqZWN0LmNyZWF0ZShudWxsKSxqID0gT2JqZWN0LmNyZWF0ZShudWxsKSxkID0gKE8gaW5zdGFuY2VvZiBBU1RfVG9wbGV2ZWwgJiYgUi50b3BfcmV0YWluICYmIE8udmFyaWFibGVzLmVhY2goZnVuY3Rpb24gKGUpIHshUi50b3BfcmV0YWluKGUpIHx8IGUuaWQgaW4gVSB8fCAoQVNUX05vZGUuaW5mbygiUmV0YWluaW5nIHZhcmlhYmxlIHtuYW1lfSIsIGUpLCBVW2UuaWRdID0gITAsIHUucHVzaChlKSk7fSksIG5ldyBEaWN0aW9uYXJ5KCkpLEEgPSBuZXcgRGljdGlvbmFyeSgpLEwgPSB0aGlzLFYgPSAoKFQgPSBuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAocywgZSkge2lmIChzIGluc3RhbmNlb2YgQVNUX0xhbWJkYSAmJiBzLnVzZXNfYXJndW1lbnRzICYmICFULmhhc19kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSAmJiBzLmVhY2hfYXJnbmFtZShmdW5jdGlvbiAoZSkge2UgPSBlLmRlZmluaXRpb24oKTtlLmlkIGluIFUgfHwgKFVbZS5pZF0gPSAhMCwgdS5wdXNoKGUpKTt9KSwgcyAhPT0gTykge2lmIChMID09PSBPKSB7dmFyIHQsIGksIG4sIHI7aWYgKHMgaW5zdGFuY2VvZiBBU1RfRGVmQ2xhc3MpIHJldHVybiByID0gcy5uYW1lLmRlZmluaXRpb24oKSwgKG4gPSBCICYmICFyLmV4cG9ydGVkKSB8fCByLmlkIGluIFUgfHwgKFVbci5pZF0gPSAhMCwgdS5wdXNoKHIpKSwgKHQgPSBULnBhcmVudCgpIGluc3RhbmNlb2YgQVNUX0V4cG9ydERlZmF1bHQpID8gYVtyLmlkXSA9ICEwIDogIW4gfHwgci5pZCBpbiBfIHx8IChfW3IuaWRdID0gMSksIHMuZXh0ZW5kcyAmJiBzLmV4dGVuZHMud2FsayhUKSwgaSA9IFtdLCBzLnByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2Uua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgJiYgZS5rZXkud2FsayhUKTt2YXIgbiA9IGUudmFsdWU7biAmJiAoaGUoZSkgPyAoIXQgJiYgbi5jb250YWluc190aGlzKCkgJiYgKHQgPSAhMCksIG8obikpIDogaS5wdXNoKG4pKTt9KSwgaS5mb3JFYWNoKG4gJiYgdCA/IG8gOiBmdW5jdGlvbiAoZSkge0EuYWRkKHIuaWQsIGUpO30pLCAhMDtpZiAocyBpbnN0YW5jZW9mIEFTVF9MYW1iZGFEZWZpbml0aW9uKSByZXR1cm4gciA9IHMubmFtZS5kZWZpbml0aW9uKCksIChuID0gQiAmJiAhci5leHBvcnRlZCkgfHwgci5pZCBpbiBVIHx8IChVW3IuaWRdID0gITAsIHUucHVzaChyKSksIEEuYWRkKHIuaWQsIHMpLCBULnBhcmVudCgpIGluc3RhbmNlb2YgQVNUX0V4cG9ydERlZmF1bHQgPyAoYVtyLmlkXSA9ICEwLCBmKHMsIGUsICEwKSkgOiAoIW4gfHwgci5pZCBpbiBfIHx8IChfW3IuaWRdID0gMSksICEwKTtpZiAocyBpbnN0YW5jZW9mIEFTVF9EZWZpbml0aW9ucykgcmV0dXJuIHMuZGVmaW5pdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoaSkge3ZhciByID0gaS52YWx1ZSxvID0gciAmJiAoaS5uYW1lIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCB8fCByLmhhc19zaWRlX2VmZmVjdHMoUikpLGEgPSBvICYmICI9IiA9PSByLnRhaWxfbm9kZSgpLm9wZXJhdG9yO2kubmFtZS5tYXJrX3N5bWJvbChmdW5jdGlvbiAoZSkge3ZhciBuLCB0O2lmIChlIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlY2xhcmF0aW9uKSByZXR1cm4gbiA9IGUuZGVmaW5pdGlvbigpLCBqW24uaWRdID0gKGpbbi5pZF0gfHwgMCkgKyAxLCBzIGluc3RhbmNlb2YgQVNUX1ZhciAmJiBuLm9yaWdbMF0gaW5zdGFuY2VvZiBBU1RfU3ltYm9sQ2F0Y2ggJiYgKHQgPSBuLnJlZGVmaW5lZCgpKSAmJiAoalt0LmlkXSA9IChqW3QuaWRdIHx8IDApICsgMSksIG4uaWQgaW4gVSB8fCBQICYmICFuLmV4cG9ydGVkICYmIChzIGluc3RhbmNlb2YgQVNUX0NvbnN0ID8gIW4ucmVkZWZpbmVkKCkgOiAhbi5jb25zdF9yZWRlZnMpICYmIChzIGluc3RhbmNlb2YgQVNUX1ZhciB8fCBPbihuKSkgfHwgKFVbbi5pZF0gPSAhMCwgdS5wdXNoKG4pKSwgciAmJiAobyA/IGEgJiYgdihuLCBlLCBwW24uaWRdKSA6IEEuYWRkKG4uaWQsIHIpLCBkLmFkZChuLmlkLCBpKSksIHkobiksICEwO30sIFQpLCBvICYmIHIud2FsayhUKTt9KSwgITA7aWYgKHMgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnKSByZXR1cm4gciA9IHMuZGVmaW5pdGlvbigpLCBqW3IuaWRdID0gKGpbci5pZF0gfHwgMCkgKyAxLCBkLmFkZChyLmlkLCBzKSwgITA7aWYgKHMgaW5zdGFuY2VvZiBBU1RfU3ltYm9sSW1wb3J0KSByZXR1cm4gKHIgPSBzLmRlZmluaXRpb24oKSkuaWQgaW4gVSB8fCBQICYmIE9uKHIpIHx8IChVW3IuaWRdID0gITAsIHUucHVzaChyKSksICEwO31yZXR1cm4gZihzLCBlLCAhMCk7fWZ1bmN0aW9uIG8oZSkge3ZhciBuID0gTDtMID0gcywgZS53YWxrKFQpLCBMID0gbjt9fSkpLmRpcmVjdGl2ZXMgPSBPYmplY3QuY3JlYXRlKFIuZGlyZWN0aXZlcyksIE8ud2FsayhUKSwgUi5vcHRpb24oImtlZXBfZm5hbWVzIikgPyByZXR1cm5fZmFsc2UgOiBSLm9wdGlvbigiaWUiKSA/IGZ1bmN0aW9uIChlKSB7cmV0dXJuICFSLmV4cG9zZWQoZSkgJiYgZS5yZWZlcmVuY2VzLmxlbmd0aCA9PSBlLnJlcGxhY2VkO30gOiBmdW5jdGlvbiAoZSkge3JldHVybiAhKGUuaWQgaW4gVSkgfHwgIShlLm9yaWcubGVuZ3RoIC0gZS5lbGltaW5hdGVkIDwgMikgJiYgKGUub3JpZ1sxXSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcgfHwgYWxsKGUucmVmZXJlbmNlcywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIWUuaW5fYXJnO30pKTt9KTtSLm9wdGlvbigiaWUiKSAmJiBBLmVhY2goZnVuY3Rpb24gKGUsIG4pIHtuIGluIFUgfHwgZS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfRnVuY3Rpb24gJiYgZS5uYW1lICYmICFWKGUubmFtZS5kZWZpbml0aW9uKCkpID8gKGUud2FsayhUKSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9TY29wZSB8fCB2b2lkIDA7fSkpO30pO30pO2ZvciAodmFyIFQgPSBuZXcgVHJlZVdhbGtlcihmKSwgZSA9IDA7IGUgPCB1Lmxlbmd0aDsgZSsrKSB7dmFyIG4gPSBBLmdldCh1W2VdLmlkKTtuICYmIG4uZm9yRWFjaChmdW5jdGlvbiAoZSkge2Uud2FsayhUKTt9KTt9T2JqZWN0LmtleXMocSkuZm9yRWFjaChmdW5jdGlvbiAoZSkge3ZhciBuLHQgPSBxW2VdO3QgJiYgKHQgPSB0LnJlZHVjZShmdW5jdGlvbiAobiwgZSkge3JldHVybiBlLmZvckVhY2goZnVuY3Rpb24gKGUpIHtwdXNoX3VuaXEobiwgZSk7fSksIG47fSwgW10pLCBuID0gKGQuZ2V0KGUpIHx8IFtdKS5maWx0ZXIoZnVuY3Rpb24gKG4pIHtyZXR1cm4gZmluZF9pZihuIGluc3RhbmNlb2YgQVNUX1VuYXJ5ID8gZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSA9PT0gbjt9IDogZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSA9PT0gbiB8fCAhKGUgaW5zdGFuY2VvZiBBU1RfVW5hcnkpICYmIGkoZSkgPT09IGkobik7fSwgdCk7fSksIHQubGVuZ3RoID09IG4ubGVuZ3RoKSA/IHFbZV0gPSBuIDogZGVsZXRlIHFbZV07fSk7dmFyIEkgPSBbXSxNID0gW10sSCA9IG5ldyBUcmVlVHJhbnNmb3JtZXIoZnVuY3Rpb24gKHQpIHtpZiAodCBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUpIHJldHVybiBFKEgsIHQpO2lmICh0IGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCAmJiB0LnJlc3QgJiYgKHQucmVzdCA9IHQucmVzdC50cmFuc2Zvcm0oSCkpLCB0IGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZEFycmF5KSB7Zm9yICh2YXIgZSA9ICF0LnJlc3QsIG4gPSB0LmVsZW1lbnRzLmxlbmd0aDsgMCA8PSAtLW47KSB7dmFyIGkgPSB0LmVsZW1lbnRzW25dLnRyYW5zZm9ybShIKTtpID8gKHQuZWxlbWVudHNbbl0gPSBpLCBlID0gITEpIDogZSA/IHQuZWxlbWVudHMucG9wKCkgOiB0LmVsZW1lbnRzW25dID0ga2UoQVNUX0hvbGUsIHQuZWxlbWVudHNbbl0pO31yZXR1cm4gdDt9dmFyIHI7cmV0dXJuIHQgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkT2JqZWN0ID8gKHIgPSBbXSwgdC5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHt2YXIgbiA9ICExO2Uua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgJiYgKGUua2V5ID0gZS5rZXkudHJhbnNmb3JtKFcpLCBuID0gZS5rZXkuaGFzX3NpZGVfZWZmZWN0cyhSKSksIChuIHx8IHQucmVzdCkgJiYgKChuID0gZS52YWx1ZSkgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdFZhbHVlID8gbi5uYW1lIDogbikgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRGVjbGFyYXRpb24gPyAoZS52YWx1ZSA9IGUudmFsdWUudHJhbnNmb3JtKFcpLCByLnB1c2goZSkpIDogKG4gPSAhKG4gPSBlLnZhbHVlLnRyYW5zZm9ybShIKSkgJiYgdC5yZXN0ID8gZS52YWx1ZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRBcnJheSA/IGtlKEFTVF9EZXN0cnVjdHVyZWRBcnJheSwgZS52YWx1ZSwgeyBlbGVtZW50czogW10gfSkgOiBrZShBU1RfRGVzdHJ1Y3R1cmVkT2JqZWN0LCBlLnZhbHVlLCB7IHByb3BlcnRpZXM6IFtdIH0pIDogbikgJiYgKGUudmFsdWUgPSBuLCByLnB1c2goZSkpO30pLCB0LnByb3BlcnRpZXMgPSByLCB0KSA6IHQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRGVjbGFyYXRpb24gPyAkKHQpIDogdm9pZCAwO30pLFcgPSBuZXcgVHJlZVRyYW5zZm9ybWVyKGZ1bmN0aW9uIChTLCBuLCBlKSB7dmFyIHQsaSxwID0gVy5wYXJlbnQoKTtpZiAoUCkge3ZhciByLG8sYSA9IFtdLHMgPSBGKFMsIGEpO2lmIChzKSB7aWYgKGkgPSBTLCBUID0gKHQgPSBzKS5kZWZpbml0aW9uKCksIHIgPSAhKG8gPSBVW1QuaWRdKSB8fCBpW2kgaW5zdGFuY2VvZiBBU1RfQXNzaWduID8gImxlZnQiIDogImV4cHJlc3Npb24iXSA9PT0gdCAmJiAobyA9PT0gdCAmJiBULnJlZmVyZW5jZXMubGVuZ3RoIC0gVC5yZXBsYWNlZCA9PSAxIHx8IEcoVCwgaSkgPCAwKSA/IChyID0gUyBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gJiYgKHIgPSBRKFMpLCAhMCA9PT0gUy53cml0ZV9vbmx5KSA/IHIuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKFIpIDogcikgfHwga2UoQVNUX051bWJlciwgUywgeyB2YWx1ZTogMCB9KSA6IHIpIHN3aXRjaCAoYS5hc3NpZ24gJiYgKG8gPSBhLmFzc2lnbi5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoUikpICYmIChvLndyaXRlX29ubHkgPSAhMCwgYS51bnNoaWZ0KG8pKSwgcCBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSAmJiBwLnRhaWxfbm9kZSgpICE9PSBTICYmICFyLmhhc19zaWRlX2VmZmVjdHMoUikgfHwgYS5wdXNoKHIpLCBhLmxlbmd0aCkge2Nhc2UgMDpyZXR1cm4gTGlzdC5za2lwO2Nhc2UgMTpyZXR1cm4gRGUocCwgUywgYVswXS50cmFuc2Zvcm0oVykpO2RlZmF1bHQ6cmV0dXJuIHdlKFMsIGEubWFwKGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUudHJhbnNmb3JtKFcpO30pKTt9fSBlbHNlIGlmIChTIGluc3RhbmNlb2YgQVNUX1VuYXJ5UG9zdGZpeCAmJiBTLmV4cHJlc3Npb24gaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIEcoUy5leHByZXNzaW9uLmRlZmluaXRpb24oKSwgUykgPCAwKSByZXR1cm4ga2UoQVNUX1VuYXJ5UHJlZml4LCBTLCB7IG9wZXJhdG9yOiAiKyIsIGV4cHJlc3Npb246IFMuZXhwcmVzc2lvbiB9KTt9aWYgKFMgaW5zdGFuY2VvZiBBU1RfQmluYXJ5ICYmICJpbnN0YW5jZW9mIiA9PSBTLm9wZXJhdG9yKSByZXR1cm4gISgocyA9IFMucmlnaHQpIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikgfHwgcy5kZWZpbml0aW9uKCkuaWQgaW4gVSA/IHZvaWQgMCA6ICh0ID0gUy5sZWZ0LmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShSKSwgciA9IGtlKEFTVF9GYWxzZSwgUykub3B0aW1pemUoUiksIHQgPyB3ZShTLCBbdCwgcl0pIDogcik7aWYgKFMgaW5zdGFuY2VvZiBBU1RfQ2FsbCkgcmV0dXJuIEkucHVzaChTKSwgUy5hcmdzID0gUy5hcmdzLm1hcChmdW5jdGlvbiAoZSkge3JldHVybiBlLnRyYW5zZm9ybShXKTt9KSwgUy5leHByZXNzaW9uID0gUy5leHByZXNzaW9uLnRyYW5zZm9ybShXKSwgUztpZiAoTCA9PT0gTykge2lmIChCICYmIFMgIT09IE8gJiYgUyBpbnN0YW5jZW9mIEFTVF9EZWZDbGFzcykgaWYgKCEoKHUgPSBTLm5hbWUuZGVmaW5pdGlvbigpKS5pZCBpbiBVKSkgcmV0dXJuIFkoUy5uYW1lLCAiRHJvcHBpbmcgdW51c2VkIGNsYXNzIHtuYW1lfSIpLCB1LmVsaW1pbmF0ZWQrKywgbihTLCBXKSwgXyA9IG1uKFMsICEwKSwgcCBpbnN0YW5jZW9mIEFTVF9FeHBvcnREZWZhdWx0ID8gXyA6IChfID0gXy5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoUiwgITApKSA/IGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIFMsIHsgYm9keTogXyB9KSA6IGUgPyBMaXN0LnNraXAgOiBrZShBU1RfRW1wdHlTdGF0ZW1lbnQsIFMpO2lmIChTIGluc3RhbmNlb2YgQVNUX0NsYXNzRXhwcmVzc2lvbiAmJiBTLm5hbWUgJiYgVihTLm5hbWUuZGVmaW5pdGlvbigpKSAmJiAoUy5uYW1lID0gbnVsbCksIFMgaW5zdGFuY2VvZiBBU1RfTGFtYmRhKSB7aWYgKEIgJiYgUyAhPT0gTyAmJiBTIGluc3RhbmNlb2YgQVNUX0xhbWJkYURlZmluaXRpb24pIGlmICghKCh1ID0gUy5uYW1lLmRlZmluaXRpb24oKSkuaWQgaW4gVSkpIHJldHVybiBZKFMubmFtZSwgIkRyb3BwaW5nIHVudXNlZCBmdW5jdGlvbiB7bmFtZX0iKSwgdS5lbGltaW5hdGVkKyssIHAgaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVmYXVsdCA/IChOKCksIHZuKFMsICEwKSkgOiBlID8gTGlzdC5za2lwIDoga2UoQVNUX0VtcHR5U3RhdGVtZW50LCBTKTtpZiAoTigpLCBTIGluc3RhbmNlb2YgQVNUX0xhbWJkYUV4cHJlc3Npb24gJiYgUy5uYW1lICYmIFYoUy5uYW1lLmRlZmluaXRpb24oKSkgJiYgKFMubmFtZSA9IG51bGwpLCAhKFMgaW5zdGFuY2VvZiBBU1RfQWNjZXNzb3IpKSB7dmFyIGYsYyxsID0gUi5kcm9wX2ZhcmdzKFMsIHApO2lmIChsICYmIHAgaW5zdGFuY2VvZiBBU1RfQ2FsbCAmJiBwLmV4cHJlc3Npb24gPT09IFMpIGZvciAoZiA9IHAuYXJncywgYyA9IDA7IGMgPCBmLmxlbmd0aCAmJiAhKGZbY10gaW5zdGFuY2VvZiBBU1RfU3ByZWFkKTsgYysrKTtmb3IgKHZhciB1LCBfLCBkLCBBID0gUy5hcmduYW1lcywgVCA9IFMucmVzdCwgaCA9ICExLCBtID0gITEsIHYgPSAoVCAmJiAobSA9ICEwLCAhZiB8fCBjIDwgQS5sZW5ndGggfHwgVCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcgPyBUID0gVC50cmFuc2Zvcm0oSCkgOiAoVCA9IChfID0gWChULCBrZShBU1RfQXJyYXksIHAsIHsgZWxlbWVudHM6IGYuc2xpY2UoQS5sZW5ndGgpIH0pLCAkLCAhUy51c2VzX2FyZ3VtZW50cywgVCkpLm5hbWUsIGYubGVuZ3RoID0gQS5sZW5ndGgsIF8udmFsdWUuZWxlbWVudHMubGVuZ3RoICYmIFtdLnB1c2guYXBwbHkoZiwgXy52YWx1ZS5lbGVtZW50cykpLCBUIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCAmJiAhVC5yZXN0ICYmIChUIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZEFycmF5ID8gMCA9PSBULmVsZW1lbnRzLmxlbmd0aCAmJiAoVCA9IG51bGwpIDogMCA9PSBULnByb3BlcnRpZXMubGVuZ3RoICYmIChUID0gbnVsbCkpLCBTLnJlc3QgPSBUKSAmJiAoaCA9ICEobCA9ICExKSksIGwgPyAtMSA6IFMubGVuZ3RoKCkpLCB5ID0gZiAmJiAhUy51c2VzX2FyZ3VtZW50cyAmJiBwICE9PSBSLnBhcmVudCgpLCBnID0gQS5sZW5ndGg7IDAgPD0gLS1nOykgKHMgPSBBW2ddKSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcgPyAodSA9IHMuZGVmaW5pdGlvbigpKS5pZCBpbiBVID8gKGwgPSAhMSwgRyh1LCBzKSA8IDAgJiYgKHMudW51c2VkID0gbnVsbCkpIDogKGwgJiYgKFkocywgIkRyb3BwaW5nIHVudXNlZCBmdW5jdGlvbiBhcmd1bWVudCB7bmFtZX0iKSwgQS5wb3AoKSwgdS5lbGltaW5hdGVkKyspLCBzLnVudXNlZCA9ICEwKSA6IChtID0gITAsICFmIHx8IGMgPCBnID8gZCA9IHMudHJhbnNmb3JtKEgpIDogKGQgPSAoXyA9IFgocywgZltnXSwgJCwgeSwgcykpLm5hbWUsIF8udmFsdWUgJiYgKGZbZ10gPSBfLnZhbHVlKSksIGQgPyAobCA9ICExLCBBW2ddID0gZCwgaCA9IGggfHwgIShkIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZykpIDogbCA/IChLKHMsICJEcm9wcGluZyB1bnVzZWQgZGVmYXVsdCBhcmd1bWVudCB7bmFtZX0iKSwgQS5wb3AoKSkgOiB2IDwgZyA/IChLKHMsICJEcm9wcGluZyB1bnVzZWQgZGVmYXVsdCBhcmd1bWVudCBhc3NpZ25tZW50IHtuYW1lfSIpLCBzLm5hbWUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnID8gcy5uYW1lLnVudXNlZCA9ICEwIDogaCA9ICEwLCBBW2ddID0gcy5uYW1lKSA6IChLKHMsICJEcm9wcGluZyB1bnVzZWQgZGVmYXVsdCBhcmd1bWVudCB2YWx1ZSB7bmFtZX0iKSwgQVtnXSA9IHMgPSBzLmNsb25lKCksIHMudmFsdWUgPSBrZShBU1RfTnVtYmVyLCBzLCB7IHZhbHVlOiAwIH0pLCBoID0gITApKTttICYmICFoICYmIFMudXNlc19hcmd1bWVudHMgJiYgIVcuaGFzX2RpcmVjdGl2ZSgidXNlIHN0cmljdCIpICYmIChTLnJlc3QgPSBrZShBU1RfRGVzdHJ1Y3R1cmVkQXJyYXksIFMsIHsgZWxlbWVudHM6IFtdIH0pKSwgTS5wdXNoKFMpO31yZXR1cm4gUzt9aWYgKFMgaW5zdGFuY2VvZiBBU1RfQ2F0Y2ggJiYgUy5hcmduYW1lIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCAmJiBTLmFyZ25hbWUudHJhbnNmb3JtKEgpLCAhKFMgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMpIHx8IHAgaW5zdGFuY2VvZiBBU1RfRm9yRW51bWVyYXRpb24gJiYgcC5pbml0ID09PSBTKSByZXR1cm4gUyBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gPyAobihTLCBXKSwgUy5sZWZ0IGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCA/IChfID0gWChTLmxlZnQsIFMucmlnaHQsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGU7fSwgITAgPT09IFMud3JpdGVfb25seSkpLm5hbWUgPyBrZShBU1RfQXNzaWduLCBTLCB7IG9wZXJhdG9yOiBTLm9wZXJhdG9yLCBsZWZ0OiBfLm5hbWUsIHJpZ2h0OiBfLnZhbHVlIH0pIDogXy52YWx1ZSB8fCAocCBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSAmJiBwLnRhaWxfbm9kZSgpICE9PSBTID8gTGlzdC5za2lwIDoga2UoQVNUX051bWJlciwgUywgeyB2YWx1ZTogMCB9KSkgOiBTKSA6IFMgaW5zdGFuY2VvZiBBU1RfTGFiZWxlZFN0YXRlbWVudCAmJiBTLmJvZHkgaW5zdGFuY2VvZiBBU1RfRm9yID8gKG4oUywgVyksIFMuYm9keSBpbnN0YW5jZW9mIEFTVF9CbG9ja1N0YXRlbWVudCA/IChTLmJvZHkgPSAoaSA9IFMuYm9keSkuYm9keS5wb3AoKSwgaS5ib2R5LnB1c2goUyksIGUgPyBMaXN0LnNwbGljZShpLmJvZHkpIDogaSkgOiBTKSA6IFMgaW5zdGFuY2VvZiBBU1RfU2NvcGUgPyAoTigpLCBTKSA6IFMgaW5zdGFuY2VvZiBBU1RfU3ltYm9sSW1wb3J0ID8gIVIub3B0aW9uKCJpbXBvcnRzIikgfHwgUy5kZWZpbml0aW9uKCkuaWQgaW4gVSA/IFMgOiBlID8gTGlzdC5za2lwIDogbnVsbCA6IHZvaWQgMDt2YXIgYiA9IFtdLHggPSBbXSxrID0gW10sdyA9IFtdLEQgPSAwLEUgPSBTIGluc3RhbmNlb2YgQVNUX1Zhcjtzd2l0Y2ggKFMuZGVmaW5pdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2UudmFsdWUgJiYgKGUudmFsdWUgPSBlLnZhbHVlLnRyYW5zZm9ybShXKSk7dmFyIG4gPSBlLnZhbHVlO2lmIChlLm5hbWUgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkKSAoZiA9IFgoZS5uYW1lLCBuLCBmdW5jdGlvbiAoZSkge3JldHVybiAhUCB8fCBlLmRlZmluaXRpb24oKS5pZCBpbiBVIHx8IHUoZSkgfHwgRSAmJiAhYmUoZSkgPyBlIDogbnVsbDt9LCAhMCkpLm5hbWUgPyAoZSA9IGtlKEFTVF9WYXJEZWYsIGUsIHsgbmFtZTogZi5uYW1lLCB2YWx1ZTogbiA9IGYudmFsdWUgfSksIF8oKSkgOiBmLnZhbHVlICYmIHcucHVzaChmLnZhbHVlKTtlbHNlIHt2YXIgdCxpLHIsbyxhLHMgPSBlLm5hbWUuZGVmaW5pdGlvbigpLGYgPSBFID8gYmUoZS5uYW1lKSA6IE9uKHMpO2lmICghZiB8fCAhUCB8fCBzLmlkIGluIFUpIHtpZiAobiAmJiAoKG8gPSBHKHMsIGUpKSA8IDAgfHwgKGEgPSBuLnRhaWxfbm9kZSgpKSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgYS5kZWZpbml0aW9uKCkgPT09IHMpICYmIChlID0gZS5jbG9uZSgpLCAobiA9IG4uZHJvcF9zaWRlX2VmZmVjdF9mcmVlKFIpKSAmJiBBU1RfTm9kZS53YXJuKCJTaWRlIGVmZmVjdHMgaW4gZGVmaW5pdGlvbiBvZiB2YXJpYWJsZSB7bmFtZX0gW3tzdGFydH1dIiwgZS5uYW1lKSwgUyBpbnN0YW5jZW9mIEFTVF9Db25zdCA/IGUudmFsdWUgPSBuIHx8IGtlKEFTVF9OdW1iZXIsIGUsIHsgdmFsdWU6IDAgfSkgOiAoZS52YWx1ZSA9IG51bGwsIG4gJiYgdy5wdXNoKG4pKSwgbiA9IG51bGwsIDAgPD0gbykgJiYgKHFbcy5pZF1bb10gPSBlKSwgbiB8fCBTIGluc3RhbmNlb2YgQVNUX0xldCkge2lmIChSLm9wdGlvbigiZnVuY3Rpb25zIikgJiYgIVIub3B0aW9uKCJpZSIpICYmIGYgJiYgbiAmJiAxID09IGpbcy5pZF0gJiYgMCA9PSBzLmFzc2lnbm1lbnRzICYmIChhID0gbi50YWlsX25vZGUoKSkgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRXhwcmVzc2lvbiAmJiAhZ2UocykgJiYgIWlzX2Fycm93KGEpICYmIChyID0gYSwgMCA9PSAobyA9IHMucmVmZXJlbmNlcykubGVuZ3RoID8gciA9PT0gZS5uYW1lLmZpeGVkX3ZhbHVlKCkgOiBhbGwobywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gciA9PT0gZS5maXhlZF92YWx1ZSgpO30pKSAmJiAoaSA9IGEsIEUgJiYgIVIuaGFzX2RpcmVjdGl2ZSgidXNlIHN0cmljdCIpICYmIGkgaW5zdGFuY2VvZiBBU1RfRnVuY3Rpb24gPyBwIGluc3RhbmNlb2YgQVNUX0Jsb2NrIHx8IHAgaW5zdGFuY2VvZiBBU1RfRm9yICYmIHAuaW5pdCA9PT0gUyB8fCBwIGluc3RhbmNlb2YgQVNUX0lmIDogcCBpbnN0YW5jZW9mIEFTVF9TY29wZSkgJiYgITEgIT09IChpID0gZnVuY3Rpb24gKHQsIGkpIHtpZiAoIXQubmFtZSkgcmV0dXJuIG51bGw7dmFyIHIsZSA9IHQubmFtZS5kZWZpbml0aW9uKCk7aWYgKDEgPCBlLm9yaWcubGVuZ3RoKSByZXR1cm4gbnVsbDtpZiAoMCA8IGUuYXNzaWdubWVudHMpIHJldHVybiAhMTtpZiAoZS5uYW1lID09IGkpIHJldHVybiBlO2lmIChSLm9wdGlvbigia2VlcF9mbmFtZXMiKSkgcmV0dXJuICExO3N3aXRjaCAoaSkge2Nhc2UgImF3YWl0IjpyID0gaXNfYXN5bmM7YnJlYWs7Y2FzZSAieWllbGQiOnIgPSBpc19nZW5lcmF0b3I7fXJldHVybiBhbGwoZS5yZWZlcmVuY2VzLCBmdW5jdGlvbiAoZSkge3ZhciBuID0gZS5zY29wZTtpZiAobi5maW5kX3ZhcmlhYmxlKGkpICE9PSBzKSByZXR1cm4gITE7aWYgKHIpIGRvIHtpZiAobiA9IG4ucmVzb2x2ZSgpLCByKG4pKSByZXR1cm4gITE7fSB3aGlsZSAobiAhPT0gdCAmJiAobiA9IG4ucGFyZW50X3Njb3BlKSk7cmV0dXJuICEwO30pICYmIGU7fShhLCBlLm5hbWUubmFtZSkpKSB7c3dpdGNoIChBU1RfTm9kZS53YXJuKCJEZWNsYXJpbmcge25hbWV9IGFzIGZ1bmN0aW9uIFt7c3RhcnR9XSIsIGUubmFtZSksIGEuQ1RPUikge2Nhc2UgQVNUX0FzeW5jRnVuY3Rpb246dCA9IEFTVF9Bc3luY0RlZnVuO2JyZWFrO2Nhc2UgQVNUX0FzeW5jR2VuZXJhdG9yRnVuY3Rpb246dCA9IEFTVF9Bc3luY0dlbmVyYXRvckRlZnVuO2JyZWFrO2Nhc2UgQVNUX0Z1bmN0aW9uOnQgPSBBU1RfRGVmdW47YnJlYWs7Y2FzZSBBU1RfR2VuZXJhdG9yRnVuY3Rpb246dCA9IEFTVF9HZW5lcmF0b3JEZWZ1bjt9dmFyIGMgPSBrZSh0LCBhKSxsID0gKGMubmFtZSA9IGtlKEFTVF9TeW1ib2xEZWZ1biwgZS5uYW1lKSwgZS5uYW1lLnNjb3BlLnJlc29sdmUoKS5kZWZfZnVuY3Rpb24oYy5uYW1lKSk7aSAmJiBpLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLm5hbWUgPSBsLm5hbWUsIGUudGhlZGVmID0gbCwgZS5yZWZlcmVuY2UoKTt9KSwgYi5wdXNoKGMpLCBuICE9PSBhICYmIFtdLnB1c2guYXBwbHkodywgbi5leHByZXNzaW9ucy5zbGljZSgwLCAtMSkpLCBzLmVsaW1pbmF0ZWQrKzt9IGVsc2UgZiAmJiAxIDwgaltzLmlkXSAmJiAhKHAgaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVjbGFyYXRpb24pICYmIHMub3JpZy5pbmRleE9mKGUubmFtZSkgPiBzLmVsaW1pbmF0ZWQgJiYgKGpbcy5pZF0tLSwgRCsrKSwgXygpO30gZWxzZSBwIGluc3RhbmNlb2YgQVNUX0V4cG9ydERlY2xhcmF0aW9uID8gXygpIDogZiAmJiAxIDwgaltzLmlkXSA/IChBU1RfTm9kZS5pbmZvKCJEcm9wcGluZyBkZWNsYXJhdGlvbiBvZiB2YXJpYWJsZSB7bmFtZX0gW3tzdGFydH1dIiwgZS5uYW1lKSwgaltzLmlkXS0tLCBzLmVsaW1pbmF0ZWQrKykgOiB4LnB1c2goZSk7fSBlbHNlIHUoZS5uYW1lKSA/ICgobiA9IG4gJiYgbi5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoUikpICYmIHcucHVzaChuKSwgMSA8IGpbcy5pZF0gPyAoQVNUX05vZGUud2FybigiRHJvcHBpbmcgZHVwbGljYXRlZCBkZWNsYXJhdGlvbiBvZiB2YXJpYWJsZSB7bmFtZX0gW3tzdGFydH1dIiwgZS5uYW1lKSwgaltzLmlkXS0tLCBzLmVsaW1pbmF0ZWQrKykgOiAoZS52YWx1ZSA9IG51bGwsIHgucHVzaChlKSkpIDogKChuID0gbiAmJiBuLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShSKSkgPyAoQVNUX05vZGUud2FybigiU2lkZSBlZmZlY3RzIGluIGluaXRpYWxpemF0aW9uIG9mIHVudXNlZCB2YXJpYWJsZSB7bmFtZX0gW3tzdGFydH1dIiwgZS5uYW1lKSwgdy5wdXNoKG4pKSA6IFkoZS5uYW1lLCAiRHJvcHBpbmcgdW51c2VkIHZhcmlhYmxlIHtuYW1lfSIpLCBzLmVsaW1pbmF0ZWQrKyk7fWZ1bmN0aW9uIHUoZSkge3ZhciBuID0gZS5kZWZpbml0aW9uKCk7cmV0dXJuIG4ub3JpZ1swXSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xDYXRjaCAmJiBuLnNjb3BlLnJlc29sdmUoKSA9PT0gZS5zY29wZS5yZXNvbHZlKCk7fWZ1bmN0aW9uIF8oKSB7MCA8IHcubGVuZ3RoICYmICgwID09IGsubGVuZ3RoID8gYi5wdXNoKGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIFMsIHsgYm9keTogd2UoUywgdykgfSkpIDogbiA/ICh3LnB1c2gobiksIGUudmFsdWUgPSB3ZShuLCB3KSkgOiBlLnZhbHVlID0ga2UoQVNUX1VuYXJ5UHJlZml4LCBlLCB7IG9wZXJhdG9yOiAidm9pZCIsIGV4cHJlc3Npb246IHdlKGUsIHcpIH0pLCB3ID0gW10pLCBrLnB1c2goZSk7fX0pLCB4Lmxlbmd0aCkge2Nhc2UgMDppZiAoMCA9PSBrLmxlbmd0aCkgYnJlYWs7aWYgKGsubGVuZ3RoID09IEQpIHtbXS51bnNoaWZ0LmFwcGx5KHcsIGsubWFwKGZ1bmN0aW9uIChlKSB7QVNUX05vZGUuaW5mbygiRHJvcHBpbmcgZHVwbGljYXRlZCBkZWZpbml0aW9uIG9mIHZhcmlhYmxlIHtuYW1lfSBbe3N0YXJ0fV0iLCBlLm5hbWUpO3ZhciBuID0gZS5uYW1lLmRlZmluaXRpb24oKSx0ID0ga2UoQVNUX1N5bWJvbFJlZiwgZS5uYW1lKSx0ID0gKG4ucmVmZXJlbmNlcy5wdXNoKHQpLCBrZShBU1RfQXNzaWduLCBlLCB7IG9wZXJhdG9yOiAiPSIsIGxlZnQ6IHQsIHJpZ2h0OiBlLnZhbHVlIH0pKSxlID0gRyhuLCBlKTtyZXR1cm4gMCA8PSBlICYmIChxW24uaWRdW2VdID0gdCksIG4uYXNzaWdubWVudHMrKywgbi5lbGltaW5hdGVkKyssIHQ7fSkpO2JyZWFrO31jYXNlIDE6aWYgKDAgPT0gay5sZW5ndGgpIHt2YXIgQyA9IHhbMF0ubmFtZS5kZWZpbml0aW9uKCkuaWQ7aWYgKEMgaW4geikge1MuZGVmaW5pdGlvbnMgPSB4LCB6W0NdLmluaXQgPSBTO2JyZWFrO319ZGVmYXVsdDowIDwgay5sZW5ndGggJiYgKEMgPSBrWzBdLnZhbHVlKSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSAmJiAoa1swXS52YWx1ZSA9IEMudGFpbF9ub2RlKCksIGIucHVzaChrZShBU1RfU2ltcGxlU3RhdGVtZW50LCBTLCB7IGJvZHk6IHdlKEMsIEMuZXhwcmVzc2lvbnMuc2xpY2UoMCwgLTEpKSB9KSkpLCBTLmRlZmluaXRpb25zID0geC5jb25jYXQoayksIGIucHVzaChTKTt9cmV0dXJuIDAgPCB3Lmxlbmd0aCAmJiBiLnB1c2goa2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgUywgeyBib2R5OiB3ZShTLCB3KSB9KSksIEooYiwgUywgZSk7fWZ1bmN0aW9uIE4oKSB7dmFyIGUgPSBMO24oTCA9IFMsIFcpLCBMID0gZTt9fSwgZnVuY3Rpb24gKGUsIG4pIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9CbG9ja1N0YXRlbWVudCkgcmV0dXJuIHBuKGUsIFcucGFyZW50KCksIG4pO2lmIChlIGluc3RhbmNlb2YgQVNUX0V4cG9ydERlY2xhcmF0aW9uKSByZXR1cm4gKHQgPSBlLmJvZHkpIGluc3RhbmNlb2YgQVNUX0Jsb2NrU3RhdGVtZW50ID8gKGUuYm9keSA9IHQuYm9keS5wb3AoKSwgdC5ib2R5LnB1c2goZSksIG4gPyBMaXN0LnNwbGljZSh0LmJvZHkpIDogdCkgOiB2b2lkIDA7aWYgKGUgaW5zdGFuY2VvZiBBU1RfRm9yKSByZXR1cm4gVWUoZSwgbik7aWYgKGUgaW5zdGFuY2VvZiBBU1RfRm9ySW4pIHtpZiAoIVAgfHwgIVIub3B0aW9uKCJsb29wcyIpKSByZXR1cm47aWYgKCFlZShlLmJvZHkpKSByZXR1cm47dmFyIHQgPSBnKGUpO2lmICghdCkgcmV0dXJuO3ZhciBpID0gdC5kZWZpbml0aW9uKCk7aWYgKGkuaWQgaW4gVSkgcmV0dXJuO1kodCwgIkRyb3BwaW5nIHVudXNlZCBsb29wIHZhcmlhYmxlIHtuYW1lfSIpLCB6W2kuaWRdID09PSBlICYmIGRlbGV0ZSB6W2kuaWRdO3ZhciB0ID0gW10sciA9IGUub2JqZWN0LmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShSKTtyZXR1cm4gciAmJiAoQVNUX05vZGUud2FybigiU2lkZSBlZmZlY3RzIGluIG9iamVjdCBvZiBmb3ItaW4gbG9vcCBbe3N0YXJ0fV0iLCByKSwgdC5wdXNoKGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUsIHsgYm9keTogciB9KSkpLCBlLmluaXQgaW5zdGFuY2VvZiBBU1RfRGVmaW5pdGlvbnMgJiYgaS5vcmlnWzBdIGluc3RhbmNlb2YgQVNUX1N5bWJvbENhdGNoICYmIHQucHVzaChlLmluaXQpLCBKKHQsIGUsIG4pO31yZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9JbXBvcnQgPyAoZS5wcm9wZXJ0aWVzICYmIDAgPT0gZS5wcm9wZXJ0aWVzLmxlbmd0aCAmJiAoZS5wcm9wZXJ0aWVzID0gbnVsbCksIGUpIDogZSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSAmJiAhKDEgPCBlLmV4cHJlc3Npb25zLmxlbmd0aCkgPyBEZShXLnBhcmVudCgpLCBlLCBlLmV4cHJlc3Npb25zWzBdKSA6IHZvaWQgMDt9KTtXLnB1c2goUi5wYXJlbnQoKSksIFcuZGlyZWN0aXZlcyA9IE9iamVjdC5jcmVhdGUoUi5kaXJlY3RpdmVzKSwgTy50cmFuc2Zvcm0oVyksIE8gaW5zdGFuY2VvZiBBU1RfTGFtYmRhICYmIDEgPT0gTy5ib2R5Lmxlbmd0aCAmJiBPLmJvZHlbMF0gaW5zdGFuY2VvZiBBU1RfRGlyZWN0aXZlICYmICJ1c2Ugc3RyaWN0IiA9PSBPLmJvZHlbMF0udmFsdWUgJiYgKE8uYm9keS5sZW5ndGggPSAwKSwgSS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7VW4oZSwgUiwgTSk7fSk7fWZ1bmN0aW9uIFkoZSwgbikge0FTVF9Ob2RlWzAgPCBlLmRlZmluaXRpb24oKS5yZWZlcmVuY2VzLmxlbmd0aCA/ICJpbmZvIiA6ICJ3YXJuIl0obiArICIgW3tzdGFydH1dIiwgZSk7fWZ1bmN0aW9uIEsoZSwgbikge2UubmFtZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcgPyBZKGUubmFtZSwgbikgOiBBU1RfTm9kZS5pbmZvKG4gKyAiIFt7c3RhcnR9XSIsIGUpO31mdW5jdGlvbiBpKGUpIHtyZXR1cm4gZVtlIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiA/ICJyaWdodCIgOiAidmFsdWUiXTt9ZnVuY3Rpb24gSihlLCBuLCB0KSB7c3dpdGNoIChlLmxlbmd0aCkge2Nhc2UgMDpyZXR1cm4gdCA/IExpc3Quc2tpcCA6IGtlKEFTVF9FbXB0eVN0YXRlbWVudCwgbik7Y2FzZSAxOnJldHVybiBlWzBdO2RlZmF1bHQ6cmV0dXJuIHQgPyBMaXN0LnNwbGljZShlKSA6IGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgbiwgeyBib2R5OiBlIH0pO319ZnVuY3Rpb24gaChlLCBuKSB7cmV0dXJuIGUuc2NvcGUucmVzb2x2ZSgpID09PSBPICYmIChlLmZpeGVkICYmIG4uZml4ZWQgfHwgKHFbZS5pZF0gPSAhMSksICExICE9PSBxW2UuaWRdKTt9ZnVuY3Rpb24gbShlLCBuKSB7cVtlLmlkXSB8fCAocVtlLmlkXSA9IFtdKSwgbi5maXhlZC5hc3NpZ25zICYmIHB1c2hfdW5pcShxW2UuaWRdLCBuLmZpeGVkLmFzc2lnbnMpO31mdW5jdGlvbiBHKGUsIG4pIHtlID0gcVtlLmlkXTtyZXR1cm4gZSAmJiBlLmluZGV4T2Yobik7fWZ1bmN0aW9uIHkoZSkgezEgPCBfW2UuaWRdICYmICEoZS5pZCBpbiBVKSAmJiAoVVtlLmlkXSA9ICEwLCB1LnB1c2goZSkpLCBfW2UuaWRdID0gMDt9ZnVuY3Rpb24gdihlLCBuLCB0KSB7ZS5pZCBpbiBVIHx8IChuICYmIHQgPyAoVVtlLmlkXSA9IG4sIHUucHVzaChlKSkgOiAoU1tlLmlkXSA9IG4sIHBbZS5pZF0gPSB0KSk7fWZ1bmN0aW9uIFEoZSkge3ZhciBuID0gZS5yaWdodDtyZXR1cm4gIWUud3JpdGVfb25seSB8fCAhKG4gaW5zdGFuY2VvZiBBU1RfQmluYXJ5ICYmIE5lW24ub3BlcmF0b3JdKSB8fCAhKG4ubGVmdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYpIHx8ICEoZS5sZWZ0IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikgfHwgKGUgPSBlLmxlZnQuZGVmaW5pdGlvbigpLCBuLmxlZnQuZGVmaW5pdGlvbigpICE9PSBlKSB8fCBuLnJpZ2h0Lmhhc19zaWRlX2VmZmVjdHMoUikgPyBuIDogKGgoZSwgbi5sZWZ0KSAmJiBtKGUsIG4ubGVmdCksIG4ucmlnaHQpO31mdW5jdGlvbiBnKGUpIHt2YXIgbiA9IGUuaW5pdDtpZiAobiBpbnN0YW5jZW9mIEFTVF9EZWZpbml0aW9ucykgcmV0dXJuIChuID0gbi5kZWZpbml0aW9uc1swXS5uYW1lKSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiAmJiBuO2ZvciAoOyBuIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3M7KSBuID0gbi5leHByZXNzaW9uLnRhaWxfbm9kZSgpO3JldHVybiBuIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IG4gOiB2b2lkIDA7fWZ1bmN0aW9uIGYoZSwgbiwgdCkge2UgaW5zdGFuY2VvZiBBU1RfQXNzaWduICYmIGUubGVmdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgKG8gPSBlLmxlZnQuZGVmaW5pdGlvbigpKS5zY29wZS5yZXNvbHZlKCkgPT09IE8gJiYgZC5hZGQoby5pZCwgZSksIGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIGUuaW5fYXJnICYmIChqW2UuZGVmaW5pdGlvbigpLmlkXSA9IDApLCBlIGluc3RhbmNlb2YgQVNUX1VuYXJ5ICYmIGUuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgKG8gPSBlLmV4cHJlc3Npb24uZGVmaW5pdGlvbigpKS5zY29wZS5yZXNvbHZlKCkgPT09IE8gJiYgZC5hZGQoby5pZCwgZSk7dmFyIGkscixvLGEscyxmID0gW10sYyA9IEYoZSwgZik7aWYgKGMpIHJldHVybiAoYSA9IGMuZGVmaW5pdGlvbigpKS5zY29wZS5yZXNvbHZlKCkgIT09IE8gJiYgTy52YXJpYWJsZXMuZ2V0KGMubmFtZSkgIT09IGEgfHwgZ2UoYSkgJiYgIWFsbChPLmFyZ25hbWVzLCBmdW5jdGlvbiAoZSkge3JldHVybiAhZS5tYXRjaF9zeW1ib2woZnVuY3Rpb24gKGUpIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcpIHJldHVybiAoZSA9IGUuZGVmaW5pdGlvbigpKS5yZWZlcmVuY2VzLmxlbmd0aCA+IGUucmVwbGFjZWQ7fSwgITApO30pIHx8ICJwIiA9PT0gZS53cml0ZV9vbmx5ICYmIGUucmlnaHQubWF5X3Rocm93X29uX2FjY2VzcyhSLCAhMCkgPyB2b2lkIDAgOiAoKGkgPSBmLmFzc2lnbikgJiYgKGkud3JpdGVfb25seSA9ICEwLCBpLndhbGsoVCkpLCBmLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLndhbGsoVCk7fSksIGUgaW5zdGFuY2VvZiBBU1RfQXNzaWduICYmIChpID0gYy5maXhlZF92YWx1ZSgpLCBmID0gUShlKSwgaSA9IGkgJiYgaS5pc19jb25zdGFudCgpLCBzID0gITEsIHQgJiYgITAgPT09IGUud3JpdGVfb25seSAmJiAoaSB8fCBlLmxlZnQgPT09IGMgfHwgZi5lcXVhbHMoYykpICYmICFmLmhhc19zaWRlX2VmZmVjdHMoUikgPyBBLmFkZChhLmlkLCBmKSA6IChmLndhbGsoVCksIHMgPSAiPSIgPT0gZi50YWlsX25vZGUoKS5vcGVyYXRvciksIGUubGVmdCA9PT0gYyA/IGUud3JpdGVfb25seSAmJiAhcyB8fCB2KGEsIGMsIHBbYS5pZF0pIDogaSB8fCB2KGEsIFNbYS5pZF0sICEwKSksIGgoYSwgYykgJiYgaXNfbGhzKGMsIGUpICE9PSBjICYmIG0oYSwgYyksIHkoYSksICEwKTtpZiAoZSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkpIHJldHVybiAiaW5zdGFuY2VvZiIgPT0gZS5vcGVyYXRvciAmJiAoYyA9IGUucmlnaHQpIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiAociA9IGMuZGVmaW5pdGlvbigpLmlkLCBfW3JdKSA/IChlLmxlZnQud2FsayhUKSwgX1tyXSsrLCAhMCkgOiB2b2lkIDA7aWYgKGUgaW5zdGFuY2VvZiBBU1RfRm9ySW4pIHtpZiAoZS5pbml0IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiBMID09PSBPICYmICgociA9IGUuaW5pdC5kZWZpbml0aW9uKCkuaWQpIGluIHogfHwgKHpbcl0gPSBlKSksICFQIHx8ICFSLm9wdGlvbigibG9vcHMiKSkgcmV0dXJuO2lmICghZWUoZS5ib2R5KSkgcmV0dXJuO2lmIChlLmluaXQuaGFzX3NpZGVfZWZmZWN0cyhSKSkgcmV0dXJuO2lmICghKGMgPSBnKGUpKSkgcmV0dXJuO2lmICgobyA9IGMuZGVmaW5pdGlvbigpKS5zY29wZS5yZXNvbHZlKCkgIT09IE8pIHt0ID0gX2woYy5uYW1lKTtpZiAodCA9PT0gbyB8fCB0ICYmIHQucmVkZWZpbmVkKCkgPT09IG8pIHJldHVybjt9cmV0dXJuIGUub2JqZWN0LndhbGsoVCksICEwO31yZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyAoKGEgPSBlLmRlZmluaXRpb24oKSkuaWQgaW4gVSB8fCAoVVthLmlkXSA9ICEwLCB1LnB1c2goYSkpLCAhYihhLnNjb3BlLCBlLnNjb3BlKSB8fCAhKGYgPSBhLnJlZGVmaW5lZCgpKSB8fCBmLmlkIGluIFUgfHwgKFVbZi5pZF0gPSAhMCwgdS5wdXNoKGYpKSwgaChhLCBlKSAmJiBtKGEsIGUpLCAhMCkgOiBlIGluc3RhbmNlb2YgQVNUX1Njb3BlID8gKHMgPSBMLCBMID0gZSwgbigpLCBMID0gcywgITApIDogdm9pZCAwO31mdW5jdGlvbiAkKGUpIHtyZXR1cm4gZS5kZWZpbml0aW9uKCkuaWQgaW4gVSA/IGUgOiAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcgJiYgKGUudW51c2VkID0gITApLCBudWxsKTt9ZnVuY3Rpb24gRShlLCBuKSB7aWYgKG4udmFsdWUgPSBuLnZhbHVlLnRyYW5zZm9ybShXKSwgIW4ubmFtZS50cmFuc2Zvcm0oZSkpIHtpZiAobi5uYW1lIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCkgcmV0dXJuIG51bGw7ZSA9IG4udmFsdWUuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKFIpO2lmICghZSkgcmV0dXJuIG51bGw7WShuLm5hbWUsICJTaWRlIGVmZmVjdHMgaW4gZGVmYXVsdCB2YWx1ZSBvZiB1bnVzZWQgdmFyaWFibGUge25hbWV9IiksIChuID0gbi5jbG9uZSgpKS5uYW1lLnVudXNlZCA9IG51bGwsIG4udmFsdWUgPSBlO31yZXR1cm4gbjt9ZnVuY3Rpb24gWChlLCB2LCB5LCBnLCBiKSB7dmFyIHggPSAhMCxrID0gbmV3IFRyZWVUcmFuc2Zvcm1lcihmdW5jdGlvbiAocikge2lmIChyIGluc3RhbmNlb2YgQVNUX0RlZmF1bHRWYWx1ZSkge2lmICghKFIub3B0aW9uKCJkZWZhdWx0X3ZhbHVlcyIpICYmIHYgJiYgdi5pc19kZWZpbmVkKFIpKSkgcmV0dXJuIG4gPSBnLCBnID0gITEsIGkgPSBFKGssIHIpLCBnID0gbiwgIWkgJiYgZyAmJiAodiA9IHYgJiYgdi5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoUikpLCBpO3IgPT09IGIgPyBiID0gciA9IHIubmFtZSA6IHIgPSByLm5hbWU7fWlmIChyIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZEFycmF5KSB7dmFyIGUsbiA9IGcsbyA9IHgsdCA9IHY7aWYgKHYgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIChnID0gITEsIHYgPSB2LmZpeGVkX3ZhbHVlKCkpLCB2IGluc3RhbmNlb2YgQVNUX0FycmF5KSB7aWYgKGUgPSAhMCwgZCA9IHYuZWxlbWVudHMsIG8pIGZvciAoXyA9IGQubGVuZ3RoOyAwIDw9IC0tXyAmJiAhZFtfXS5oYXNfc2lkZV9lZmZlY3RzKFIpOyk7fSBlbHNlIGUgPSB2ICYmIHYuaXNfc3RyaW5nKFIpLCBkID0gITEsIF8gPSByLmVsZW1lbnRzLmxlbmd0aDt2YXIgaSxhID0gW10scyA9IGcgJiYgW10sZiA9IDA7aWYgKHIuZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZSwgbikge28gJiYgKHggPSBfIDw9IG4pLCAodiA9IGQgJiYgZFtuXSkgaW5zdGFuY2VvZiBBU1RfSG9sZSA/IHYgPSBudWxsIDogdiBpbnN0YW5jZW9mIEFTVF9TcHJlYWQgJiYgKGcgJiYgKHMubGVuZ3RoID0gZiwgaG4odCwgcyksIFtdLnB1c2guYXBwbHkocywgZC5zbGljZShuKSksIHQuZWxlbWVudHMgPSBzKSwgdiA9IGQgPSAhMSksIChlID0gZS50cmFuc2Zvcm0oaykpICYmIChhW2ZdID0gZSksIGcgJiYgdiAmJiAoc1tmXSA9IHYpLCAhZSAmJiAhdiAmJiBnICYmIGQgfHwgZisrO30pLCB2ID0gZCAmJiBrZShBU1RfQXJyYXksIHQsIHsgZWxlbWVudHM6IGQuc2xpY2Uoci5lbGVtZW50cy5sZW5ndGgpIH0pLCByLnJlc3QgJiYgKGkgPSBnLCBnID0gITEsIHIucmVzdCA9IHIucmVzdC50cmFuc2Zvcm0oUi5vcHRpb24oInJlc3RzIikgPyBrIDogVyksIGcgPSBpLCByLnJlc3QpICYmIChhLmxlbmd0aCA9IGYpLCBnICYmICh2ID0gKHYgPSB2ICYmICFyLnJlc3QgPyB2LmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShSKSA6IHYpIGluc3RhbmNlb2YgQVNUX0FycmF5ID8gdi5lbGVtZW50cyA6IHYgaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgPyB2LmV4cHJlc3Npb25zIDogdiAmJiBbdl0pICYmIHYubGVuZ3RoICYmIChzLmxlbmd0aCA9IGYsIFtdLnB1c2guYXBwbHkocywgdikpLCB2ID0gdCwgeCA9IG8sIGcgPSBuLCBkICYmIHMgJiYgKGhuKHYsIHMpLCAodiA9IHYuY2xvbmUoKSkuZWxlbWVudHMgPSBzKSwgZSkge2lmICghci5yZXN0KSBlOiBzd2l0Y2ggKGEubGVuZ3RoKSB7Y2FzZSAwOmlmIChyID09PSBiKSBicmVhaztyZXR1cm4gZyAmJiAodiA9IHYuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKFIpKSwgbnVsbDtkZWZhdWx0OmlmICghZykgYnJlYWs7aWYgKCF4KSBicmVhaztpZiAociA9PT0gYikgYnJlYWs7Zm9yICh2YXIgYywgZiA9IGEubGVuZ3RoOyAwIDw9IC0tZjspIHt2YXIgbCA9IGFbZl07aWYgKGwpIHtjID0gbDticmVhazt9fWlmIChmIDwgMCkgYnJlYWs7Zm9yICh2YXIgdSA9IGY7IDAgPD0gLS11OykgaWYgKGFbdV0pIGJyZWFrIGU7aWYgKGMuaGFzX3NpZGVfZWZmZWN0cyhSKSkgYnJlYWs7aWYgKHYuaGFzX3NpZGVfZWZmZWN0cyhSKSAmJiBjLm1hdGNoX3N5bWJvbChmdW5jdGlvbiAoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3M7fSkpIGJyZWFrO3JldHVybiB2ID0ga2UoQVNUX1N1YiwgciwgeyBleHByZXNzaW9uOiB2LCBwcm9wZXJ0eToga2UoQVNUX051bWJlciwgciwgeyB2YWx1ZTogZiB9KSB9KSwgYzt9fSBlbHNlIGEubGVuZ3RoID0gci5lbGVtZW50cy5sZW5ndGg7aG4ociwgYSksIHIuZWxlbWVudHMgPSBhO30gZWxzZSBpZiAociBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRPYmplY3QpIHt2YXIgXyxTLHAsZCxuID0gZyxvID0geCx0ID0gdixBID0gKHYgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIChnID0gITEsIHYgPSB2LmZpeGVkX3ZhbHVlKCkpLCB2IGluc3RhbmNlb2YgQVNUX09iamVjdCA/IChfID0gLTEsIFMgPSBbXSwgcCA9IG5ldyBEaWN0aW9uYXJ5KCksIGQgPSB2LnByb3BlcnRpZXMubWFwKGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQ7cmV0dXJuIG8gJiYgZS5oYXNfc2lkZV9lZmZlY3RzKFIpICYmIChfID0gbiksIChlID0gZS5jbG9uZSgpKSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQgPyBwID0gITEgOiAoKHQgPSAodCA9IGUua2V5KSBpbnN0YW5jZW9mIEFTVF9Ob2RlID8gdC5ldmFsdWF0ZShSLCAhMCkgOiB0KSBpbnN0YW5jZW9mIEFTVF9Ob2RlID8gcCA9ICExIDogIXAgfHwgZSBpbnN0YW5jZW9mIEFTVF9PYmplY3RTZXR0ZXIgfHwgcC5zZXQodCwgZSksIFNbbl0gPSB0KSwgZTt9KSkgOiBfID0gci5wcm9wZXJ0aWVzLmxlbmd0aCwgci5yZXN0ICYmICh2ID0gITEsIHIucmVzdCA9IHIucmVzdC50cmFuc2Zvcm0oUi5vcHRpb24oInJlc3RzIikgPyBrIDogVykpLCBuZXcgRGljdGlvbmFyeSgpKSxUID0gZyAmJiBuZXcgRGljdGlvbmFyeSgpLGggPSBbXTtpZiAoci5wcm9wZXJ0aWVzLm1hcChmdW5jdGlvbiAoZSkge3ZhciBuID0gZS5rZXk7cmV0dXJuIG4gaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiAoZS5rZXkgPSBuID0gbi50cmFuc2Zvcm0oVyksIG4gPSBuLmV2YWx1YXRlKFIsICEwKSksIG4gaW5zdGFuY2VvZiBBU1RfTm9kZSA/IFQgPSAhMSA6IEEuc2V0KG4sICFBLmhhcyhuKSksIG47fSkuZm9yRWFjaChmdW5jdGlvbiAoZSwgbikge3ZhciB0LGkgPSByLnByb3BlcnRpZXNbbl07byAmJiAoeCA9IF8gPD0gbiksIGUgaW5zdGFuY2VvZiBBU1RfTm9kZSA/ICh2ID0gZyA9ICExLCB0ID0gaS52YWx1ZS50cmFuc2Zvcm0oaykgfHwgRChpLnZhbHVlKSkgOiAoZyA9IFQgJiYgQS5nZXQoZSksICghKG4gPSBwICYmIHAuZ2V0KGUpKSB8fCAodiA9IG4udmFsdWUpIGluc3RhbmNlb2YgQVNUX0FjY2Vzc29yKSAmJiAodiA9ICExKSwgKHQgPSBpLnZhbHVlLnRyYW5zZm9ybShrKSkgPyBUICYmIFQuc2V0KGUsICExKSA6ICgoci5yZXN0IHx8IHcoaSkpICYmICh0ID0gRChpLnZhbHVlKSksIFQgJiYgIVQuaGFzKGUpICYmIChuID8gKFQuc2V0KGUsIG4pLCBudWxsID09PSB2ICYmIHAuc2V0KGUsIHcobikgJiYga2UoQVNUX09iamVjdEtleVZhbCwgbiwgeyBrZXk6IG4ua2V5LCB2YWx1ZToga2UoQVNUX051bWJlciwgbiwgeyB2YWx1ZTogMCB9KSB9KSkpIDogVC5zZXQoZSwgITApKSksIHYgJiYgKG4udmFsdWUgPSB2KSksIHQgJiYgKGkudmFsdWUgPSB0LCBoLnB1c2goaSkpO30pLCB2ID0gdCwgeCA9IG8sIGcgPSBuLCBUICYmIFMgJiYgKCh2ID0gdi5jbG9uZSgpKS5wcm9wZXJ0aWVzID0gTGlzdChkLCBmdW5jdGlvbiAoZSwgbikge2lmIChlIGluc3RhbmNlb2YgQVNUX1NwcmVhZCkgcmV0dXJuIGU7biA9IFNbbl07aWYgKG4gaW5zdGFuY2VvZiBBU1RfTm9kZSkgcmV0dXJuIGU7aWYgKCJfX3Byb3RvX18iID09PSBuKSByZXR1cm4gZTtpZiAoVC5oYXMobikpIHt2YXIgdCA9IFQuZ2V0KG4pO2lmICghdCkgcmV0dXJuIGU7aWYgKHQgPT09IGUpIHJldHVybiBwLmdldChuKSB8fCBMaXN0LnNraXA7fSBlbHNlIGlmIChyLnJlc3QpIHJldHVybiBlO3QgPSBlLnZhbHVlLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShSKTtyZXR1cm4gdCA/IChlLnZhbHVlID0gdCwgZSkgOiB3KGUpID8ga2UoQVNUX09iamVjdEtleVZhbCwgZSwgeyBrZXk6IGUua2V5LCB2YWx1ZToga2UoQVNUX051bWJlciwgZSwgeyB2YWx1ZTogMCB9KSB9KSA6IExpc3Quc2tpcDt9KSksIHYgJiYgIXIucmVzdCkgc3dpdGNoIChoLmxlbmd0aCkge2Nhc2UgMDppZiAociA9PT0gYikgYnJlYWs7aWYgKHYubWF5X3Rocm93X29uX2FjY2VzcyhSLCAhMCkpIGJyZWFrO3JldHVybiBnICYmICh2ID0gdi5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoUikpLCBudWxsO2Nhc2UgMTppZiAoIWcpIGJyZWFrO2lmICgheCkgYnJlYWs7aWYgKHIgPT09IGIpIGJyZWFrO3ZhciBtID0gaFswXTtpZiAobS5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSkgYnJlYWs7aWYgKG0udmFsdWUuaGFzX3NpZGVfZWZmZWN0cyhSKSkgYnJlYWs7aWYgKHYuaGFzX3NpZGVfZWZmZWN0cyhSKSAmJiBtLnZhbHVlLm1hdGNoX3N5bWJvbChmdW5jdGlvbiAoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3M7fSkpIGJyZWFrO3JldHVybiB2ID0gaXNfaWRlbnRpZmllcl9zdHJpbmcobS5rZXkpID8ga2UoQVNUX0RvdCwgciwgeyBleHByZXNzaW9uOiB2LCBwcm9wZXJ0eTogbS5rZXkgfSkgOiBrZShBU1RfU3ViLCByLCB7IGV4cHJlc3Npb246IHYsIHByb3BlcnR5OiBaKG0ua2V5LCBtKSB9KSwgbS52YWx1ZTt9ci5wcm9wZXJ0aWVzID0gaDt9IGVsc2UgIShyID0gciBpbnN0YW5jZW9mIEFTVF9Ib2xlID8gbnVsbCA6IHkocikpICYmIGcgJiYgKHYgPSB2ICYmIHYuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKFIpKTtyZXR1cm4gcjt9KTtyZXR1cm4geyBuYW1lOiBlLnRyYW5zZm9ybShrKSwgdmFsdWU6IHYgfTtmdW5jdGlvbiB3KGUpIHtyZXR1cm4gZS5rZXkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiBlLmtleS5oYXNfc2lkZV9lZmZlY3RzKFIpO31mdW5jdGlvbiBEKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgPyBEKGUubmFtZSkgOiBlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCA/IChudWxsID09PSB2ID8gdiA9IGtlKEFTVF9OdW1iZXIsIGUsIHsgdmFsdWU6IDAgfSkgOiB2ICYmICh2Lm1heV90aHJvd19vbl9hY2Nlc3MoUiwgITApID8gdiA9IGtlKEFTVF9BcnJheSwgZSwgeyBlbGVtZW50czogdiBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSA/IHYuZXhwcmVzc2lvbnMgOiBbdl0gfSkgOiBmdW5jdGlvbiBlKG4pIHtuIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiA/IChuLndyaXRlX29ubHkgPSAhMSwgZShuLnJpZ2h0KSkgOiBuIGluc3RhbmNlb2YgQVNUX0JpbmFyeSA/IE5lW24ub3BlcmF0b3JdICYmIChlKG4ubGVmdCksIGUobi5yaWdodCkpIDogbiBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCA/IChlKG4uY29uc2VxdWVudCksIGUobi5hbHRlcm5hdGl2ZSkpIDogbiBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSA/IGUobi50YWlsX25vZGUoKSkgOiBuIGluc3RhbmNlb2YgQVNUX1VuYXJ5ICYmIChuLndyaXRlX29ubHkgPSAhMSk7fSh2KSksIGtlKEFTVF9EZXN0cnVjdHVyZWRPYmplY3QsIGUsIHsgcHJvcGVydGllczogW10gfSkpIDogKGUudW51c2VkID0gbnVsbCwgZSk7fX19KSwgQVNUX1Njb3BlLkRFRk1FVEhPRCgiaG9pc3RfZGVjbGFyYXRpb25zIiwgZnVuY3Rpb24gKGEpIHt2YXIgcywgZiwgYywgbiwgbCwgdSwgXywgUywgcCwgaTshYS5oYXNfZGlyZWN0aXZlKCJ1c2UgYXNtIikgJiYgKHMgPSBhLm9wdGlvbigiaG9pc3RfZnVucyIpLCBmID0gYS5vcHRpb24oImhvaXN0X3ZhcnMiKSwgYyA9IHRoaXMsIGYgJiYgKG4gPSAwLCBjLndhbGsobmV3IFRyZWVXYWxrZXIoZnVuY3Rpb24gKGUpIHtyZXR1cm4gMSA8IG4gfHwgZSBpbnN0YW5jZW9mIEFTVF9FeHBvcnREZWNsYXJhdGlvbiB8fCBlIGluc3RhbmNlb2YgQVNUX1Njb3BlICYmIGUgIT09IGMgfHwgKGUgaW5zdGFuY2VvZiBBU1RfVmFyID8gKG4rKywgITApIDogdm9pZCAwKTt9KSksIG4gPD0gMSkgJiYgKGYgPSAhMSksIHMgfHwgZikgJiYgKGwgPSBuZXcgRGljdGlvbmFyeSgpLCB1ID0gW10sIF8gPSBbXSwgUyA9IG5ldyBEaWN0aW9uYXJ5KCksIHAgPSBuZXcgVHJlZVRyYW5zZm9ybWVyKGZ1bmN0aW9uIChlLCBuLCB0KSB7aWYgKGUgIT09IGMpIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9EaXJlY3RpdmUpIHJldHVybiB1LnB1c2goZSksIHQgPyBMaXN0LnNraXAgOiBrZShBU1RfRW1wdHlTdGF0ZW1lbnQsIGUpO3ZhciBpO2lmIChlIGluc3RhbmNlb2YgQVNUX0xhbWJkYURlZmluaXRpb24pIHJldHVybiAhcyB8fCAoaSA9IHAucGFyZW50KCkpIGluc3RhbmNlb2YgQVNUX0V4cG9ydERlY2xhcmF0aW9uIHx8IGkgaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVmYXVsdCB8fCBpICE9PSBjICYmIGEuaGFzX2RpcmVjdGl2ZSgidXNlIHN0cmljdCIpID8gZSA6IChfLnB1c2goZSksIHQgPyBMaXN0LnNraXAgOiBrZShBU1RfRW1wdHlTdGF0ZW1lbnQsIGUpKTtpZiAoZSBpbnN0YW5jZW9mIEFTVF9WYXIpIHtpZiAoIWYpIHJldHVybiBlO2lmICgoaSA9IHAucGFyZW50KCkpIGluc3RhbmNlb2YgQVNUX0V4cG9ydERlY2xhcmF0aW9uKSByZXR1cm4gZTtpZiAoIWFsbChlLmRlZmluaXRpb25zLCBmdW5jdGlvbiAoZSkge2UgPSBlLm5hbWU7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sVmFyICYmICFsLmhhcyhlLm5hbWUpICYmIGMuZmluZF92YXJpYWJsZShlLm5hbWUpID09PSBlLmRlZmluaXRpb24oKTt9KSkgcmV0dXJuIGU7ZS5kZWZpbml0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7dmFyIG4gPSBlLm5hbWUubmFtZTtTLmhhcyhuKSB8fCBTLnNldChuLCBlKTt9KTt2YXIgcixvID0gZS50b19hc3NpZ25tZW50cygpO3JldHVybiBpIGluc3RhbmNlb2YgQVNUX0ZvckVudW1lcmF0aW9uICYmIGkuaW5pdCA9PT0gZSA/IG8gfHwgKHIgPSBlLmRlZmluaXRpb25zWzBdLm5hbWUsIGtlKEFTVF9TeW1ib2xSZWYsIHIpKSA6IGkgaW5zdGFuY2VvZiBBU1RfRm9yICYmIGkuaW5pdCA9PT0gZSA/IG8gOiBvID8ga2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgZSwgeyBib2R5OiBvIH0pIDogdCA/IExpc3Quc2tpcCA6IGtlKEFTVF9FbXB0eVN0YXRlbWVudCwgZSk7fXJldHVybiBlIGluc3RhbmNlb2YgQVNUX1Njb3BlID8gZSA6IGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sQ29uc3QgPyAobC5zZXQoZS5uYW1lLCAhMCksIGUpIDogdm9pZCAwO319KSwgYy50cmFuc2Zvcm0ocCksIDAgPCBTLnNpemUoKSAmJiAoaSA9IFtdLCBjIGluc3RhbmNlb2YgQVNUX0xhbWJkYSAmJiBjLmVhY2hfYXJnbmFtZShmdW5jdGlvbiAoZSkge2FsbChlLmRlZmluaXRpb24oKS5yZWZlcmVuY2VzLCBmdW5jdGlvbiAoZSkge3JldHVybiAhZS5pbl9hcmc7fSkgJiYgUy5kZWwoZS5uYW1lKTt9KSwgUy5lYWNoKGZ1bmN0aW9uIChlKSB7dmFyIG4gPSBlLm5hbWUsdCA9ICgoZSA9IGUuY2xvbmUoKSkubmFtZSA9IG4uY2xvbmUoKSwgZS52YWx1ZSA9IG51bGwsIGkucHVzaChlKSwgbi5kZWZpbml0aW9uKCkub3JpZyk7dC5zcGxpY2UodC5pbmRleE9mKG4pLCAwLCBlLm5hbWUpO30pLCAwIDwgaS5sZW5ndGgpICYmIF8ucHVzaChrZShBU1RfVmFyLCBjLCB7IGRlZmluaXRpb25zOiBpIH0pKSwgYy5ib2R5ID0gdS5jb25jYXQoXywgYy5ib2R5KSk7fSksIEFTVF9TY29wZS5ERUZNRVRIT0QoInByb2Nlc3NfcmV0dXJucyIsIG5vb3ApLCBBU1RfRGVmdW4uREVGTUVUSE9EKCJwcm9jZXNzX3JldHVybnMiLCBmdW5jdGlvbiAoZSkge2lmIChlLm9wdGlvbigiYm9vbGVhbnMiKSAmJiAhKGUucGFyZW50KCkgaW5zdGFuY2VvZiBBU1RfRXhwb3J0RGVmYXVsdCkpIHN3aXRjaCAoYm4odGhpcy5uYW1lLmRlZmluaXRpb24oKSwgZ24odGhpcyksIGUpKSB7Y2FzZSAiZCI6d24oZSwgdGhpcywgITApO2JyZWFrO2Nhc2UgITA6eG4odGhpcywgZSk7fX0pLCBBU1RfRnVuY3Rpb24uREVGTUVUSE9EKCJwcm9jZXNzX3JldHVybnMiLCBmdW5jdGlvbiAobikge2lmIChuLm9wdGlvbigiYm9vbGVhbnMiKSkge3ZhciB0ID0gITAsaSA9IGduKHRoaXMpO2lmICghdGhpcy5uYW1lIHx8IGModGhpcy5uYW1lLmRlZmluaXRpb24oKSkpIHt2YXIgZSA9IG4ucGFyZW50KCk7aWYgKGUgaW5zdGFuY2VvZiBBU1RfQXNzaWduKSB7aWYgKCI9IiAhPSBlLm9wZXJhdG9yKSByZXR1cm47aWYgKCEoKG8gPSBlLmxlZnQpIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZikpIHJldHVybjtpZiAoIWMoby5kZWZpbml0aW9uKCkpKSByZXR1cm47fSBlbHNlIGlmIChlIGluc3RhbmNlb2YgQVNUX0NhbGwgJiYgZS5leHByZXNzaW9uICE9PSB0aGlzKSB7dmFyIHIgPSBlLmV4cHJlc3Npb247aWYgKCEoKHIgPSByIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IHIuZml4ZWRfdmFsdWUoKSA6IHIpIGluc3RhbmNlb2YgQVNUX0xhbWJkYSkpIHJldHVybjtpZiAoci51c2VzX2FyZ3VtZW50cyB8fCByLnBpbm5lZCgpKSByZXR1cm47Zm9yICh2YXIgbywgYSA9IGUuYXJncywgcyA9IDA7IHMgPCBhLmxlbmd0aDsgcysrKSB7dmFyIGYgPSBhW3NdO2lmIChmID09PSB0aGlzKSB7aWYgKCEobyA9IHIuYXJnbmFtZXNbc10pICYmIHIucmVzdCkgcmV0dXJuO2JyZWFrO31pZiAoZiBpbnN0YW5jZW9mIEFTVF9TcHJlYWQpIHJldHVybjt9aWYgKChvID0gbyBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgPyBvLm5hbWUgOiBvKSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xGdW5hcmcgJiYgIWMoby5kZWZpbml0aW9uKCkpKSByZXR1cm47fSBlbHNlIHtpZiAoIkNhbGwiICE9IGUuVFlQRSkgcmV0dXJuO24ucG9wKCk7ZSA9IG4uaW5fYm9vbGVhbl9jb250ZXh0KCk7c3dpdGNoIChuLnB1c2godGhpcyksIGUpIHtjYXNlICEwOnQgPSAhMTtjYXNlICJkIjpicmVhaztkZWZhdWx0OnJldHVybjt9fXQgPyB3bihuLCB0aGlzLCAhMCkgOiB4bih0aGlzLCBuKTt9fWZ1bmN0aW9uIGMoZSkge3N3aXRjaCAoYm4oZSwgaSwgbikpIHtjYXNlICEwOnQgPSAhMTtjYXNlICJkIjpyZXR1cm4gMTt9fX0pLCBBU1RfQmxvY2tTY29wZS5ERUZNRVRIT0QoInZhcl9uYW1lcyIsIGZ1bmN0aW9uICgpIHt2YXIgdCA9IHRoaXMuX3Zhcl9uYW1lcztyZXR1cm4gdCB8fCAodGhpcy5fdmFyX25hbWVzID0gdCA9IG5ldyBEaWN0aW9uYXJ5KCksIHRoaXMuZW5jbG9zZWQuZm9yRWFjaChmdW5jdGlvbiAoZSkge3Quc2V0KGUubmFtZSwgITApO30pLCB0aGlzLnZhcmlhYmxlcy5lYWNoKGZ1bmN0aW9uIChlLCBuKSB7dC5zZXQobiwgITApO30pKSwgdDt9KSwgQVNUX1Njb3BlLkRFRk1FVEhPRCgibWFrZV92YXIiLCBmdW5jdGlvbiAoZSwgbiwgdCkge2ZvciAodmFyIGkgPSBbdGhpc10sIHIgPSAobiBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiAmJiBuLmRlZmluaXRpb24oKS5yZWZlcmVuY2VzLmZvckVhY2goZnVuY3Rpb24gKGUpIHt2YXIgbiA9IGUuc2NvcGU7ZG8ge2lmICghcHVzaF91bmlxKGksIG4pKSByZXR1cm47fSB3aGlsZSAoKG4gPSBuLnBhcmVudF9zY29wZSkgJiYgbiAhPT0gdGhpcyk7fSksIHQgPSB0LnJlcGxhY2UoL15bXmEtel8kXXxbXmEtejAtOV8kXS9naSwgIl8iKSksIG8gPSAwOyAhYWxsKGksIGZ1bmN0aW9uIChlKSB7cmV0dXJuICFlLnZhcl9uYW1lcygpLmhhcyhyKTt9KTsgbysrKSByID0gdCArICIkIiArIG87dmFyIGUgPSBrZShlLCBuLCB7IG5hbWU6IHIsIHNjb3BlOiB0aGlzIH0pLGEgPSB0aGlzLmRlZl92YXJpYWJsZShlKTtyZXR1cm4gaS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZS5lbmNsb3NlZC5wdXNoKGEpLCBlLnZhcl9uYW1lcygpLnNldChyLCAhMCk7fSksIGU7fSksIEFTVF9TY29wZS5ERUZNRVRIT0QoImhvaXN0X3Byb3BlcnRpZXMiLCBmdW5jdGlvbiAocikge3ZhciBmLCBvLCBjLCBsO2Z1bmN0aW9uIHUoZSwgbiwgdCkge3ZhciBpO3JldHVybiAhKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sKSB8fCAoaSA9IGUuZGVmaW5pdGlvbigpKS5hc3NpZ25tZW50cyAhPSB0IHx8IGkucmVmZXJlbmNlcy5sZW5ndGggLSBpLnJlcGxhY2VkID09IHQgfHwgaS5zaW5nbGVfdXNlIHx8IGYuZmluZF92YXJpYWJsZShlLm5hbWUpICE9PSBpIHx8IG8oaSkgfHwgZS5maXhlZF92YWx1ZSgpICE9PSBuIHx8ICh0ID0gZS5maXhlZCB8fCBpLmZpeGVkKS5kaXJlY3RfYWNjZXNzID8gdm9pZCAwIDogKCF0LmVzY2FwZWQgfHwgMSAhPSB0LmVzY2FwZWQuZGVwdGgpICYmIG4gaW5zdGFuY2VvZiBBU1RfT2JqZWN0ICYmIDAgPCBuLnByb3BlcnRpZXMubGVuZ3RoICYmIGJlKGUsIHIpICYmIGFsbChuLnByb3BlcnRpZXMsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHN0KGUpICYmICJfX3Byb3RvX18iICE9PSBlLmtleTt9KTt9IXIub3B0aW9uKCJob2lzdF9wcm9wcyIpIHx8IHIuaGFzX2RpcmVjdGl2ZSgidXNlIGFzbSIpIHx8IChmID0gdGhpcywgaXNfYXJyb3coZikgJiYgZi52YWx1ZSkgfHwgKG8gPSBmIGluc3RhbmNlb2YgQVNUX1RvcGxldmVsICYmIHIudG9wX3JldGFpbiB8fCByZXR1cm5fZmFsc2UsIGMgPSBPYmplY3QuY3JlYXRlKG51bGwpLCBsID0gbmV3IFRyZWVUcmFuc2Zvcm1lcihmdW5jdGlvbiAodCwgZSkge2lmICh0IGluc3RhbmNlb2YgQVNUX0Fzc2lnbikge2lmICgiPSIgIT0gdC5vcGVyYXRvcikgcmV0dXJuO2lmICghdC53cml0ZV9vbmx5KSByZXR1cm47aWYgKCF1KHQubGVmdCwgdC5yaWdodCwgMSkpIHJldHVybjtlKHQsIGwpO3ZhciBpID0gbmV3IERpY3Rpb25hcnkoKSxyID0gW10sbyA9IFtdO3JldHVybiB0LnJpZ2h0LnByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge3ZhciBuID0gcyhBU1RfU3ltYm9sVmFyLCB0LmxlZnQsIGUua2V5KSxuID0gKG8ucHVzaChrZShBU1RfVmFyRGVmLCB0LCB7IG5hbWU6IG4sIHZhbHVlOiBudWxsIH0pKSwga2UoQVNUX1N5bWJvbFJlZiwgdCwgeyBuYW1lOiBuLm5hbWUsIHNjb3BlOiBmLCB0aGVkZWY6IG4uZGVmaW5pdGlvbigpIH0pKTtuLnJlZmVyZW5jZSgpLCByLnB1c2goa2UoQVNUX0Fzc2lnbiwgdCwgeyBvcGVyYXRvcjogIj0iLCBsZWZ0OiBuLCByaWdodDogZS52YWx1ZSB9KSk7fSksIGkudmFsdWUgPSB0LnJpZ2h0LCBjW3QubGVmdC5kZWZpbml0aW9uKCkuaWRdID0gaSwgZi5ib2R5LnNwbGljZShmLmJvZHkuaW5kZXhPZihsLnN0YWNrWzFdKSArIDEsIDAsIGtlKEFTVF9WYXIsIHQsIHsgZGVmaW5pdGlvbnM6IG8gfSkpLCB3ZSh0LCByKTt9dmFyIG4sIGE7aWYgKHQgaW5zdGFuY2VvZiBBU1RfU2NvcGUpIHJldHVybiB0ID09PSBmIHx8ICJDYWxsIiA9PSAoYSA9IGwucGFyZW50KCkpLlRZUEUgJiYgYS5leHByZXNzaW9uID09PSB0ID8gdm9pZCAwIDogdDtpZiAodCBpbnN0YW5jZW9mIEFTVF9WYXJEZWYgJiYgdSh0Lm5hbWUsIHQudmFsdWUsIDApKSByZXR1cm4gZSh0LCBsKSwgaSA9IG5ldyBEaWN0aW9uYXJ5KCksIG4gPSBbXSwgKGEgPSB0LmNsb25lKCkpLnZhbHVlID0gdC5uYW1lIGluc3RhbmNlb2YgQVNUX1N5bWJvbENvbnN0ID8ga2UoQVNUX051bWJlciwgdCwgeyB2YWx1ZTogMCB9KSA6IG51bGwsIG4ucHVzaChhKSwgdC52YWx1ZS5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtuLnB1c2goa2UoQVNUX1ZhckRlZiwgdCwgeyBuYW1lOiBzKHQubmFtZS5DVE9SLCB0Lm5hbWUsIGUua2V5KSwgdmFsdWU6IGUudmFsdWUgfSkpO30pLCBpLnZhbHVlID0gdC52YWx1ZSwgY1t0Lm5hbWUuZGVmaW5pdGlvbigpLmlkXSA9IGksIExpc3Quc3BsaWNlKG4pO2Z1bmN0aW9uIHMoZSwgbiwgdCkge2UgPSBmLm1ha2VfdmFyKGUsIG4sIG4ubmFtZSArICJfIiArIHQpO3JldHVybiBpLnNldCh0LCBlLmRlZmluaXRpb24oKSksIGU7fX0pLCBmLnRyYW5zZm9ybShsKSwgZi50cmFuc2Zvcm0obmV3IFRyZWVUcmFuc2Zvcm1lcihmdW5jdGlvbiAoZSwgbikge3ZhciB0O2lmIChlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpIHJldHVybiAhKGUuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgKGkgPSBjW2UuZXhwcmVzc2lvbi5kZWZpbml0aW9uKCkuaWRdKSAmJiBlLmV4cHJlc3Npb24uZml4ZWRfdmFsdWUoKSA9PT0gaS52YWx1ZSkgPyB2b2lkIDAgOiAodCA9IGkuZ2V0KGUuZ2V0X3Byb3BlcnR5KCkpLCAodCA9IGtlKEFTVF9TeW1ib2xSZWYsIGUsIHsgbmFtZTogdC5uYW1lLCBzY29wZTogZS5leHByZXNzaW9uLnNjb3BlLCB0aGVkZWY6IHQgfSkpLnJlZmVyZW5jZSgpLCB0KTtpZiAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYpIHt2YXIgaSA9IGNbZS5kZWZpbml0aW9uKCkuaWRdO2lmIChpICYmIGUuZml4ZWRfdmFsdWUoKSA9PT0gaS52YWx1ZSkgcmV0dXJuIGtlKEFTVF9PYmplY3QsIGUsIHsgcHJvcGVydGllczogW10gfSk7fX0pKSk7fSksIChuID0gZnVuY3Rpb24gbihlLCBfbjE3KSB7ZS5ERUZNRVRIT0QoImRyb3Bfc2lkZV9lZmZlY3RfZnJlZSIsIF9uMTcpO30pKEFTVF9Ob2RlLCByZXR1cm5fdGhpcyksIG4oQVNUX0FjY2Vzc29yLCByZXR1cm5fbnVsbCksIG4oQVNUX0FycmF5LCBmdW5jdGlvbiAoZSwgbikge2UgPSBfKHRoaXMuZWxlbWVudHMsIGUsIG4sIERuKTtyZXR1cm4gZSA/IGUgPT09IHRoaXMuZWxlbWVudHMgJiYgYWxsKGUsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfU3ByZWFkO30pID8gdGhpcyA6IHdlKHRoaXMsIGUubWFwKEVuKSkgOiBudWxsO30pLCBuKEFTVF9Bc3NpZ24sIGZ1bmN0aW9uIChlKSB7dmFyIG4gPSB0aGlzLmxlZnQ7aWYgKG4gaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2Vzcykge3ZhciB0ID0gbi5leHByZXNzaW9uO2lmICh0Lm1heV90aHJvd19vbl9hY2Nlc3MoZSwgITApKSByZXR1cm4gdGhpcztpZiAoZS5oYXNfZGlyZWN0aXZlKCJ1c2Ugc3RyaWN0IikgJiYgdC5pc19jb25zdGFudCgpKSByZXR1cm4gdGhpczt9cmV0dXJuICFuLmhhc19zaWRlX2VmZmVjdHMoZSkgJiYgIU5lW3RoaXMub3BlcmF0b3Iuc2xpY2UoMCwgLTEpXSAmJiAodGhpcy53cml0ZV9vbmx5ID0gITAsIHJvb3RfZXhwcihuKS5pc19jb25zdGFudF9leHByZXNzaW9uKGUuZmluZF9wYXJlbnQoQVNUX1Njb3BlKSkpID8gdGhpcy5yaWdodC5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSkgOiB0aGlzO30pLCBuKEFTVF9Bd2FpdCwgZnVuY3Rpb24gKGUpIHtpZiAoIWUub3B0aW9uKCJhd2FpdHMiKSkgcmV0dXJuIHRoaXM7dmFyIG4gPSB0aGlzLmV4cHJlc3Npb247aWYgKCFoKGUsIG4pKSByZXR1cm4gdGhpczt2YXIgdCA9IChuID0gbiBpbnN0YW5jZW9mIEFTVF9VbmFyeVByZWZpeCAmJiAiISIgPT0gbi5vcGVyYXRvciA/IG4uZXhwcmVzc2lvbiA6IG4pLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShlKTtpZiAodCA9PT0gbikgcmV0dXJuIHRoaXM7dCA/IGgoZSwgdCkgfHwgKHQgPSB0Lm5lZ2F0ZShlKSkgOiB0ID0ga2UoQVNUX051bWJlciwgbiwgeyB2YWx1ZTogMCB9KTtlID0gdGhpcy5jbG9uZSgpO3JldHVybiBlLmV4cHJlc3Npb24gPSB0LCBlO30pLCBuKEFTVF9CaW5hcnksIGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQsaSxyLG8sYSA9IHRoaXMubGVmdCxzID0gdGhpcy5yaWdodCxmID0gdGhpcy5vcGVyYXRvcjtyZXR1cm4gR24odGhpcywgZSkgPyAodCA9IHMuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKGUsIG4pKSA/IE5lW2ZdICYmIHQuaGFzX3NpZGVfZWZmZWN0cyhlKSA/IChpID0gdGhpcywgdCAhPT0gcyAmJiAoKGkgPSBpLmNsb25lKCkpLnJpZ2h0ID0gdC5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSkpLCAiPz8iID09IGYgPyBpIDogKChzID0gaS5jbG9uZSgpKS5vcGVyYXRvciA9ICImJiIgPT0gZiA/ICJ8fCIgOiAiJiYiLCBzLmxlZnQgPSBhLm5lZ2F0ZShlLCBuKSwgKHIgPSBzLnJpZ2h0LnRhaWxfbm9kZSgpKSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgcy5vcGVyYXRvciA9PSByLm9wZXJhdG9yICYmIEpuKHMpLCByID0gbiA/IEllIDogWSwgIiYmIiA9PSBmID8gcihpLCBzKSA6IHIocywgaSkpKSA6IChvID0gYS5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSwgbikpID8gKHQgPSB0LmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShlKSkgPyB3ZSh0aGlzLCBbbywgdF0pIDogbyA6IHQgOiBhLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShlLCBuKSA6IChvID0gYS5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSwgbikpID09PSBhID8gdGhpcyA6IChpID0gdGhpcy5jbG9uZSgpLCBvID8gaS5sZWZ0ID0gbyA6ICJpbnN0YW5jZW9mIiAhPSBmIHx8IGEuaXNfY29uc3RhbnQoKSA/IGkubGVmdCA9IGtlKEFTVF9OdW1iZXIsIGEsIHsgdmFsdWU6IDAgfSkgOiBpLmxlZnQgPSBrZShBU1RfQXJyYXksIGEsIHsgZWxlbWVudHM6IFtdIH0pLCBpKTt9KSwgbihBU1RfQ2FsbCwgZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCA9IHRoaXM7aWYgKHQuaXNfZXhwcl9wdXJlKGUpKSByZXR1cm4gdC5wdXJlICYmIEFTVF9Ob2RlLndhcm4oIkRyb3BwaW5nIF9fUFVSRV9fIGNhbGwgW3tzdGFydH1dIiwgdCksIChpID0gXyh0LmFyZ3MsIGUsIG4sIERuKSkgJiYgd2UodCwgaS5tYXAoRW4pKTt2YXIgaSA9IHQuZXhwcmVzc2lvbjtpZiAodC5pc19jYWxsX3B1cmUoZSkpIHJldHVybiAoZiA9IHQuYXJncy5zbGljZSgpKS51bnNoaWZ0KGkuZXhwcmVzc2lvbiksIChmID0gXyhmLCBlLCBuLCBEbikpICYmIHdlKHQsIGYubWFwKEVuKSk7aWYgKGUub3B0aW9uKCJ5aWVsZHMiKSAmJiBpc19nZW5lcmF0b3IoaSkgJiYga24oaSwgZSkpIHJldHVybiAocyA9IHQuY2xvbmUoKSkuZXhwcmVzc2lvbiA9IGtlKEFTVF9GdW5jdGlvbiwgaSksIHMuZXhwcmVzc2lvbi5ib2R5ID0gW10sIHM7dmFyIHIsbyxhLHMgPSB3bihlLCBpKTtpZiAocyAmJiAoKHQgPSB0LmNsb25lKCkpLmV4cHJlc3Npb24gPSBzLCBpLl9zcXVlZXplZCkgJiYgKHQuZXhwcmVzc2lvbi5fc3F1ZWV6ZWQgPSAhMCksIHQgaW5zdGFuY2VvZiBBU1RfTmV3KSB7dmFyIGYscyA9IGk7aWYgKChzID0gcyBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyBzLmZpeGVkX3ZhbHVlKCkgOiBzKSBpbnN0YW5jZW9mIEFTVF9MYW1iZGEpIHtpZiAobyA9IGUsIChyID0gcykubmV3ID0gITAsIGEgPSBhbGwoci5ib2R5LCBmdW5jdGlvbiAoZSkge3JldHVybiAhZS5oYXNfc2lkZV9lZmZlY3RzKG8pO30pICYmIGFsbChyLmFyZ25hbWVzLCBmdW5jdGlvbiAoZSkge3JldHVybiAhZS5tYXRjaF9zeW1ib2wocmV0dXJuX2ZhbHNlKTt9KSAmJiAhKHIucmVzdCAmJiByLnJlc3QubWF0Y2hfc3ltYm9sKHJldHVybl9mYWxzZSkpLCByLm5ldyA9ICExLCBhKSByZXR1cm4gKGYgPSB0LmFyZ3Muc2xpY2UoKSkudW5zaGlmdChpKSwgKGYgPSBfKGYsIGUsIG4sIERuKSkgJiYgd2UodCwgZi5tYXAoRW4pKTtzLmNvbnRhaW5zX3RoaXMoKSB8fCAoKHQgPSBrZShBU1RfQ2FsbCwgdCkpLmV4cHJlc3Npb24gPSB0LmV4cHJlc3Npb24uY2xvbmUoKSwgdC5hcmdzID0gdC5hcmdzLnNsaWNlKCkpO319cmV0dXJuIHQuY2FsbF9vbmx5ID0gITAsIHQ7fSksIG4oQVNUX0NsYXNzRXhwcmVzc2lvbiwgZnVuY3Rpb24gKGUsIG4pIHtmb3IgKHZhciB0ID0gdGhpcywgaSA9IFtdLCByID0gW10sIG8gPSAwLCBhID0gdC5wcm9wZXJ0aWVzLCBzID0gMDsgcyA8IGEubGVuZ3RoOyBzKyspIHt2YXIgZiA9IGFbc107aWYgKGYua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgJiYgaS5wdXNoKGYua2V5KSwgaGUoZikpIHt2YXIgYyA9IGYudmFsdWU7aWYgKGMuaGFzX3NpZGVfZWZmZWN0cyhlKSkge2lmIChjLmNvbnRhaW5zX3RoaXMoKSkgcmV0dXJuIHQ7ZiBpbnN0YW5jZW9mIEFTVF9DbGFzc0luaXQgPyAobysrLCByLnB1c2goZikpIDogci5wdXNoKGMpO319fXZhciBsID0gdC5leHRlbmRzO2lmICghbCB8fCAobCA9ICFSZShsID0gbCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyBsLmZpeGVkX3ZhbHVlKCkgOiBsKSkgfHwgaS51bnNoaWZ0KHQuZXh0ZW5kcyksIGkgPSBfKGksIGUsIG4pLCByID0gXyhyLCBlLCBuID0gaSA/ICExIDogbiksICFpKSB7aWYgKCFsICYmICFyICYmICF0Lm5hbWUpIHJldHVybiBudWxsO2kgPSBbXTt9cmV0dXJuIGwgfHwgdC5uYW1lIHx8ICFlLmhhc19kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSA/IChuID0gbW4odCksIGwgfHwgKG4uZXh0ZW5kcyA9IG51bGwpLCBuLnByb3BlcnRpZXMgPSBbXSwgciA/IHIubGVuZ3RoID09IG8gPyAoaS5sZW5ndGggJiYgci51bnNoaWZ0KGtlKEFTVF9DbGFzc0ZpZWxkLCB0LCB7IGtleTogd2UodCwgaSksIHZhbHVlOiBudWxsIH0pKSwgbi5wcm9wZXJ0aWVzID0gcikgOiBuLnByb3BlcnRpZXMucHVzaChrZShBU1RfQ2xhc3NGaWVsZCwgdCwgeyBzdGF0aWM6ICEwLCBrZXk6IGkubGVuZ3RoID8gd2UodCwgaSkgOiAiYyIsIHZhbHVlOiB1KCkgfSkpIDogaS5sZW5ndGggJiYgbi5wcm9wZXJ0aWVzLnB1c2goa2UoQVNUX0NsYXNzTWV0aG9kLCB0LCB7IGtleTogd2UodCwgaSksIHZhbHVlOiBrZShBU1RfRnVuY3Rpb24sIHQsIHsgYXJnbmFtZXM6IFtdLCBib2R5OiBbXSB9KS5pbml0X3ZhcnMobikgfSkpLCBuKSA6IChyICYmIGkucHVzaChrZShBU1RfQ2FsbCwgdCwgeyBleHByZXNzaW9uOiBrZShBU1RfQXJyb3csIHQsIHsgYXJnbmFtZXM6IFtdLCBib2R5OiBbXSwgdmFsdWU6IHUoKSB9KS5pbml0X3ZhcnModC5wYXJlbnRfc2NvcGUsIHQpLCBhcmdzOiBbXSB9KSksIHdlKHQsIGkpKTtmdW5jdGlvbiB1KCkge3JldHVybiB3ZSh0LCByLm1hcChmdW5jdGlvbiAoZSkge3ZhciBuO3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0NsYXNzSW5pdCA/ICgobiA9IGtlKEFTVF9BcnJvdywgZS52YWx1ZSkpLmFyZ25hbWVzID0gW10sIGtlKEFTVF9DYWxsLCBlLCB7IGV4cHJlc3Npb246IG4sIGFyZ3M6IFtdIH0pKSA6IGU7fSkpO319KSwgbihBU1RfQ29uZGl0aW9uYWwsIGZ1bmN0aW9uIChlKSB7dmFyIG4sdCxpID0gdGhpcy5jb25zZXF1ZW50LmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShlKSxyID0gdGhpcy5hbHRlcm5hdGl2ZS5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSk7cmV0dXJuIGkgPT09IHRoaXMuY29uc2VxdWVudCAmJiByID09PSB0aGlzLmFsdGVybmF0aXZlID8gdGhpcyA6IChlLm9wdGlvbigiaWUiKSAmJiAobiA9IFtdLCBpIGluc3RhbmNlb2YgQVNUX0Z1bmN0aW9uICYmIChuLnB1c2goaSksIGkgPSBudWxsKSwgciBpbnN0YW5jZW9mIEFTVF9GdW5jdGlvbikgJiYgKG4ucHVzaChyKSwgciA9IG51bGwpLCBpID8gciA/ICgodCA9IHRoaXMuY2xvbmUoKSkuY29uc2VxdWVudCA9IGksIHQuYWx0ZXJuYXRpdmUgPSByKSA6IHQgPSBrZShBU1RfQmluYXJ5LCB0aGlzLCB7IG9wZXJhdG9yOiAiJiYiLCBsZWZ0OiB0aGlzLmNvbmRpdGlvbiwgcmlnaHQ6IGkgfSkgOiB0ID0gciA/IGtlKEFTVF9CaW5hcnksIHRoaXMsIHsgb3BlcmF0b3I6ICJ8fCIsIGxlZnQ6IHRoaXMuY29uZGl0aW9uLCByaWdodDogciB9KSA6IHRoaXMuY29uZGl0aW9uLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShlKSwgbiA/ICh0ICYmIG4ucHVzaCh0KSwgMCA9PSBuLmxlbmd0aCA/IG51bGwgOiB3ZSh0aGlzLCBuKSkgOiB0KTt9KSwgbihBU1RfQ29uc3RhbnQsIHJldHVybl9udWxsKSwgbihBU1RfRG90LCBmdW5jdGlvbiAoZSwgbikge3ZhciB0ID0gdGhpcy5leHByZXNzaW9uO3JldHVybiB0Lm1heV90aHJvd19vbl9hY2Nlc3MoZSkgPyB0aGlzIDogdC5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSwgbik7fSksIG4oQVNUX0Z1bmN0aW9uLCBmdW5jdGlvbiAoZSkge3JldHVybiBrbih0aGlzLCBlKSA/IG51bGwgOiB0aGlzO30pLCBuKEFTVF9MYW1iZGFFeHByZXNzaW9uLCByZXR1cm5fbnVsbCksIG4oQVNUX09iamVjdCwgZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCA9IFtdLGUgPSAodGhpcy5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlIGluc3RhbmNlb2YgQVNUX1NwcmVhZCA/IHQucHVzaChlKSA6IChlLmtleSBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmIHQucHVzaChlLmtleSksIHQucHVzaChlLnZhbHVlKSk7fSksIF8odCwgZSwgbiwgZnVuY3Rpb24gKGUsIG4sIHQpIHt2YXIgaSA9IGUuZXhwcmVzc2lvbjtyZXR1cm4gaS5zYWZlX3RvX3NwcmVhZCgpID8gaS5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUobiwgdCkgOiBlO30pKTtyZXR1cm4gZSA/IGUgIT09IHQgfHwgYWxsKGUsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICEoZSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQpO30pID8gd2UodGhpcywgZS5tYXAoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQgPyBrZShBU1RfT2JqZWN0LCBlLCB7IHByb3BlcnRpZXM6IFtlXSB9KSA6IGU7fSkpIDogdGhpcyA6IG51bGw7fSksIG4oQVNUX09iamVjdElkZW50aXR5LCByZXR1cm5fbnVsbCksIG4oQVNUX1NlcXVlbmNlLCBmdW5jdGlvbiAoZSwgbikge3ZhciB0LGkscixvID0gXyh0aGlzLmV4cHJlc3Npb25zLCBlLCBuKTtyZXR1cm4gbyA/ICh0ID0gb1tyID0gby5sZW5ndGggLSAxXSwgZS5vcHRpb24oImF3YWl0cyIpICYmIDAgPCByICYmIHQgaW5zdGFuY2VvZiBBU1RfQXdhaXQgJiYgdC5leHByZXNzaW9uLmlzX2NvbnN0YW50KCkgJiYgKGkgPSAobyA9IG8uc2xpY2UoMCwgLTEpKVstLXJdLCB0LmV4cHJlc3Npb24gPSBoKGUsIGkpID8gaSA6IGkubmVnYXRlKGUpLCBvW3JdID0gdCksIGUub3B0aW9uKCJjb25kaXRpb25hbHMiKSAmJiAwIDwgciAmJiAoaSA9IG9bciAtIDFdKSBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gJiYgIj0iID09IGkub3BlcmF0b3IgJiYgKHIgPSBpLmxlZnQpIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiAociA9IEluKGUsIHIuZGVmaW5pdGlvbigpLCBpLnJpZ2h0LCB0KSkgJiYgKChpID0gaS5jbG9uZSgpKS5yaWdodCA9IHIsIChvID0gby5zbGljZSgwLCAtMikpLnB1c2goaS5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSwgbikpKSwgbyA9PT0gdGhpcy5leHByZXNzaW9ucyA/IHRoaXMgOiB3ZSh0aGlzLCBvKSkgOiBudWxsO30pLCBuKEFTVF9TdWIsIGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQsaSA9IHRoaXMuZXhwcmVzc2lvbjtyZXR1cm4gaS5tYXlfdGhyb3dfb25fYWNjZXNzKGUpID8gdGhpcyA6ICh0ID0gdGhpcy5wcm9wZXJ0eSwgKGkgPSBpLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShlLCBuKSkgPyAodCA9IHQuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKGUpKSA/IHdlKHRoaXMsIFtpLCB0XSkgOiBpIDogdC5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSwgbikpO30pLCBuKEFTVF9TeW1ib2xSZWYsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIHRoaXMuaXNfZGVjbGFyZWQoZSkgJiYgYmUodGhpcywgZSkgPyBudWxsIDogdGhpczt9KSwgbihBU1RfVGVtcGxhdGUsIGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQsaSA9IHRoaXM7cmV0dXJuIGkuaXNfZXhwcl9wdXJlKGUpID8gMCA9PSAodCA9IGkuZXhwcmVzc2lvbnMpLmxlbmd0aCA/IG51bGwgOiB3ZShpLCB0KS5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSwgbikgOiAoKG4gPSB3bihlLCB0ID0gaS50YWcpKSAmJiAoKGkgPSBpLmNsb25lKCkpLnRhZyA9IG4sIHQuX3NxdWVlemVkKSAmJiAoaS50YWcuX3NxdWVlemVkID0gITApLCBpKTt9KSwgbihBU1RfVW5hcnksIGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQsaSA9IHRoaXMuZXhwcmVzc2lvbjtyZXR1cm4gdW5hcnlfc2lkZV9lZmZlY3RzW3RoaXMub3BlcmF0b3JdID8gKHRoaXMud3JpdGVfb25seSA9ICFpLmhhc19zaWRlX2VmZmVjdHMoZSksIHRoaXMpIDogInR5cGVvZiIgPT0gdGhpcy5vcGVyYXRvciAmJiBpIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiBiZShpLCBlKSA/IG51bGwgOiAodCA9IGkuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKGUsIG4pLCBuICYmIHQgJiYgbGUodCkgPyB0ID09PSBpICYmICIhIiA9PSB0aGlzLm9wZXJhdG9yID8gdGhpcyA6IHQubmVnYXRlKGUsIG4pIDogdCk7fSksIGUoQVNUX1NpbXBsZVN0YXRlbWVudCwgZnVuY3Rpb24gKGUsIG4pIHtpZiAobi5vcHRpb24oInNpZGVfZWZmZWN0cyIpKSB7dmFyIHQgPSBlLmJvZHksbiA9IHQuZHJvcF9zaWRlX2VmZmVjdF9mcmVlKG4sICEwKTtpZiAoIW4pIHJldHVybiBBU1RfTm9kZS53YXJuKCJEcm9wcGluZyBzaWRlLWVmZmVjdC1mcmVlIHN0YXRlbWVudCBbe3N0YXJ0fV0iLCBlKSwga2UoQVNUX0VtcHR5U3RhdGVtZW50LCBlKTtpZiAobiAhPT0gdCkgcmV0dXJuIGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUsIHsgYm9keTogbiB9KTt9cmV0dXJuIGU7fSksIGUoQVNUX1doaWxlLCBmdW5jdGlvbiAoZSwgbikge3JldHVybiBuLm9wdGlvbigibG9vcHMiKSA/IGtlKEFTVF9Gb3IsIGUpLm9wdGltaXplKG4pIDogZTt9KSwgZShBU1RfRG8sIGZ1bmN0aW9uICh0LCBlKSB7aWYgKCFlLm9wdGlvbigibG9vcHMiKSkgcmV0dXJuIHQ7dmFyIG4gPSBOKGUsIHQuY29uZGl0aW9uKTtpZiAoIShuIGluc3RhbmNlb2YgQVNUX05vZGUpKSB7aWYgKG4gJiYgIUNuKHQsIGUucGFyZW50KCksIEFTVF9Db250aW51ZSkpIHJldHVybiBrZShBU1RfRm9yLCB0LCB7IGJvZHk6IGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgdC5ib2R5LCB7IGJvZHk6IFt0LmJvZHksIGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIHQuY29uZGl0aW9uLCB7IGJvZHk6IHQuY29uZGl0aW9uIH0pXSB9KSB9KS5vcHRpbWl6ZShlKTtpZiAoIUNuKHQsIGUucGFyZW50KCkpKSByZXR1cm4ga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCB0LmJvZHksIHsgYm9keTogW3QuYm9keSwga2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgdC5jb25kaXRpb24sIHsgYm9keTogdC5jb25kaXRpb24gfSldIH0pLm9wdGltaXplKGUpO31pZiAodC5ib2R5IGluc3RhbmNlb2YgQVNUX0Jsb2NrU3RhdGVtZW50ICYmICFDbih0LCBlLnBhcmVudCgpLCBBU1RfQ29udGludWUpKSB7Zm9yICh2YXIgaSA9IHQuYm9keS5ib2R5LCByID0gaS5sZW5ndGg7IDAgPD0gLS1yOykge3ZhciBvID0gaVtyXTtpZiAobyBpbnN0YW5jZW9mIEFTVF9JZiAmJiAhby5hbHRlcm5hdGl2ZSAmJiBvLmJvZHkgaW5zdGFuY2VvZiBBU1RfQnJlYWsgJiYgZS5sb29wY29udHJvbF90YXJnZXQoby5ib2R5KSA9PT0gdCkge2lmIChhKG8uY29uZGl0aW9uKSkgYnJlYWs7dC5jb25kaXRpb24gPSBrZShBU1RfQmluYXJ5LCB0LCB7IG9wZXJhdG9yOiAiJiYiLCBsZWZ0OiBvLmNvbmRpdGlvbi5uZWdhdGUoZSksIHJpZ2h0OiB0LmNvbmRpdGlvbiB9KSwgaS5zcGxpY2UociwgMSk7fSBlbHNlIGlmIChvIGluc3RhbmNlb2YgQVNUX1NpbXBsZVN0YXRlbWVudCkge2lmIChhKG8uYm9keSkpIGJyZWFrO3QuY29uZGl0aW9uID0gd2UodCwgW28uYm9keSwgdC5jb25kaXRpb25dKSwgaS5zcGxpY2UociwgMSk7fSBlbHNlIGlmICghRihvLCAhMCkpIGJyZWFrO310LmJvZHkgPSBwbih0LmJvZHksIGUucGFyZW50KCkpO31yZXR1cm4gdC5ib2R5IGluc3RhbmNlb2YgQVNUX0VtcHR5U3RhdGVtZW50ID8ga2UoQVNUX0ZvciwgdCkub3B0aW1pemUoZSkgOiB0LmJvZHkgaW5zdGFuY2VvZiBBU1RfU2ltcGxlU3RhdGVtZW50ID8ga2UoQVNUX0ZvciwgdCwgeyBjb25kaXRpb246IHdlKHQuY29uZGl0aW9uLCBbdC5ib2R5LmJvZHksIHQuY29uZGl0aW9uXSksIGJvZHk6IGtlKEFTVF9FbXB0eVN0YXRlbWVudCwgdCkgfSkub3B0aW1pemUoZSkgOiB0O2Z1bmN0aW9uIGEoZSkge3ZhciBuID0gITE7cmV0dXJuIGUud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3JldHVybiAhIW4gfHwgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmID8gKG1lbWJlcihlLmRlZmluaXRpb24oKSwgdC5lbmNsb3NlZCkgfHwgKG4gPSAhMCksICEwKSA6IHZvaWQgMCk7fSkpLCBuO319KSwgZShBU1RfRm9yLCBmdW5jdGlvbiAoZSwgbikge2lmICghbi5vcHRpb24oImxvb3BzIikpIHJldHVybiBlO2lmIChuLm9wdGlvbigic2lkZV9lZmZlY3RzIikgJiYgKGUuaW5pdCAmJiAoZS5pbml0ID0gZS5pbml0LmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShuKSksIGUuc3RlcCkgJiYgKGUuc3RlcCA9IGUuc3RlcC5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUobikpLCBlLmNvbmRpdGlvbikge3ZhciB0ID0gTihuLCBlLmNvbmRpdGlvbik7aWYgKHQpIHQgaW5zdGFuY2VvZiBBU1RfTm9kZSB8fCAoZS5ib2R5ID0ga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBlLmJvZHksIHsgYm9keTogW2tlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUuY29uZGl0aW9uLCB7IGJvZHk6IGUuY29uZGl0aW9uIH0pLCBlLmJvZHldIH0pLCBlLmNvbmRpdGlvbiA9IG51bGwpO2Vsc2UgaWYgKG4ub3B0aW9uKCJkZWFkX2NvZGUiKSkgcmV0dXJuIHQgPSBbXSwgaXNfc3RhdGVtZW50KGUuaW5pdCkgPyB0LnB1c2goZS5pbml0KSA6IGUuaW5pdCAmJiB0LnB1c2goa2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgZS5pbml0LCB7IGJvZHk6IGUuaW5pdCB9KSksIHQucHVzaChrZShBU1RfU2ltcGxlU3RhdGVtZW50LCBlLmNvbmRpdGlvbiwgeyBib2R5OiBlLmNvbmRpdGlvbiB9KSksIEMobiwgZS5ib2R5LCB0KSwga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBlLCB7IGJvZHk6IHQgfSkub3B0aW1pemUobik7fXJldHVybiBmdW5jdGlvbiBuKHQsIGkpIHt2YXIgZSA9IGEodC5ib2R5KTtpZiAoaS5vcHRpb24oImRlYWRfY29kZSIpICYmIChlIGluc3RhbmNlb2YgQVNUX0JyZWFrIHx8IGUgaW5zdGFuY2VvZiBBU1RfQ29udGludWUgJiYgcyhlKSB8fCBlIGluc3RhbmNlb2YgQVNUX0V4aXQpKSByZXR1cm4gciA9IFtdLCBpc19zdGF0ZW1lbnQodC5pbml0KSA/IHIucHVzaCh0LmluaXQpIDogdC5pbml0ICYmIHIucHVzaChrZShBU1RfU2ltcGxlU3RhdGVtZW50LCB0LmluaXQsIHsgYm9keTogdC5pbml0IH0pKSwgbyA9IHMoZSkgfHwgZSBpbnN0YW5jZW9mIEFTVF9FeGl0LCB0LmNvbmRpdGlvbiAmJiBvID8gci5wdXNoKGtlKEFTVF9JZiwgdCwgeyBjb25kaXRpb246IHQuY29uZGl0aW9uLCBib2R5OiBlLCBhbHRlcm5hdGl2ZTogbnVsbCB9KSkgOiB0LmNvbmRpdGlvbiA/IHIucHVzaChrZShBU1RfU2ltcGxlU3RhdGVtZW50LCB0LmNvbmRpdGlvbiwgeyBib2R5OiB0LmNvbmRpdGlvbiB9KSkgOiBvICYmIHIucHVzaChlKSwgQyhpLCB0LmJvZHksIHIpLCBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIHQsIHsgYm9keTogciB9KTtpZiAoZSBpbnN0YW5jZW9mIEFTVF9JZikge3ZhciByLG8gPSBhKGUuYm9keSk7aWYgKG8gaW5zdGFuY2VvZiBBU1RfQnJlYWsgJiYgIXMobykpIHJldHVybiB0LmNvbmRpdGlvbiA/IHQuY29uZGl0aW9uID0ga2UoQVNUX0JpbmFyeSwgdC5jb25kaXRpb24sIHsgbGVmdDogdC5jb25kaXRpb24sIG9wZXJhdG9yOiAiJiYiLCByaWdodDogZS5jb25kaXRpb24ubmVnYXRlKGkpIH0pIDogdC5jb25kaXRpb24gPSBlLmNvbmRpdGlvbi5uZWdhdGUoaSksIHIgPSBzZShlLmFsdGVybmF0aXZlKSwgQyhpLCBlLmJvZHksIHIpLCBmKHIpO2lmICgobyA9IGEoZS5hbHRlcm5hdGl2ZSkpIGluc3RhbmNlb2YgQVNUX0JyZWFrICYmICFzKG8pKSByZXR1cm4gdC5jb25kaXRpb24gPyB0LmNvbmRpdGlvbiA9IGtlKEFTVF9CaW5hcnksIHQuY29uZGl0aW9uLCB7IGxlZnQ6IHQuY29uZGl0aW9uLCBvcGVyYXRvcjogIiYmIiwgcmlnaHQ6IGUuY29uZGl0aW9uIH0pIDogdC5jb25kaXRpb24gPSBlLmNvbmRpdGlvbiwgciA9IHNlKGUuYm9keSksIEMoaSwgZS5hbHRlcm5hdGl2ZSwgciksIGYocik7fXJldHVybiB0O2Z1bmN0aW9uIGEoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0Jsb2NrU3RhdGVtZW50ID8gZS5ib2R5WzBdIDogZTt9ZnVuY3Rpb24gcyhlKSB7cmV0dXJuIGkubG9vcGNvbnRyb2xfdGFyZ2V0KGUpICE9PSBpLnNlbGYoKTt9ZnVuY3Rpb24gZihlKSB7cmV0dXJuIHQuYm9keSBpbnN0YW5jZW9mIEFTVF9CbG9ja1N0YXRlbWVudCA/ICh0LmJvZHkgPSB0LmJvZHkuY2xvbmUoKSwgdC5ib2R5LmJvZHkgPSBlLmNvbmNhdCh0LmJvZHkuYm9keS5zbGljZSgxKSksIHQuYm9keSA9IHQuYm9keS50cmFuc2Zvcm0oaSkpIDogdC5ib2R5ID0ga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCB0LmJvZHksIHsgYm9keTogZSB9KS50cmFuc2Zvcm0oaSksIG4odCwgaSk7fX0oZSwgbik7fSksIGUoQVNUX0ZvckVudW1lcmF0aW9uLCBmdW5jdGlvbiAoZSwgbikge3ZhciB0O3JldHVybiBuLm9wdGlvbigidmFyaWZ5IikgJiYgb2UoZS5pbml0KSAmJiAodCA9IGUuaW5pdC5kZWZpbml0aW9uc1swXS5uYW1lLCAobi5vcHRpb24oIm1vZHVsZSIpIHx8IHQgaW5zdGFuY2VvZiBBU1RfRGVzdHJ1Y3R1cmVkIHx8IHQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sTGV0KSAmJiAhdC5tYXRjaF9zeW1ib2woZnVuY3Rpb24gKGUpIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbikgcmV0dXJuICFabihlID0gZS5kZWZpbml0aW9uKCkpIHx8IEJuKG4sIGUpO30sICEwKSA/IGUuaW5pdCA9IEZuKGUuaW5pdCwgZS5yZXNvbHZlKCkpIDogZS5pbml0LmNhbl9sZXRpZnkobiwgITApICYmIChlLmluaXQgPSBQbihlLmluaXQsIGUpKSksIGU7fSksIGUoQVNUX0lmLCBmdW5jdGlvbiAoZSwgYykge2lmIChlZShlLmFsdGVybmF0aXZlKSAmJiAoZS5hbHRlcm5hdGl2ZSA9IG51bGwpLCBjLm9wdGlvbigiY29uZGl0aW9uYWxzIikpIHtpZiAoYy5vcHRpb24oImJvb2xlYW5zIikgJiYgIWUuY29uZGl0aW9uLmhhc19zaWRlX2VmZmVjdHMoYykgJiYgTm4oYywgZS5jb25kaXRpb24pLCBjLm9wdGlvbigiZGVhZF9jb2RlIikpIHt2YXIgbiA9IE4oYywgZS5jb25kaXRpb24pO2lmICghbikgcmV0dXJuIEFTVF9Ob2RlLndhcm4oIkNvbmRpdGlvbiBhbHdheXMgZmFsc2UgW3tzdGFydH1dIiwgZS5jb25kaXRpb24pLCBwID0gW2tlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUuY29uZGl0aW9uLCB7IGJvZHk6IGUuY29uZGl0aW9uIH0pLnRyYW5zZm9ybShjKV0sIEMoYywgZS5ib2R5LCBwKSwgZS5hbHRlcm5hdGl2ZSAmJiBwLnB1c2goZS5hbHRlcm5hdGl2ZSksIGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgZSwgeyBib2R5OiBwIH0pLm9wdGltaXplKGMpO2lmICghKG4gaW5zdGFuY2VvZiBBU1RfTm9kZSkpIHJldHVybiBBU1RfTm9kZS53YXJuKCJDb25kaXRpb24gYWx3YXlzIHRydWUgW3tzdGFydH1dIiwgZS5jb25kaXRpb24pLCBwID0gW2tlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUuY29uZGl0aW9uLCB7IGJvZHk6IGUuY29uZGl0aW9uIH0pLnRyYW5zZm9ybShjKSwgZS5ib2R5XSwgZS5hbHRlcm5hdGl2ZSAmJiBDKGMsIGUuYWx0ZXJuYXRpdmUsIHApLCBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGUsIHsgYm9keTogcCB9KS5vcHRpbWl6ZShjKTt9dmFyIG4gPSBlLmNvbmRpdGlvbi5uZWdhdGUoYyksdCA9IGUuY29uZGl0aW9uLnByaW50X3RvX3N0cmluZygpLmxlbmd0aCxpID0gbi5wcmludF90b19zdHJpbmcoKS5sZW5ndGgsciA9IGkgPCB0LG8gPSAoZS5hbHRlcm5hdGl2ZSAmJiByICYmIChyID0gITEsIGUuY29uZGl0aW9uID0gbiwgbyA9IGUuYm9keSwgZS5ib2R5ID0gZS5hbHRlcm5hdGl2ZSwgZS5hbHRlcm5hdGl2ZSA9IGVlKG8pID8gbnVsbCA6IG8pLCBbXSksYSA9IFtdLHMgPSBbXSxmID0gRShlLmJvZHksIG8sIGEsIHMpLGwgPSBbXSx1ID0gW10sXyA9IFtdLFMgPSBFKGUuYWx0ZXJuYXRpdmUsIGwsIHUsIF8pO2lmIChmIGluc3RhbmNlb2YgQVNUX0Jsb2NrU3RhdGVtZW50IHx8IFMgaW5zdGFuY2VvZiBBU1RfQmxvY2tTdGF0ZW1lbnQpIHt2YXIgcCA9IFtdLGQgPSBbXTtpZiAoZiAmJiAoW10ucHVzaC5hcHBseShwLCBvKSwgW10ucHVzaC5hcHBseShkLCBhKSwgZiBpbnN0YW5jZW9mIEFTVF9CbG9ja1N0YXRlbWVudCA/IGUuYm9keSA9IGYgOiAwID09IGYubGVuZ3RoID8gZS5ib2R5ID0ga2UoQVNUX0VtcHR5U3RhdGVtZW50LCBlLmJvZHkpIDogZS5ib2R5ID0ga2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgZS5ib2R5LCB7IGJvZHk6IHdlKGUuYm9keSwgZikgfSksIHMuZm9yRWFjaChYKSksIFMgJiYgKFtdLnB1c2guYXBwbHkocCwgbCksIFtdLnB1c2guYXBwbHkoZCwgdSksIFMgaW5zdGFuY2VvZiBBU1RfQmxvY2tTdGF0ZW1lbnQgPyBlLmFsdGVybmF0aXZlID0gUyA6IDAgPT0gUy5sZW5ndGggPyBlLmFsdGVybmF0aXZlID0gbnVsbCA6IGUuYWx0ZXJuYXRpdmUgPSBrZShBU1RfU2ltcGxlU3RhdGVtZW50LCBlLmFsdGVybmF0aXZlLCB7IGJvZHk6IHdlKGUuYWx0ZXJuYXRpdmUsIFMpIH0pLCBfLmZvckVhY2goWCkpLCAwIDwgZC5sZW5ndGggJiYgcC5wdXNoKGtlKEFTVF9WYXIsIGUsIHsgZGVmaW5pdGlvbnM6IGQgfSkpLCAwIDwgcC5sZW5ndGgpIHJldHVybiBwLnB1c2goZS50cmFuc2Zvcm0oYykpLCBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGUsIHsgYm9keTogcCB9KS5vcHRpbWl6ZShjKTt9IGVsc2UgaWYgKGYgJiYgUykgcmV0dXJuIHAgPSBvLmNvbmNhdChsKSwgKDAgPCBhLmxlbmd0aCB8fCAwIDwgdS5sZW5ndGgpICYmIHAucHVzaChrZShBU1RfVmFyLCBlLCB7IGRlZmluaXRpb25zOiBhLmNvbmNhdCh1KSB9KSksIDAgPT0gZi5sZW5ndGggPyBwLnB1c2goa2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgZS5jb25kaXRpb24sIHsgYm9keTogMCA8IFMubGVuZ3RoID8ga2UoQVNUX0JpbmFyeSwgZSwgeyBvcGVyYXRvcjogInx8IiwgbGVmdDogZS5jb25kaXRpb24sIHJpZ2h0OiB3ZShlLmFsdGVybmF0aXZlLCBTKSB9KS50cmFuc2Zvcm0oYykgOiBlLmNvbmRpdGlvbi5jbG9uZSgpIH0pLm9wdGltaXplKGMpKSA6IDAgPT0gUy5sZW5ndGggPyAodCA9PT0gaSAmJiAhciAmJiBlLmNvbmRpdGlvbiBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgInx8IiA9PSBlLmNvbmRpdGlvbi5vcGVyYXRvciAmJiAociA9ICEwKSwgcC5wdXNoKGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUsIHsgYm9keToga2UoQVNUX0JpbmFyeSwgZSwgeyBvcGVyYXRvcjogciA/ICJ8fCIgOiAiJiYiLCBsZWZ0OiByID8gbiA6IGUuY29uZGl0aW9uLCByaWdodDogd2UoZS5ib2R5LCBmKSB9KS50cmFuc2Zvcm0oYykgfSkub3B0aW1pemUoYykpKSA6IHAucHVzaChrZShBU1RfU2ltcGxlU3RhdGVtZW50LCBlLCB7IGJvZHk6IGtlKEFTVF9Db25kaXRpb25hbCwgZSwgeyBjb25kaXRpb246IGUuY29uZGl0aW9uLCBjb25zZXF1ZW50OiB3ZShlLmJvZHksIGYpLCBhbHRlcm5hdGl2ZTogd2UoZS5hbHRlcm5hdGl2ZSwgUykgfSkgfSkub3B0aW1pemUoYykpLCBzLmZvckVhY2goWCksIF8uZm9yRWFjaChYKSwga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBlLCB7IGJvZHk6IHAgfSkub3B0aW1pemUoYyk7aWYgKChlID0gZWUoZS5ib2R5KSA/IGtlKEFTVF9JZiwgZSwgeyBjb25kaXRpb246IG4sIGJvZHk6IGUuYWx0ZXJuYXRpdmUsIGFsdGVybmF0aXZlOiBudWxsIH0pIDogZSkuYWx0ZXJuYXRpdmUgaW5zdGFuY2VvZiBBU1RfRXhpdCAmJiBlLmJvZHkuVFlQRSA9PSBlLmFsdGVybmF0aXZlLlRZUEUpIHtkID0gZS5ib2R5LnZhbHVlLCBvID0gZS5hbHRlcm5hdGl2ZS52YWx1ZTtpZiAoIWQgJiYgIW8pIHJldHVybiBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGUsIHsgYm9keTogW2tlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUsIHsgYm9keTogZS5jb25kaXRpb24gfSksIGUuYm9keV0gfSkub3B0aW1pemUoYyk7aWYgKGQgJiYgbyB8fCAhZnVuY3Rpb24gKCkge3ZhciBlID0gITEsbiA9IDAsdCA9IGMuc2VsZigpO2RvIHtpZiAodCBpbnN0YW5jZW9mIEFTVF9DYXRjaCkgYy5wYXJlbnQobikuYmZpbmFsbHkgJiYgKGUgPSAhMCksIG4rKztlbHNlIGlmICh0IGluc3RhbmNlb2YgQVNUX0ZpbmFsbHkpIG4rKztlbHNlIHtpZiAodCBpbnN0YW5jZW9mIEFTVF9TY29wZSkgcmV0dXJuIGUgJiYgQih0KTt0IGluc3RhbmNlb2YgQVNUX1RyeSAmJiB0LmJmaW5hbGx5ICYmIChlID0gITApO319IHdoaWxlICh0ID0gYy5wYXJlbnQobisrKSk7fSgpKSByZXR1cm4gKGwgPSBrZShlLmJvZHkuQ1RPUiwgZSwgeyB2YWx1ZToga2UoQVNUX0NvbmRpdGlvbmFsLCBlLCB7IGNvbmRpdGlvbjogZS5jb25kaXRpb24sIGNvbnNlcXVlbnQ6IGQgfHwga2UoQVNUX1VuZGVmaW5lZCwgZS5ib2R5KS50cmFuc2Zvcm0oYyksIGFsdGVybmF0aXZlOiBvIHx8IGtlKEFTVF9VbmRlZmluZWQsIGUuYWx0ZXJuYXRpdmUpLnRyYW5zZm9ybShjKSB9KSB9KSkgaW5zdGFuY2VvZiBBU1RfUmV0dXJuICYmIChsLmluX2Jvb2wgPSBlLmJvZHkuaW5fYm9vbCB8fCBlLmFsdGVybmF0aXZlLmluX2Jvb2wpLCBsO31pZiAocSgoZSA9IGUuYm9keSBpbnN0YW5jZW9mIEFTVF9JZiAmJiAhZS5ib2R5LmFsdGVybmF0aXZlICYmICFlLmFsdGVybmF0aXZlID8ga2UoQVNUX0lmLCBlLCB7IGNvbmRpdGlvbjoga2UoQVNUX0JpbmFyeSwgZS5jb25kaXRpb24sIHsgb3BlcmF0b3I6ICImJiIsIGxlZnQ6IGUuY29uZGl0aW9uLCByaWdodDogZS5ib2R5LmNvbmRpdGlvbiB9KSwgYm9keTogZS5ib2R5LmJvZHksIGFsdGVybmF0aXZlOiBudWxsIH0pIDogZSkuYm9keSkgJiYgZS5hbHRlcm5hdGl2ZSkgcmV0dXJuIGEgPSBlLmFsdGVybmF0aXZlLCBlLmFsdGVybmF0aXZlID0gbnVsbCwga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBlLCB7IGJvZHk6IFtlLCBhXSB9KS5vcHRpbWl6ZShjKTtpZiAocShlLmFsdGVybmF0aXZlKSkgcmV0dXJuIHAgPSBlLmJvZHksIGUuYm9keSA9IGUuYWx0ZXJuYXRpdmUsIGUuY29uZGl0aW9uID0gciA/IG4gOiBlLmNvbmRpdGlvbi5uZWdhdGUoYyksIGUuYWx0ZXJuYXRpdmUgPSBudWxsLCBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGUsIHsgYm9keTogW2UsIHBdIH0pLm9wdGltaXplKGMpO2lmIChlLmFsdGVybmF0aXZlKSB7Zm9yICh2YXIgQSA9IGsoZS5ib2R5KSwgVCA9IHcoQSksIGggPSBrKGUuYWx0ZXJuYXRpdmUpLCBtID0gdyhoKSwgdiA9IFtdOyAwIDw9IFQgJiYgMCA8PSBtOykge3ZhciB5ID0gQVtUXSxnID0gaFttXTtpZiAoeS5lcXVhbHMoZykpIEEuc3BsaWNlKFQtLSwgMSksIGguc3BsaWNlKG0tLSwgMSksIHYudW5zaGlmdChQKHksIGcpKTtlbHNlIHtpZiAoISh5IGluc3RhbmNlb2YgQVNUX1NpbXBsZVN0YXRlbWVudCkpIGJyZWFrO2lmICghKGcgaW5zdGFuY2VvZiBBU1RfU2ltcGxlU3RhdGVtZW50KSkgYnJlYWs7dmFyIGIgPSB5LmJvZHkudGFpbF9ub2RlKCkseCA9IGcuYm9keS50YWlsX25vZGUoKTtpZiAoIWIuZXF1YWxzKHgpKSBicmVhaztUID0gRChBLCB5LmJvZHksIFQpLCBtID0gRChoLCBnLmJvZHksIG0pLCB2LnVuc2hpZnQoa2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgYiwgeyBib2R5OiBQKGIsIHgpIH0pKTt9fWlmICgwIDwgdi5sZW5ndGgpIHJldHVybiBlLmJvZHkgPSAwIDwgQS5sZW5ndGggPyBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGUsIHsgYm9keTogQSB9KSA6IGtlKEFTVF9FbXB0eVN0YXRlbWVudCwgZSksIGUuYWx0ZXJuYXRpdmUgPSAwIDwgaC5sZW5ndGggPyBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGUsIHsgYm9keTogaCB9KSA6IG51bGwsIHYudW5zaGlmdChlKSwga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBlLCB7IGJvZHk6IHYgfSkub3B0aW1pemUoYyk7fWMub3B0aW9uKCJ0eXBlb2ZzIikgJiYgeihlLmNvbmRpdGlvbiwgZS5ib2R5LCBlLmFsdGVybmF0aXZlKTt9cmV0dXJuIGU7ZnVuY3Rpb24gayhlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfQmxvY2tTdGF0ZW1lbnQgPyBlLmJvZHkgOiBbZV07fWZ1bmN0aW9uIHcoZSkge2ZvciAodmFyIG4gPSBlLmxlbmd0aDsgMCA8PSAtLW4gJiYgRihlW25dLCAhMCk7KTtyZXR1cm4gbjt9ZnVuY3Rpb24gRChlLCBuLCB0KSB7cmV0dXJuIG4gaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgPyBlW3RdID0ga2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgbiwgeyBib2R5OiB3ZShuLCBuLmV4cHJlc3Npb25zLnNsaWNlKDAsIC0xKSkgfSkgOiBlLnNwbGljZSh0LS0sIDEpLCB0O31mdW5jdGlvbiBFKGUsIG4sIHQsIGkpIHtpZiAobnVsbCA9PSBlKSByZXR1cm4gW107aWYgKGUgaW5zdGFuY2VvZiBBU1RfQmxvY2tTdGF0ZW1lbnQpIHtmb3IgKHZhciByID0gW10sIG8gPSAwOyBvIDwgZS5ib2R5Lmxlbmd0aDsgbysrKSB7dmFyIGEgPSBlLmJvZHlbb107aWYgKCEoYSBpbnN0YW5jZW9mIEFTVF9FbXB0eVN0YXRlbWVudCkpIHtpZiAoYSBpbnN0YW5jZW9mIEFTVF9FeGl0KSB7aWYgKDAgPT0gbykgcmV0dXJuOzAgPCByLmxlbmd0aCAmJiAoYSA9IGEuY2xvbmUoKSwgci5wdXNoKGEudmFsdWUgfHwga2UoQVNUX1VuZGVmaW5lZCwgYSkudHJhbnNmb3JtKGMpKSwgYS52YWx1ZSA9IHdlKGUsIHIpKTt2YXIgcyA9IGUuY2xvbmUoKTtyZXR1cm4gcy5ib2R5ID0gcy5ib2R5LnNsaWNlKG8gKyAxKSwgcy5ib2R5LnVuc2hpZnQoYSksIHM7fWlmIChhIGluc3RhbmNlb2YgQVNUX0xhbWJkYURlZmluaXRpb24pIG4ucHVzaChhKTtlbHNlIGlmIChhIGluc3RhbmNlb2YgQVNUX1NpbXBsZVN0YXRlbWVudCkge2lmICghYy5vcHRpb24oInNlcXVlbmNlcyIpICYmIDAgPCByLmxlbmd0aCkgcmV0dXJuO3IucHVzaChhLmJvZHkpO30gZWxzZSB7aWYgKCEoYSBpbnN0YW5jZW9mIEFTVF9WYXIpKSByZXR1cm47aWYgKCFjLm9wdGlvbigic2VxdWVuY2VzIikgJiYgMCA8IHIubGVuZ3RoKSByZXR1cm47YS5yZW1vdmVfaW5pdGlhbGl6ZXJzKGMsIHQpLCBhLmRlZmluaXRpb25zLmZvckVhY2goZik7fX19cmV0dXJuIHI7fXJldHVybiBlIGluc3RhbmNlb2YgQVNUX0xhbWJkYURlZmluaXRpb24gPyAobi5wdXNoKGUpLCBbXSkgOiBlIGluc3RhbmNlb2YgQVNUX0VtcHR5U3RhdGVtZW50ID8gW10gOiBlIGluc3RhbmNlb2YgQVNUX1NpbXBsZVN0YXRlbWVudCA/IFtlLmJvZHldIDogZSBpbnN0YW5jZW9mIEFTVF9WYXIgPyAociA9IFtdLCBlLnJlbW92ZV9pbml0aWFsaXplcnMoYywgdCksIGUuZGVmaW5pdGlvbnMuZm9yRWFjaChmKSwgcikgOiB2b2lkIDA7ZnVuY3Rpb24gZihlKSB7ZS52YWx1ZSAmJiByLnB1c2goa2UoQVNUX0Fzc2lnbiwgZSwgeyBvcGVyYXRvcjogIj0iLCBsZWZ0OiBlLm5hbWUuY29udmVydF9zeW1ib2woQVNUX1N5bWJvbFJlZiwgZnVuY3Rpb24gKGUpIHtpLnB1c2goZSk7fSksIHJpZ2h0OiBlLnZhbHVlIH0pKTt9fX0pLCBlKEFTVF9Td2l0Y2gsIGZ1bmN0aW9uIChpLCB0KSB7aWYgKHQub3B0aW9uKCJzd2l0Y2hlcyIpICYmIHQub3B0aW9uKCJkZWFkX2NvZGUiKSkge2ZvciAodmFyIGUsIG4sIHIsIG8gPSBbXSwgYSA9IFtdLCBzID0gW10sIGYgPSAwLCBjID0gaS5ib2R5Lmxlbmd0aDsgZiA8IGM7IGYrKykge2lmICgoZSA9IGkuYm9keVtmXSkgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdCkge3ZhciBsID0gb1tvLmxlbmd0aCAtIDFdO2lmIChuIHx8IHYoZS5ib2R5WzBdLCB0KSAmJiAoIWwgfHwgcShsKSkpIHtnKGUsIGwpO2NvbnRpbnVlO31uID0gZTt9IGVsc2Uge3ZhciB1ID0gZS5leHByZXNzaW9uLF8gPSBrZShBU1RfQmluYXJ5LCBpLCB7IG9wZXJhdG9yOiAiPT09IiwgbGVmdDogaS5leHByZXNzaW9uLCByaWdodDogdSB9KS5ldmFsdWF0ZSh0LCAhMCk7aWYgKCFfKSB7dS5oYXNfc2lkZV9lZmZlY3RzKHQpICYmIHMucHVzaCh1KSwgZyhlLCBvW28ubGVuZ3RoIC0gMV0pO2NvbnRpbnVlO31pZiAoIShfIGluc3RhbmNlb2YgQVNUX05vZGUpKSBmb3IgKG4gJiYgKF8gPSBvLmluZGV4T2YobiksIG8uc3BsaWNlKF8sIDEpLCBnKG4sIG9bXyAtIDFdKSwgbiA9IG51bGwpLCB1Lmhhc19zaWRlX2VmZmVjdHModCkgPyByID0gZSA6IG4gPSBlID0ga2UoQVNUX0RlZmF1bHQsIGUpOyArK2YgPCBjOykgZyhpLmJvZHlbZl0sIGUpO31pZiAoYyA8PSBmICsgMSB8fCBxKGUpKSB7dmFyIFMsbCA9IG9bby5sZW5ndGggLSAxXSxwID0gZS5ib2R5O2lmIChxKGwpKSBzd2l0Y2ggKGwuYm9keS5sZW5ndGggLSBwLmxlbmd0aCkge2Nhc2UgMTppZiAoIXYoUyA9IGwuYm9keVtsLmJvZHkubGVuZ3RoIC0gMV0sIHQpKSBicmVhaztwID0gcC5jb25jYXQoUyk7Y2FzZSAwOnZhciBkID0ga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBsKSxBID0ga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBlLCB7IGJvZHk6IHAgfSk7ZC5lcXVhbHMoQSkgJiYgKGwuYm9keSA9IFtdKTt9fXMubGVuZ3RoICYmIChlIGluc3RhbmNlb2YgQVNUX0RlZmF1bHQgPyBvLnB1c2goa2UoQVNUX0Nhc2UsIGksIHsgZXhwcmVzc2lvbjogd2UoaSwgcyksIGJvZHk6IFtdIH0pKSA6IChzLnB1c2goZS5leHByZXNzaW9uKSwgZS5leHByZXNzaW9uID0gd2UoaSwgcykpLCBzID0gW10pLCBvLnB1c2goZSk7fWZvciAocy5sZW5ndGggJiYgIXIgJiYgby5wdXNoKGtlKEFTVF9DYXNlLCBpLCB7IGV4cHJlc3Npb246IHdlKGksIHMpLCBib2R5OiBbXSB9KSk7IGUgPSBvW28ubGVuZ3RoIC0gMV07KSB7aWYgKHYoUyA9IGUuYm9keVtlLmJvZHkubGVuZ3RoIC0gMV0sIHQpICYmIGUuYm9keS5wb3AoKSwgZSA9PT0gbikge2lmICghZmUoZSkpIGJyZWFrO30gZWxzZSB7aWYgKGUuZXhwcmVzc2lvbi5oYXNfc2lkZV9lZmZlY3RzKHQpKSBicmVhaztpZiAobikge2lmICghZmUobikpIGJyZWFrO2lmIChvW28ubGVuZ3RoIC0gMl0gIT09IG4pIGJyZWFrO24uYm9keSA9IG4uYm9keS5jb25jYXQoZS5ib2R5KSwgZS5ib2R5ID0gW107fSBlbHNlIGlmICghZmUoZSkpIGJyZWFrO31nKGUpLCBvLnBvcCgpID09PSBuICYmIChuID0gbnVsbCk7fWlmICghZSkgcmV0dXJuIGEucHVzaChrZShBU1RfU2ltcGxlU3RhdGVtZW50LCBpLmV4cHJlc3Npb24sIHsgYm9keTogaS5leHByZXNzaW9uIH0pKSwgcy5sZW5ndGggJiYgYS5wdXNoKGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGksIHsgYm9keTogd2UoaSwgcykgfSkpLCBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGksIHsgYm9keTogYSB9KS5vcHRpbWl6ZSh0KTtpZiAoZSA9PT0gbikgZm9yICg7IChlID0gb1tvLmxlbmd0aCAtIDJdKSAmJiAhKGUgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdCkgJiYgZmUoZSk7KSB7aWYgKCh1ID0gZS5leHByZXNzaW9uKS5oYXNfc2lkZV9lZmZlY3RzKHQpKSB7aWYgKChsID0gb1tvLmxlbmd0aCAtIDNdKSAmJiAhcShsKSkgYnJlYWs7bi5ib2R5LnVuc2hpZnQoa2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgaSwgeyBib2R5OiB1IH0pKTt9ZyhlKSwgby5zcGxpY2UoLTIsIDEpO31pZiAob1swXS5ib2R5ID0gYS5jb25jYXQob1swXS5ib2R5KSwgaS5ib2R5ID0gbywgdC5vcHRpb24oImNvbmRpdGlvbmFscyIpKSBzd2l0Y2ggKG8ubGVuZ3RoKSB7Y2FzZSAxOmlmICh5KG9bMF0pKSByZXR1cm4gdSA9IG9bMF0uZXhwcmVzc2lvbiwgcCA9IG9bMF0uYm9keS5zbGljZSgpLCAob1swXSAhPT0gbiAmJiBvWzBdICE9PSByID8ga2UoQVNUX0lmLCBpLCB7IGNvbmRpdGlvbjoga2UoQVNUX0JpbmFyeSwgaSwgeyBvcGVyYXRvcjogIj09PSIsIGxlZnQ6IGkuZXhwcmVzc2lvbiwgcmlnaHQ6IHUgfSksIGJvZHk6IGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgaSwgeyBib2R5OiBwIH0pLCBhbHRlcm5hdGl2ZTogbnVsbCB9KSA6ICh1ICYmIHAudW5zaGlmdChrZShBU1RfU2ltcGxlU3RhdGVtZW50LCB1LCB7IGJvZHk6IHUgfSkpLCBwLnVuc2hpZnQoa2UoQVNUX1NpbXBsZVN0YXRlbWVudCwgaS5leHByZXNzaW9uLCB7IGJvZHk6IGkuZXhwcmVzc2lvbiB9KSksIGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgaSwgeyBib2R5OiBwIH0pKSkub3B0aW1pemUodCk7YnJlYWs7Y2FzZSAyOmlmIChtZW1iZXIobiwgbykgJiYgeShvWzFdKSkge3ZhciBULGgsbSA9IChwID0gb1swXS5ib2R5LnNsaWNlKCkpLmxlbmd0aCAmJiB2KHBbcC5sZW5ndGggLSAxXSwgdCk7aWYgKG0gJiYgcC5wb3AoKSwgYWxsKHAsIHkpKSByZXR1cm4gVCA9IG9bMV0uYm9keS5sZW5ndGggJiYga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBvWzFdKSwgaCA9IGtlKEFTVF9JZiwgaSwgeyBjb25kaXRpb246IGtlKEFTVF9CaW5hcnksIGksIG9bMF0gPT09IG4gPyB7IG9wZXJhdG9yOiAiIT09IiwgbGVmdDogaS5leHByZXNzaW9uLCByaWdodDogb1sxXS5leHByZXNzaW9uIH0gOiB7IG9wZXJhdG9yOiAiPT09IiwgbGVmdDogaS5leHByZXNzaW9uLCByaWdodDogb1swXS5leHByZXNzaW9uIH0pLCBib2R5OiBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIG9bMF0sIHsgYm9keTogcCB9KSwgYWx0ZXJuYXRpdmU6IG0gJiYgVCB8fCBudWxsIH0pLCAoaCA9ICFtICYmIFQgPyBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGksIHsgYm9keTogW2gsIFRdIH0pIDogaCkub3B0aW1pemUodCk7fX19cmV0dXJuIGk7ZnVuY3Rpb24gdihlLCBuKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfQnJlYWsgJiYgbi5sb29wY29udHJvbF90YXJnZXQoZSkgPT09IGk7fWZ1bmN0aW9uIHkoZSkge3ZhciBuID0gITEsdCA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7aWYgKG4gfHwgZSBpbnN0YW5jZW9mIEFTVF9MYW1iZGEgfHwgZSBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQpIHJldHVybiAhMDt2KGUsIHQpICYmIChuID0gITApO30pO3JldHVybiB0LnB1c2goaSksIGUud2Fsayh0KSwgIW47fWZ1bmN0aW9uIGcoZSwgbikge24gJiYgIXEobikgPyBuLmJvZHkgPSBuLmJvZHkuY29uY2F0KGUuYm9keSkgOiBDKHQsIGUsIGEpO319KSwgZShBU1RfVHJ5LCBmdW5jdGlvbiAoZSwgbikge2lmIChlLmJvZHkgPSBtZShlLmJvZHksIG4pLCBuLm9wdGlvbigiZGVhZF9jb2RlIikpIHtpZiAoZmUoZSkgJiYgIShlLmJjYXRjaCAmJiBlLmJjYXRjaC5hcmduYW1lICYmIGUuYmNhdGNoLmFyZ25hbWUubWF0Y2hfc3ltYm9sKGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sQ2F0Y2ggJiYgIWJlKGUpO30sICEwKSkpIHJldHVybiB0ID0gW10sIGUuYmNhdGNoICYmIChDKG4sIGUuYmNhdGNoLCB0KSwgdC5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZSBpbnN0YW5jZW9mIEFTVF9WYXIgJiYgZS5kZWZpbml0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7dmFyIG4gPSBlLm5hbWUuZGVmaW5pdGlvbigpLnJlZGVmaW5lZCgpO24gJiYgKGUubmFtZSA9IGUubmFtZS5jbG9uZSgpLCBlLm5hbWUudGhlZGVmID0gbik7fSk7fSkpLCB0LnVuc2hpZnQoa2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBlKS5vcHRpbWl6ZShuKSksIGUuYmZpbmFsbHkgJiYgdC5wdXNoKGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgZS5iZmluYWxseSkub3B0aW1pemUobikpLCBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIGUsIHsgYm9keTogdCB9KS5vcHRpbWl6ZShuKTtpZiAoZS5iZmluYWxseSAmJiBmZShlLmJmaW5hbGx5KSkge3ZhciB0ID0ga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBlLmJmaW5hbGx5KS5vcHRpbWl6ZShuKTtpZiAodCA9IGUuYm9keS5jb25jYXQodCksICFlLmJjYXRjaCkgcmV0dXJuIGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgZSwgeyBib2R5OiB0IH0pLm9wdGltaXplKG4pO2UuYm9keSA9IHQsIGUuYmZpbmFsbHkgPSBudWxsO319cmV0dXJuIGU7fSksIEFTVF9Db25zdC5ERUZNRVRIT0QoInJlbW92ZV9pbml0aWFsaXplcnMiLCBSbihmdW5jdGlvbiAoZSwgbikge3JldHVybiBrZShBU1RfVW5kZWZpbmVkLCBuKS5vcHRpbWl6ZShlKTt9KSksIEFTVF9MZXQuREVGTUVUSE9EKCJyZW1vdmVfaW5pdGlhbGl6ZXJzIiwgUm4ocmV0dXJuX251bGwpKSwgQVNUX1Zhci5ERUZNRVRIT0QoInJlbW92ZV9pbml0aWFsaXplcnMiLCBSbihyZXR1cm5fbnVsbCkpLCBBU1RfRGVmaW5pdGlvbnMuREVGTUVUSE9EKCJ0b19hc3NpZ25tZW50cyIsIGZ1bmN0aW9uICgpIHt2YXIgZSA9IHRoaXMuZGVmaW5pdGlvbnMucmVkdWNlKGZ1bmN0aW9uIChlLCB0KSB7dmFyIG4saSxyLG8gPSB0Lm5hbWUuZGVmaW5pdGlvbigpLGEgPSB0LnZhbHVlO3JldHVybiBhICYmIChhIGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlICYmIChhID0gYS5jbG9uZSgpKSwgbiA9IGtlKEFTVF9TeW1ib2xSZWYsIHQubmFtZSksIGkgPSBrZShBU1RfQXNzaWduLCB0LCB7IG9wZXJhdG9yOiAiPSIsIGxlZnQ6IG4sIHJpZ2h0OiBhIH0pLCBlLnB1c2goaSksIChyID0gZnVuY3Rpb24gcigpIHtyZXR1cm4gaS5yaWdodDt9KS5hc3NpZ25zID0gW2ldLCByLmRpcmVjdF9hY2Nlc3MgPSBvLmRpcmVjdF9hY2Nlc3MsIHIuZXNjYXBlZCA9IG8uZXNjYXBlZCwgbi5maXhlZCA9IHIsIG8ucmVmZXJlbmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7dmFyIG47ZS5maXhlZCAmJiAobiA9IGUuZml4ZWQuYXNzaWducykgJiYgblswXSA9PT0gdCAmJiAoMSA8IG4ubGVuZ3RoIHx8IGUuZml4ZWQudG9fYmluYXJ5IHx8IGUuZml4ZWQudG9fcHJlZml4ID8gblswXSA9IGkgOiAoZS5maXhlZCA9IHIsIG8uZml4ZWQgPT09IGUuZml4ZWQgJiYgKG8uZml4ZWQgPSByKSkpO30pLCBvLnJlZmVyZW5jZXMucHVzaChuKSwgby5hc3NpZ25tZW50cysrKSwgby5lbGltaW5hdGVkKyssIGU7fSwgW10pO3JldHVybiAwID09IGUubGVuZ3RoID8gbnVsbCA6IHdlKHRoaXMsIGUpO30pLCAobiA9IGZ1bmN0aW9uIG4oZSwgX24xOCkge2UuREVGTUVUSE9EKCJjYW5fbGV0aWZ5IiwgX24xOCk7fSkoQVNUX05vZGUsIHJldHVybl9mYWxzZSksIG4oQVNUX0NvbnN0LCBmdW5jdGlvbiAoZSwgbikge24gPSBuID8gMSA6IDA7dmFyIHQgPSB0aGlzLmRlZmluaXRpb25zO3JldHVybiAhKCFlLm9wdGlvbigibW9kdWxlIikgJiYgYWxsKHQsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUubmFtZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xDb25zdDt9KSkgJiYgYWxsKHQsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICFlLm5hbWUubWF0Y2hfc3ltYm9sKGZ1bmN0aW9uIChlKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRGVjbGFyYXRpb24pIHJldHVybiBlLmRlZmluaXRpb24oKS5hc3NpZ25tZW50cyAhPSBuO30sICEwKTt9KTt9KSwgbihBU1RfVmFyLCBmdW5jdGlvbiAoaSkge3JldHVybiBhbGwodGhpcy5kZWZpbml0aW9ucywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIWUubmFtZS5tYXRjaF9zeW1ib2woZnVuY3Rpb24gKGUpIHt2YXIgbiwgdDtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiAmJiAoKG4gPSBlLmRlZmluaXRpb24oKSkuZmlyc3RfZGVjbCAhPT0gZSB8fCAhcW4oaSwgZSkgfHwgISgodCA9IGUuc2NvcGUpIGluc3RhbmNlb2YgQVNUX1Njb3BlIHx8IGFsbChuLnJlZmVyZW5jZXMsIGZ1bmN0aW9uIChlKSB7dmFyIG4gPSBlLnNjb3BlO2RvIHtpZiAobiA9PT0gdCkgcmV0dXJuICEwO30gd2hpbGUgKG4gPSBuLnBhcmVudF9zY29wZSk7cmV0dXJuICExO30pKSk7fSwgITApO30pO30pLCBBU1RfRGVmaW5pdGlvbnMuREVGTUVUSE9EKCJjYW5fdmFyaWZ5IiwgZnVuY3Rpb24gKG4pIHtyZXR1cm4gYWxsKHRoaXMuZGVmaW5pdGlvbnMsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICFlLm5hbWUubWF0Y2hfc3ltYm9sKGZ1bmN0aW9uIChlKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRGVjbGFyYXRpb24pIHJldHVybiAhcW4obiwgZSk7fSwgITApO30pO30pLCBlKEFTVF9Db25zdCwgZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gbi5vcHRpb24oInZhcmlmeSIpID8gZS5jYW5fdmFyaWZ5KG4pID8gRm4oZSwgbi5maW5kX3BhcmVudChBU1RfU2NvcGUpKSA6IGUuY2FuX2xldGlmeShuKSA/IFBuKGUsIHhlKG4pKSA6IGUgOiBlO30pLCBlKEFTVF9MZXQsIGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuIG4ub3B0aW9uKCJ2YXJpZnkiKSAmJiBlLmNhbl92YXJpZnkobikgPyBGbihlLCBuLmZpbmRfcGFyZW50KEFTVF9TY29wZSkpIDogZTt9KSwgZShBU1RfQ2FsbCwgZnVuY3Rpb24gKF8sIGMpIHt2YXIgbyA9IF8uZXhwcmVzc2lvbixlID0gem4oXywgYyk7aWYgKGUpIHJldHVybiBlO2lmIChjLm9wdGlvbigic2VxdWVuY2VzIikpIGlmIChvIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpIHtpZiAoKG0gPSBHKG8pKSAhPT0gbykgcmV0dXJuICh2ID0gXy5jbG9uZSgpKS5leHByZXNzaW9uID0gbS5leHByZXNzaW9ucy5wb3AoKSwgbS5leHByZXNzaW9ucy5wdXNoKHYpLCBtLm9wdGltaXplKGMpO30gZWxzZSBpZiAoIWllKG8udGFpbF9ub2RlKCkpKSBpZiAoKG0gPSBHKF8pKSAhPT0gXykgcmV0dXJuIG0ub3B0aW1pemUoYyk7aWYgKGMub3B0aW9uKCJ1bnVzZWQiKSAmJiBVbihfLCBjKSwgYy5vcHRpb24oInVuc2FmZSIpKSBpZiAoRWUobykpIHN3aXRjaCAoby5uYW1lKSB7Y2FzZSAiQXJyYXkiOmlmICgxID09IF8uYXJncy5sZW5ndGgpIHtpZiAoKHMgPSBfLmFyZ3NbMF0pIGluc3RhbmNlb2YgQVNUX051bWJlcikgdHJ5IHt2YXIgbiA9IHMudmFsdWU7aWYgKDYgPCBuKSBicmVhaztmb3IgKHZhciB0ID0gQXJyYXkobiksIGkgPSAwOyBpIDwgbjsgaSsrKSB0W2ldID0ga2UoQVNUX0hvbGUsIF8pO3JldHVybiBrZShBU1RfQXJyYXksIF8sIHsgZWxlbWVudHM6IHQgfSk7fSBjYXRjaCAoZSkge0FTVF9Ob2RlLndhcm4oIkludmFsaWQgYXJyYXkgbGVuZ3RoOiB7bGVuZ3RofSBbe3N0YXJ0fV0iLCB7IGxlbmd0aDogbiwgc3RhcnQ6IF8uc3RhcnQgfSk7YnJlYWs7fWlmICghcy5pc19ib29sZWFuKGMpICYmICFzLmlzX3N0cmluZyhjKSkgYnJlYWs7fXJldHVybiBrZShBU1RfQXJyYXksIF8sIHsgZWxlbWVudHM6IF8uYXJncyB9KTtjYXNlICJPYmplY3QiOmlmICgwID09IF8uYXJncy5sZW5ndGgpIHJldHVybiBrZShBU1RfT2JqZWN0LCBfLCB7IHByb3BlcnRpZXM6IFtdIH0pO2JyZWFrO2Nhc2UgIlN0cmluZyI6aWYgKDAgPT0gXy5hcmdzLmxlbmd0aCkgcmV0dXJuIGtlKEFTVF9TdHJpbmcsIF8sIHsgdmFsdWU6ICIiIH0pO2lmICgxID09IF8uYXJncy5sZW5ndGgpIHJldHVybiBrZShBU1RfQmluYXJ5LCBfLCB7IG9wZXJhdG9yOiAiKyIsIGxlZnQ6IGtlKEFTVF9TdHJpbmcsIF8sIHsgdmFsdWU6ICIiIH0pLCByaWdodDogXy5hcmdzWzBdIH0pLm9wdGltaXplKGMpO2JyZWFrO2Nhc2UgIk51bWJlciI6aWYgKDAgPT0gXy5hcmdzLmxlbmd0aCkgcmV0dXJuIGtlKEFTVF9OdW1iZXIsIF8sIHsgdmFsdWU6IDAgfSk7aWYgKDEgPT0gXy5hcmdzLmxlbmd0aCkgcmV0dXJuIGtlKEFTVF9VbmFyeVByZWZpeCwgXywgeyBvcGVyYXRvcjogIisiLCBleHByZXNzaW9uOiBrZShBU1RfQmluYXJ5LCBfLCB7IG9wZXJhdG9yOiAiKyIsIGxlZnQ6IGtlKEFTVF9TdHJpbmcsIF8sIHsgdmFsdWU6ICIiIH0pLCByaWdodDogXy5hcmdzWzBdIH0pIH0pLm9wdGltaXplKGMpO2JyZWFrO2Nhc2UgIkJvb2xlYW4iOmlmICgwID09IF8uYXJncy5sZW5ndGgpIHJldHVybiBrZShBU1RfRmFsc2UsIF8pLm9wdGltaXplKGMpO2lmICgxID09IF8uYXJncy5sZW5ndGgpIHJldHVybiBrZShBU1RfVW5hcnlQcmVmaXgsIF8sIHsgb3BlcmF0b3I6ICIhIiwgZXhwcmVzc2lvbjoga2UoQVNUX1VuYXJ5UHJlZml4LCBfLCB7IG9wZXJhdG9yOiAiISIsIGV4cHJlc3Npb246IF8uYXJnc1swXSB9KSB9KS5vcHRpbWl6ZShjKTticmVhaztjYXNlICJSZWdFeHAiOnZhciBxID0gW107aWYgKGFsbChfLmFyZ3MsIGZ1bmN0aW9uIChlKSB7dmFyIG4gPSBlLmV2YWx1YXRlKGMpO3JldHVybiBxLnVuc2hpZnQobiksIGUgIT09IG47fSkpIHRyeSB7cmV0dXJuIE1lKGMsIF8sIGtlKEFTVF9SZWdFeHAsIF8sIHsgdmFsdWU6IFJlZ0V4cC5hcHBseShSZWdFeHAsIHEpIH0pKTt9IGNhdGNoIChlKSB7QVNUX05vZGUud2FybigiRXJyb3IgY29udmVydGluZyB7dGhpc30gW3tzdGFydH1dIiwgXyk7fX0gZWxzZSBpZiAobyBpbnN0YW5jZW9mIEFTVF9Eb3QpIHN3aXRjaCAoby5wcm9wZXJ0eSkge2Nhc2UgInRvU3RyaW5nIjp2YXIgciA9IG8uZXhwcmVzc2lvbjtpZiAoMCAhPSBfLmFyZ3MubGVuZ3RoIHx8IHIubWF5X3Rocm93X29uX2FjY2VzcyhjKSB8fCByIGluc3RhbmNlb2YgQVNUX1N1cGVyKSBicmVhaztyZXR1cm4ga2UoQVNUX0JpbmFyeSwgXywgeyBvcGVyYXRvcjogIisiLCBsZWZ0OiBrZShBU1RfU3RyaW5nLCBfLCB7IHZhbHVlOiAiIiB9KSwgcmlnaHQ6IHIgfSkub3B0aW1pemUoYyk7Y2FzZSAiam9pbiI6aWYgKG8uZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9BcnJheSAmJiBfLmFyZ3MubGVuZ3RoIDwgMikgZToge3ZhciBhID0gXy5hcmdzWzBdO2lmICgwID09IG8uZXhwcmVzc2lvbi5lbGVtZW50cy5sZW5ndGggJiYgIShhIGluc3RhbmNlb2YgQVNUX1NwcmVhZCkpIHJldHVybiBhID8gd2UoXywgW2EsIGtlKEFTVF9TdHJpbmcsIF8sIHsgdmFsdWU6ICIiIH0pXSkub3B0aW1pemUoYykgOiBrZShBU1RfU3RyaW5nLCBfLCB7IHZhbHVlOiAiIiB9KTtpZiAoIShhICYmIChhID0gYS5ldmFsdWF0ZShjKSkgaW5zdGFuY2VvZiBBU1RfTm9kZSkpIHtmb3IgKHZhciBzLCB0ID0gW10sIGYgPSBbXSwgaSA9IDA7IGkgPCBvLmV4cHJlc3Npb24uZWxlbWVudHMubGVuZ3RoOyBpKyspIHt2YXIgbCA9IG8uZXhwcmVzc2lvbi5lbGVtZW50c1tpXTtpZiAoKHggPSBsLmV2YWx1YXRlKGMpKSAhPT0gbCkgZi5wdXNoKHgpO2Vsc2Uge2lmIChsIGluc3RhbmNlb2YgQVNUX1NwcmVhZCkgYnJlYWsgZTswIDwgZi5sZW5ndGggJiYgKHQucHVzaChrZShBU1RfU3RyaW5nLCBfLCB7IHZhbHVlOiBmLmpvaW4oYSkgfSkpLCBmLmxlbmd0aCA9IDApLCB0LnB1c2gobCk7fX1yZXR1cm4gKDAgPCBmLmxlbmd0aCAmJiB0LnB1c2goa2UoQVNUX1N0cmluZywgXywgeyB2YWx1ZTogZi5qb2luKGEpIH0pKSwgMSA9PSB0Lmxlbmd0aCkgPyB0WzBdLmlzX3N0cmluZyhjKSA/IHRbMF0gOiBrZShBU1RfQmluYXJ5LCB0WzBdLCB7IG9wZXJhdG9yOiAiKyIsIGxlZnQ6IGtlKEFTVF9TdHJpbmcsIF8sIHsgdmFsdWU6ICIiIH0pLCByaWdodDogdFswXSB9KSA6ICIiID09IGEgPyAocyA9IHRbMF0uaXNfc3RyaW5nKGMpIHx8IHRbMV0uaXNfc3RyaW5nKGMpID8gdC5zaGlmdCgpIDoga2UoQVNUX1N0cmluZywgXywgeyB2YWx1ZTogIiIgfSksIHQucmVkdWNlKGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuIGtlKEFTVF9CaW5hcnksIG4sIHsgb3BlcmF0b3I6ICIrIiwgbGVmdDogZSwgcmlnaHQ6IG4gfSk7fSwgcykub3B0aW1pemUoYykpIDogKChCID0gXy5jbG9uZSgpKS5leHByZXNzaW9uID0gQi5leHByZXNzaW9uLmNsb25lKCksIEIuZXhwcmVzc2lvbi5leHByZXNzaW9uID0gQi5leHByZXNzaW9uLmV4cHJlc3Npb24uY2xvbmUoKSwgQi5leHByZXNzaW9uLmV4cHJlc3Npb24uZWxlbWVudHMgPSB0LCBNZShjLCBfLCBCKSk7fX1icmVhaztjYXNlICJjaGFyQXQiOmlmIChfLmFyZ3MubGVuZ3RoIDwgMikgcmV0dXJuIChCID0ga2UoQVNUX0JpbmFyeSwgXywgeyBvcGVyYXRvcjogInx8IiwgbGVmdDoga2UoQVNUX1N1YiwgXywgeyBleHByZXNzaW9uOiBvLmV4cHJlc3Npb24sIHByb3BlcnR5OiBfLmFyZ3MubGVuZ3RoID8ga2UoQVNUX0JpbmFyeSwgXy5hcmdzWzBdLCB7IG9wZXJhdG9yOiAifCIsIGxlZnQ6IGtlKEFTVF9OdW1iZXIsIF8sIHsgdmFsdWU6IDAgfSksIHJpZ2h0OiBfLmFyZ3NbMF0gfSkgOiBrZShBU1RfTnVtYmVyLCBfLCB7IHZhbHVlOiAwIH0pIH0pLm9wdGltaXplKGMpLCByaWdodDoga2UoQVNUX1N0cmluZywgXywgeyB2YWx1ZTogIiIgfSkgfSkpLmlzX3N0cmluZyA9IHJldHVybl90cnVlLCBCLm9wdGltaXplKGMpO2JyZWFrO2Nhc2UgImFwcGx5IjppZiAoMiA9PSBfLmFyZ3MubGVuZ3RoICYmIF8uYXJnc1sxXSBpbnN0YW5jZW9mIEFTVF9BcnJheSkgcmV0dXJuIChSID0gXy5hcmdzWzFdLmVsZW1lbnRzLnNsaWNlKCkpLnVuc2hpZnQoXy5hcmdzWzBdKSwga2UoQVNUX0NhbGwsIF8sIHsgZXhwcmVzc2lvbjoga2UoQVNUX0RvdCwgbywgeyBleHByZXNzaW9uOiBvLmV4cHJlc3Npb24sIHByb3BlcnR5OiAiY2FsbCIgfSksIGFyZ3M6IFIgfSkub3B0aW1pemUoYyk7YnJlYWs7Y2FzZSAiY2FsbCI6ciA9IG8uZXhwcmVzc2lvbjtpZiAoKHIgPSByIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IHIuZml4ZWRfdmFsdWUoKSA6IHIpIGluc3RhbmNlb2YgQVNUX0xhbWJkYSAmJiAhci5jb250YWluc190aGlzKCkpIHJldHVybiAoXy5hcmdzLmxlbmd0aCA/IHdlKF8sIFtfLmFyZ3NbMF0sIGtlKEFTVF9DYWxsLCBfLCB7IGV4cHJlc3Npb246IG8uZXhwcmVzc2lvbiwgYXJnczogXy5hcmdzLnNsaWNlKDEpIH0pXSkgOiBrZShBU1RfQ2FsbCwgXywgeyBleHByZXNzaW9uOiBvLmV4cHJlc3Npb24sIGFyZ3M6IFtdIH0pKS5vcHRpbWl6ZShjKTt9IGVsc2UgaWYgKGMub3B0aW9uKCJzaWRlX2VmZmVjdHMiKSAmJiBvIGluc3RhbmNlb2YgQVNUX0NhbGwgJiYgMSA9PSBvLmFyZ3MubGVuZ3RoICYmIEVlKG8uZXhwcmVzc2lvbikgJiYgIk9iamVjdCIgPT0gby5leHByZXNzaW9uLm5hbWUpIHJldHVybiAodiA9IF8uY2xvbmUoKSkuZXhwcmVzc2lvbiA9IERlKF8sIG8sIG8uYXJnc1swXSksIHYub3B0aW1pemUoYyk7aWYgKGMub3B0aW9uKCJ1bnNhZmVfRnVuY3Rpb24iKSAmJiBFZShvKSAmJiAiRnVuY3Rpb24iID09IG8ubmFtZSkge2lmICgwID09IF8uYXJncy5sZW5ndGgpIHJldHVybiBrZShBU1RfRnVuY3Rpb24sIF8sIHsgYXJnbmFtZXM6IFtdLCBib2R5OiBbXSB9KS5pbml0X3ZhcnMoby5zY29wZSk7aWYgKGFsbChfLmFyZ3MsIGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfU3RyaW5nO30pKSB0cnkge3ZhciB1LFMgPSAibihmdW5jdGlvbigiICsgXy5hcmdzLnNsaWNlKDAsIC0xKS5tYXAoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZS52YWx1ZTt9KS5qb2luKCkgKyAiKXsiICsgXy5hcmdzW18uYXJncy5sZW5ndGggLSAxXS52YWx1ZSArICJ9KSIscCA9IHBhcnNlKFMpLGQgPSB7IGllOiBjLm9wdGlvbigiaWUiKSB9LEEgPSAocC5maWd1cmVfb3V0X3Njb3BlKGQpLCBuZXcgQ29tcHJlc3NvcihjLm9wdGlvbnMpKSxTID0gKChwID0gcC50cmFuc2Zvcm0oQSkpLmZpZ3VyZV9vdXRfc2NvcGUoZCksIHAuY29tcHV0ZV9jaGFyX2ZyZXF1ZW5jeShkKSwgcC5tYW5nbGVfbmFtZXMoZCksIHAud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3JldHVybiAhIXUgfHwgKGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhID8gKHUgPSBlLCAhMCkgOiB2b2lkIDApO30pKSwgT3V0cHV0U3RyZWFtKCkpO3JldHVybiBBU1RfQmxvY2tTdGF0ZW1lbnQucHJvdG90eXBlLl9jb2RlZ2VuLmNhbGwodSwgUyksIF8uYXJncyA9IFtrZShBU1RfU3RyaW5nLCBfLCB7IHZhbHVlOiB1LmFyZ25hbWVzLm1hcChmdW5jdGlvbiAoZSkge3JldHVybiBlLnByaW50X3RvX3N0cmluZygpO30pLmpvaW4oKSB9KSwga2UoQVNUX1N0cmluZywgXy5hcmdzW18uYXJncy5sZW5ndGggLSAxXSwgeyB2YWx1ZTogUy5nZXQoKS5yZXBsYWNlKC9eXHt8XH0kL2csICIiKSB9KV0sIF87fSBjYXRjaCAoZSkge2lmICghKGUgaW5zdGFuY2VvZiBKU19QYXJzZV9FcnJvcikpIHRocm93IGU7QVNUX05vZGUud2FybigiRXJyb3IgcGFyc2luZyBjb2RlIHBhc3NlZCB0byBuZXcgRnVuY3Rpb24gW3tzdGFydH1dIiwgXy5hcmdzW18uYXJncy5sZW5ndGggLSAxXSksIEFTVF9Ob2RlLndhcm4oZS50b1N0cmluZygpKTt9fXZhciBUID0gbyBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyBvLmZpeGVkX3ZhbHVlKCkgOiBvLGUgPSBjLnBhcmVudCgpLGggPSBjLnNlbGYoKSxtID0gVCBpbnN0YW5jZW9mIEFTVF9MYW1iZGEgJiYgKCFpc19hc3luYyhUKSB8fCBjLm9wdGlvbigiYXdhaXRzIikgJiYgZSBpbnN0YW5jZW9mIEFTVF9Bd2FpdCkgJiYgKCFpc19nZW5lcmF0b3IoVCkgfHwgYy5vcHRpb24oInlpZWxkcyIpICYmIGggaW5zdGFuY2VvZiBBU1RfWWllbGQgJiYgaC5uZXN0ZWQpLHYgPSBtICYmIFQuZmlyc3Rfc3RhdGVtZW50KCkseSA9IDAsZyA9ICExLGIgPSAhYWxsKF8uYXJncywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX1NwcmVhZCk7fSksQSA9IG0gJiYgYWxsKFQuYXJnbmFtZXMsIGZ1bmN0aW9uIChlLCBuKSB7aWYgKDEgPT0geSAmJiBfLmFyZ3Nbbl0gaW5zdGFuY2VvZiBBU1RfU3ByZWFkICYmICh5ID0gMiksIGUgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdFZhbHVlKSB7aWYgKENlKDEgPT0gKHkgPSB5IHx8IDEpICYmIF8uYXJnc1tuXSkgfHwgKHkgPSAyKSwgY3QoVCwgZS52YWx1ZSkpIHJldHVybiAhMTtlID0gZS5uYW1lO31yZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCAmJiAoZyA9ICEwLCBjdChULCBlKSkpO30pICYmICEoVC5yZXN0IGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCAmJiBjdChULCBULnJlc3QpKSxkID0gQSAmJiBjLm9wdGlvbigiaW5saW5lIikgJiYgIV8uaXNfZXhwcl9wdXJlKGMpICYmIChvID09PSBUIHx8IFZuKFQsIGMpKTtpZiAoZCAmJiB2IGluc3RhbmNlb2YgQVNUX1JldHVybikge3ZhciB4ID0gdi52YWx1ZTtpZiAobyA9PT0gVCAmJiAhVC5uYW1lICYmICgheCB8fCB4LmlzX2NvbnN0YW50X2V4cHJlc3Npb24oKSkgJiYgTG4oVCwgam4oYykpKSByZXR1cm4gd2UoXywgTCh4KSkub3B0aW1pemUoYyk7fWlmIChtICYmICFULmNvbnRhaW5zX3RoaXMoKSkge3ZhciBrLHcgPSAhMTtpZiAoZCAmJiAhVC51c2VzX2FyZ3VtZW50cyAmJiAhVC5waW5uZWQoKSAmJiAhKFQubmFtZSAmJiBUIGluc3RhbmNlb2YgQVNUX0xhbWJkYUV4cHJlc3Npb24pICYmIChvID09PSBUIHx8ICFRbihjLCBrID0gby5kZWZpbml0aW9uKCksIFQpICYmIFQuaXNfY29uc3RhbnRfZXhwcmVzc2lvbih4ZShjKSkpICYmICh4ID0gZnVuY3Rpb24gKGUpIHt2YXIgbiA9IFQuYm9keS5sZW5ndGg7aWYgKG4gPCAyICYmIChlID0gSShlKSkpIHJldHVybiBlO2lmIChjLm9wdGlvbigiaW5saW5lIikgPCAzKSByZXR1cm4gITE7ZSA9IG51bGw7Zm9yICh2YXIgdCA9IDA7IHQgPCBuOyB0KyspIHt2YXIgaSA9IFQuYm9keVt0XTtpZiAoaSBpbnN0YW5jZW9mIEFTVF9WYXIpIHtpZiAodykge2lmIChlKSB7aWYgKCEoZSBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQpKSByZXR1cm4gITE7VyhpKSB8fCAoZSA9IG51bGwpO319IGVsc2UgaWYgKCFXKGkpKSB7aWYgKGUgJiYgIShlIGluc3RhbmNlb2YgQVNUX1NpbXBsZVN0YXRlbWVudCkpIHJldHVybiAhMTt3ID0gIShlID0gbnVsbCk7fX0gZWxzZSBpZiAoIShpIGluc3RhbmNlb2YgQVNUX0FzeW5jRGVmdW4gfHwgaSBpbnN0YW5jZW9mIEFTVF9EZWZ1biB8fCBpIGluc3RhbmNlb2YgQVNUX0VtcHR5U3RhdGVtZW50KSkge2lmIChlKSByZXR1cm4gITE7ZSA9IGk7fX1yZXR1cm4gSShlKTt9KHYpKSkge3ZhciBELHosRSxDLE4gPSBvID09PSBUIHx8IGsuc2luZ2xlX3VzZSAmJiBrLnJlZmVyZW5jZXMubGVuZ3RoIC0gay5yZXBsYWNlZCA9PSAxO2lmIChmdW5jdGlvbiAoKSB7aWYgKCEoeSB8fCBnIHx8IGIgfHwgdyB8fCBULnJlc3QpICYmICEoYy5vcHRpb24oImlubGluZSIpIDwgMiAmJiBULmFyZ25hbWVzLmxlbmd0aCkgJiYgVC52YXJpYWJsZXMuYWxsKGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUucmVmZXJlbmNlcy5sZW5ndGggLSBlLnJlcGxhY2VkIDwgMiAmJiBlLm9yaWdbMF0gaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnO30pKSB7dmFyIGksbiA9IGMuZmluZF9wYXJlbnQoQVNUX1Njb3BlKSxyID0gITEsbyA9IGpuKGMsIG4pLGEgPSBbXSxzID0gITEsZiA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQ7cmV0dXJuICEhciB8fCAoZSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgTmVbZS5vcGVyYXRvcl0gfHwgZSBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCA/IHZvaWQgKGEgPSBudWxsKSA6IGUgaW5zdGFuY2VvZiBBU1RfQ2xhc3MgPyByID0gITAgOiBlIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZCA/IHZvaWQgKHMgPSAhMCkgOiBlIGluc3RhbmNlb2YgQVNUX1Njb3BlIHx8IG8gJiYgZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2wgJiYgb1tlLm5hbWVdID8gciA9ICEwIDogZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyAodCA9IGUuZGVmaW5pdGlvbigpLCBULnZhcmlhYmxlcy5nZXQoZS5uYW1lKSAhPT0gdCA/IHZvaWQgKGEgPSBudWxsKSA6IHQuaW5pdCBpbnN0YW5jZW9mIEFTVF9MYW1iZGFEZWZpbml0aW9uIHx8IGlzX2xocyhlLCBmLnBhcmVudCgpKSA/IHIgPSAhMCA6ICh0ID0gTSh0KSwgaSA8IHQgfHwgKGkgPSB0KSwgYSA/IHZvaWQgKHMgPyBhID0gbnVsbCA6IGEucHVzaChULmFyZ25hbWVzW3RdKSkgOiB2b2lkIDApKSA6IHMgPyB2b2lkIDAgOiBlIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiAmJiBlLmxlZnQgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyA/IChlLmxlZnQuZXhwcmVzc2lvbi53YWxrKGYpLCBlLmxlZnQgaW5zdGFuY2VvZiBBU1RfU3ViICYmIGUubGVmdC5wcm9wZXJ0eS53YWxrKGYpLCBlLnJpZ2h0LndhbGsoZiksIHMgPSAhMCkgOiBlLmhhc19zaWRlX2VmZmVjdHMoYykgPyAobigpLCBzID0gITApIDogdm9pZCAwKTt9KTtpZiAoeC53YWxrKGYpLCAhcikge3ZhciBlID0gXy5hcmdzLmxlbmd0aDtpZiAoYSAmJiBULmFyZ25hbWVzLmxlbmd0aCA+PSBlKSB7Zm9yIChlID0gVC5hcmduYW1lcy5sZW5ndGg7IGUtLSA+IGkgJiYgVC5hcmduYW1lc1tlXSA9PT0gYS5wb3AoKTspO2UrKzt9cmV0dXJuIGUgPD0gaSB8fCBhbGwoXy5hcmdzLnNsaWNlKGksIGUpLCBzICYmICFhID8gZnVuY3Rpb24gKGUpIHtyZXR1cm4gZS5pc19jb25zdGFudF9leHByZXNzaW9uKG4pO30gOiBmdW5jdGlvbiAoZSkge3JldHVybiAhZS5oYXNfc2lkZV9lZmZlY3RzKGMpO30pO319fSgpKSB7Xy5fb3B0aW1pemVkID0gITA7dmFyIHAgPSB4Lm9wdGltaXplKGMpLmNsb25lKCEwKSxSID0gXy5hcmdzLnNsaWNlKCksTyA9IFtdLHAgPSBwLnRyYW5zZm9ybShuZXcgVHJlZVRyYW5zZm9ybWVyKGZ1bmN0aW9uIChlKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmKSB7dmFyIG4gPSBlLmRlZmluaXRpb24oKTtpZiAoVC52YXJpYWJsZXMuZ2V0KGUubmFtZSkgIT09IG4pIHJldHVybiBPLnB1c2goZSksIGU7dmFyIG4gPSBNKG4pLHQgPSBSW25dO2lmICghdCkgcmV0dXJuIGtlKEFTVF9VbmRlZmluZWQsIF8pO1Jbbl0gPSBudWxsO24gPSB0aGlzLnBhcmVudCgpO3JldHVybiBuID8gRGUobiwgZSwgdCkgOiB0O319KSksUyA9IFQuaW5saW5lZCxVID0gKG8gIT09IFQgJiYgKFQuaW5saW5lZCA9ICEwKSwgW10pLEIgPSAoUi5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZSAmJiAoKGUgPSBlLmNsb25lKCEwKSkud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge2UgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIE8ucHVzaChlKTt9KSksIFUucHVzaChlKSk7fSwgW10pLCBVLnB1c2gocCksIHdlKF8sIFUpLm9wdGltaXplKGMpKTtpZiAoVC5pbmxpbmVkID0gUywgQiA9IERlKGUsIGgsIEIpLCBOIHx8IFkoQiwgXykgPT09IEIpIHJldHVybiBPLmZvckVhY2goZnVuY3Rpb24gKGUpIHtlLnNjb3BlID0gbyA9PT0gVCA/IFQucGFyZW50X3Njb3BlIDogby5zY29wZSwgZS5yZWZlcmVuY2UoKTtlID0gZS5kZWZpbml0aW9uKCk7TiAmJiBlLnJlcGxhY2VkKyssIGUuc2luZ2xlX3VzZSA9ICExO30pLCBCO0IuaGFzX3NpZGVfZWZmZWN0cyhjKSB8fCAoXy5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUgPSBmdW5jdGlvbiAoZSwgbikge3ZhciB0ID0gdGhpcy5hcmdzLnNsaWNlKCk7cmV0dXJuIHQudW5zaGlmdCh0aGlzLmV4cHJlc3Npb24pLCB3ZSh0aGlzLCB0KS5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSwgbik7fSk7fWlmIChOICYmIGZ1bmN0aW9uICgpIHt2YXIgZSxuID0gbmV3IERpY3Rpb25hcnkoKSx0ID0gMDtDID0gaDtkbyB7aWYgKEMudmFyaWFibGVzICYmIEMudmFyaWFibGVzLmVhY2goZnVuY3Rpb24gKGUpIHtuLnNldChlLm5hbWUsICEwKTt9KSwgZSA9IEMsIChDID0gYy5wYXJlbnQodCsrKSkgaW5zdGFuY2VvZiBBU1RfQ2xhc3NGaWVsZCkge2lmICghQy5zdGF0aWMpIHJldHVybjt9IGVsc2UgQyBpbnN0YW5jZW9mIEFTVF9EV0xvb3AgPyBFID0gW10gOiBDIGluc3RhbmNlb2YgQVNUX0ZvciA/IEMuaW5pdCAhPT0gZSAmJiAoRSA9IFtdKSA6IEMgaW5zdGFuY2VvZiBBU1RfRm9yRW51bWVyYXRpb24gJiYgQy5pbml0ICE9PSBlICYmIEMub2JqZWN0ICE9PSBlICYmIChFID0gW10pO30gd2hpbGUgKCEoQyBpbnN0YW5jZW9mIEFTVF9TY29wZSkpO2lmICghKHogPSBDLmJvZHkuaW5kZXhPZihlKSArIDEpKSByZXR1cm47aWYgKCFMbihULCBqbihjLCBDKSkpIHJldHVybjt2YXIgaSA9IChvICE9PSBUIHx8IFQucGFyZW50X3Njb3BlLnJlc29sdmUoKSA9PT0gQykgJiYgIUMucGlubmVkKCk7QyBpbnN0YW5jZW9mIEFTVF9Ub3BsZXZlbCAmJiAoYy50b3BsZXZlbC52YXJzID8gbi5zZXQoImFyZ3VtZW50cyIsICEwKSA6IGkgPSAhMSk7RCA9IG5ldyBEaWN0aW9uYXJ5KCk7dmFyIHIgPSBjLm9wdGlvbigiaW5saW5lIik7cmV0dXJuIGZ1bmN0aW9uIChuLCB0KSB7dmFyIGkgPSAhMTtyZXR1cm4gVC5lYWNoX2FyZ25hbWUoZnVuY3Rpb24gKGUpIHtpZiAoIWkgJiYgIWUudW51c2VkKSB7aWYgKCF0IHx8IEgobiwgZS5uYW1lKSkgcmV0dXJuIGkgPSAhMDtELnNldChlLm5hbWUsICEwKSwgRSAmJiBFLnB1c2goZS5kZWZpbml0aW9uKCkpO319KSwgIWk7fShuLCAyIDw9IHIgJiYgaSkgJiYgISghZnVuY3Rpb24gKG4sIGUpIHtmb3IgKHZhciB0ID0gMDsgdCA8IFQuYm9keS5sZW5ndGg7IHQrKykge3ZhciBpID0gVC5ib2R5W3RdO2lmIChpIGluc3RhbmNlb2YgQVNUX0xhbWJkYURlZmluaXRpb24pIHt2YXIgciA9IGkubmFtZTtpZiAoIWUpIHJldHVybjtpZiAoRC5oYXMoci5uYW1lKSkgcmV0dXJuO2lmIChIKG4sIHIubmFtZSkpIHJldHVybjtpZiAoIWFsbChpLmVuY2xvc2VkLCBmdW5jdGlvbiAoZSkge3JldHVybiBlLnNjb3BlID09PSBDIHx8IGUuc2NvcGUgPT09IGkgfHwgIW4uaGFzKGUubmFtZSk7fSkpIHJldHVybjtFICYmIEUucHVzaChyLmRlZmluaXRpb24oKSk7fSBlbHNlIGlmIChpIGluc3RhbmNlb2YgQVNUX1Zhcikge2lmICghZSkgcmV0dXJuO2ZvciAodmFyIG8gPSBpLmRlZmluaXRpb25zLmxlbmd0aDsgMCA8PSAtLW87KSB7ciA9IGkuZGVmaW5pdGlvbnNbb10ubmFtZTtpZiAoSChuLCByLm5hbWUpKSByZXR1cm47RSAmJiBFLnB1c2goci5kZWZpbml0aW9uKCkpO319fXJldHVybiAxO30obiwgMyA8PSByICYmIGkpIHx8IEUgJiYgMCAhPSBFLmxlbmd0aCAmJiBpdChULCBFKSk7fSgpKSByZXR1cm4gVC5fc3F1ZWV6ZWQgPSAhMCwgbyAhPT0gVCAmJiAoVC5wYXJlbnRfc2NvcGUgPSBvLnNjb3BlKSwgQiA9IHdlKF8sIGZ1bmN0aW9uICgpIHt2YXIgZSA9IFtdLG4gPSBbXTsoMSA8IHkgfHwgZyB8fCBiIHx8IFQucmVzdCA/IGZ1bmN0aW9uIChpLCByKSB7ZnVuY3Rpb24gbihlLCBuKSB7aWYgKG4udW51c2VkKSByZXR1cm4gaihuKTt2YXIgdCA9IG4uZGVmaW5pdGlvbigpLGUgPSAodC5hc3NpZ25tZW50cysrLCB0LnJlZmVyZW5jZXMucHVzaChlKSwga2UoQVNUX1N5bWJvbFZhciwgbikpO3Qub3JpZy5wdXNoKGUpLCB0LmVsaW1pbmF0ZWQrKywgRihpLCByLCBlKTt9ci5wdXNoKGtlKEFTVF9Bc3NpZ24sIF8sIHsgb3BlcmF0b3I6ICI9IiwgbGVmdDoga2UoQVNUX0Rlc3RydWN0dXJlZEFycmF5LCBfLCB7IGVsZW1lbnRzOiBULmFyZ25hbWVzLm1hcChmdW5jdGlvbiAoZSkge3JldHVybiBlLnVudXNlZCA/IGtlKEFTVF9Ib2xlLCBlKSA6IGUuY29udmVydF9zeW1ib2woQVNUX1N5bWJvbFJlZiwgbik7fSksIHJlc3Q6IFQucmVzdCAmJiBULnJlc3QuY29udmVydF9zeW1ib2woQVNUX1N5bWJvbFJlZiwgbikgfSksIHJpZ2h0OiBrZShBU1RfQXJyYXksIF8sIHsgZWxlbWVudHM6IF8uYXJncy5zbGljZSgpIH0pIH0pKTt9IDogZnVuY3Rpb24gKGUsIG4pIHtmb3IgKHZhciB0ID0gVC5hcmduYW1lcy5sZW5ndGgsIGkgPSBfLmFyZ3MubGVuZ3RoOyAtLWkgPj0gdDspIG4ucHVzaChfLmFyZ3NbaV0pO3ZhciByLG8gPSBbXTtmb3IgKGkgPSB0OyAwIDw9IC0taTspIHt2YXIgYSxzLGYgPSBULmFyZ25hbWVzW2ldLGMgPSAociA9IGYgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdFZhbHVlID8gKG8ucHVzaChmKSwgZi5uYW1lKSA6IGYsIF8uYXJnc1tpXSk7ci51bnVzZWQgfHwgQy52YXJfbmFtZXMoKS5oYXMoci5uYW1lKSA/IGMgJiYgbi5wdXNoKGMpIDogKGEgPSBrZShBU1RfU3ltYm9sVmFyLCByKSwgKHMgPSByLmRlZmluaXRpb24oKSkub3JpZy5wdXNoKGEpLCBzLmVsaW1pbmF0ZWQrKywgdm9pZCAwICE9PSByLnVudXNlZCA/IChGKGUsIG4sIGEpLCBjICYmIG4ucHVzaChjKSkgOiAoIWMgJiYgZiA9PT0gciAmJiAoRSB8fCAiYXJndW1lbnRzIiA9PSByLm5hbWUgJiYgIWlzX2Fycm93KFQpICYmIGlzX2Fycm93KEMpKSAmJiAoYyA9IGtlKEFTVF9VbmRlZmluZWQsIF8pKSwgRihlLCBuLCBhLCBjKSkpO31mb3IgKGUucmV2ZXJzZSgpLCBuLnJldmVyc2UoKSwgaSA9IG8ubGVuZ3RoOyAwIDw9IC0taTspIHt2YXIgbCx1ID0gb1tpXTt2b2lkIDAgIT09IHUubmFtZS51bnVzZWQgPyBuLnB1c2godS52YWx1ZSkgOiAobCA9IGtlKEFTVF9TeW1ib2xSZWYsIHUubmFtZSksIHUubmFtZS5kZWZpbml0aW9uKCkucmVmZXJlbmNlcy5wdXNoKGwpLCBuLnB1c2goa2UoQVNUX0Fzc2lnbiwgdSwgeyBvcGVyYXRvcjogIj0iLCBsZWZ0OiBsLCByaWdodDogdS52YWx1ZSB9KSkpO319KShlLCBuKTt2YXIgdCA9IGZ1bmN0aW9uIChpLCBlKSB7dmFyIHQgPSBbeiwgMF0sbyA9IFtdLHIgPSBbXSxhID0gW10scyA9IFtdLGYgPSBbXTtyZXR1cm4gVC5ib2R5LmZpbHRlcihFID8gZnVuY3Rpb24gKGUpIHt2YXIgbiwgdDtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX0xhbWJkYURlZmluaXRpb24gJiYgKCh0ID0gKG4gPSBrZShBU1RfU3ltYm9sVmFyLCBmdChlLm5hbWUpKSkuZGVmaW5pdGlvbigpKS5maXhlZCA9ICExLCB0Lm9yaWcucHVzaChuKSwgdC5lbGltaW5hdGVkKyssIEYoaSwgciwgbiwgdm4oZSwgITApKSwgMSkpO30gOiBmdW5jdGlvbiAoZSkge3ZhciBuO3JldHVybiAhKGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRGVmaW5pdGlvbiAmJiAobiA9IGUubmFtZS5kZWZpbml0aW9uKCksIEMuZnVuY3Rpb25zLnNldChuLm5hbWUsIG4pLCBDLnZhcmlhYmxlcy5zZXQobi5uYW1lLCBuKSwgQy5lbmNsb3NlZC5wdXNoKG4pLCBDLnZhcl9uYW1lcygpLnNldChuLm5hbWUsICEwKSwgdC5wdXNoKGUpLCAxKSk7fSkuZm9yRWFjaChmdW5jdGlvbiAoZSkge2lmIChlIGluc3RhbmNlb2YgQVNUX1ZhcikgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmRlZmluaXRpb25zLmxlbmd0aDsgbisrKSB7dmFyIHQgPSBlLmRlZmluaXRpb25zW25dLGkgPSBmdCh0Lm5hbWUpLHIgPSB0LnZhbHVlO3IgJiYgMCA8IGYubGVuZ3RoICYmIChmLnB1c2gociksIHIgPSB3ZSh0LCBmKSwgZiA9IFtdKSwgRihvLCBhLCBpLCByKSwgIUUgfHwgRC5oYXMoaS5uYW1lKSB8fCAxID09IGkuZGVmaW5pdGlvbigpLm9yaWcubGVuZ3RoICYmIFQuZnVuY3Rpb25zLmhhcyhpLm5hbWUpIHx8IHMucHVzaCh1dChjLCBpKSk7fSBlbHNlIGUgaW5zdGFuY2VvZiBBU1RfU2ltcGxlU3RhdGVtZW50ICYmIGYucHVzaChlLmJvZHkpO30pLCBbXS5wdXNoLmFwcGx5KGksIG8pLCBbXS5wdXNoLmFwcGx5KGUsIHMpLCBbXS5wdXNoLmFwcGx5KGUsIHIpLCBbXS5wdXNoLmFwcGx5KGUsIGEpLCB0O30oZSwgbik7bi5wdXNoKHgpLCBlLmxlbmd0aCAmJiB0LnB1c2goa2UoQVNUX1ZhciwgVCwgeyBkZWZpbml0aW9uczogZSB9KSk7cmV0dXJuIFtdLnNwbGljZS5hcHBseShDLmJvZHksIHQpLCBULmVuY2xvc2VkLmZvckVhY2goZnVuY3Rpb24gKGUpIHtDLnZhcl9uYW1lcygpLmhhcyhlLm5hbWUpIHx8IChDLmVuY2xvc2VkLnB1c2goZSksIEMudmFyX25hbWVzKCkuc2V0KGUubmFtZSwgITApKTt9KSwgbjt9KCkpLm9wdGltaXplKGMpLCBEZShlLCBoLCBCKTt9aWYgKGMub3B0aW9uKCJzaWRlX2VmZmVjdHMiKSAmJiBBICYmIGFsbChULmJvZHksIGVlKSAmJiAoVCA9PT0gbyA/IGtuKFQsIGMpIDogIXkgJiYgIWcgJiYgIVQucmVzdCkgJiYgKCFpc19hcnJvdyhUKSB8fCAhVC52YWx1ZSkgJiYgTG4oVCwgam4oYykpKSByZXR1cm4gd2UoXywgTCgpKS5vcHRpbWl6ZShjKTt9aWYgKGMub3B0aW9uKCJkcm9wX2NvbnNvbGUiKSAmJiBvIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpIHtmb3IgKHZhciBQID0gby5leHByZXNzaW9uOyBQLmV4cHJlc3Npb247KSBQID0gUC5leHByZXNzaW9uO2lmIChFZShQKSAmJiAiY29uc29sZSIgPT0gUC5uYW1lKSByZXR1cm4ga2UoQVNUX1VuZGVmaW5lZCwgXykub3B0aW1pemUoYyk7fXJldHVybiBjLm9wdGlvbigibmVnYXRlX2lpZmUiKSAmJiBlIGluc3RhbmNlb2YgQVNUX1NpbXBsZVN0YXRlbWVudCAmJiBsZShoKSA/IF8ubmVnYXRlKGMsICEwKSA6IEsoYywgXyk7ZnVuY3Rpb24gaihlKSB7cmV0dXJuIGtlKEFTVF9TdWIsIGUsIHsgZXhwcmVzc2lvbjoga2UoQVNUX0FycmF5LCBlLCB7IGVsZW1lbnRzOiBbXSB9KSwgcHJvcGVydHk6IGtlKEFTVF9OdW1iZXIsIGUsIHsgdmFsdWU6IDAgfSkgfSk7fWZ1bmN0aW9uIEwoZSkge3ZhciBhLHQsbiA9IF8uYXJncy5zbGljZSgpLGkgPSAxIDwgeSB8fCBnIHx8IFQucmVzdDtyZXR1cm4gKGkgfHwgYikgJiYgKG4gPSBba2UoQVNUX0FycmF5LCBfLCB7IGVsZW1lbnRzOiBuIH0pXSksIGkgPyAoYSA9IG5ldyBUcmVlVHJhbnNmb3JtZXIoZnVuY3Rpb24gKGksIGUpIHt2YXIgdCwgciwgbztyZXR1cm4gaSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgPyBrZShBU1RfRGVmYXVsdFZhbHVlLCBpLCB7IG5hbWU6IGkubmFtZS50cmFuc2Zvcm0oYSkgfHwgaihpKSwgdmFsdWU6IGkudmFsdWUgfSkgOiBpIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZEFycmF5ID8gKHQgPSBbXSwgaS5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlLCBuKSB7KGUgPSBlLnRyYW5zZm9ybShhKSkgJiYgKHRbbl0gPSBlKTt9KSwgaG4oaSwgdCksIGtlKEFTVF9EZXN0cnVjdHVyZWRBcnJheSwgaSwgeyBlbGVtZW50czogdCB9KSkgOiBpIGluc3RhbmNlb2YgQVNUX0Rlc3RydWN0dXJlZE9iamVjdCA/IChyID0gW10sIG8gPSBbXSwgaS5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHt2YXIgbiA9IGUua2V5LHQgPSBlLnZhbHVlLnRyYW5zZm9ybShhKTt0ID8gKG8ubGVuZ3RoICYmIChuIGluc3RhbmNlb2YgQVNUX05vZGUgfHwgKG4gPSBaKG4sIGUpKSwgby5wdXNoKG4pLCBuID0gd2UoaSwgbyksIG8gPSBbXSksIHIucHVzaChrZShBU1RfRGVzdHJ1Y3R1cmVkS2V5VmFsLCBlLCB7IGtleTogbiwgdmFsdWU6IHQgfSkpKSA6IG4gaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiBvLnB1c2gobik7fSksIG8ubGVuZ3RoICYmIHIucHVzaChrZShBU1RfRGVzdHJ1Y3R1cmVkS2V5VmFsLCBpLCB7IGtleTogd2UoaSwgbyksIHZhbHVlOiBqKGkpIH0pKSwga2UoQVNUX0Rlc3RydWN0dXJlZE9iamVjdCwgaSwgeyBwcm9wZXJ0aWVzOiByIH0pKSA6IGkgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnID8gbnVsbCA6IHZvaWQgMDt9KSwgdCA9IFtdLCBULmFyZ25hbWVzLmZvckVhY2goZnVuY3Rpb24gKGUsIG4pIHsoZSA9IGUudHJhbnNmb3JtKGEpKSAmJiAodFtuXSA9IGUpO30pLCAoaSA9IFQucmVzdCAmJiBULnJlc3QudHJhbnNmb3JtKGEpKSAmJiAodC5sZW5ndGggPSBULmFyZ25hbWVzLmxlbmd0aCksIGhuKFQsIHQpLCBuWzBdID0ga2UoQVNUX0Fzc2lnbiwgXywgeyBvcGVyYXRvcjogIj0iLCBsZWZ0OiBrZShBU1RfRGVzdHJ1Y3R1cmVkQXJyYXksIFQsIHsgZWxlbWVudHM6IHQsIHJlc3Q6IGkgfSksIHJpZ2h0OiBuWzBdIH0pKSA6IFQuYXJnbmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge2UgaW5zdGFuY2VvZiBBU1RfRGVmYXVsdFZhbHVlICYmIG4ucHVzaChlLnZhbHVlKTt9KSwgbi5wdXNoKGUgfHwga2UoQVNUX1VuZGVmaW5lZCwgXykpLCBuO31mdW5jdGlvbiBWKCkge3JldHVybiBfLmNhbGxfb25seSA/IGtlKEFTVF9OdW1iZXIsIF8sIHsgdmFsdWU6IDAgfSkgOiBrZShBU1RfVW5kZWZpbmVkLCBfKTt9ZnVuY3Rpb24gSShlKSB7cmV0dXJuIGUgPyBlIGluc3RhbmNlb2YgQVNUX1JldHVybiA/IGUudmFsdWUgfHwgVigpIDogZSBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQgPyBfLmNhbGxfb25seSA/IGUuYm9keSA6IGtlKEFTVF9VbmFyeVByZWZpeCwgZSwgeyBvcGVyYXRvcjogInZvaWQiLCBleHByZXNzaW9uOiBlLmJvZHkgfSkgOiB2b2lkIDAgOiBWKCk7fWZ1bmN0aW9uIE0oZSkge2ZvciAodmFyIG4gPSBULmFyZ25hbWVzLmxlbmd0aDsgMCA8PSAtLW47KSBpZiAoVC5hcmduYW1lc1tuXS5kZWZpbml0aW9uKCkgPT09IGUpIHJldHVybiBuO31mdW5jdGlvbiBIKGUsIG4pIHtyZXR1cm4gZS5oYXMobikgfHwgdGVbbl0gfHwgQy52YXJfbmFtZXMoKS5oYXMobik7fWZ1bmN0aW9uIEYoZSwgbiwgdCwgaSkge3ZhciByID0gdC5kZWZpbml0aW9uKCk7Qy52YXJfbmFtZXMoKS5oYXModC5uYW1lKSB8fCAoci5maXJzdF9kZWNsID0gbnVsbCwgQy52YXJfbmFtZXMoKS5zZXQodC5uYW1lLCAhMCksIGUucHVzaChrZShBU1RfVmFyRGVmLCB0LCB7IG5hbWU6IHQsIHZhbHVlOiBudWxsIH0pKSksIEMudmFyaWFibGVzLnNldCh0Lm5hbWUsIHIpLCBDLmVuY2xvc2VkLnB1c2gociksIGkgJiYgKGUgPSBrZShBU1RfU3ltYm9sUmVmLCB0KSwgci5hc3NpZ25tZW50cysrLCByLnJlZmVyZW5jZXMucHVzaChlKSwgbi5wdXNoKGtlKEFTVF9Bc3NpZ24sIF8sIHsgb3BlcmF0b3I6ICI9IiwgbGVmdDogZSwgcmlnaHQ6IGkgfSkpKTt9fSksIGUoQVNUX05ldywgZnVuY3Rpb24gKGUsIG4pIHtpZiAobi5vcHRpb24oInVuc2FmZSIpKSB7dmFyIHQgPSBlLmV4cHJlc3Npb247aWYgKEVlKHQpKSBzd2l0Y2ggKHQubmFtZSkge2Nhc2UgIkFycmF5IjpjYXNlICJFcnJvciI6Y2FzZSAiRnVuY3Rpb24iOmNhc2UgIk9iamVjdCI6Y2FzZSAiUmVnRXhwIjpyZXR1cm4ga2UoQVNUX0NhbGwsIGUpLnRyYW5zZm9ybShuKTt9fWlmIChuLm9wdGlvbigic2VxdWVuY2VzIikpIHt0ID0gRyhlKTtpZiAodCAhPT0gZSkgcmV0dXJuIHQub3B0aW1pemUobik7fXJldHVybiBuLm9wdGlvbigidW51c2VkIikgJiYgVW4oZSwgbiksIGU7fSksIGUoQVNUX1NlcXVlbmNlLCBmdW5jdGlvbiAoZSwgdCkge2ZvciAodmFyIGksIHIsIG8sIG4gPSB0Lm9wdGlvbigic2lkZV9lZmZlY3RzIikgPyAoaSA9IFtdLCByID0gZmlyc3RfaW5fc3RhdGVtZW50KHQpLCBvID0gZS5leHByZXNzaW9ucy5sZW5ndGggLSAxLCBlLmV4cHJlc3Npb25zLmZvckVhY2goZnVuY3Rpb24gKGUsIG4pIHsoZSA9IG4gPCBvID8gZS5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUodCwgcikgOiBlKSAmJiAocmUoaSwgZSksIHIgPSAhMSk7fSksIGkpIDogZS5leHByZXNzaW9ucywgYSA9IG4ubGVuZ3RoIC0gMSwgcyA9IDE7IHMgPCBhOyBzKyspIHt2YXIgZiA9IG5bcyAtIDFdLGMgPSBfKGYpO2lmIChjKSB7dmFyIGwgPSBuW3NdO2lmICh0Lm9wdGlvbigiY29uZGl0aW9uYWxzIikpIHt2YXIgdSA9IEluKHQsIGMsIGYucmlnaHQsIGwpO2lmICh1KSB7Zi5yaWdodCA9IHUsIG4uc3BsaWNlKHMtLSwgMSksIGEtLTtjb250aW51ZTt9fXQub3B0aW9uKCJkZWFkX2NvZGUiKSAmJiBfKGwpID09PSBjICYmIGwucmlnaHQuaXNfY29uc3RhbnRfZXhwcmVzc2lvbihjLnNjb3BlLnJlc29sdmUoKSkgJiYgKG5bLS1zXSA9IGYucmlnaHQpO319aWYgKHQub3B0aW9uKCJzaWRlX2VmZmVjdHMiKSkge2ZvciAoOyAwIDwgYSAmJiBDZShuW2FdLCB0KTspIGEtLTthIDwgbi5sZW5ndGggLSAxICYmIChuW2FdID0ga2UoQVNUX1VuYXJ5UHJlZml4LCBlLCB7IG9wZXJhdG9yOiAidm9pZCIsIGV4cHJlc3Npb246IG5bYV0gfSksIG4ubGVuZ3RoID0gYSArIDEpO31yZXR1cm4gMCA9PSBhID8gKGUgPSBEZSh0LnBhcmVudCgpLCB0LnNlbGYoKSwgblswXSkpIGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlID8gZSA6IGUub3B0aW1pemUodCkgOiAoZS5leHByZXNzaW9ucyA9IG4sIGUpO2Z1bmN0aW9uIF8oZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiAmJiAiPSIgPT0gZS5vcGVyYXRvciAmJiBlLmxlZnQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIGUubGVmdC5kZWZpbml0aW9uKCk7fX0pLCBlKEFTVF9VbmFyeVBvc3RmaXgsIGZ1bmN0aW9uIChlLCBuKSB7aWYgKG4ub3B0aW9uKCJzZXF1ZW5jZXMiKSkge3ZhciB0ID0gRyhlKTtpZiAodCAhPT0gZSkgcmV0dXJuIHQub3B0aW1pemUobik7fXJldHVybiBLKG4sIGUpO30pO3ZhciBNbiA9IG1ha2VQcmVkaWNhdGUoIisgLSIpLEhuID0gbWFrZVByZWRpY2F0ZSgiKiAvICUiKSxXbiA9IChlKEFTVF9VbmFyeVByZWZpeCwgZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCA9IGUub3BlcmF0b3IsaSA9IGUuZXhwcmVzc2lvbjtpZiAobi5vcHRpb24oInNlcXVlbmNlcyIpICYmIGZ1bmN0aW9uICgpIHtzd2l0Y2ggKHQpIHtjYXNlICJkZWxldGUiOnJldHVybiAhYShpLnRhaWxfbm9kZSgpKTtjYXNlICJ0eXBlb2YiOnJldHVybiAhRWUoaS50YWlsX25vZGUoKSk7ZGVmYXVsdDpyZXR1cm4gMTt9fSgpKSB7dmFyIHIgPSBHKGUpO2lmIChyICE9PSBlKSByZXR1cm4gci5vcHRpbWl6ZShuKTt9c3dpdGNoICh0KSB7Y2FzZSAiKyI6aWYgKCFuLm9wdGlvbigiZXZhbHVhdGUiKSkgYnJlYWs7aWYgKCFpLmlzX251bWJlcihuLCAhMCkpIGJyZWFrO3ZhciBvID0gbi5wYXJlbnQoKTtpZiAobyBpbnN0YW5jZW9mIEFTVF9VbmFyeVByZWZpeCAmJiAiZGVsZXRlIiA9PSBvLm9wZXJhdG9yKSBicmVhaztyZXR1cm4gaTtjYXNlICItIjppZiAoKGkgPSBpIGluc3RhbmNlb2YgQVNUX0luZmluaXR5ID8gaS50cmFuc2Zvcm0obikgOiBpKSBpbnN0YW5jZW9mIEFTVF9OdW1iZXIgfHwgaSBpbnN0YW5jZW9mIEFTVF9JbmZpbml0eSkgcmV0dXJuIGU7YnJlYWs7Y2FzZSAiISI6aWYgKG4ub3B0aW9uKCJib29sZWFucyIpKSB7aWYgKGkuaXNfdHJ1dGh5KCkpIHJldHVybiB3ZShlLCBbaSwga2UoQVNUX0ZhbHNlLCBlKV0pLm9wdGltaXplKG4pO2lmIChuLmluX2Jvb2xlYW5fY29udGV4dCgpKSB7aWYgKGkgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgIiEiID09IGkub3BlcmF0b3IpIHJldHVybiBpLmV4cHJlc3Npb247aSBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgKGUgPSAoKG8gPSBmaXJzdF9pbl9zdGF0ZW1lbnQobikpID8gSWUgOiBZKShlLCBpLm5lZ2F0ZShuLCBvKSkpO319YnJlYWs7Y2FzZSAiZGVsZXRlIjppZiAoIW4ub3B0aW9uKCJldmFsdWF0ZSIpKSBicmVhaztpZiAoYShpKSkgYnJlYWs7cmV0dXJuIHdlKGUsIFtpLCBrZShBU1RfVHJ1ZSwgZSldKS5vcHRpbWl6ZShuKTtjYXNlICJ0eXBlb2YiOmlmICghbi5vcHRpb24oImJvb2xlYW5zIikpIGJyZWFrO2lmICghbi5pbl9ib29sZWFuX2NvbnRleHQoKSkgYnJlYWs7QVNUX05vZGUud2FybigiQm9vbGVhbiBleHByZXNzaW9uIGFsd2F5cyB0cnVlIFt7c3RhcnR9XSIsIGUpO28gPSBba2UoQVNUX1RydWUsIGUpXTtyZXR1cm4gaSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgYmUoaSwgbikgfHwgby51bnNoaWZ0KGkpLCB3ZShlLCBvKS5vcHRpbWl6ZShuKTtjYXNlICJ2b2lkIjppZiAobi5vcHRpb24oInNpZGVfZWZmZWN0cyIpKSByZXR1cm4gKGkgPSBpLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZShuKSkgPyAoZS5leHByZXNzaW9uID0gaSwgZSkgOiBrZShBU1RfVW5kZWZpbmVkLCBlKS5vcHRpbWl6ZShuKTt9cmV0dXJuIG4ub3B0aW9uKCJldmFsdWF0ZSIpICYmIGkgaW5zdGFuY2VvZiBBU1RfQmluYXJ5ICYmIE1uW3RdICYmIEhuW2kub3BlcmF0b3JdICYmIChpLmxlZnQuaXNfY29uc3RhbnQoKSB8fCAhaS5yaWdodC5oYXNfc2lkZV9lZmZlY3RzKG4pKSA/IGtlKEFTVF9CaW5hcnksIGUsIHsgb3BlcmF0b3I6IGkub3BlcmF0b3IsIGxlZnQ6IGtlKEFTVF9VbmFyeVByZWZpeCwgaS5sZWZ0LCB7IG9wZXJhdG9yOiB0LCBleHByZXNzaW9uOiBpLmxlZnQgfSksIHJpZ2h0OiBpLnJpZ2h0IH0pIDogSyhuLCBlKTtmdW5jdGlvbiBhKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9JbmZpbml0eSB8fCBlIGluc3RhbmNlb2YgQVNUX05hTiB8fCBlIGluc3RhbmNlb2YgQVNUX05ld1RhcmdldCB8fCBlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MgfHwgZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgfHwgZSBpbnN0YW5jZW9mIEFTVF9VbmRlZmluZWQ7fX0pLCBlKEFTVF9Bd2FpdCwgZnVuY3Rpb24gKGUsIG4pIHtpZiAobi5vcHRpb24oImF3YWl0cyIpKSB7aWYgKG4ub3B0aW9uKCJzZXF1ZW5jZXMiKSkge3ZhciB0ID0gRyhlKTtpZiAodCAhPT0gZSkgcmV0dXJuIHQub3B0aW1pemUobik7fWlmIChuLm9wdGlvbigic2lkZV9lZmZlY3RzIikpIHt2YXIgaSA9IGUuZXhwcmVzc2lvbjtpZiAoaSBpbnN0YW5jZW9mIEFTVF9Bd2FpdCkgcmV0dXJuIGkub3B0aW1pemUobik7aWYgKGkgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgaS5leHByZXNzaW9uIGluc3RhbmNlb2YgQVNUX0F3YWl0KSByZXR1cm4gaS5vcHRpbWl6ZShuKTtmb3IgKHZhciByLCBvID0gMCwgYSA9IGU7IHIgPSBuLnBhcmVudChvKyspOyBhID0gcikge2lmIChpc19hcnJvdyhyKSkge2lmIChyLnZhbHVlID09PSBhKSByZXR1cm4gaS5vcHRpbWl6ZShuKTt9IGVsc2UgaWYgKHIgaW5zdGFuY2VvZiBBU1RfUmV0dXJuKSB7dmFyIHMgPSAhMDtkbyB7aWYgKGEgPSByLCAociA9IG4ucGFyZW50KG8rKykpIGluc3RhbmNlb2YgQVNUX1RyeSAmJiAoci5iZmluYWxseSB8fCByLmJjYXRjaCkgIT09IGEpIHtzID0gITE7YnJlYWs7fX0gd2hpbGUgKHIgJiYgIShyIGluc3RhbmNlb2YgQVNUX1Njb3BlKSk7aWYgKHMpIHJldHVybiBpLm9wdGltaXplKG4pO30gZWxzZSBpZiAociBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSAmJiByLnRhaWxfbm9kZSgpID09PSBhKSBjb250aW51ZTticmVhazt9fX1yZXR1cm4gZTt9KSwgZShBU1RfWWllbGQsIGZ1bmN0aW9uIChlLCBuKSB7aWYgKG4ub3B0aW9uKCJ5aWVsZHMiKSkge2lmIChuLm9wdGlvbigic2VxdWVuY2VzIikpIHt2YXIgdCA9IEcoZSk7aWYgKHQgIT09IGUpIHJldHVybiB0Lm9wdGltaXplKG4pO310ID0gZS5leHByZXNzaW9uO2lmIChlLm5lc3RlZCAmJiAiQ2FsbCIgPT0gdC5UWVBFKSB7dCA9IHQuY2xvbmUoKS5vcHRpbWl6ZShuKTtpZiAoIkNhbGwiICE9IHQuVFlQRSkgcmV0dXJuIHQ7fX1yZXR1cm4gZTt9KSwgQVNUX0JpbmFyeS5ERUZNRVRIT0QoImxpZnRfc2VxdWVuY2VzIiwgZnVuY3Rpb24gKGUpIHtpZiAodGhpcy5sZWZ0IGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpIHJldHVybiB0aGlzLmxlZnQuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSA/IChuID0gdGhpcy5sZWZ0LmV4cHJlc3Npb24uZXhwcmVzc2lvbnMuc2xpY2UoKSwgKHQgPSB0aGlzLmNsb25lKCkpLmxlZnQgPSB0LmxlZnQuY2xvbmUoKSwgdC5sZWZ0LmV4cHJlc3Npb24gPSBuLnBvcCgpLCBuLnB1c2godCksIHdlKHRoaXMsIG4pKSA6IHRoaXM7aWYgKHRoaXMubGVmdCBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSkgcmV0dXJuIG4gPSB0aGlzLmxlZnQuZXhwcmVzc2lvbnMuc2xpY2UoKSwgKHQgPSB0aGlzLmNsb25lKCkpLmxlZnQgPSBuLnBvcCgpLCBuLnB1c2godCksIHdlKHRoaXMsIG4pO2lmICh0aGlzLnJpZ2h0IGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlKSB7aWYgKHRoaXMubGVmdC5oYXNfc2lkZV9lZmZlY3RzKGUpKSByZXR1cm4gdGhpcztmb3IgKHZhciBuLCB0LCBpID0gIj0iID09IHRoaXMub3BlcmF0b3IgJiYgdGhpcy5sZWZ0IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiwgciA9IChuID0gdGhpcy5yaWdodC5leHByZXNzaW9ucykubGVuZ3RoIC0gMSwgbyA9IDA7IG8gPCByICYmIChpIHx8ICFuW29dLmhhc19zaWRlX2VmZmVjdHMoZSkpOyBvKyspO2lmIChvID09IHIpIHJldHVybiBuID0gbi5zbGljZSgpLCAodCA9IHRoaXMuY2xvbmUoKSkucmlnaHQgPSBuLnBvcCgpLCBuLnB1c2godCksIHdlKHRoaXMsIG4pO2lmICgwIDwgbykgcmV0dXJuICh0ID0gdGhpcy5jbG9uZSgpKS5yaWdodCA9IHdlKHRoaXMucmlnaHQsIG4uc2xpY2UobykpLCAobiA9IG4uc2xpY2UoMCwgbykpLnB1c2godCksIHdlKHRoaXMsIG4pO31yZXR1cm4gdGhpczt9KSwgbWFrZVByZWRpY2F0ZSgiaW5kZXhPZiBsYXN0SW5kZXhPZiIpKSxZbiA9IG1ha2VQcmVkaWNhdGUoIj09ID09PSAhPSAhPT0gKiAmIHwgXiIpO2Z1bmN0aW9uIEtuKGUsIG4pIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gPyAhbiAmJiAiPSIgPT0gZS5vcGVyYXRvciAmJiBLbihlLnJpZ2h0KSA6IGUgaW5zdGFuY2VvZiBBU1RfTmV3ID8gIW4gOiBlIGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlID8gS24oZS50YWlsX25vZGUoKSwgbikgOiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/ICFuICYmIEtuKGUuZml4ZWRfdmFsdWUoKSkgOiBlIGluc3RhbmNlb2YgQVNUX0FycmF5IHx8IGUgaW5zdGFuY2VvZiBBU1RfQ2xhc3MgfHwgZSBpbnN0YW5jZW9mIEFTVF9MYW1iZGEgfHwgZSBpbnN0YW5jZW9mIEFTVF9PYmplY3Q7fWZ1bmN0aW9uIEduKGUsIG4pIHt2YXIgdCA9IGUucmlnaHQ7c3dpdGNoIChlLm9wZXJhdG9yKSB7Y2FzZSAiaW4iOnJldHVybiBLbih0KSB8fCBuICYmIG4ub3B0aW9uKCJ1bnNhZmVfY29tcHMiKTtjYXNlICJpbnN0YW5jZW9mIjpyZXR1cm4gKHQgPSB0IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IHQuZml4ZWRfdmFsdWUoKSA6IHQpIGluc3RhbmNlb2YgQVNUX0RlZnVuIHx8IHQgaW5zdGFuY2VvZiBBU1RfRnVuY3Rpb24gfHwgaXNfZ2VuZXJhdG9yKHQpID8gITAgOiAhKCF3KHQpIHx8ICFlLmxlZnQuaXNfY29uc3RhbnQoKSkgfHwgbiAmJiBuLm9wdGlvbigidW5zYWZlX2NvbXBzIik7ZGVmYXVsdDpyZXR1cm4gITA7fX1mdW5jdGlvbiBoKGUsIG4pIHt2YXIgdCwgaTtyZXR1cm4gISFuLmlzX2NvbnN0YW50KCkgfHwgKG4gaW5zdGFuY2VvZiBBU1RfQXNzaWduID8gIj0iICE9IG4ub3BlcmF0b3IgfHwgaChlLCBuLnJpZ2h0KSA6IG4gaW5zdGFuY2VvZiBBU1RfQmluYXJ5ID8gIU5lW24ub3BlcmF0b3JdIHx8IGgoZSwgbi5sZWZ0KSAmJiBoKGUsIG4ucmlnaHQpIDogbiBpbnN0YW5jZW9mIEFTVF9DYWxsID8gISFpc19hc3luYyhuLmV4cHJlc3Npb24pICYmICh0ID0gITEsIHdhbGtfYm9keShuLmV4cHJlc3Npb24sIG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuICEhdCB8fCAoZSBpbnN0YW5jZW9mIEFTVF9Bd2FpdCA/IHQgPSAhMCA6IGUgIT09IG4gJiYgZSBpbnN0YW5jZW9mIEFTVF9TY29wZSB8fCB2b2lkIDApO30pKSwgIXQpIDogbiBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCA/IGgoZSwgbi5jb25zZXF1ZW50KSAmJiBoKGUsIG4uYWx0ZXJuYXRpdmUpIDogbiBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSA/IGgoZSwgbi50YWlsX25vZGUoKSkgOiBuIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/IChpID0gbi5maXhlZF92YWx1ZSgpKSAmJiBoKGUsIGkpIDogbiBpbnN0YW5jZW9mIEFTVF9UZW1wbGF0ZSA/ICFuLnRhZyB8fCBldChlLCBuLnRhZykgOiBuIGluc3RhbmNlb2YgQVNUX1VuYXJ5IHx8IHZvaWQgMCk7fWZ1bmN0aW9uICRuKGUsIG4pIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gPyBQZShlLmxlZnQsIG4pID8gZSA6IGUubGVmdCA6IGUgaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgPyAkbihlLnRhaWxfbm9kZSgpLCBuKSA6ICEoZSBpbnN0YW5jZW9mIEFTVF9VbmFyeVByZWZpeCAmJiBVTkFSWV9QT1NURklYW2Uub3BlcmF0b3JdKSB8fCBQZShlLmV4cHJlc3Npb24sIG4pID8gZSA6IGUuZXhwcmVzc2lvbjt9ZnVuY3Rpb24gWG4oZSwgbikge3JldHVybiBuIGluc3RhbmNlb2YgQVNUX0RvdCA/IFhuKGUsIG4uZXhwcmVzc2lvbikgOiBuIGluc3RhbmNlb2YgQVNUX1N1YiA/IFhuKGUsIG4uZXhwcmVzc2lvbikgJiYgWG4oZSwgbi5wcm9wZXJ0eSkgOiBuIGluc3RhbmNlb2YgQVNUX1N5bWJvbCB8fCAhbi5oYXNfc2lkZV9lZmZlY3RzKGUpO31mdW5jdGlvbiBKbihlLCBuKSB7dmFyIHQsaSA9IGUucmlnaHQudGFpbF9ub2RlKCk7aWYgKGkgIT09IGUucmlnaHQgJiYgKCh0ID0gZS5yaWdodC5leHByZXNzaW9ucy5zbGljZSgwLCAtMSkpLnB1c2goaS5sZWZ0KSwgKGkgPSBpLmNsb25lKCkpLmxlZnQgPSB3ZShlLnJpZ2h0LCB0KSwgZS5yaWdodCA9IGkpLCBlLmxlZnQgPSBrZShBU1RfQmluYXJ5LCBlLCB7IG9wZXJhdG9yOiBlLm9wZXJhdG9yLCBsZWZ0OiBlLmxlZnQsIHJpZ2h0OiBpLmxlZnQsIHN0YXJ0OiBlLmxlZnQuc3RhcnQsIGVuZDogaS5sZWZ0LmVuZCB9KSwgZS5yaWdodCA9IGkucmlnaHQsIG4pIHJldHVybiAodCA9IGUubGVmdC50cmFuc2Zvcm0obikpICE9PSBlLmxlZnQgJiYgKChlID0gZS5jbG9uZSgpKS5sZWZ0ID0gdCksIGU7ZS5vcGVyYXRvciA9PSBpLmxlZnQub3BlcmF0b3IgJiYgSm4oZS5sZWZ0KTt9ZnVuY3Rpb24gUW4oZSwgbiwgdCkge3ZhciBpID0gMCxyID0gZS5zZWxmKCk7ZG8ge2lmIChyID09PSB0KSByZXR1cm4gcjtpZiAodyhyKSAmJiByLm5hbWUgJiYgci5uYW1lLmRlZmluaXRpb24oKSA9PT0gbikgcmV0dXJuIHI7fSB3aGlsZSAociA9IGUucGFyZW50KGkrKykpO31mdW5jdGlvbiBabihlKSB7dmFyIG4gPSBlLnNjb3BlLnJlc29sdmUoKTtyZXR1cm4gYWxsKGUucmVmZXJlbmNlcywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gbiA9PT0gZS5zY29wZS5yZXNvbHZlKCk7fSk7fWZ1bmN0aW9uIGV0KGUsIG4pIHtyZXR1cm4gZS5vcHRpb24oInVuc2FmZSIpICYmIG4gaW5zdGFuY2VvZiBBU1RfRG90ICYmICJyYXciID09IG4ucHJvcGVydHkgJiYgRWUobi5leHByZXNzaW9uKSAmJiAiU3RyaW5nIiA9PSBuLmV4cHJlc3Npb24ubmFtZTt9ZnVuY3Rpb24gbnQoZSkge3ZhciB0ID0gITE7aWYgKGUgPSBlLnJlcGxhY2UoL1xcKHVce1tee31dKlx9P3x1W1xzXFNdezAsNH18eFtcc1xTXXswLDJ9fFswLTldK3xbXHNcU10pL2csIGZ1bmN0aW9uIChlLCBuKSB7biA9IGRlY29kZV9lc2NhcGVfc2VxdWVuY2Uobik7aWYgKCJzdHJpbmciID09IHR5cGVvZiBuKSByZXR1cm4gbjt0ID0gITA7fSksICF0KSByZXR1cm4gZTt9ZnVuY3Rpb24gdHQoZSwgbikge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiB8fCBlLlRZUEUgPT09IG4uVFlQRTt9ZnVuY3Rpb24gaXQodCwgbikge3ZhciBpID0gITEsciA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuICEhaSB8fCAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgbWVtYmVyKGUuZGVmaW5pdGlvbigpLCBuKSA/IGkgPSAhMCA6IHZvaWQgMCk7fSksbyA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7aWYgKGkpIHJldHVybiAhMDtpZiAoZSBpbnN0YW5jZW9mIEFTVF9MYW1iZGEgJiYgZSAhPT0gdCkge2lmICghKGUubmFtZSB8fCBpc19hc3luYyhlKSB8fCBpc19nZW5lcmF0b3IoZSkpKSB7dmFyIG4gPSBvLnBhcmVudCgpO2lmIChuIGluc3RhbmNlb2YgQVNUX0NhbGwgJiYgbi5leHByZXNzaW9uID09PSBlKSByZXR1cm47fXJldHVybiBlLndhbGsociksICEwO319KTtyZXR1cm4gdC53YWxrKG8pLCBpO31lKEFTVF9CaW5hcnksIGZ1bmN0aW9uICh0LCByKSB7aWYgKCFZblt0Lm9wZXJhdG9yXSB8fCAhdC5yaWdodC5pc19jb25zdGFudCgpIHx8IHQubGVmdC5pc19jb25zdGFudCgpIHx8IHQubGVmdCBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgUFJFQ0VERU5DRVt0LmxlZnQub3BlcmF0b3JdID49IFBSRUNFREVOQ0VbdC5vcGVyYXRvcl0gfHwgaygpLCByLm9wdGlvbigic2VxdWVuY2VzIikpIHt2YXIgZSA9IHQubGlmdF9zZXF1ZW5jZXMocik7aWYgKGUgIT09IHQpIHJldHVybiBlLm9wdGltaXplKHIpO31pZiAoci5vcHRpb24oImFzc2lnbm1lbnRzIikgJiYgTmVbdC5vcGVyYXRvcl0pIHt2YXIgbixpID0gJG4odC5sZWZ0LCByKSxlID0gdC5yaWdodDtpZiAoaSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgZSBpbnN0YW5jZW9mIEFTVF9Bc3NpZ24gJiYgIj0iID09IGUub3BlcmF0b3IgJiYgaS5lcXVhbHMoZS5sZWZ0KSkgcmV0dXJuIGkgPSBpLmNsb25lKCksIG4gPSBrZShBU1RfQXNzaWduLCB0LCB7IG9wZXJhdG9yOiAiPSIsIGxlZnQ6IGksIHJpZ2h0OiBrZShBU1RfQmluYXJ5LCB0LCB7IG9wZXJhdG9yOiB0Lm9wZXJhdG9yLCBsZWZ0OiB0LmxlZnQsIHJpZ2h0OiBlLnJpZ2h0IH0pIH0pLCBpLmZpeGVkICYmIChpLmZpeGVkID0gZnVuY3Rpb24gKCkge3JldHVybiBuLnJpZ2h0O30sIGkuZml4ZWQuYXNzaWducyA9IFtuXSksIChlID0gaS5kZWZpbml0aW9uKCkpLnJlZmVyZW5jZXMucHVzaChpKSwgZS5yZXBsYWNlZCsrLCBuLm9wdGltaXplKHIpO31pZiAoci5vcHRpb24oImNvbXBhcmlzb25zIikpIHN3aXRjaCAodC5vcGVyYXRvcikge2Nhc2UgIj09PSI6Y2FzZSAiIT09IjppZiAoQ2UodC5sZWZ0LCByKSAmJiB0LnJpZ2h0LmlzX2RlZmluZWQocikpIHJldHVybiBBU1RfTm9kZS53YXJuKCJFeHByZXNzaW9uIGFsd2F5cyBkZWZpbmVkIFt7c3RhcnR9XSIsIHQpLCB3ZSh0LCBbdC5yaWdodCwga2UoIj09PSIgPT0gdC5vcGVyYXRvciA/IEFTVF9GYWxzZSA6IEFTVF9UcnVlLCB0KV0pLm9wdGltaXplKHIpO3ZhciBvID0gITA7KHQubGVmdC5pc19zdHJpbmcocikgJiYgdC5yaWdodC5pc19zdHJpbmcocikgfHwgdC5sZWZ0LmlzX251bWJlcihyKSAmJiB0LnJpZ2h0LmlzX251bWJlcihyKSB8fCB0LmxlZnQuaXNfYm9vbGVhbihyKSAmJiB0LnJpZ2h0LmlzX2Jvb2xlYW4ocikgfHwgWG4ociwgdC5sZWZ0KSAmJiB0LmxlZnQuZXF1YWxzKHQucmlnaHQpKSAmJiAodC5vcGVyYXRvciA9IHQub3BlcmF0b3Iuc2xpY2UoMCwgMikpO2Nhc2UgIj09IjpjYXNlICIhPSI6aWYgKCFvICYmIENlKHQubGVmdCwgcikpIHQubGVmdCA9IGtlKEFTVF9OdWxsLCB0LmxlZnQpO2Vsc2UgaWYgKHIub3B0aW9uKCJ0eXBlb2ZzIikgJiYgdC5sZWZ0IGluc3RhbmNlb2YgQVNUX1N0cmluZyAmJiAidW5kZWZpbmVkIiA9PSB0LmxlZnQudmFsdWUgJiYgdC5yaWdodCBpbnN0YW5jZW9mIEFTVF9VbmFyeVByZWZpeCAmJiAidHlwZW9mIiA9PSB0LnJpZ2h0Lm9wZXJhdG9yKSAoKGEgPSB0LnJpZ2h0LmV4cHJlc3Npb24pIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiA/ICFhLmlzX2RlY2xhcmVkKHIpIDogYSBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzICYmIHIub3B0aW9uKCJpZSIpKSB8fCAodC5yaWdodCA9IGEsIHQubGVmdCA9IGtlKEFTVF9VbmRlZmluZWQsIHQubGVmdCkub3B0aW1pemUociksIDIgPT0gdC5vcGVyYXRvci5sZW5ndGggJiYgKHQub3BlcmF0b3IgKz0gIj0iKSk7ZWxzZSBpZiAodC5sZWZ0IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiB0LnJpZ2h0IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiB0LmxlZnQuZGVmaW5pdGlvbigpID09PSB0LnJpZ2h0LmRlZmluaXRpb24oKSAmJiBLbih0LmxlZnQpKSByZXR1cm4ga2UoIj0iID09IHQub3BlcmF0b3JbMF0gPyBBU1RfVHJ1ZSA6IEFTVF9GYWxzZSwgdCkub3B0aW1pemUocik7YnJlYWs7Y2FzZSAiJiYiOmNhc2UgInx8Ijp2YXIgYSxvID0gdC5sZWZ0O2lmIChvIGluc3RhbmNlb2YgQVNUX0JpbmFyeSAmJiBvLm9wZXJhdG9yID09ICgiJiYiID09IHQub3BlcmF0b3IgPyAiIT09IiA6ICI9PT0iKSAmJiB0LnJpZ2h0IGluc3RhbmNlb2YgQVNUX0JpbmFyeSAmJiBvLm9wZXJhdG9yID09IHQucmlnaHQub3BlcmF0b3IgJiYgKENlKG8ubGVmdCwgcikgJiYgdC5yaWdodC5sZWZ0IGluc3RhbmNlb2YgQVNUX051bGwgfHwgby5sZWZ0IGluc3RhbmNlb2YgQVNUX051bGwgJiYgQ2UodC5yaWdodC5sZWZ0LCByKSkpIHtpZiAoKGEgPSAoYSA9IG8ucmlnaHQpIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiAmJiAiPSIgPT0gYS5vcGVyYXRvciA/IGEubGVmdCA6IGEpLmhhc19zaWRlX2VmZmVjdHMocikpIGJyZWFrO2lmIChhLmVxdWFscyh0LnJpZ2h0LnJpZ2h0KSkgcmV0dXJuIG8ub3BlcmF0b3IgPSBvLm9wZXJhdG9yLnNsaWNlKDAsIC0xKSwgby5sZWZ0ID0ga2UoQVNUX051bGwsIHQpLCBvO319dmFyIHMsZixjID0gITEsbCA9IHIucGFyZW50KCk7aWYgKHIub3B0aW9uKCJib29sZWFucyIpKSB7aSA9ICRuKHQubGVmdCwgcik7aWYgKE5lW3Qub3BlcmF0b3JdICYmICFpLmhhc19zaWRlX2VmZmVjdHMocikpIHtpZiAoaS5lcXVhbHModC5yaWdodCkpIHJldHVybiBEZShsLCByLnNlbGYoKSwgdC5sZWZ0KS5vcHRpbWl6ZShyKTtObihyLCBpKTt9YyA9IHIuaW5fYm9vbGVhbl9jb250ZXh0KCk7fWlmIChjKSBzd2l0Y2ggKHQub3BlcmF0b3IpIHtjYXNlICIrIjp2YXIgdSA9IHQubGVmdC5ldmFsdWF0ZShyLCAhMCk7aWYgKHUgJiYgInN0cmluZyIgPT0gdHlwZW9mIHUgfHwgKHUgPSB0LnJpZ2h0LmV2YWx1YXRlKHIsICEwKSkgJiYgInN0cmluZyIgPT0gdHlwZW9mIHUpIHtBU1RfTm9kZS53YXJuKCIrIGluIGJvb2xlYW4gY29udGV4dCBhbHdheXMgdHJ1ZSBbe3N0YXJ0fV0iLCB0KTt2YXIgXyA9IFtdO3N3aXRjaCAodC5sZWZ0LmV2YWx1YXRlKHIpIGluc3RhbmNlb2YgQVNUX05vZGUgJiYgXy5wdXNoKHQubGVmdCksIHQucmlnaHQuZXZhbHVhdGUocikgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiBfLnB1c2godC5yaWdodCksIF8ubGVuZ3RoKSB7Y2FzZSAwOnJldHVybiBrZShBU1RfVHJ1ZSwgdCkub3B0aW1pemUocik7Y2FzZSAxOnJldHVybiBfWzBdID0gX1swXS5jbG9uZSgpLCBfLnB1c2goa2UoQVNUX1RydWUsIHQpKSwgd2UodCwgXykub3B0aW1pemUocik7fXQudHJ1dGh5ID0gITA7fWJyZWFrO2Nhc2UgIj09IjppZiAodC5sZWZ0IGluc3RhbmNlb2YgQVNUX1N0cmluZyAmJiAiIiA9PSB0LmxlZnQudmFsdWUgJiYgdC5yaWdodC5pc19zdHJpbmcocikpIHJldHVybiBrZShBU1RfVW5hcnlQcmVmaXgsIHQsIHsgb3BlcmF0b3I6ICIhIiwgZXhwcmVzc2lvbjogdC5yaWdodCB9KS5vcHRpbWl6ZShyKTticmVhaztjYXNlICIhPSI6aWYgKHQubGVmdCBpbnN0YW5jZW9mIEFTVF9TdHJpbmcgJiYgIiIgPT0gdC5sZWZ0LnZhbHVlICYmIHQucmlnaHQuaXNfc3RyaW5nKHIpKSByZXR1cm4gdC5yaWdodC5vcHRpbWl6ZShyKTt9aWYgKHIub3B0aW9uKCJjb21wYXJpc29ucyIpICYmIHQuaXNfYm9vbGVhbihyKSkge2lmICgiQmluYXJ5IiAhPSBsLlRZUEUpIHtlID0ga2UoQVNUX1VuYXJ5UHJlZml4LCB0LCB7IG9wZXJhdG9yOiAiISIsIGV4cHJlc3Npb246IHQubmVnYXRlKHIpIH0pO2lmIChNZShyLCB0LCBlKSA9PT0gZSkgcmV0dXJuIGU7fXN3aXRjaCAodC5vcGVyYXRvcikge2Nhc2UgIj4iOmsoIjwiKTticmVhaztjYXNlICI+PSI6aygiPD0iKTt9fWlmIChyLm9wdGlvbigiY29uZGl0aW9uYWxzIikgJiYgTmVbdC5vcGVyYXRvcl0gJiYgKHQubGVmdCBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgdC5vcGVyYXRvciA9PSB0LmxlZnQub3BlcmF0b3IgJiYgKHMgPSAoZSA9IGtlKEFTVF9CaW5hcnksIHQsIHsgb3BlcmF0b3I6IHQub3BlcmF0b3IsIGxlZnQ6IHQubGVmdC5yaWdodCwgcmlnaHQ6IHQucmlnaHQgfSkpLnRyYW5zZm9ybShyKSwgZSAhPT0gcykgJiYgKHQubGVmdCA9IHQubGVmdC5sZWZ0LCB0LnJpZ2h0ID0gcyksIChTID0gdC5yaWdodC50YWlsX25vZGUoKSkgaW5zdGFuY2VvZiBBU1RfQmluYXJ5KSAmJiB0Lm9wZXJhdG9yID09IFMub3BlcmF0b3IgJiYgKHQgPSBKbih0LCByKSksIHIub3B0aW9uKCJzdHJpbmdzIikgJiYgIisiID09IHQub3BlcmF0b3IpIHtpZiAodC5yaWdodCBpbnN0YW5jZW9mIEFTVF9TdHJpbmcgJiYgIiIgPT0gdC5yaWdodC52YWx1ZSAmJiB0LmxlZnQuaXNfc3RyaW5nKHIpKSByZXR1cm4gdC5sZWZ0Lm9wdGltaXplKHIpO2lmICh0LmxlZnQgaW5zdGFuY2VvZiBBU1RfU3RyaW5nICYmICIiID09IHQubGVmdC52YWx1ZSAmJiB0LnJpZ2h0LmlzX3N0cmluZyhyKSkgcmV0dXJuIHQucmlnaHQub3B0aW1pemUocik7aWYgKHQubGVmdCBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgIisiID09IHQubGVmdC5vcGVyYXRvciAmJiB0LmxlZnQubGVmdCBpbnN0YW5jZW9mIEFTVF9TdHJpbmcgJiYgIiIgPT0gdC5sZWZ0LmxlZnQudmFsdWUgJiYgdC5yaWdodC5pc19zdHJpbmcocikgJiYgKHQubGVmdC5yaWdodC5pc19jb25zdGFudCgpIHx8ICF0LnJpZ2h0Lmhhc19zaWRlX2VmZmVjdHMocikpKSByZXR1cm4gdC5sZWZ0ID0gdC5sZWZ0LnJpZ2h0LCB0Lm9wdGltaXplKHIpOyhTID0gdC5yaWdodC50YWlsX25vZGUoKSkgaW5zdGFuY2VvZiBBU1RfQmluYXJ5ICYmIHQub3BlcmF0b3IgPT0gUy5vcGVyYXRvciAmJiAodC5sZWZ0LmlzX3N0cmluZyhyKSAmJiBTLmlzX3N0cmluZyhyKSB8fCBTLmxlZnQuaXNfc3RyaW5nKHIpICYmICh0LmxlZnQuaXNfY29uc3RhbnQoKSB8fCAhUy5yaWdodC5oYXNfc2lkZV9lZmZlY3RzKHIpKSkgJiYgKHQgPSBKbih0LCByKSk7fWlmIChyLm9wdGlvbigiZXZhbHVhdGUiKSkge3ZhciBTLHAgPSAhMDtzd2l0Y2ggKHQub3BlcmF0b3IpIHtjYXNlICImJiI6aWYgKCEoVCA9IE4ociwgdC5sZWZ0KSkpIHJldHVybiBBU1RfTm9kZS53YXJuKCJDb25kaXRpb24gbGVmdCBvZiAmJiBhbHdheXMgZmFsc2UgW3tzdGFydH1dIiwgdCksIERlKGwsIHIuc2VsZigpLCB0LmxlZnQpLm9wdGltaXplKHIpO2lmICghKFQgaW5zdGFuY2VvZiBBU1RfTm9kZSkpIHJldHVybiBBU1RfTm9kZS53YXJuKCJDb25kaXRpb24gbGVmdCBvZiAmJiBhbHdheXMgdHJ1ZSBbe3N0YXJ0fV0iLCB0KSwgd2UodCwgW3QubGVmdCwgdC5yaWdodF0pLm9wdGltaXplKHIpO2lmICh0LnJpZ2h0LmV2YWx1YXRlKHIsICEwKSkge2lmICgoYyB8fCAiJiYiID09IGwub3BlcmF0b3IgJiYgbC5sZWZ0ID09PSByLnNlbGYoKSkgJiYgISh0LnJpZ2h0LmV2YWx1YXRlKHIpIGluc3RhbmNlb2YgQVNUX05vZGUpKSByZXR1cm4gQVNUX05vZGUud2FybigiRHJvcHBpbmcgc2lkZS1lZmZlY3QtZnJlZSAmJiBbe3N0YXJ0fV0iLCB0KSwgdC5sZWZ0Lm9wdGltaXplKHIpO30gZWxzZSB7aWYgKGMgJiYgISh0LnJpZ2h0LmV2YWx1YXRlKHIpIGluc3RhbmNlb2YgQVNUX05vZGUpKSByZXR1cm4gQVNUX05vZGUud2FybigiQm9vbGVhbiAmJiBhbHdheXMgZmFsc2UgW3tzdGFydH1dIiwgdCksIHdlKHQsIFt0LmxlZnQsIGtlKEFTVF9GYWxzZSwgdCldKS5vcHRpbWl6ZShyKTt0LmZhbHN5ID0gITA7fWlmICgifHwiID09IHQubGVmdC5vcGVyYXRvcikgaWYgKCEoQSA9IE4ociwgdC5sZWZ0LnJpZ2h0KSkpIHJldHVybiBrZShBU1RfQ29uZGl0aW9uYWwsIHQsIHsgY29uZGl0aW9uOiB0LmxlZnQubGVmdCwgY29uc2VxdWVudDogdC5yaWdodCwgYWx0ZXJuYXRpdmU6IHQubGVmdC5yaWdodCB9KS5vcHRpbWl6ZShyKTticmVhaztjYXNlICI/PyI6dmFyIGQgPSAhMDtjYXNlICJ8fCI6dmFyIEEsVCA9IE4ociwgdC5sZWZ0LCBkKTtpZiAoZCA/IG51bGwgPT0gVCA6ICFUKSByZXR1cm4gQVNUX05vZGUud2FybigiQ29uZGl0aW9uIGxlZnQgb2Yge29wZXJhdG9yfSBhbHdheXMge3ZhbHVlfSBbe3N0YXJ0fV0iLCB7IG9wZXJhdG9yOiB0Lm9wZXJhdG9yLCB2YWx1ZTogZCA/ICJudWxsaXNoIiA6ICJmYWxzZSIsIHN0YXJ0OiB0LnN0YXJ0IH0pLCB3ZSh0LCBbdC5sZWZ0LCB0LnJpZ2h0XSkub3B0aW1pemUocik7aWYgKCEoVCBpbnN0YW5jZW9mIEFTVF9Ob2RlKSkgcmV0dXJuIEFTVF9Ob2RlLndhcm4oIkNvbmRpdGlvbiBsZWZ0IG9mIHtvcGVyYXRvcn0gYWx3YXlzIHt2YWx1ZX0gW3tzdGFydH1dIiwgeyBvcGVyYXRvcjogdC5vcGVyYXRvciwgdmFsdWU6IGQgPyAiZGVmaW5lZCIgOiAidHJ1ZSIsIHN0YXJ0OiB0LnN0YXJ0IH0pLCBEZShsLCByLnNlbGYoKSwgdC5sZWZ0KS5vcHRpbWl6ZShyKTtpZiAoZCB8fCAhKFQgPSB0LnJpZ2h0LmV2YWx1YXRlKHIsICEwKSkgfHwgVCBpbnN0YW5jZW9mIEFTVF9Ob2RlKSB7aWYgKChjIHx8ICJ8fCIgPT0gbC5vcGVyYXRvciAmJiBsLmxlZnQgPT09IHIuc2VsZigpKSAmJiAhdC5yaWdodC5ldmFsdWF0ZShyKSkgcmV0dXJuIEFTVF9Ob2RlLndhcm4oIkRyb3BwaW5nIHNpZGUtZWZmZWN0LWZyZWUge29wZXJhdG9yfSBbe3N0YXJ0fV0iLCB0KSwgdC5sZWZ0Lm9wdGltaXplKHIpO30gZWxzZSB7aWYgKGMgJiYgISh0LnJpZ2h0LmV2YWx1YXRlKHIpIGluc3RhbmNlb2YgQVNUX05vZGUpKSByZXR1cm4gQVNUX05vZGUud2FybigiQm9vbGVhbiB8fCBhbHdheXMgdHJ1ZSBbe3N0YXJ0fV0iLCB0KSwgd2UodCwgW3QubGVmdCwga2UoQVNUX1RydWUsIHQpXSkub3B0aW1pemUocik7dC50cnV0aHkgPSAhMDt9aWYgKCFkICYmICImJiIgPT0gdC5sZWZ0Lm9wZXJhdG9yKSBpZiAoKEEgPSBOKHIsIHQubGVmdC5yaWdodCkpICYmICEoQSBpbnN0YW5jZW9mIEFTVF9Ob2RlKSkgcmV0dXJuIGtlKEFTVF9Db25kaXRpb25hbCwgdCwgeyBjb25kaXRpb246IHQubGVmdC5sZWZ0LCBjb25zZXF1ZW50OiB0LmxlZnQucmlnaHQsIGFsdGVybmF0aXZlOiB0LnJpZ2h0IH0pLm9wdGltaXplKHIpO2JyZWFrO2Nhc2UgIisiOmlmICgodCA9ICh0ID0gdC5sZWZ0IGluc3RhbmNlb2YgQVNUX0NvbnN0YW50ICYmIHQucmlnaHQgaW5zdGFuY2VvZiBBU1RfQmluYXJ5ICYmICIrIiA9PSB0LnJpZ2h0Lm9wZXJhdG9yICYmIHQucmlnaHQubGVmdCBpbnN0YW5jZW9mIEFTVF9Db25zdGFudCAmJiB0LnJpZ2h0LmlzX3N0cmluZyhyKSA/IGtlKEFTVF9CaW5hcnksIHQsIHsgb3BlcmF0b3I6ICIrIiwgbGVmdDoga2UoQVNUX1N0cmluZywgdC5sZWZ0LCB7IHZhbHVlOiAiIiArIHQubGVmdC52YWx1ZSArIHQucmlnaHQubGVmdC52YWx1ZSwgc3RhcnQ6IHQubGVmdC5zdGFydCwgZW5kOiB0LnJpZ2h0LmxlZnQuZW5kIH0pLCByaWdodDogdC5yaWdodC5yaWdodCB9KSA6IHQpLnJpZ2h0IGluc3RhbmNlb2YgQVNUX0NvbnN0YW50ICYmIHQubGVmdCBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgIisiID09IHQubGVmdC5vcGVyYXRvciAmJiB0LmxlZnQucmlnaHQgaW5zdGFuY2VvZiBBU1RfQ29uc3RhbnQgJiYgdC5sZWZ0LmlzX3N0cmluZyhyKSA/IGtlKEFTVF9CaW5hcnksIHQsIHsgb3BlcmF0b3I6ICIrIiwgbGVmdDogdC5sZWZ0LmxlZnQsIHJpZ2h0OiBrZShBU1RfU3RyaW5nLCB0LnJpZ2h0LCB7IHZhbHVlOiAiIiArIHQubGVmdC5yaWdodC52YWx1ZSArIHQucmlnaHQudmFsdWUsIHN0YXJ0OiB0LmxlZnQucmlnaHQuc3RhcnQsIGVuZDogdC5yaWdodC5lbmQgfSkgfSkgOiB0KS5yaWdodCBpbnN0YW5jZW9mIEFTVF9VbmFyeVByZWZpeCAmJiAiLSIgPT0gdC5yaWdodC5vcGVyYXRvciAmJiB0LmxlZnQuaXNfbnVtYmVyKHIpKSB7dCA9IGtlKEFTVF9CaW5hcnksIHQsIHsgb3BlcmF0b3I6ICItIiwgbGVmdDogdC5sZWZ0LCByaWdodDogdC5yaWdodC5leHByZXNzaW9uIH0pO2JyZWFrO31pZiAodC5sZWZ0IGluc3RhbmNlb2YgQVNUX1VuYXJ5UHJlZml4ICYmICItIiA9PSB0LmxlZnQub3BlcmF0b3IgJiYgeCgpICYmIHQucmlnaHQuaXNfbnVtYmVyKHIpKSB7dCA9IGtlKEFTVF9CaW5hcnksIHQsIHsgb3BlcmF0b3I6ICItIiwgbGVmdDogdC5yaWdodCwgcmlnaHQ6IHQubGVmdC5leHByZXNzaW9uIH0pO2JyZWFrO31pZiAoci5vcHRpb24oInVuc2FmZV9tYXRoIikgJiYgdC5sZWZ0IGluc3RhbmNlb2YgQVNUX0JpbmFyeSAmJiBQUkVDRURFTkNFW3QubGVmdC5vcGVyYXRvcl0gPT0gUFJFQ0VERU5DRVt0Lm9wZXJhdG9yXSAmJiB0LnJpZ2h0LmlzX2NvbnN0YW50KCkgJiYgKHQucmlnaHQuaXNfYm9vbGVhbihyKSB8fCB0LnJpZ2h0LmlzX251bWJlcihyKSkgJiYgdC5sZWZ0LmlzX251bWJlcihyKSAmJiAhdC5sZWZ0LnJpZ2h0LmlzX2NvbnN0YW50KCkgJiYgKHQubGVmdC5sZWZ0LmlzX2Jvb2xlYW4ocikgfHwgdC5sZWZ0LmxlZnQuaXNfbnVtYmVyKHIpKSkge3QgPSBrZShBU1RfQmluYXJ5LCB0LCB7IG9wZXJhdG9yOiB0LmxlZnQub3BlcmF0b3IsIGxlZnQ6IGtlKEFTVF9CaW5hcnksIHQsIHsgb3BlcmF0b3I6IHQub3BlcmF0b3IsIGxlZnQ6IHQucmlnaHQsIHJpZ2h0OiB0LmxlZnQubGVmdCB9KSwgcmlnaHQ6IHQubGVmdC5yaWdodCB9KTticmVhazt9Y2FzZSAiLSI6aWYgKHQucmlnaHQgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgIi0iID09IHQucmlnaHQub3BlcmF0b3IgJiYgdC5sZWZ0LmlzX251bWJlcihyKSAmJiB0LnJpZ2h0LmV4cHJlc3Npb24uaXNfbnVtYmVyKHIpKSB7dCA9IGtlKEFTVF9CaW5hcnksIHQsIHsgb3BlcmF0b3I6ICIrIiwgbGVmdDogdC5sZWZ0LCByaWdodDogdC5yaWdodC5leHByZXNzaW9uIH0pO2JyZWFrO31jYXNlICIqIjpjYXNlICIvIjpwID0gci5vcHRpb24oInVuc2FmZV9tYXRoIiksICIrIiAhPSB0Lm9wZXJhdG9yICYmIFsibGVmdCIsICJyaWdodCJdLmZvckVhY2goZnVuY3Rpb24gKGUpIHt2YXIgbiA9IHRbZV07biBpbnN0YW5jZW9mIEFTVF9VbmFyeVByZWZpeCAmJiAiKyIgPT0gbi5vcGVyYXRvciAmJiAoKG4gPSBuLmV4cHJlc3Npb24pLmlzX2Jvb2xlYW4ocikgfHwgbi5pc19udW1iZXIocikgfHwgbi5pc19zdHJpbmcocikpICYmICh0W2VdID0gbik7fSk7Y2FzZSAiJiI6Y2FzZSAifCI6Y2FzZSAiXiI6Ii0iID09IHQub3BlcmF0b3IgfHwgIi8iID09IHQub3BlcmF0b3IgfHwgIXQubGVmdC5pc19ib29sZWFuKHIpICYmICF0LmxlZnQuaXNfbnVtYmVyKHIpIHx8ICF0LnJpZ2h0LmlzX2Jvb2xlYW4ocikgJiYgIXQucmlnaHQuaXNfbnVtYmVyKHIpIHx8ICF4KCkgfHwgdC5sZWZ0IGluc3RhbmNlb2YgQVNUX0JpbmFyeSAmJiB0LmxlZnQub3BlcmF0b3IgIT0gdC5vcGVyYXRvciAmJiBQUkVDRURFTkNFW3QubGVmdC5vcGVyYXRvcl0gPj0gUFJFQ0VERU5DRVt0Lm9wZXJhdG9yXSB8fCAodCA9IE1lKHIsIHQsIGtlKEFTVF9CaW5hcnksIHQsIHsgb3BlcmF0b3I6IHQub3BlcmF0b3IsIGxlZnQ6IHQucmlnaHQsIHJpZ2h0OiB0LmxlZnQgfSksIHQucmlnaHQgaW5zdGFuY2VvZiBBU1RfQ29uc3RhbnQgJiYgISh0LmxlZnQgaW5zdGFuY2VvZiBBU1RfQ29uc3RhbnQpKSksIHAgJiYgdC5pc19udW1iZXIocikgJiYgKCEodC5yaWdodCBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgIiUiICE9IHQucmlnaHQub3BlcmF0b3IgJiYgUFJFQ0VERU5DRVt0LnJpZ2h0Lm9wZXJhdG9yXSA9PSBQUkVDRURFTkNFW3Qub3BlcmF0b3JdICYmIHQucmlnaHQuaXNfbnVtYmVyKHIpICYmICgiKyIgIT0gdC5vcGVyYXRvciB8fCB0LnJpZ2h0LmxlZnQuaXNfYm9vbGVhbihyKSB8fCB0LnJpZ2h0LmxlZnQuaXNfbnVtYmVyKHIpKSkgfHwgIi0iID09IHQub3BlcmF0b3IgJiYgdC5sZWZ0LmlzX25lZ2F0aXZlX3plcm8oKSB8fCAhdC5yaWdodC5sZWZ0LmlzX2NvbnN0YW50X2V4cHJlc3Npb24oKSAmJiB0LnJpZ2h0LnJpZ2h0Lmhhc19zaWRlX2VmZmVjdHMocikgfHwgKFQgPSB0LnJpZ2h0LnJpZ2h0LCBmID0gITEsIFQud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge2lmIChmKSByZXR1cm4gITA7aWYgKGUgaW5zdGFuY2VvZiBBU1RfQXNzaWduKSB7aWYgKGUubGVmdCBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzKSByZXR1cm4gZiA9ICEwO30gZWxzZSBpZiAoZSBpbnN0YW5jZW9mIEFTVF9VbmFyeSAmJiB1bmFyeV9zaWRlX2VmZmVjdHNbZS5vcGVyYXRvcl0gJiYgZS5leHByZXNzaW9uIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpIHJldHVybiBmID0gITA7fSkpLCBmKSB8fCAiKyIgIT0gKHQgPSBrZShBU1RfQmluYXJ5LCB0LCB7IG9wZXJhdG9yOiB5KHQub3BlcmF0b3IsIHQucmlnaHQub3BlcmF0b3IpLCBsZWZ0OiBrZShBU1RfQmluYXJ5LCB0LmxlZnQsIHsgb3BlcmF0b3I6IHQub3BlcmF0b3IsIGxlZnQ6IHQubGVmdCwgcmlnaHQ6IHQucmlnaHQubGVmdCwgc3RhcnQ6IHQubGVmdC5zdGFydCwgZW5kOiB0LnJpZ2h0LmxlZnQuZW5kIH0pLCByaWdodDogdC5yaWdodC5yaWdodCB9KSkub3BlcmF0b3IgfHwgdC5yaWdodC5pc19ib29sZWFuKHIpIHx8IHQucmlnaHQuaXNfbnVtYmVyKHIpIHx8ICh0LnJpZ2h0ID0ga2UoQVNUX1VuYXJ5UHJlZml4LCB0LnJpZ2h0LCB7IG9wZXJhdG9yOiAiKyIsIGV4cHJlc3Npb246IHQucmlnaHQgfSkpLCB0LnJpZ2h0IGluc3RhbmNlb2YgQVNUX0NvbnN0YW50KSAmJiB0LmxlZnQgaW5zdGFuY2VvZiBBU1RfQmluYXJ5ICYmICIlIiAhPSB0LmxlZnQub3BlcmF0b3IgJiYgUFJFQ0VERU5DRVt0LmxlZnQub3BlcmF0b3JdID09IFBSRUNFREVOQ0VbdC5vcGVyYXRvcl0gJiYgdC5sZWZ0LmlzX251bWJlcihyKSAmJiAodC5sZWZ0LmxlZnQgaW5zdGFuY2VvZiBBU1RfQ29uc3RhbnQgPyAoaSA9IGcodC5vcGVyYXRvciwgdC5sZWZ0LmxlZnQsIHQucmlnaHQsIHsgc3RhcnQ6IHQubGVmdC5sZWZ0LnN0YXJ0LCBlbmQ6IHQucmlnaHQuZW5kIH0pLCB0ID0gZyh0LmxlZnQub3BlcmF0b3IsIEsociwgaSksIHQubGVmdC5yaWdodCwgdCkpIDogdC5sZWZ0LnJpZ2h0IGluc3RhbmNlb2YgQVNUX0NvbnN0YW50ICYmIChkID0geSh0LmxlZnQub3BlcmF0b3IsIHQub3BlcmF0b3IpLCAhKFMgPSBLKHIsIGcoZCwgdC5sZWZ0LnJpZ2h0LCB0LnJpZ2h0LCB0LmxlZnQpKSkuaXNfY29uc3RhbnQoKSB8fCAiLSIgPT0gdC5sZWZ0Lm9wZXJhdG9yICYmIDAgIT0gdC5yaWdodC52YWx1ZSAmJiAwID09ICtTLnZhbHVlICYmIHQubGVmdC5sZWZ0LmlzX25lZ2F0aXZlX3plcm8oKSB8fCAodCA9IGcodC5sZWZ0Lm9wZXJhdG9yLCB0LmxlZnQubGVmdCwgUywgdCkpKSk7YnJlYWs7Y2FzZSAiaW5zdGFuY2VvZiI6aWYgKEduKHQsIHIpICYmIHcodC5yaWdodCkpIHJldHVybiB3ZSh0LCBbdC5sZWZ0LCB0LnJpZ2h0LCBrZShBU1RfRmFsc2UsIHQpXSkub3B0aW1pemUocik7fWlmICghKGwgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgImRlbGV0ZSIgPT0gbC5vcGVyYXRvcikpIHtpZiAodC5sZWZ0IGluc3RhbmNlb2YgQVNUX051bWJlciAmJiAhdC5yaWdodC5pc19jb25zdGFudCgpKSBzd2l0Y2ggKHQub3BlcmF0b3IpIHtjYXNlICIrIjppZiAoMCA9PSB0LmxlZnQudmFsdWUpIHtpZiAodC5yaWdodC5pc19ib29sZWFuKHIpKSByZXR1cm4ga2UoQVNUX1VuYXJ5UHJlZml4LCB0LCB7IG9wZXJhdG9yOiAiKyIsIGV4cHJlc3Npb246IHQucmlnaHQgfSkub3B0aW1pemUocik7aWYgKHQucmlnaHQuaXNfbnVtYmVyKHIpICYmICF0LnJpZ2h0LmlzX25lZ2F0aXZlX3plcm8oKSkgcmV0dXJuIHQucmlnaHQ7fWJyZWFrO2Nhc2UgIioiOmlmICgxID09IHQubGVmdC52YWx1ZSkgcmV0dXJuIGtlKEFTVF9VbmFyeVByZWZpeCwgdCwgeyBvcGVyYXRvcjogIisiLCBleHByZXNzaW9uOiB0LnJpZ2h0IH0pLm9wdGltaXplKHIpO31pZiAodC5yaWdodCBpbnN0YW5jZW9mIEFTVF9OdW1iZXIgJiYgIXQubGVmdC5pc19jb25zdGFudCgpKSBzd2l0Y2ggKHQub3BlcmF0b3IpIHtjYXNlICIrIjppZiAoMCA9PSB0LnJpZ2h0LnZhbHVlKSB7aWYgKHQubGVmdC5pc19ib29sZWFuKHIpKSByZXR1cm4ga2UoQVNUX1VuYXJ5UHJlZml4LCB0LCB7IG9wZXJhdG9yOiAiKyIsIGV4cHJlc3Npb246IHQubGVmdCB9KS5vcHRpbWl6ZShyKTtpZiAodC5sZWZ0LmlzX251bWJlcihyKSAmJiAhdC5sZWZ0LmlzX25lZ2F0aXZlX3plcm8oKSkgcmV0dXJuIHQubGVmdDt9YnJlYWs7Y2FzZSAiLSI6aWYgKDAgPT0gdC5yaWdodC52YWx1ZSkgcmV0dXJuIGtlKEFTVF9VbmFyeVByZWZpeCwgdCwgeyBvcGVyYXRvcjogIisiLCBleHByZXNzaW9uOiB0LmxlZnQgfSkub3B0aW1pemUocik7YnJlYWs7Y2FzZSAiLyI6aWYgKDEgPT0gdC5yaWdodC52YWx1ZSkgcmV0dXJuIGtlKEFTVF9VbmFyeVByZWZpeCwgdCwgeyBvcGVyYXRvcjogIisiLCBleHByZXNzaW9uOiB0LmxlZnQgfSkub3B0aW1pemUocik7fX19aWYgKHIub3B0aW9uKCJ0eXBlb2ZzIikpIHN3aXRjaCAodC5vcGVyYXRvcikge2Nhc2UgIiYmIjp6KHQubGVmdCwgdC5yaWdodCwgbnVsbCk7YnJlYWs7Y2FzZSAifHwiOnoodC5sZWZ0LCBudWxsLCB0LnJpZ2h0KTt9aWYgKHIub3B0aW9uKCJ1bnNhZmUiKSkge3ZhciBoID0gYih0LnJpZ2h0KTtpZiAoYyAmJiBoICYmICgiPT0iID09IHQub3BlcmF0b3IgfHwgIiE9IiA9PSB0Lm9wZXJhdG9yKSAmJiB0LmxlZnQgaW5zdGFuY2VvZiBBU1RfTnVtYmVyICYmIDAgPT0gdC5sZWZ0LnZhbHVlKSByZXR1cm4gKCI9PSIgPT0gdC5vcGVyYXRvciA/IGtlKEFTVF9VbmFyeVByZWZpeCwgdCwgeyBvcGVyYXRvcjogIiEiLCBleHByZXNzaW9uOiB0LnJpZ2h0IH0pIDogdC5yaWdodCkub3B0aW1pemUocik7dmFyIG0gPSBiKHQubGVmdCk7aWYgKHIub3B0aW9uKCJjb21wYXJpc29ucyIpICYmIGZ1bmN0aW9uICgpIHtzd2l0Y2ggKHQub3BlcmF0b3IpIHtjYXNlICI8PSI6cmV0dXJuIGggJiYgdC5sZWZ0IGluc3RhbmNlb2YgQVNUX051bWJlciAmJiAwID09IHQubGVmdC52YWx1ZTtjYXNlICI8IjppZiAobSAmJiB0LnJpZ2h0IGluc3RhbmNlb2YgQVNUX051bWJlciAmJiAwID09IHQucmlnaHQudmFsdWUpIHJldHVybiAxO2Nhc2UgIj09IjpjYXNlICIhPSI6cmV0dXJuIGggPyB0LmxlZnQgaW5zdGFuY2VvZiBBU1RfTnVtYmVyICYmIC0xID09IHQubGVmdC52YWx1ZSB8fCB0LmxlZnQgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgIi0iID09IHQubGVmdC5vcGVyYXRvciAmJiB0LmxlZnQuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9OdW1iZXIgJiYgMSA9PSB0LmxlZnQuZXhwcmVzc2lvbi52YWx1ZSA6IHZvaWQgMDt9fSgpKSB7dmFyIHYgPSBrZShBU1RfVW5hcnlQcmVmaXgsIHQsIHsgb3BlcmF0b3I6ICIhIiwgZXhwcmVzc2lvbjoga2UoQVNUX1VuYXJ5UHJlZml4LCB0LCB7IG9wZXJhdG9yOiAifiIsIGV4cHJlc3Npb246IG0gPyB0LmxlZnQgOiB0LnJpZ2h0IH0pIH0pO3N3aXRjaCAodC5vcGVyYXRvcikge2Nhc2UgIjwiOmlmIChtKSBicmVhaztjYXNlICI8PSI6Y2FzZSAiIT0iOnYgPSBrZShBU1RfVW5hcnlQcmVmaXgsIHQsIHsgb3BlcmF0b3I6ICIhIiwgZXhwcmVzc2lvbjogdiB9KTt9cmV0dXJuIHYub3B0aW1pemUocik7fX1yZXR1cm4gSyhyLCB0KTtmdW5jdGlvbiB5KGUsIG4pIHtzd2l0Y2ggKGUpIHtjYXNlICItIjpyZXR1cm4gIisiID09IG4gPyAiLSIgOiAiKyI7Y2FzZSAiLyI6cmV0dXJuICIqIiA9PSBuID8gIi8iIDogIioiO2RlZmF1bHQ6cmV0dXJuIG47fX1mdW5jdGlvbiBnKGUsIG4sIHQsIGkpIHtyZXR1cm4gIisiID09IGUgJiYgKG4uaXNfYm9vbGVhbihyKSB8fCBuLmlzX251bWJlcihyKSB8fCAobiA9IGtlKEFTVF9VbmFyeVByZWZpeCwgbiwgeyBvcGVyYXRvcjogIisiLCBleHByZXNzaW9uOiBuIH0pKSwgdC5pc19ib29sZWFuKHIpIHx8IHQuaXNfbnVtYmVyKHIpIHx8ICh0ID0ga2UoQVNUX1VuYXJ5UHJlZml4LCB0LCB7IG9wZXJhdG9yOiAiKyIsIGV4cHJlc3Npb246IHQgfSkpKSwga2UoQVNUX0JpbmFyeSwgaSwgeyBvcGVyYXRvcjogZSwgbGVmdDogbiwgcmlnaHQ6IHQgfSk7fWZ1bmN0aW9uIGIoZSkge3JldHVybiAiQ2FsbCIgPT0gZS5UWVBFICYmIGUuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9Eb3QgJiYgV25bZS5leHByZXNzaW9uLnByb3BlcnR5XTt9ZnVuY3Rpb24geCgpIHtyZXR1cm4gdC5sZWZ0LmlzX2NvbnN0YW50KCkgfHwgdC5yaWdodC5pc19jb25zdGFudCgpIHx8ICF0LmxlZnQuaGFzX3NpZGVfZWZmZWN0cyhyKSAmJiAhdC5yaWdodC5oYXNfc2lkZV9lZmZlY3RzKHIpO31mdW5jdGlvbiBrKGUpIHt4KCkgJiYgKGUgJiYgKHQub3BlcmF0b3IgPSBlKSwgZSA9IHQubGVmdCwgdC5sZWZ0ID0gdC5yaWdodCwgdC5yaWdodCA9IGUpO319KSwgZShBU1RfU3ltYm9sRXhwb3J0LCBmdW5jdGlvbiAoZSkge3JldHVybiBlO30pLCBlKEFTVF9TeW1ib2xSZWYsIGZ1bmN0aW9uICh0LCBlKSB7aWYgKCFlLm9wdGlvbigiaWUiKSAmJiBFZSh0KSAmJiAoIXQuc2NvcGUucmVzb2x2ZSgpLnVzZXNfd2l0aCB8fCAhZS5maW5kX3BhcmVudChBU1RfV2l0aCkpKSBzd2l0Y2ggKHQubmFtZSkge2Nhc2UgInVuZGVmaW5lZCI6cmV0dXJuIGtlKEFTVF9VbmRlZmluZWQsIHQpLm9wdGltaXplKGUpO2Nhc2UgIk5hTiI6cmV0dXJuIGtlKEFTVF9OYU4sIHQpLm9wdGltaXplKGUpO2Nhc2UgIkluZmluaXR5IjpyZXR1cm4ga2UoQVNUX0luZmluaXR5LCB0KS5vcHRpbWl6ZShlKTt9dmFyIG4gPSBlLnBhcmVudCgpO2lmIChlLm9wdGlvbigicmVkdWNlX3ZhcnMiKSAmJiBpc19saHMoZS5zZWxmKCksIG4pICE9PSBlLnNlbGYoKSkge3ZhciBpLHIsbyxhLHMsZixjLGwsdSxfID0gdC5kZWZpbml0aW9uKCksUyA9IHQuZml4ZWRfdmFsdWUoKSxuID0gXy5zaW5nbGVfdXNlICYmICEobiBpbnN0YW5jZW9mIEFTVF9DYWxsICYmIG4uaXNfZXhwcl9wdXJlKGUpKTtpZiAobikgaWYgKHcoUykpIHtpZiAoXy5zY29wZSA9PT0gdC5zY29wZS5yZXNvbHZlKCEwKSAmJiAhXy5pbl9sb29wIHx8IGUub3B0aW9uKCJyZWR1Y2VfZnVuY3MiKSAmJiAxICE9IF8uZXNjYXBlZC5kZXB0aCAmJiAhUy5pbmxpbmVkKSB7aWYgKF8ucmVkZWZpbmVkKCkpIG4gPSAhMTtlbHNlIGlmIChRbihlLCBfLCBTKSkgbiA9ICExO2Vsc2UgaWYgKFMubmFtZSAmJiBTLm5hbWUuZGVmaW5pdGlvbigpICE9PSBfKSBuID0gITE7ZWxzZSBpZiAoUy5wYXJlbnRfc2NvcGUgIT09IHQuc2NvcGUgfHwgaXNfZnVuYXJnKF8pKSB7aWYgKFZuKFMsIGUpKSB7aWYgKCJmIiA9PSAobiA9IFMuaXNfY29uc3RhbnRfZXhwcmVzc2lvbih0LnNjb3BlKSkpIGZvciAodmFyIHAgPSB0LnNjb3BlOyAocCBpbnN0YW5jZW9mIEFTVF9MYW1iZGFEZWZpbml0aW9uIHx8IHAgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRXhwcmVzc2lvbikgJiYgKHAuaW5saW5lZCA9ICEwKSwgcCA9IHAucGFyZW50X3Njb3BlOyk7fSBlbHNlIG4gPSAhMTt9IGVsc2UgKFMubmFtZSAmJiAoImF3YWl0IiA9PSBTLm5hbWUubmFtZSAmJiBpc19hc3luYyhTKSB8fCAieWllbGQiID09IFMubmFtZS5uYW1lICYmIGlzX2dlbmVyYXRvcihTKSkgfHwgUy5oYXNfc2lkZV9lZmZlY3RzKGUpIHx8IFMgaW5zdGFuY2VvZiBBU1RfQ2xhc3MgJiYgKGUub3B0aW9uKCJpZSIpIHx8ICFTLmlzX2NvbnN0YW50X2V4cHJlc3Npb24odC5zY29wZSkpKSAmJiAobiA9ICExKTt9IGVsc2UgbiA9ICExO24gJiYgKFMucGFyZW50X3Njb3BlID0gdC5zY29wZSk7fSBlbHNlICghUyB8fCAwIDwgXy5yZWN1cnNpdmVfcmVmcyB8fCAhUy5pc19jb25zdGFudF9leHByZXNzaW9uKCkgfHwgUy5kcm9wX3NpZGVfZWZmZWN0X2ZyZWUoZSkpICYmIChuID0gITEpO2lmIChuKSB7aWYgKF8uc2luZ2xlX3VzZSA9ICExLCBTLl9zcXVlZXplZCA9ICEwLCBTLnNpbmdsZV91c2UgPSAhMCwgdyhTID0gKFMgPSBTIGluc3RhbmNlb2YgQVNUX0RlZkNsYXNzID8gbW4oUykgOiBTKSBpbnN0YW5jZW9mIEFTVF9MYW1iZGFEZWZpbml0aW9uID8gdm4oUykgOiBTKSkge3ZhciBkID0gW10scCA9IHQuc2NvcGU7ZG8ge2lmIChkLnB1c2gocCksIHAgPT09IF8uc2NvcGUpIGJyZWFrO30gd2hpbGUgKHAgPSBwLnBhcmVudF9zY29wZSk7Uy5lbmNsb3NlZC5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7aWYgKCFTLnZhcmlhYmxlcy5oYXMoZS5uYW1lKSkgZm9yICh2YXIgbiA9IDA7IG4gPCBkLmxlbmd0aDsgbisrKSB7dmFyIHQgPSBkW25dO2lmICghcHVzaF91bmlxKHQuZW5jbG9zZWQsIGUpKSByZXR1cm47dC52YXJfbmFtZXMoKS5zZXQoZS5uYW1lLCAhMCk7fX0pO31yZXR1cm4gMCA8IF8ucmVjdXJzaXZlX3JlZnMgPyAoaSA9ICh1ID0gUy5jbG9uZSghMCkpLm5hbWUuZGVmaW5pdGlvbigpLCByID0gdS52YXJpYWJsZXMuZ2V0KHUubmFtZS5uYW1lKSwgbyA9IHIgJiYgci5vcmlnWzBdLCBuID0gdSBpbnN0YW5jZW9mIEFTVF9DbGFzcyA/IChhID0gImRlZl9mdW5jdGlvbiIsIEFTVF9TeW1ib2xDbGFzcykgOiAoYSA9ICJkZWZfdmFyaWFibGUiLCBBU1RfU3ltYm9sTGFtYmRhKSwgbyBpbnN0YW5jZW9mIG4gfHwgKCgobyA9IGtlKG4sIHUubmFtZSkpLnNjb3BlID0gdSkubmFtZSA9IG8sIChyID0gdVthXShvKSkucmVjdXJzaXZlX3JlZnMgPSBfLnJlY3Vyc2l2ZV9yZWZzKSwgdS53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7dmFyIG4sIHQ7ZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xEZWNsYXJhdGlvbiA/IGUgIT09IG8gJiYgKChuID0gZS5kZWZpbml0aW9uKCkpLm9yaWcucHVzaChlKSwgbi5lbGltaW5hdGVkKyspIDogZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgKChuID0gZS5kZWZpbml0aW9uKCkpID09PSBpID8gZS50aGVkZWYgPSBuID0gciA6IChuLnNpbmdsZV91c2UgPSAhMSwgdyh0ID0gZS5maXhlZF92YWx1ZSgpKSAmJiB0Lm5hbWUgJiYgdC5uYW1lLmRlZmluaXRpb24oKSA9PT0gbiAmJiBuLnNjb3BlID09PSB0Lm5hbWUuc2NvcGUgJiYgUy52YXJpYWJsZXMuZ2V0KHQubmFtZS5uYW1lKSA9PT0gbiAmJiAodC5uYW1lID0gdC5uYW1lLmNsb25lKCksIGUudGhlZGVmID0gbiA9IHUudmFyaWFibGVzLmdldCh0Lm5hbWUubmFtZSkgfHwgdVthXSh0Lm5hbWUpKSksIG4ucmVmZXJlbmNlcy5wdXNoKGUpKTt9KSkpIDogKFMgaW5zdGFuY2VvZiBBU1RfU2NvcGUgPyAoZS5wdXNoKFMpLCB1ID0gUy5vcHRpbWl6ZShlKSwgZS5wb3AoKSkgOiB1ID0gUy5vcHRpbWl6ZShlKSwgdSA9IHUudHJhbnNmb3JtKG5ldyBUcmVlVHJhbnNmb3JtZXIoZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TY29wZSB8fCBuKGUgPSBlLmNsb25lKCksIHRoaXMpLCBlO30pKSksIF8ucmVwbGFjZWQrKywgdTt9aWYgKFMgJiYgITEgIT09IChzID0gdC5maXhlZCB8fCBfLmZpeGVkKS5zaG91bGRfcmVwbGFjZSkgaWYgKFMgaW5zdGFuY2VvZiBBU1RfVGhpcyA/IGlzX2Z1bmFyZyhfKSB8fCAhWm4oXykgfHwgZnVuY3Rpb24gKGUpIHt2YXIgbiA9IHQuc2NvcGU7Zm9yICg7IG4gIT09IGUuc2NvcGU7KSB7aWYgKG4gaW5zdGFuY2VvZiBBU1RfQ2xhc3MpIHJldHVybiAxO24gPSBuLnBhcmVudF9zY29wZTt9fShfKSB8fCAoZiA9IFMpIDogKG4gPSBTLmV2YWx1YXRlKGUsICEwKSkgIT09IFMgJiYgImZ1bmN0aW9uIiAhPSB0eXBlb2YgbiAmJiAobnVsbCA9PT0gbiB8fCAib2JqZWN0IiAhPSB0eXBlb2YgbiB8fCBlLm9wdGlvbigidW5zYWZlX3JlZ2V4cCIpICYmIG4gaW5zdGFuY2VvZiBSZWdFeHAgJiYgIV8uY3Jvc3NfbG9vcCAmJiBabihfKSkgJiYgKGYgPSBaKG4sIFMpKSwgZikgaWYgKHZvaWQgMCA9PT0gcy5zaG91bGRfcmVwbGFjZSAmJiAobiA9IGYub3B0aW1pemUoZSkucHJpbnRfdG9fc3RyaW5nKCkubGVuZ3RoLCBBKFMpIHx8IChuID0gTWF0aC5taW4obiwgUy5wcmludF90b19zdHJpbmcoKS5sZW5ndGgpKSwgYyA9IF8ubmFtZS5sZW5ndGgsIGUub3B0aW9uKCJ1bnVzZWQiKSAmJiAhZS5leHBvc2VkKF8pICYmIChsID0gXy5yZWZlcmVuY2VzLmxlbmd0aCAtIF8ucmVwbGFjZWQgLSBfLmFzc2lnbm1lbnRzLCBsID0gTWF0aC5taW4obCwgXy5yZWZlcmVuY2VzLmZpbHRlcihmdW5jdGlvbiAoZSkge3JldHVybiBlLmZpeGVkID09PSBzO30pLmxlbmd0aCksIGMgKz0gKGMgKyAyICsgbikgLyBNYXRoLm1heCgxLCBsKSksIHMuc2hvdWxkX3JlcGxhY2UgPSBuIC0gTWF0aC5mbG9vcihjKSA8IGUuZXZhbF90aHJlc2hvbGQpLCBzLnNob3VsZF9yZXBsYWNlKSByZXR1cm4gQShTKSA/ICh1ID0gZi5vcHRpbWl6ZShlKSkgPT09IGYgJiYgKHUgPSB1LmNsb25lKCEwKSkgOiAodSA9IFkoZi5vcHRpbWl6ZShlKSwgUykpICE9PSBmICYmIHUgIT09IFMgfHwgKHUgPSB1LmNsb25lKCEwKSksIF8ucmVwbGFjZWQrKywgdTt9cmV0dXJuIHQ7ZnVuY3Rpb24gQShlKSB7dmFyIG47cmV0dXJuIGUud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge2lmIChuID0gZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgPyAhMCA6IG4pIHJldHVybiAhMDt9KSksIG47fX0pLCBlKEFTVF9UZW1wbGF0ZSwgZnVuY3Rpb24gKGUsIHQpIHtpZiAoIXQub3B0aW9uKCJ0ZW1wbGF0ZXMiKSkgcmV0dXJuIGU7dmFyIGkgPSBlLnRhZztpZiAoIWkgfHwgZXQodCwgaSkpIHtmb3IgKHZhciBuLCByID0gW10sIG8gPSBbXSwgYSA9IDA7IGEgPCBlLnN0cmluZ3MubGVuZ3RoOyBhKyspIHt2YXIgcyxmID0gZS5zdHJpbmdzW2FdO2lmIChpIHx8IChzID0gbnQoZikpICYmIChmID0gUyhzKSksIDAgPCBhKSB7dmFyIGMgPSBlLmV4cHJlc3Npb25zW2EgLSAxXSxsID0gZnVuY3Rpb24gKGUpIHt2YXIgbiA9IGUuZXZhbHVhdGUodCk7aWYgKG4gIT09IGUgJiYgIShpICYmIC9ccnxcXHxgLy50ZXN0KG4pIHx8IChuID0gUygiIiArIG4pKS5sZW5ndGggPiBlLnByaW50X3RvX3N0cmluZygpLmxlbmd0aCArICIke30iLmxlbmd0aCkpIHJldHVybiBuO30oYyk7aWYgKGwpIHt2YXIgdSxsID0gb1tvLmxlbmd0aCAtIDFdICsgbCArIGY7aWYgKGkgfHwgdHlwZW9mICh1ID0gbnQobCkpID09IG4pIHtvW28ubGVuZ3RoIC0gMV0gPSB1ID8gUyh1KSA6IGw7Y29udGludWU7fX1yLnB1c2goYyk7fW8ucHVzaChmKSwgaSB8fCAobiA9IHR5cGVvZiBzKTt9aWYgKCFpICYmIDEgPCBvLmxlbmd0aCkge2lmICgiIiA9PSBvW28ubGVuZ3RoIC0gMV0pIHJldHVybiBrZShBU1RfQmluYXJ5LCBlLCB7IG9wZXJhdG9yOiAiKyIsIGxlZnQ6IGtlKEFTVF9UZW1wbGF0ZSwgZSwgeyBleHByZXNzaW9uczogci5zbGljZSgwLCAtMSksIHN0cmluZ3M6IG8uc2xpY2UoMCwgLTEpIH0pLnRyYW5zZm9ybSh0KSwgcmlnaHQ6IHJbci5sZW5ndGggLSAxXSB9KS5vcHRpbWl6ZSh0KTtpZiAoIiIgPT0gb1swXSkge2ZvciAodmFyIF8gPSBrZShBU1RfQmluYXJ5LCBlLCB7IG9wZXJhdG9yOiAiKyIsIGxlZnQ6IGtlKEFTVF9TdHJpbmcsIGUsIHsgdmFsdWU6ICIiIH0pLCByaWdodDogclswXSB9KSwgYSA9IDE7ICIiID09IG9bYV0gJiYgYSA8IHIubGVuZ3RoOyBhKyspIF8gPSBrZShBU1RfQmluYXJ5LCBlLCB7IG9wZXJhdG9yOiAiKyIsIGxlZnQ6IF8sIHJpZ2h0OiByW2FdIH0pO3JldHVybiBNZSh0LCBlLCBrZShBU1RfQmluYXJ5LCBlLCB7IG9wZXJhdG9yOiAiKyIsIGxlZnQ6IF8udHJhbnNmb3JtKHQpLCByaWdodDoga2UoQVNUX1RlbXBsYXRlLCBlLCB7IGV4cHJlc3Npb25zOiByLnNsaWNlKGEpLCBzdHJpbmdzOiBvLnNsaWNlKGEpIH0pLnRyYW5zZm9ybSh0KSB9KS5vcHRpbWl6ZSh0KSk7fX1lLmV4cHJlc3Npb25zID0gciwgZS5zdHJpbmdzID0gbzt9cmV0dXJuIEsodCwgZSk7ZnVuY3Rpb24gUyhlKSB7cmV0dXJuIGUucmVwbGFjZSgvXHJ8XFx8YHxcJHsvZywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIlxcIiArICgiXHIiID09IGUgPyAiciIgOiBlKTt9KTt9fSksIGUoQVNUX1VuZGVmaW5lZCwgZnVuY3Rpb24gKGUsIG4pIHtpZiAobi5vcHRpb24oInVuc2FmZV91bmRlZmluZWQiKSkge3ZhciB0ID0geGUobikuZmluZF92YXJpYWJsZSgidW5kZWZpbmVkIik7aWYgKHQpIHJldHVybiAodCA9IGtlKEFTVF9TeW1ib2xSZWYsIGUsIHsgbmFtZTogInVuZGVmaW5lZCIsIHNjb3BlOiB0LnNjb3BlLCB0aGVkZWY6IHQgfSkpLmlzX3VuZGVmaW5lZCA9ICEwLCB0O310ID0gaXNfbGhzKG4uc2VsZigpLCBuLnBhcmVudCgpKTtyZXR1cm4gdCAmJiB0dCh0LCBlKSA/IGUgOiBrZShBU1RfVW5hcnlQcmVmaXgsIGUsIHsgb3BlcmF0b3I6ICJ2b2lkIiwgZXhwcmVzc2lvbjoga2UoQVNUX051bWJlciwgZSwgeyB2YWx1ZTogMCB9KSB9KTt9KSwgZShBU1RfSW5maW5pdHksIGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQgPSBpc19saHMobi5zZWxmKCksIG4ucGFyZW50KCkpO3JldHVybiAoIXQgfHwgIXR0KHQsIGUpKSAmJiAoIW4ub3B0aW9uKCJrZWVwX2luZmluaXR5IikgfHwgdCB8fCB4ZShuKS5maW5kX3ZhcmlhYmxlKCJJbmZpbml0eSIpKSA/IGtlKEFTVF9CaW5hcnksIGUsIHsgb3BlcmF0b3I6ICIvIiwgbGVmdDoga2UoQVNUX051bWJlciwgZSwgeyB2YWx1ZTogMSB9KSwgcmlnaHQ6IGtlKEFTVF9OdW1iZXIsIGUsIHsgdmFsdWU6IDAgfSkgfSkgOiBlO30pLCBlKEFTVF9OYU4sIGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQgPSBpc19saHMobi5zZWxmKCksIG4ucGFyZW50KCkpO3JldHVybiAoIXQgfHwgIXR0KHQsIGUpKSAmJiAodCB8fCB4ZShuKS5maW5kX3ZhcmlhYmxlKCJOYU4iKSkgPyBrZShBU1RfQmluYXJ5LCBlLCB7IG9wZXJhdG9yOiAiLyIsIGxlZnQ6IGtlKEFTVF9OdW1iZXIsIGUsIHsgdmFsdWU6IDAgfSksIHJpZ2h0OiBrZShBU1RfTnVtYmVyLCBlLCB7IHZhbHVlOiAwIH0pIH0pIDogZTt9KTt2YXIgcnQgPSBtYWtlUHJlZGljYXRlKCIrIC0gKiAvICUgPj4gPDwgPj4+IHwgXiAmIiksb3QgPSBtYWtlUHJlZGljYXRlKCIqIHwgXiAmIik7ZnVuY3Rpb24gYXQoZSwgbikge3ZhciB0O2lmIChlKSByZXR1cm4gIkNhbGwiICE9ICh0ID0gbi5wYXJlbnQoKSkuVFlQRSA/IDEgOiB0LmV4cHJlc3Npb24gIT09IG4uc2VsZigpIHx8ICghKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmKSB8fCAoZSA9IGUuZml4ZWRfdmFsdWUoKSkpICYmIGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhICYmICFlLmNvbnRhaW5zX3RoaXMoKTt9ZnVuY3Rpb24gc3QoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX09iamVjdEtleVZhbCAmJiAic3RyaW5nIiA9PSB0eXBlb2YgZS5rZXkgJiYgIShlIGluc3RhbmNlb2YgQVNUX09iamVjdE1ldGhvZCAmJiBlLnZhbHVlLmNvbnRhaW5zX3N1cGVyKCkpO31mdW5jdGlvbiBmdChlKSB7dmFyIG4gPSBlLmRlZmluaXRpb24oKS5yZWRlZmluZWQoKTtyZXR1cm4gbiAmJiAoKGUgPSBlLmNsb25lKCkpLnRoZWRlZiA9IG4pLCBlO31mdW5jdGlvbiBjdChuLCBlKSB7dmFyIHQgPSAhMTtyZXR1cm4gZS53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuICEhdCB8fCAoZSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgbi52YXJpYWJsZXMuZ2V0KGUubmFtZSkgPT09IGUuZGVmaW5pdGlvbigpID8gdCA9ICEwIDogdm9pZCAwKTt9KSksIHQ7fWZ1bmN0aW9uIGx0KGUsIG4pIHt2YXIgdCA9IFtdO2UucmVmZXJlbmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7ZSA9IGUuZml4ZWQ7ZSAmJiBwdXNoX3VuaXEodCwgZSkgJiYgKGUuYXNzaWducyA/IGUuYXNzaWducy51bnNoaWZ0KG4pIDogZS5hc3NpZ25zID0gW25dKTt9KTt9ZnVuY3Rpb24gdXQoZSwgbikge3ZhciB0ID0ga2UoQVNUX1N5bWJvbFJlZiwgbiksaSA9IGtlKEFTVF9Bc3NpZ24sIG4sIHsgb3BlcmF0b3I6ICI9IiwgbGVmdDogdCwgcmlnaHQ6IGtlKEFTVF9VbmRlZmluZWQsIG4pLnRyYW5zZm9ybShlKSB9KSxlID0gbi5kZWZpbml0aW9uKCk7cmV0dXJuIGUuZml4ZWQgJiYgKHQuZml4ZWQgPSBmdW5jdGlvbiAoKSB7cmV0dXJuIGkucmlnaHQ7fSwgdC5maXhlZC5hc3NpZ25zID0gW2ldLCBsdChlLCBpKSksIGUuYXNzaWdubWVudHMrKywgZS5yZWZlcmVuY2VzLnB1c2godCksIGk7fWZ1bmN0aW9uIF90KGUsIG4sIHQsIGksIHIsIG8sIGEpIHtmb3IgKHZhciBzID0gW10sIGYgPSBvLmV4cHJlc3Npb25zLCBjID0gdCwgbCA9IGYubGVuZ3RoIC0gKGEgfHwgMCksIHUgPSBsOyAwIDw9IC0tbDsgciA9ICEoYyA9ICEwKSkge3ZhciBfID0gZltsXS50cnlfaW5saW5lKGUsIG4sIGMsIGksIHIpO18gJiYgKFMoKSwgcy5wdXNoKF8pKTt9aWYgKDAgIT0gcy5sZW5ndGgpIHJldHVybiBTKCksICF0ICYmIHNbMF0gaW5zdGFuY2VvZiBBU1RfU2ltcGxlU3RhdGVtZW50ICYmIChzWzBdID0ga2UoQVNUX1JldHVybiwgbywgeyB2YWx1ZTogc1swXS5ib2R5IH0pKSwga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCBvLCB7IGJvZHk6IHMucmV2ZXJzZSgpIH0pO2Z1bmN0aW9uIFMoKSB7bCArIDEgPCB1ICYmIHMucHVzaChrZShBU1RfU2ltcGxlU3RhdGVtZW50LCBvLCB7IGJvZHk6IHdlKG8sIGYuc2xpY2UobCArIDEsIHUpKSB9KSksIHUgPSBsO319ZShBU1RfQXNzaWduLCBmdW5jdGlvbiAobywgYSkge2lmIChhLm9wdGlvbigiZGVhZF9jb2RlIikpIGlmIChvLmxlZnQgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2Vzcykge2lmICgiPSIgPT0gby5vcGVyYXRvcikge3ZhciBlID0gby5sZWZ0LmV4cHJlc3Npb247aWYgKG8ubGVmdC5lcXVhbHMoby5yaWdodCkpIHt2YXIgbiA9IGUuZGVmaW5lZCx0ID0gKGUuZGVmaW5lZCA9ICExLCAhby5sZWZ0Lmhhc19zaWRlX2VmZmVjdHMoYSkpO2lmIChlLmRlZmluZWQgPSBuLCB0KSByZXR1cm4gby5yaWdodDt9aWYgKGUgaW5zdGFuY2VvZiBBU1RfTGFtYmRhIHx8ICFhLmhhc19kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSAmJiBlIGluc3RhbmNlb2YgQVNUX0NvbnN0YW50ICYmICFlLm1heV90aHJvd19vbl9hY2Nlc3MoYSkpIHJldHVybiBuID0gby5sZWZ0IGluc3RhbmNlb2YgQVNUX0RvdCA/IG8ucmlnaHQgOiB3ZShvLCBbby5sZWZ0LnByb3BlcnR5LCBvLnJpZ2h0XSksIERlKGEucGFyZW50KCksIG8sIG4pLm9wdGltaXplKGEpO319IGVsc2UgaWYgKG8ubGVmdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgYmUoby5sZWZ0LCBhKSkge2lmICgiPSIgPT0gby5vcGVyYXRvciAmJiBvLmxlZnQuZXF1YWxzKG8ucmlnaHQpICYmICEoKGwgPSBhLnBhcmVudCgpKSBpbnN0YW5jZW9mIEFTVF9VbmFyeVByZWZpeCAmJiAiZGVsZXRlIiA9PSBsLm9wZXJhdG9yKSkgcmV0dXJuIG8ucmlnaHQ7aWYgKG8ubGVmdC5pc19pbW11dGFibGUoKSkgcmV0dXJuIGQoKTt2YXIgaSxyID0gby5sZWZ0LmRlZmluaXRpb24oKSxzID0gci5zY29wZS5yZXNvbHZlKCksZiA9IHMgPT09IGEuZmluZF9wYXJlbnQoQVNUX0xhbWJkYSksYyA9IDAsbCA9IGEuc2VsZigpO2lmICghcy51c2VzX2FyZ3VtZW50cyB8fCAhaXNfZnVuYXJnKHIpIHx8IGEuaGFzX2RpcmVjdGl2ZSgidXNlIHN0cmljdCIpKSBkbyB7aWYgKGkgPSBsLCAobCA9IGEucGFyZW50KGMrKykpIGluc3RhbmNlb2YgQVNUX0Fzc2lnbikge2lmIChsLmxlZnQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIGwubGVmdC5kZWZpbml0aW9uKCkgPT09IHIpIHtpZiAoUyhjLCBsLCAhZikpIGJyZWFrO3JldHVybiBkKHIpO31pZiAobC5sZWZ0Lm1hdGNoX3N5bWJvbChmdW5jdGlvbiAoZSkge2lmIChlIGluc3RhbmNlb2YgQVNUX1Byb3BBY2Nlc3MpIHJldHVybiAhMDt9KSkgYnJlYWs7fSBlbHNlIHtpZiAobCBpbnN0YW5jZW9mIEFTVF9FeGl0KSB7aWYgKCFmKSBicmVhaztpZiAoUyhjLCBsKSkgYnJlYWs7aWYgKGl0KHMsIFtyXSkpIGJyZWFrO3JldHVybiBkKHIpO31pZiAobCBpbnN0YW5jZW9mIEFTVF9TaW1wbGVTdGF0ZW1lbnQpIHtpZiAoIWYpIGJyZWFrO2lmIChpdChzLCBbcl0pKSBicmVhaztkbyB7aWYgKHUgPSBsLCAobCA9IGEucGFyZW50KGMrKykpID09PSBzICYmIHplKGwuYm9keSwgdSkpIHJldHVybiBkKHIpO30gd2hpbGUgKHUgPSB1LCAoXyA9IGwpIGluc3RhbmNlb2YgQVNUX0Jsb2NrU3RhdGVtZW50IHx8IF8gaW5zdGFuY2VvZiBBU1RfQ2F0Y2ggfHwgXyBpbnN0YW5jZW9mIEFTVF9GaW5hbGx5ID8gemUoXy5ib2R5LCB1KSA6IF8gaW5zdGFuY2VvZiBBU1RfSWYgPyBfLmJvZHkgPT09IHUgfHwgXy5hbHRlcm5hdGl2ZSA9PT0gdSA6IF8gaW5zdGFuY2VvZiBBU1RfVHJ5ID8gXy5iZmluYWxseSA/IF8uYmZpbmFsbHkgPT09IHUgOiBfLmJjYXRjaCA9PT0gdSA6IHZvaWQgMCk7YnJlYWs7fWlmIChsIGluc3RhbmNlb2YgQVNUX1ZhckRlZiAmJiBsLm5hbWUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRGVjbGFyYXRpb24gJiYgbC5uYW1lLmRlZmluaXRpb24oKSA9PT0gcikge2lmIChTKGMsIGwpKSBicmVhaztyZXR1cm4gZChyKTt9fX0gd2hpbGUgKGZ1bmN0aW9uIChlLCBuKSB7aWYgKG4gaW5zdGFuY2VvZiBBU1RfQmluYXJ5KSBzd2l0Y2ggKGUpIHtjYXNlIG4ubGVmdDpyZXR1cm4gbi5yaWdodC5pc19jb25zdGFudF9leHByZXNzaW9uKHMpO2Nhc2Ugbi5yaWdodDpyZXR1cm4gMTtkZWZhdWx0OnJldHVybjt9aWYgKG4gaW5zdGFuY2VvZiBBU1RfQ29uZGl0aW9uYWwpIHN3aXRjaCAoZSkge2Nhc2Ugbi5jb25kaXRpb246cmV0dXJuIG4uY29uc2VxdWVudC5pc19jb25zdGFudF9leHByZXNzaW9uKHMpICYmIG4uYWx0ZXJuYXRpdmUuaXNfY29uc3RhbnRfZXhwcmVzc2lvbihzKTtjYXNlIG4uY29uc2VxdWVudDpjYXNlIG4uYWx0ZXJuYXRpdmU6cmV0dXJuIDE7ZGVmYXVsdDpyZXR1cm47fWlmIChuIGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlKSB7dmFyIHQgPSBuLmV4cHJlc3Npb25zLGkgPSB0LmluZGV4T2YoZSk7aWYgKGkgPCAwKSByZXR1cm47Zm9yICh2YXIgciA9IHQubGVuZ3RoOyAtLXIgPiBpOykgaWYgKCF0W3JdLmlzX2NvbnN0YW50X2V4cHJlc3Npb24ocykpIHJldHVybjtyZXR1cm4gMTt9cmV0dXJuIG4gaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXg7fShpLCBsKSk7fXZhciB1LCBfO2lmIChhLm9wdGlvbigic2VxdWVuY2VzIikpIHt0ID0gby5saWZ0X3NlcXVlbmNlcyhhKTtpZiAodCAhPT0gbykgcmV0dXJuIHQub3B0aW1pemUoYSk7fWlmIChhLm9wdGlvbigiYXNzaWdubWVudHMiKSkge2lmICgiPSIgPT0gby5vcGVyYXRvciAmJiBvLmxlZnQgaW5zdGFuY2VvZiBBU1RfU3ltYm9sUmVmICYmIG8ucmlnaHQgaW5zdGFuY2VvZiBBU1RfQmluYXJ5KSB7aWYgKG8ucmlnaHQubGVmdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgby5yaWdodC5sZWZ0Lm5hbWUgPT0gby5sZWZ0Lm5hbWUgJiYgcnRbby5yaWdodC5vcGVyYXRvcl0pIHJldHVybiBwKG8ucmlnaHQucmlnaHQpO2lmIChvLnJpZ2h0LnJpZ2h0IGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiBvLnJpZ2h0LnJpZ2h0Lm5hbWUgPT0gby5sZWZ0Lm5hbWUgJiYgb3Rbby5yaWdodC5vcGVyYXRvcl0gJiYgIW8ucmlnaHQubGVmdC5oYXNfc2lkZV9lZmZlY3RzKGEpKSByZXR1cm4gcChvLnJpZ2h0LmxlZnQpO31pZiAoKCItPSIgPT0gby5vcGVyYXRvciB8fCAiKz0iID09IG8ub3BlcmF0b3IgJiYgKG8ubGVmdC5pc19ib29sZWFuKGEpIHx8IG8ubGVmdC5pc19udW1iZXIoYSkpKSAmJiBvLnJpZ2h0IGluc3RhbmNlb2YgQVNUX051bWJlciAmJiAxID09IG8ucmlnaHQudmFsdWUpIHJldHVybiBlID0gby5vcGVyYXRvci5zbGljZSgwLCAtMSksIGtlKEFTVF9VbmFyeVByZWZpeCwgbywgeyBvcGVyYXRvcjogZSArIGUsIGV4cHJlc3Npb246IG8ubGVmdCB9KTt9cmV0dXJuIEsoYSwgbyk7ZnVuY3Rpb24gUyhlLCBuLCB0KSB7dmFyIGkgPSBvLnJpZ2h0LHIgPSAoby5yaWdodCA9IGtlKEFTVF9OdWxsLCBpKSwgbi5tYXlfdGhyb3coYSkpO3JldHVybiBvLnJpZ2h0ID0gaSwgQmUoYSwgZSwgbiwgcywgciwgdCk7fWZ1bmN0aW9uIHAoZSkge3ZhciBuID0gby5sZWZ0LmZpeGVkO3JldHVybiBuICYmIChuLnRvX2JpbmFyeSA9IHYoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZS5sZWZ0O30sIG4pKSwga2UoQVNUX0Fzc2lnbiwgbywgeyBvcGVyYXRvcjogby5yaWdodC5vcGVyYXRvciArICI9IiwgbGVmdDogby5sZWZ0LCByaWdodDogZSB9KTt9ZnVuY3Rpb24gZChlKSB7cmV0dXJuIGUgJiYgKGUuZml4ZWQgPSAhMSksICgiPSIgIT0gby5vcGVyYXRvciA/IGtlKEFTVF9CaW5hcnksIG8sIHsgb3BlcmF0b3I6IG8ub3BlcmF0b3Iuc2xpY2UoMCwgLTEpLCBsZWZ0OiBvLmxlZnQsIHJpZ2h0OiBvLnJpZ2h0IH0pIDogRGUoYS5wYXJlbnQoKSwgbywgby5yaWdodCkpLm9wdGltaXplKGEpO319KSwgZShBU1RfQ29uZGl0aW9uYWwsIGZ1bmN0aW9uIChhLCBuKSB7aWYgKG4ub3B0aW9uKCJzZXF1ZW5jZXMiKSAmJiBhLmNvbmRpdGlvbiBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSkgcmV0dXJuIGUgPSBhLmNvbmRpdGlvbi5leHByZXNzaW9ucy5zbGljZSgpLCAoYyA9IGEuY2xvbmUoKSkuY29uZGl0aW9uID0gZS5wb3AoKSwgZS5wdXNoKGMpLCB3ZShhLCBlKS5vcHRpbWl6ZShuKTtpZiAobi5vcHRpb24oImNvbmRpdGlvbmFscyIpKSB7dmFyIHMgPSBhLmNvbmRpdGlvbjtpZiAobi5vcHRpb24oImJvb2xlYW5zIikgJiYgIXMuaGFzX3NpZGVfZWZmZWN0cyhuKSAmJiBObihuLCBzKSwgIShzID0gTihuLCBzKSkpIHJldHVybiBBU1RfTm9kZS53YXJuKCJDb25kaXRpb24gYWx3YXlzIGZhbHNlIFt7c3RhcnR9XSIsIGEpLCB3ZShhLCBbYS5jb25kaXRpb24sIGEuYWx0ZXJuYXRpdmVdKS5vcHRpbWl6ZShuKTtpZiAoIShzIGluc3RhbmNlb2YgQVNUX05vZGUpKSByZXR1cm4gQVNUX05vZGUud2FybigiQ29uZGl0aW9uIGFsd2F5cyB0cnVlIFt7c3RhcnR9XSIsIGEpLCB3ZShhLCBbYS5jb25kaXRpb24sIGEuY29uc2VxdWVudF0pLm9wdGltaXplKG4pO3ZhciBlID0gZmlyc3RfaW5fc3RhdGVtZW50KG4pLHQgPSBzLm5lZ2F0ZShuLCBlKSxlID0gKChlID8gSWUgOiBZKShzLCB0KSA9PT0gdCAmJiAoYSA9IGtlKEFTVF9Db25kaXRpb25hbCwgYSwgeyBjb25kaXRpb246IHQsIGNvbnNlcXVlbnQ6IGEuYWx0ZXJuYXRpdmUsIGFsdGVybmF0aXZlOiBhLmNvbnNlcXVlbnQgfSksIHQgPSBzLCBzID0gYS5jb25kaXRpb24pLCBhLmNvbnNlcXVlbnQpLGkgPSBhLmFsdGVybmF0aXZlLHIgPSAkbihzLCBuKTtpZiAoWG4obiwgcikpIHtpZiAoci5lcXVhbHMoZSkpIHJldHVybiBrZShBU1RfQmluYXJ5LCBhLCB7IG9wZXJhdG9yOiAifHwiLCBsZWZ0OiBzLCByaWdodDogaSB9KS5vcHRpbWl6ZShuKTtpZiAoci5lcXVhbHMoaSkpIHJldHVybiBrZShBU1RfQmluYXJ5LCBhLCB7IG9wZXJhdG9yOiAiJiYiLCBsZWZ0OiBzLCByaWdodDogZSB9KS5vcHRpbWl6ZShuKTt9ciA9IGUudGFpbF9ub2RlKCk7aWYgKHIgaW5zdGFuY2VvZiBBU1RfQXNzaWduKSB7dmFyIG8gPSAiPSIgPT0gci5vcGVyYXRvcixmID0gbyA/IGkudGFpbF9ub2RlKCkgOiBpO2lmICgobyB8fCBlID09PSByKSAmJiBmIGluc3RhbmNlb2YgQVNUX0Fzc2lnbiAmJiByLm9wZXJhdG9yID09IGYub3BlcmF0b3IgJiYgci5sZWZ0LmVxdWFscyhmLmxlZnQpICYmIChvICYmIHIubGVmdCBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgfHwgIXMuaGFzX3NpZGVfZWZmZWN0cyhuKSAmJiBoKGUpICYmIGgoaSkpKSByZXR1cm4ga2UoQVNUX0Fzc2lnbiwgYSwgeyBvcGVyYXRvcjogci5vcGVyYXRvciwgbGVmdDogci5sZWZ0LCByaWdodDoga2UoQVNUX0NvbmRpdGlvbmFsLCBhLCB7IGNvbmRpdGlvbjogcywgY29uc2VxdWVudDogbShlKSwgYWx0ZXJuYXRpdmU6IG0oaSkgfSkgfSk7fWYgPSBpLnRhaWxfbm9kZSgpO2lmIChyLmVxdWFscyhmKSkgcmV0dXJuIHdlKGEsIGUuZXF1YWxzKGkpID8gW3MsIGVdIDogW2tlKEFTVF9Db25kaXRpb25hbCwgYSwgeyBjb25kaXRpb246IHMsIGNvbnNlcXVlbnQ6IHYoZSksIGFsdGVybmF0aXZlOiB2KGkpIH0pLCBmXSkub3B0aW1pemUobik7dmFyIGMsbCxvID0gZnVuY3Rpb24gZShuLCB0LCBpKSB7dmFyIHIgPSBuLnRhaWxfbm9kZSgpO3ZhciBvID0gdC50YWlsX25vZGUoKTtpZiAoIVQociwgbykpIHJldHVybiAhaSAmJiBrZShBU1RfQ29uZGl0aW9uYWwsIGEsIHsgY29uZGl0aW9uOiBzLCBjb25zZXF1ZW50OiBuLCBhbHRlcm5hdGl2ZTogdCB9KTtpID0gci5jbG9uZSgpO24gPSBBKG4sIHIsICJleHByZXNzaW9uIik7dCA9IEEodCwgbywgImV4cHJlc3Npb24iKTtvID0gZShuLCB0KTtyLmV4cHJlc3Npb24gaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgJiYgKG8gPSBEZShyLCByLmV4cHJlc3Npb24sIG8pKTtpLmV4cHJlc3Npb24gPSBvO3JldHVybiBpO30oZSwgaSwgITApO2lmIChvKSByZXR1cm4gbztpZiAoZSBpbnN0YW5jZW9mIEFTVF9DYWxsICYmIGkuVFlQRSA9PSBlLlRZUEUgJiYgMCA8PSAobyA9IGQoZSwgaSkpICYmIGUuZXhwcmVzc2lvbi5lcXVhbHMoaS5leHByZXNzaW9uKSAmJiAhcy5oYXNfc2lkZV9lZmZlY3RzKG4pICYmICFlLmV4cHJlc3Npb24uaGFzX3NpZGVfZWZmZWN0cyhuKSkgcmV0dXJuIGMgPSBlLmNsb25lKCksIGwgPSBlLmFyZ3Nbb10sIGMuYXJnc1tvXSA9IGwgaW5zdGFuY2VvZiBBU1RfU3ByZWFkID8ga2UoQVNUX1NwcmVhZCwgYSwgeyBleHByZXNzaW9uOiBrZShBU1RfQ29uZGl0aW9uYWwsIGEsIHsgY29uZGl0aW9uOiBzLCBjb25zZXF1ZW50OiBsLmV4cHJlc3Npb24sIGFsdGVybmF0aXZlOiBpLmFyZ3Nbb10uZXhwcmVzc2lvbiB9KSB9KSA6IGtlKEFTVF9Db25kaXRpb25hbCwgYSwgeyBjb25kaXRpb246IHMsIGNvbnNlcXVlbnQ6IGwsIGFsdGVybmF0aXZlOiBpLmFyZ3Nbb10gfSksIGM7aWYgKHIgaW5zdGFuY2VvZiBBU1RfQ29uZGl0aW9uYWwgJiYgci5hbHRlcm5hdGl2ZS5lcXVhbHMoaSkpIHJldHVybiBrZShBU1RfQ29uZGl0aW9uYWwsIGEsIHsgY29uZGl0aW9uOiBrZShBU1RfQmluYXJ5LCBhLCB7IGxlZnQ6IHMsIG9wZXJhdG9yOiAiJiYiLCByaWdodDogQShlLCByLCAiY29uZGl0aW9uIikgfSksIGNvbnNlcXVlbnQ6IHIuY29uc2VxdWVudCwgYWx0ZXJuYXRpdmU6IFAoci5hbHRlcm5hdGl2ZSwgaSkgfSk7aWYgKHIgaW5zdGFuY2VvZiBBU1RfQ29uZGl0aW9uYWwgJiYgci5jb25zZXF1ZW50LmVxdWFscyhpKSkgcmV0dXJuIGtlKEFTVF9Db25kaXRpb25hbCwgYSwgeyBjb25kaXRpb246IGtlKEFTVF9CaW5hcnksIGEsIHsgbGVmdDogdCwgb3BlcmF0b3I6ICJ8fCIsIHJpZ2h0OiBBKGUsIHIsICJjb25kaXRpb24iKSB9KSwgY29uc2VxdWVudDogUChyLmNvbnNlcXVlbnQsIGkpLCBhbHRlcm5hdGl2ZTogci5hbHRlcm5hdGl2ZSB9KTtpZiAoZiBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCAmJiBlLmVxdWFscyhmLmNvbnNlcXVlbnQpKSByZXR1cm4ga2UoQVNUX0NvbmRpdGlvbmFsLCBhLCB7IGNvbmRpdGlvbjoga2UoQVNUX0JpbmFyeSwgYSwgeyBsZWZ0OiBzLCBvcGVyYXRvcjogInx8IiwgcmlnaHQ6IEEoaSwgZiwgImNvbmRpdGlvbiIpIH0pLCBjb25zZXF1ZW50OiBQKGUsIGYuY29uc2VxdWVudCksIGFsdGVybmF0aXZlOiBmLmFsdGVybmF0aXZlIH0pO2lmIChmIGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsICYmIGUuZXF1YWxzKGYuYWx0ZXJuYXRpdmUpKSByZXR1cm4ga2UoQVNUX0NvbmRpdGlvbmFsLCBhLCB7IGNvbmRpdGlvbjoga2UoQVNUX0JpbmFyeSwgYSwgeyBsZWZ0OiB0LCBvcGVyYXRvcjogIiYmIiwgcmlnaHQ6IEEoaSwgZiwgImNvbmRpdGlvbiIpIH0pLCBjb25zZXF1ZW50OiBmLmNvbnNlcXVlbnQsIGFsdGVybmF0aXZlOiBQKGUsIGYuYWx0ZXJuYXRpdmUpIH0pO2lmIChyIGluc3RhbmNlb2YgQVNUX0JpbmFyeSAmJiAiJiYiID09IHIub3BlcmF0b3IgJiYgci5yaWdodC5lcXVhbHMoaSkpIHJldHVybiBrZShBU1RfQmluYXJ5LCBhLCB7IG9wZXJhdG9yOiAiJiYiLCBsZWZ0OiBrZShBU1RfQmluYXJ5LCBhLCB7IG9wZXJhdG9yOiAifHwiLCBsZWZ0OiB0LCByaWdodDogQShlLCByLCAibGVmdCIpIH0pLCByaWdodDogUChyLnJpZ2h0LCBpKSB9KS5vcHRpbWl6ZShuKTtpZiAociBpbnN0YW5jZW9mIEFTVF9CaW5hcnkgJiYgInx8IiA9PSByLm9wZXJhdG9yICYmIHIucmlnaHQuZXF1YWxzKGkpKSByZXR1cm4ga2UoQVNUX0JpbmFyeSwgYSwgeyBvcGVyYXRvcjogInx8IiwgbGVmdDoga2UoQVNUX0JpbmFyeSwgYSwgeyBvcGVyYXRvcjogIiYmIiwgbGVmdDogcywgcmlnaHQ6IEEoZSwgciwgImxlZnQiKSB9KSwgcmlnaHQ6IFAoci5yaWdodCwgaSkgfSkub3B0aW1pemUobik7aWYgKGYgaW5zdGFuY2VvZiBBU1RfQmluYXJ5ICYmICImJiIgPT0gZi5vcGVyYXRvciAmJiBmLnJpZ2h0LmVxdWFscyhlKSkgcmV0dXJuIGtlKEFTVF9CaW5hcnksIGEsIHsgb3BlcmF0b3I6ICImJiIsIGxlZnQ6IGtlKEFTVF9CaW5hcnksIGEsIHsgb3BlcmF0b3I6ICJ8fCIsIGxlZnQ6IHMsIHJpZ2h0OiBBKGksIGYsICJsZWZ0IikgfSksIHJpZ2h0OiBQKGUsIGYucmlnaHQpIH0pLm9wdGltaXplKG4pO2lmIChmIGluc3RhbmNlb2YgQVNUX0JpbmFyeSAmJiAifHwiID09IGYub3BlcmF0b3IgJiYgZi5yaWdodC5lcXVhbHMoZSkpIHJldHVybiBrZShBU1RfQmluYXJ5LCBhLCB7IG9wZXJhdG9yOiAifHwiLCBsZWZ0OiBrZShBU1RfQmluYXJ5LCBhLCB7IG9wZXJhdG9yOiAiJiYiLCBsZWZ0OiB0LCByaWdodDogQShpLCBmLCAibGVmdCIpIH0pLCByaWdodDogUChlLCBmLnJpZ2h0KSB9KS5vcHRpbWl6ZShuKTt2YXIgdSA9IG4ub3B0aW9uKCJib29sZWFucyIpICYmIG4uaW5fYm9vbGVhbl9jb250ZXh0KCk7aWYgKFMoZSkpIHJldHVybiBwKGkpID8gXyhzKSA6IGtlKEFTVF9CaW5hcnksIGEsIHsgb3BlcmF0b3I6ICJ8fCIsIGxlZnQ6IF8ocyksIHJpZ2h0OiBpIH0pLm9wdGltaXplKG4pO2lmIChwKGUpKSByZXR1cm4gUyhpKSA/IF8ocy5uZWdhdGUobikpIDoga2UoQVNUX0JpbmFyeSwgYSwgeyBvcGVyYXRvcjogIiYmIiwgbGVmdDogXyhzLm5lZ2F0ZShuKSksIHJpZ2h0OiBpIH0pLm9wdGltaXplKG4pO2lmIChTKGkpKSByZXR1cm4ga2UoQVNUX0JpbmFyeSwgYSwgeyBvcGVyYXRvcjogInx8IiwgbGVmdDogXyhzLm5lZ2F0ZShuKSksIHJpZ2h0OiBlIH0pLm9wdGltaXplKG4pO2lmIChwKGkpKSByZXR1cm4ga2UoQVNUX0JpbmFyeSwgYSwgeyBvcGVyYXRvcjogIiYmIiwgbGVmdDogXyhzKSwgcmlnaHQ6IGUgfSkub3B0aW1pemUobik7bi5vcHRpb24oInR5cGVvZnMiKSAmJiB6KHMsIGUsIGkpO31yZXR1cm4gYTtmdW5jdGlvbiBfKGUpIHtyZXR1cm4gZS5pc19ib29sZWFuKG4pID8gZSA6IGtlKEFTVF9VbmFyeVByZWZpeCwgZSwgeyBvcGVyYXRvcjogIiEiLCBleHByZXNzaW9uOiBlLm5lZ2F0ZShuKSB9KTt9ZnVuY3Rpb24gUyhlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfVHJ1ZSB8fCB1ICYmIGUgaW5zdGFuY2VvZiBBU1RfQ29uc3RhbnQgJiYgZS52YWx1ZSB8fCBlIGluc3RhbmNlb2YgQVNUX1VuYXJ5UHJlZml4ICYmICIhIiA9PSBlLm9wZXJhdG9yICYmIGUuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9Db25zdGFudCAmJiAhZS5leHByZXNzaW9uLnZhbHVlO31mdW5jdGlvbiBwKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9GYWxzZSB8fCB1ICYmIChlIGluc3RhbmNlb2YgQVNUX0NvbnN0YW50ICYmICFlLnZhbHVlIHx8IGUgaW5zdGFuY2VvZiBBU1RfVW5hcnlQcmVmaXggJiYgInZvaWQiID09IGUub3BlcmF0b3IgJiYgIWUuZXhwcmVzc2lvbi5oYXNfc2lkZV9lZmZlY3RzKG4pKSB8fCBlIGluc3RhbmNlb2YgQVNUX1VuYXJ5UHJlZml4ICYmICIhIiA9PSBlLm9wZXJhdG9yICYmIGUuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9Db25zdGFudCAmJiBlLmV4cHJlc3Npb24udmFsdWU7fWZ1bmN0aW9uIGQoZSwgbikge3ZhciB0ID0gZS5hcmdzLGkgPSBuLmFyZ3MsciA9IHQubGVuZ3RoO2lmIChyICE9IGkubGVuZ3RoKSByZXR1cm4gLTI7Zm9yICh2YXIgbyA9IDA7IG8gPCByOyBvKyspIGlmICghdFtvXS5lcXVhbHMoaVtvXSkpIHtpZiAodFtvXSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQgIT0gaVtvXSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQpIHJldHVybiAtMztmb3IgKHZhciBhID0gbyArIDE7IGEgPCByOyBhKyspIGlmICghdFthXS5lcXVhbHMoaVthXSkpIHJldHVybiAtMjtyZXR1cm4gbzt9cmV0dXJuIC0xO31mdW5jdGlvbiBBKGUsIG4sIHQpIHt2YXIgaTtyZXR1cm4gZSA9PT0gbiA/IG5bdF0gOiAoKGkgPSBlLmV4cHJlc3Npb25zLnNsaWNlKDAsIC0xKSkucHVzaChuW3RdKSwgd2UoZSwgaSkpO31mdW5jdGlvbiBUKGUsIG4pIHt2YXIgdCwgaTtpZiAoZS5UWVBFID09IG4uVFlQRSAmJiBlLm9wdGlvbmFsID09IG4ub3B0aW9uYWwpIHJldHVybiBlIGluc3RhbmNlb2YgQVNUX0NhbGwgPyAtMSAhPSBkKGUsIG4pID8gdm9pZCAwIDogIkNhbGwiICE9IGUuVFlQRSB8fCAhKGUuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzIHx8IG4uZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9Qcm9wQWNjZXNzKSB8fCBUKGUuZXhwcmVzc2lvbiwgbi5leHByZXNzaW9uKSA6IGUgaW5zdGFuY2VvZiBBU1RfUHJvcEFjY2VzcyA/IChpID0gbi5wcm9wZXJ0eSwgKCh0ID0gZS5wcm9wZXJ0eSkgaW5zdGFuY2VvZiBBU1RfTm9kZSA/IHQuZXF1YWxzKGkpIDogdCA9PSBpKSAmJiAhKGUuZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEFTVF9TdXBlciB8fCBuLmV4cHJlc3Npb24gaW5zdGFuY2VvZiBBU1RfU3VwZXIpKSA6IHZvaWQgMDt9ZnVuY3Rpb24gaChlKSB7cmV0dXJuIGUgPT09IGUudGFpbF9ub2RlKCkgfHwgYWxsKGUuZXhwcmVzc2lvbnMuc2xpY2UoMCwgLTEpLCBmdW5jdGlvbiAoZSkge3JldHVybiAhZS5oYXNfc2lkZV9lZmZlY3RzKG4pO30pO31mdW5jdGlvbiBtKGUpIHt2YXIgbjtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSA/ICgobiA9IGUuZXhwcmVzc2lvbnMuc2xpY2UoKSkucHVzaChuLnBvcCgpLnJpZ2h0KSwgd2UoZSwgbikpIDogZS5yaWdodDt9ZnVuY3Rpb24gdihlKSB7cmV0dXJuIGUgaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UgPyB3ZShlLCBlLmV4cHJlc3Npb25zLnNsaWNlKDAsIC0xKSkgOiBrZShBU1RfTnVtYmVyLCBlLCB7IHZhbHVlOiAwIH0pO319KSwgZShBU1RfQm9vbGVhbiwgZnVuY3Rpb24gKGUsIG4pIHtyZXR1cm4gbi5vcHRpb24oImJvb2xlYW5zIikgPyBuLmluX2Jvb2xlYW5fY29udGV4dCgpID8ga2UoQVNUX051bWJlciwgZSwgeyB2YWx1ZTogK2UudmFsdWUgfSkgOiAobiA9IG4ucGFyZW50KCkpIGluc3RhbmNlb2YgQVNUX0JpbmFyeSAmJiAoIj09IiA9PSBuLm9wZXJhdG9yIHx8ICIhPSIgPT0gbi5vcGVyYXRvcikgPyAoQVNUX05vZGUud2FybigiTm9uLXN0cmljdCBlcXVhbGl0eSBhZ2FpbnN0IGJvb2xlYW46IHtvcGVyYXRvcn0ge3ZhbHVlfSBbe3N0YXJ0fV0iLCB7IG9wZXJhdG9yOiBuLm9wZXJhdG9yLCB2YWx1ZTogZS52YWx1ZSwgc3RhcnQ6IG4uc3RhcnQgfSksIGtlKEFTVF9OdW1iZXIsIGUsIHsgdmFsdWU6ICtlLnZhbHVlIH0pKSA6IGtlKEFTVF9VbmFyeVByZWZpeCwgZSwgeyBvcGVyYXRvcjogIiEiLCBleHByZXNzaW9uOiBrZShBU1RfTnVtYmVyLCBlLCB7IHZhbHVlOiAxIC0gZS52YWx1ZSB9KSB9KSA6IGU7fSksIGUoQVNUX1NwcmVhZCwgZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCA9IGUuZXhwcmVzc2lvbjtyZXR1cm4gbi5vcHRpb24oInNwcmVhZHMiKSAmJiB0IGluc3RhbmNlb2YgQVNUX0FycmF5ICYmICEobi5wYXJlbnQoKSBpbnN0YW5jZW9mIEFTVF9PYmplY3QpID8gTGlzdC5zcGxpY2UodC5lbGVtZW50cy5tYXAoZnVuY3Rpb24gKGUpIHtyZXR1cm4gZSBpbnN0YW5jZW9mIEFTVF9Ib2xlID8ga2UoQVNUX1VuZGVmaW5lZCwgZSkub3B0aW1pemUobikgOiBlO30pKSA6IGU7fSksIGUoQVNUX1N1YiwgZnVuY3Rpb24gKGUsIHQpIHt2YXIgbiA9IGUuZXhwcmVzc2lvbixpID0gZS5wcm9wZXJ0eSxyID0gem4oZSwgdCk7aWYgKHIpIHJldHVybiByO2lmICh0Lm9wdGlvbigicHJvcGVydGllcyIpKSB7dmFyIG8gPSBpLmV2YWx1YXRlKHQpO2lmIChvICE9PSBpKSB7InN0cmluZyIgPT0gdHlwZW9mIG8gJiYgKCJ1bmRlZmluZWQiID09IG8gPyBvID0gdm9pZCAwIDogKGQgPSBwYXJzZUZsb2F0KG8pKS50b1N0cmluZygpID09IG8gJiYgKG8gPSBkKSksIGkgPSBlLnByb3BlcnR5ID0gWShpLCBaKG8sIGkpLnRyYW5zZm9ybSh0KSk7dmFyIGEgPSAiIiArIG87aWYgKGlzX2lkZW50aWZpZXJfc3RyaW5nKGEpICYmIGEubGVuZ3RoIDw9IGkucHJpbnRfdG9fc3RyaW5nKCkubGVuZ3RoICsgMSkgcmV0dXJuIGtlKEFTVF9Eb3QsIGUsIHsgb3B0aW9uYWw6IGUub3B0aW9uYWwsIGV4cHJlc3Npb246IG4sIHByb3BlcnR5OiBhLCBxdW90ZWQ6ICEwIH0pLm9wdGltaXplKHQpO319dmFyIHMsZixjLGwsciA9IHQucGFyZW50KCksdSA9IGlzX2xocyh0LnNlbGYoKSwgcik7aWYgKHQub3B0aW9uKCJhcmd1bWVudHMiKSAmJiBuIGluc3RhbmNlb2YgQVNUX1N5bWJvbFJlZiAmJiBnZShzID0gbi5kZWZpbml0aW9uKCkpICYmICFuLmluX2FyZyAmJiBpIGluc3RhbmNlb2YgQVNUX051bWJlciAmJiBNYXRoLmZsb29yKHAgPSBpLnZhbHVlKSA9PSBwICYmIChmID0gcy5zY29wZSkgPT09IGZ1bmN0aW9uICgpIHt2YXIgZSxuID0gMDtmb3IgKDsgZSA9IHQucGFyZW50KG4rKyk7KSBpZiAoZSBpbnN0YW5jZW9mIEFTVF9MYW1iZGEpIHtpZiAoZSBpbnN0YW5jZW9mIEFTVF9BY2Nlc3NvcikgcmV0dXJuO2lmICghaXNfYXJyb3coZSkpIHJldHVybiBjID0gdC5wYXJlbnQobiksIGU7fX0oKSAmJiBmLnVzZXNfYXJndW1lbnRzIDwgKHUgPyAyIDogMykpIHtyIGluc3RhbmNlb2YgQVNUX1VuYXJ5UHJlZml4ICYmICJkZWxldGUiID09IHIub3BlcmF0b3IgJiYgKHMuZGVsZXRlZCB8fCAocy5kZWxldGVkID0gW10pLCBzLmRlbGV0ZWRbcF0gPSAhMCk7dmFyIF8gPSBmLmFyZ25hbWVzW3BdO2lmIChzLmRlbGV0ZWQgJiYgcy5kZWxldGVkW3BdKSBfID0gbnVsbDtlbHNlIGlmIChfKSAoIShfIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZyAmJiAiYXdhaXQiICE9IF8ubmFtZSAmJiBuLnNjb3BlLmZpbmRfdmFyaWFibGUoXy5uYW1lKSA9PT0gKFMgPSBfLmRlZmluaXRpb24oKSkpIHx8ICh0Lmhhc19kaXJlY3RpdmUoInVzZSBzdHJpY3QiKSB8fCBmLm5hbWUgfHwgZi5yZXN0IHx8ICEoYyBpbnN0YW5jZW9mIEFTVF9DYWxsICYmIHAgPCBjLmFyZ3MubGVuZ3RoICYmIGFsbChjLmFyZ3Muc2xpY2UoMCwgcCArIDEpLCBmdW5jdGlvbiAoZSkge3JldHVybiAhKGUgaW5zdGFuY2VvZiBBU1RfU3ByZWFkKTt9KSkgfHwgIWFsbChmLmFyZ25hbWVzLCBmdW5jdGlvbiAoZSkge3JldHVybiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZzt9KSkgJiYgKHYoKSB8fCBTLmFzc2lnbm1lbnRzIHx8IDEgPCBTLm9yaWcubGVuZ3RoKSkgJiYgKF8gPSBudWxsKTtlbHNlIGlmICgodSB8fCAhdigpKSAmJiBwIDwgZi5hcmduYW1lcy5sZW5ndGggKyA1ICYmIHQuZHJvcF9mYXJncyhmLCBjKSAmJiAhZi5yZXN0KSBmb3IgKDsgcCA+PSBmLmFyZ25hbWVzLmxlbmd0aDspIF8gPSBmLm1ha2VfdmFyKEFTVF9TeW1ib2xGdW5hcmcsIGYsICJhcmd1bWVudF8iICsgZi5hcmduYW1lcy5sZW5ndGgpLCBmLmFyZ25hbWVzLnB1c2goXyk7aWYgKF8gJiYgZmluZF9pZihmdW5jdGlvbiAoZSkge3JldHVybiBlLm5hbWUgPT09IF8ubmFtZTt9LCBmLmFyZ25hbWVzKSA9PT0gXykgcmV0dXJuIHUgJiYgcy5yZWFzc2lnbmVkLS0sIChTID0ga2UoQVNUX1N5bWJvbFJlZiwgXykpLnJlZmVyZW5jZSgpLCBfLnVudXNlZCA9IHZvaWQgMCwgUzt9aWYgKHUpIHJldHVybiBlO2lmICh0Lm9wdGlvbigic2VxdWVuY2VzIikgJiYgIkNhbGwiICE9IHIuVFlQRSAmJiAhKHIgaW5zdGFuY2VvZiBBU1RfRm9yRW51bWVyYXRpb24gJiYgci5pbml0ID09PSBlKSkge3ZhciBTID0gRyhlKTtpZiAoUyAhPT0gZSkgcmV0dXJuIFMub3B0aW1pemUodCk7fWlmIChvICE9PSBpICYmICh1ID0gZS5mbGF0dGVuX29iamVjdChhLCB0KSkgJiYgKG4gPSBlLmV4cHJlc3Npb24gPSB1LmV4cHJlc3Npb24sIGkgPSBlLnByb3BlcnR5ID0gdS5wcm9wZXJ0eSksIHQub3B0aW9uKCJwcm9wZXJ0aWVzIikgJiYgdC5vcHRpb24oInNpZGVfZWZmZWN0cyIpICYmIGkgaW5zdGFuY2VvZiBBU1RfTnVtYmVyICYmIG4gaW5zdGFuY2VvZiBBU1RfQXJyYXkgJiYgYWxsKGwgPSBuLmVsZW1lbnRzLCBmdW5jdGlvbiAoZSkge3JldHVybiAhKGUgaW5zdGFuY2VvZiBBU1RfU3ByZWFkKTt9KSkge3ZhciBwLHIgPSBsW3AgPSBpLnZhbHVlXTtpZiAoYXQociwgdCkpIHtmb3IgKHZhciBkLCBBID0gciBpbnN0YW5jZW9mIEFTVF9Ib2xlLCBUID0gIUEsIGggPSBbXSwgbSA9IGwubGVuZ3RoOyAtLW0gPiBwOykgKGQgPSBsW21dLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZSh0KSkgJiYgKGgudW5zaGlmdChkKSwgVCkgJiYgZC5oYXNfc2lkZV9lZmZlY3RzKHQpICYmIChUID0gITEpO2ZvciAoVCB8fCBoLnVuc2hpZnQocik7IDAgPD0gLS1tOykgKGQgPSBsW21dLmRyb3Bfc2lkZV9lZmZlY3RfZnJlZSh0KSkgPyBoLnVuc2hpZnQoZCkgOiBBID8gaC51bnNoaWZ0KGtlKEFTVF9Ib2xlLCBsW21dKSkgOiBwLS07cmV0dXJuIFQgPyAoaC5wdXNoKHIpLCB3ZShlLCBoKS5vcHRpbWl6ZSh0KSkgOiBrZShBU1RfU3ViLCBlLCB7IGV4cHJlc3Npb246IGtlKEFTVF9BcnJheSwgbiwgeyBlbGVtZW50czogaCB9KSwgcHJvcGVydHk6IGtlKEFTVF9OdW1iZXIsIGksIHsgdmFsdWU6IHAgfSkgfSk7fX1yZXR1cm4gSyh0LCBlKTtmdW5jdGlvbiB2KCkge3JldHVybiAhdC5vcHRpb24oInJlZHVjZV92YXJzIikgfHwgcy5yZWFzc2lnbmVkO319KSwgQVNUX0xhbWJkYUV4cHJlc3Npb24uREVGTUVUSE9EKCJjb250YWluc19zdXBlciIsIGZ1bmN0aW9uICgpIHt2YXIgbiA9ICExLHQgPSB0aGlzO3JldHVybiB0LndhbGsobmV3IFRyZWVXYWxrZXIoZnVuY3Rpb24gKGUpIHtyZXR1cm4gISFuIHx8IChlIGluc3RhbmNlb2YgQVNUX1N1cGVyID8gbiA9ICEwIDogZSAhPT0gdCAmJiBlIGluc3RhbmNlb2YgQVNUX1Njb3BlICYmICFpc19hcnJvdyhlKSB8fCB2b2lkIDApO30pKSwgbjt9KSwgKG4gPSBmdW5jdGlvbiBuKGUsIF9uMTkpIHtlLkRFRk1FVEhPRCgiY29udGFpbnNfdGhpcyIsIF9uMTkpO30pKEFTVF9BcnJvdywgcmV0dXJuX2ZhbHNlKSwgbihBU1RfQXN5bmNBcnJvdywgcmV0dXJuX2ZhbHNlKSwgbihBU1RfTm9kZSwgZnVuY3Rpb24gKCkge3ZhciBuID0gITEsdCA9IHRoaXM7cmV0dXJuIHQud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3JldHVybiAhIW4gfHwgKGUgaW5zdGFuY2VvZiBBU1RfVGhpcyA/IG4gPSAhMCA6IGUgIT09IHQgJiYgZSBpbnN0YW5jZW9mIEFTVF9TY29wZSAmJiAhaXNfYXJyb3coZSkgfHwgdm9pZCAwKTt9KSksIG47fSksIEFTVF9Qcm9wQWNjZXNzLkRFRk1FVEhPRCgiZmxhdHRlbl9vYmplY3QiLCBmdW5jdGlvbiAoZSwgbikge2lmIChuLm9wdGlvbigicHJvcGVydGllcyIpICYmICJfX3Byb3RvX18iICE9PSBlKSB7dmFyIHQgPSB0aGlzLmV4cHJlc3Npb247aWYgKHQgaW5zdGFuY2VvZiBBU1RfT2JqZWN0KSBmb3IgKHZhciBpID0gdC5wcm9wZXJ0aWVzLCByID0gaS5sZW5ndGg7IDAgPD0gLS1yOykge3ZhciBvID0gaVtyXTtpZiAoby5rZXkgPT09IGUpIHtpZiAoIWFsbChpLCBzdCkpIHJldHVybjtpZiAoIWF0KG8udmFsdWUsIG4pKSByZXR1cm47Zm9yICh2YXIgYSwgcyA9IFtdLCBmID0gMDsgZiA8IGkubGVuZ3RoOyBmKyspIHt2YXIgYyA9IGlbZl0udmFsdWU7aWYgKGlbZl0gaW5zdGFuY2VvZiBBU1RfT2JqZWN0TWV0aG9kKSB7dmFyIGwsdSxfLFMgPSAhKGMudXNlc19hcmd1bWVudHMgfHwgaXNfZ2VuZXJhdG9yKGMpIHx8IGMuY29udGFpbnNfdGhpcygpKTtpZiAoUyAmJiAobCA9IGwgfHwgbi5maW5kX3BhcmVudChBU1RfU2NvcGUpLCB1ID0gam4obiwgbCksIGMuZWFjaF9hcmduYW1lKGZ1bmN0aW9uIChlKSB7dVtlLm5hbWVdICYmIChTID0gITEpO30pKSwgUykgXyA9IGlzX2FzeW5jKGMpID8gQVNUX0FzeW5jQXJyb3cgOiBBU1RfQXJyb3c7ZWxzZSB7aWYgKCEociAhPSBmIHx8IChhID0gbi5wYXJlbnQoKSkgaW5zdGFuY2VvZiBBU1RfQ2FsbCAmJiBhLmV4cHJlc3Npb24gPT09IHRoaXMpKSByZXR1cm47XyA9IGMuQ1RPUjt9YyA9IGtlKF8sIGMpO31zLnB1c2goYyk7fXJldHVybiBrZShBU1RfU3ViLCB0aGlzLCB7IGV4cHJlc3Npb246IGtlKEFTVF9BcnJheSwgdCwgeyBlbGVtZW50czogcyB9KSwgcHJvcGVydHk6IGtlKEFTVF9OdW1iZXIsIHRoaXMsIHsgdmFsdWU6IHIgfSkgfSk7fX19fSksIGUoQVNUX0RvdCwgZnVuY3Rpb24gKGUsIG4pIHsiYXJndW1lbnRzIiAhPSBlLnByb3BlcnR5ICYmICJjYWxsZXIiICE9IGUucHJvcGVydHkgfHwgQVNUX05vZGUud2FybigiRnVuY3Rpb24ucHJvdG90eXBlLntwcm9wZXJ0eX0gbm90IHN1cHBvcnRlZCBbe3N0YXJ0fV0iLCBlKTt2YXIgdCA9IG4ucGFyZW50KCk7aWYgKGlzX2xocyhuLnNlbGYoKSwgdCkpIHJldHVybiBlO3ZhciBpID0gem4oZSwgbik7aWYgKGkpIHJldHVybiBpO2lmIChuLm9wdGlvbigic2VxdWVuY2VzIikgJiYgIkNhbGwiICE9IHQuVFlQRSAmJiAhKHQgaW5zdGFuY2VvZiBBU1RfRm9yRW51bWVyYXRpb24gJiYgdC5pbml0ID09PSBlKSkge2kgPSBHKGUpO2lmIChpICE9PSBlKSByZXR1cm4gaS5vcHRpbWl6ZShuKTt9aWYgKG4ub3B0aW9uKCJ1bnNhZmVfcHJvdG8iKSAmJiBlLmV4cHJlc3Npb24gaW5zdGFuY2VvZiBBU1RfRG90ICYmICJwcm90b3R5cGUiID09IGUuZXhwcmVzc2lvbi5wcm9wZXJ0eSkge3ZhciByID0gZS5leHByZXNzaW9uLmV4cHJlc3Npb247aWYgKEVlKHIpKSBzd2l0Y2ggKHIubmFtZSkge2Nhc2UgIkFycmF5IjplLmV4cHJlc3Npb24gPSBrZShBU1RfQXJyYXksIGUuZXhwcmVzc2lvbiwgeyBlbGVtZW50czogW10gfSk7YnJlYWs7Y2FzZSAiRnVuY3Rpb24iOmUuZXhwcmVzc2lvbiA9IGtlKEFTVF9GdW5jdGlvbiwgZS5leHByZXNzaW9uLCB7IGFyZ25hbWVzOiBbXSwgYm9keTogW10gfSkuaW5pdF92YXJzKHIuc2NvcGUpO2JyZWFrO2Nhc2UgIk51bWJlciI6ZS5leHByZXNzaW9uID0ga2UoQVNUX051bWJlciwgZS5leHByZXNzaW9uLCB7IHZhbHVlOiAwIH0pO2JyZWFrO2Nhc2UgIk9iamVjdCI6ZS5leHByZXNzaW9uID0ga2UoQVNUX09iamVjdCwgZS5leHByZXNzaW9uLCB7IHByb3BlcnRpZXM6IFtdIH0pO2JyZWFrO2Nhc2UgIlJlZ0V4cCI6ZS5leHByZXNzaW9uID0ga2UoQVNUX1JlZ0V4cCwgZS5leHByZXNzaW9uLCB7IHZhbHVlOiAvdC8gfSk7YnJlYWs7Y2FzZSAiU3RyaW5nIjplLmV4cHJlc3Npb24gPSBrZShBU1RfU3RyaW5nLCBlLmV4cHJlc3Npb24sIHsgdmFsdWU6ICIiIH0pO319dCA9IGUuZmxhdHRlbl9vYmplY3QoZS5wcm9wZXJ0eSwgbik7cmV0dXJuIHQgPyB0Lm9wdGltaXplKG4pIDogSyhuLCBlKTt9KSwgZShBU1RfRGVzdHJ1Y3R1cmVkQXJyYXksIGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuIG4ub3B0aW9uKCJyZXN0cyIpICYmIGUucmVzdCBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRBcnJheSA/IGtlKEFTVF9EZXN0cnVjdHVyZWRBcnJheSwgZSwgeyBlbGVtZW50czogZS5lbGVtZW50cy5jb25jYXQoZS5yZXN0LmVsZW1lbnRzKSwgcmVzdDogZS5yZXN0LnJlc3QgfSkgOiBlO30pLCBlKEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwsIGZ1bmN0aW9uIChlLCBuKSB7dmFyIHQ7cmV0dXJuIG4ub3B0aW9uKCJvYmplY3RzIikgJiYgKHQgPSBlLmtleSkgaW5zdGFuY2VvZiBBU1RfTm9kZSAmJiAodCA9IHQuZXZhbHVhdGUobikpICE9PSBlLmtleSAmJiAoZS5rZXkgPSAiIiArIHQpLCBlO30pLCBlKEFTVF9PYmplY3QsIGZ1bmN0aW9uICh0LCBpKSB7dmFyIHIsIG8sIGEsIHMsIGYsIGMsIGwsIGU7cmV0dXJuIGkub3B0aW9uKCJvYmplY3RzIikgJiYgKGEgPSBvID0gciA9ICExLCBzID0gaS5oYXNfZGlyZWN0aXZlKCJ1c2Ugc3RyaWN0IiksIGYgPSBbXSwgYyA9IG5ldyBEaWN0aW9uYXJ5KCksIGwgPSBbXSwgdC5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtpZiAoIShlIGluc3RhbmNlb2YgQVNUX1NwcmVhZCkpIHJldHVybiBfKGUpO28gPSAhMDt2YXIgbiA9IGUuZXhwcmVzc2lvbjtpLm9wdGlvbigic3ByZWFkcyIpICYmIG4gaW5zdGFuY2VvZiBBU1RfT2JqZWN0ICYmIGFsbChuLnByb3BlcnRpZXMsIGZ1bmN0aW9uIChlKSB7cmV0dXJuICEoZSBpbnN0YW5jZW9mIEFTVF9PYmplY3RHZXR0ZXIgfHwgZSBpbnN0YW5jZW9mIEFTVF9TcHJlYWQgfHwgISgiX19wcm90b19fIiAhPT0gZS5rZXkgfHwgZSBpbnN0YW5jZW9mIEFTVF9PYmplY3RTZXR0ZXIpICYmIGUudmFsdWUuaGFzX3NpZGVfZWZmZWN0cyhpKSk7fSkgPyAociA9ICEwLCBuLnByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge3ZhciBuID0gZS5rZXksdCA9IGUgaW5zdGFuY2VvZiBBU1RfT2JqZWN0U2V0dGVyO2lmICgiX19wcm90b19fIiA9PT0gbikge2lmICghdCkgcmV0dXJuO24gPSBaKG4sIGUpO31fKHQgPyBrZShBU1RfT2JqZWN0S2V5VmFsLCBlLCB7IGtleTogbiwgdmFsdWU6IGtlKEFTVF9VbmRlZmluZWQsIGUpLm9wdGltaXplKGkpIH0pIDogZSk7fSkpIDogKGEgPSAhMCwgdSgpLCBsLnB1c2goZSkpO30pLCB1KCksIHIpID8gKG8gJiYgYSAmJiAxID09IGwubGVuZ3RoICYmIChlID0gbFswXSkgaW5zdGFuY2VvZiBBU1RfT2JqZWN0UHJvcGVydHkgJiYgZS5rZXkgaW5zdGFuY2VvZiBBU1RfTnVtYmVyICYmIChlLmtleSA9ICIiICsgZS5rZXkudmFsdWUpLCBrZShBU1RfT2JqZWN0LCB0LCB7IHByb3BlcnRpZXM6IGwgfSkpIDogdDtmdW5jdGlvbiB1KCkge2YuZm9yRWFjaChmdW5jdGlvbiAoZSkge3ZhciBuID0gYy5nZXQoZSk7c3dpdGNoIChuLmxlbmd0aCkge2Nhc2UgMDpyZXR1cm47Y2FzZSAxOnJldHVybiBsLnB1c2goblswXSk7fXIgPSAhMDtlID0gcyAmJiAhYSAmJiBuLnBvcCgpO2wucHVzaCgxID09IG4ubGVuZ3RoID8gblswXSA6IGtlKEFTVF9PYmplY3RLZXlWYWwsIHQsIHsga2V5OiBuWzBdLmtleSwgdmFsdWU6IHdlKHQsIG4ubWFwKGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUudmFsdWU7fSkpIH0pKSwgZSAmJiBsLnB1c2goZSksIG4ubGVuZ3RoID0gMDt9KSwgZiA9IFtdLCBjID0gbmV3IERpY3Rpb25hcnkoKTt9ZnVuY3Rpb24gXyhlKSB7dmFyIG4gPSBlLmtleTtuIGluc3RhbmNlb2YgQVNUX05vZGUgJiYgKG8gPSAhMCwgKG4gPSBuLmV2YWx1YXRlKGkpKSA9PT0gZS5rZXkgfHwgIl9fcHJvdG9fXyIgPT09IG4gPyBhID0gITAgOiBuID0gZS5rZXkgPSAiIiArIG4pLCBzdChlKSA/IChlLnZhbHVlLmhhc19zaWRlX2VmZmVjdHMoaSkgJiYgdSgpLCBmLnB1c2gobiksIGMuYWRkKG4sIGUpKSA6ICh1KCksIGwucHVzaChlKSksIG8gJiYgIWEgJiYgInN0cmluZyIgPT0gdHlwZW9mIG4gJiYgeS50ZXN0KG4pICYmIChhID0gITAsIChlID0gYy5oYXMobikgPyBjLmdldChuKVswXSA6IGUpLmtleSA9IGtlKEFTVF9OdW1iZXIsIGUsIHsgdmFsdWU6ICtuIH0pKTt9fSksIChuID0gZnVuY3Rpb24gbihlLCBfbjIwKSB7ZS5ERUZNRVRIT0QoInRyeV9pbmxpbmUiLCBfbjIwKTt9KShBU1RfTm9kZSwgbm9vcCksIG4oQVNUX0Fzc2lnbiwgbm9vcCksIG4oQVNUX0F3YWl0LCBmdW5jdGlvbiAodCwgZSwgbiwgaSkge2lmICh0Lm9wdGlvbigiYXdhaXRzIikpIHt2YXIgciA9IHRoaXMsZSA9IHIuZXhwcmVzc2lvbi50cnlfaW5saW5lKHQsIGUsIG4sIGksICEwKTtpZiAoZSkgcmV0dXJuIG4gfHwgeW4oZSwgZnVuY3Rpb24gKGUpIHtlLmluX2Jvb2wgPSAhMTt2YXIgbiA9IGUudmFsdWU7biBpbnN0YW5jZW9mIEFTVF9Bd2FpdCB8fCAoZS52YWx1ZSA9IGtlKEFTVF9Bd2FpdCwgciwgeyBleHByZXNzaW9uOiBuIHx8IGtlKEFTVF9VbmRlZmluZWQsIGUpLnRyYW5zZm9ybSh0KSB9KSk7fSksIHEoZSkgPyBlIDoga2UoQVNUX0Jsb2NrU3RhdGVtZW50LCByLCB7IGJvZHk6IFtlLCBrZShBU1RfU2ltcGxlU3RhdGVtZW50LCByLCB7IGJvZHk6IGtlKEFTVF9Bd2FpdCwgciwgeyBleHByZXNzaW9uOiBrZShBU1RfTnVtYmVyLCByLCB7IHZhbHVlOiAwIH0pIH0pIH0pXSB9KTt9fSksIG4oQVNUX0JpbmFyeSwgZnVuY3Rpb24gKG4sIGUsIHQsIGksIHIpIHtpZiAodm9pZCAwICE9PSB0KSB7dmFyIG8gPSB0aGlzLGEgPSBvLm9wZXJhdG9yO2lmIChOZVthXSkge2UgPSBvLnJpZ2h0LnRyeV9pbmxpbmUobiwgZSwgdCwgaSwgcik7aWYgKGUpIHJldHVybiBrZShBU1RfSWYsIG8sIHsgY29uZGl0aW9uOiBmdW5jdGlvbiAoZSkge3N3aXRjaCAoYSkge2Nhc2UgIiYmIjpyZXR1cm4gZTtjYXNlICJ8fCI6cmV0dXJuIGUubmVnYXRlKG4pO2Nhc2UgIj8/IjpyZXR1cm4ga2UoQVNUX0JpbmFyeSwgbywgeyBvcGVyYXRvcjogIj09IiwgbGVmdDoga2UoQVNUX051bGwsIG8pLCByaWdodDogZSB9KTt9fShvLmxlZnQpLCBib2R5OiBlLCBhbHRlcm5hdGl2ZTogdCA/IG51bGwgOiBrZShBU1RfUmV0dXJuLCBvLCB7IHZhbHVlOiBrZShBU1RfVW5kZWZpbmVkLCBvKS50cmFuc2Zvcm0obikgfSkgfSk7fX19KSwgbihBU1RfQmxvY2tTdGF0ZW1lbnQsIGZ1bmN0aW9uIChlLCBuLCB0LCBpKSB7aWYgKCF0ICYmIHRoaXMudmFyaWFibGVzKSB7dmFyIHIgPSB0aGlzLmJvZHksbyA9IHIubGVuZ3RoIC0gMTtpZiAoIShvIDwgMCkpIHtlID0gcltvXS50cnlfaW5saW5lKGUsIHRoaXMsIHQsIGkpO2lmIChlKSByZXR1cm4gcltvXSA9IGUsIHRoaXM7fX19KSwgbihBU1RfQ2FsbCwgZnVuY3Rpb24gKGksIHIsIGUsIG8sIG4pIHtpZiAoIShpLm9wdGlvbigiaW5saW5lIikgPCA0KSkge3ZhciB0ID0gdGhpcztpZiAoIXQuaXNfZXhwcl9wdXJlKGkpKSB7dmFyIGEgPSB0LmV4cHJlc3Npb247aWYgKGEgaW5zdGFuY2VvZiBBU1RfTGFtYmRhRXhwcmVzc2lvbiAmJiAhYS5uYW1lICYmICEoYS5zaW5nbGVfdXNlIHx8IGEudXNlc19hcmd1bWVudHMgfHwgYS5waW5uZWQoKSB8fCBpc19nZW5lcmF0b3IoYSkpKSB7dmFyIHMgPSBpc19hcnJvdyhhKTtpZiAoIShzICYmIGEudmFsdWUgfHwgYS5ib2R5WzBdIGluc3RhbmNlb2YgQVNUX0RpcmVjdGl2ZSB8fCBhLmNvbnRhaW5zX3RoaXMoKSkpIHtyID0gciB8fCB4ZShpKTt2YXIgZiA9IG5ldyBEaWN0aW9uYXJ5KCk7Zm9yIChmLnNldCgiTmFOIiwgITApOyAhKHIgaW5zdGFuY2VvZiBBU1RfU2NvcGUpOykgci52YXJpYWJsZXMuZWFjaChmdW5jdGlvbiAoZSkge2Yuc2V0KGUubmFtZSwgITApO30pLCByID0gci5wYXJlbnRfc2NvcGU7aWYgKG1lbWJlcihyLCBpLnN0YWNrKSAmJiAhKHIucGlubmVkKCkgJiYgYS52YXJpYWJsZXMuc2l6ZSgpID4gKHMgPyAwIDogMSkpKSB7aWYgKHIgaW5zdGFuY2VvZiBBU1RfVG9wbGV2ZWwpIHtpZiAoYS52YXJpYWJsZXMuc2l6ZSgpID4gKHMgPyAwIDogMSkpIHtpZiAoIWkudG9wbGV2ZWwudmFycykgcmV0dXJuO2lmICgwIDwgYS5mdW5jdGlvbnMuc2l6ZSgpICYmICFpLnRvcGxldmVsLmZ1bmNzKSByZXR1cm47fWYuc2V0KCJhcmd1bWVudHMiLCAhMCk7fXZhciBjID0gIW4gJiYgaXNfYXN5bmMoYSk7aWYgKGMpIHtpZiAoIWkub3B0aW9uKCJhd2FpdHMiKSkgcmV0dXJuO2lmICghaXNfYXN5bmMocikpIHJldHVybjtpZiAodC5tYXlfdGhyb3coaSkpIHJldHVybjt9dmFyIGwgPSByLnZhcl9uYW1lcygpO2lmIChvID0gbyAmJiBbXSwgYS52YXJpYWJsZXMuYWxsKGZ1bmN0aW9uIChlLCBuKSB7cmV0dXJuIG8gJiYgby5wdXNoKGUpLCAhZi5oYXMobikgJiYgIWwuaGFzKG4pIHx8ICFzICYmICJhcmd1bWVudHMiID09IG4gJiYgMSA9PSBlLm9yaWcubGVuZ3RoO30pICYmICEobyAmJiAwIDwgby5sZW5ndGggJiYgaXQoYSwgbykpKSB7dmFyIHUsXyxTLHAsZCxBID0gITA7aWYgKGFsbChhLmFyZ25hbWVzLCBmdW5jdGlvbiAoZSkge3ZhciBuID0gITEsdCA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuICEhbiB8fCAoZSBpbnN0YW5jZW9mIEFTVF9EZWZhdWx0VmFsdWUgPyBjdChhLCBlLnZhbHVlKSA/IG4gPSAhMCA6IChlLm5hbWUud2Fsayh0KSwgITApIDogZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwgPyBlLmtleSBpbnN0YW5jZW9mIEFTVF9Ob2RlICYmIGN0KGEsIGUua2V5KSA/IG4gPSAhMCA6IChlLnZhbHVlLndhbGsodCksICEwKSA6IGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnICYmICFhbGwoZS5kZWZpbml0aW9uKCkub3JpZywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX1N5bWJvbERlZnVuKTt9KSA/IG4gPSAhMCA6IHZvaWQgMCk7fSk7cmV0dXJuIGUud2Fsayh0KSwgIW4gJiYgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnIHx8IChBID0gITEpLCAhMCk7fSkpIHtpZiAoYS5yZXN0KSB7aWYgKGN0KGEsIGEucmVzdCkpIHJldHVybjtBID0gITE7fWlmIChlID8gdSA9IGZ1bmN0aW9uIHUoZSkge3ZhciBuID0gITE7cmV0dXJuIGUud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3JldHVybiAhIW4gfHwgKGMgJiYgKGUgaW5zdGFuY2VvZiBBU1RfQXdhaXQgfHwgZSBpbnN0YW5jZW9mIEFTVF9Gb3JBd2FpdE9mKSB8fCBlIGluc3RhbmNlb2YgQVNUX1JldHVybiA/IG4gPSAhMCA6IGUgaW5zdGFuY2VvZiBBU1RfU2NvcGUgfHwgdm9pZCAwKTt9KSksICFuO30gOiAobiB8fCBpc19hc3luYyhhKSB8fCBCKHIpKSAmJiAodSA9IGZ1bmN0aW9uIHUoZSkge3ZhciBuID0gITEsdCA9IG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7cmV0dXJuICEhbiB8fCAoZSBpbnN0YW5jZW9mIEFTVF9SZXR1cm4gPyBuID0gITAgOiBlIGluc3RhbmNlb2YgQVNUX1Njb3BlIHx8IHZvaWQgMCk7fSk7cmV0dXJuIGUud2FsayhuZXcgVHJlZVdhbGtlcihmdW5jdGlvbiAoZSkge3JldHVybiAhIW4gfHwgKGUgaW5zdGFuY2VvZiBBU1RfVHJ5ID8gZS5iZmluYWxseSA/IChhbGwoZS5ib2R5LCBmdW5jdGlvbiAoZSkge3JldHVybiBlLndhbGsodCksICFuO30pICYmIGUuYmNhdGNoICYmIGUuYmNhdGNoLndhbGsodCksICEwKSA6IHZvaWQgMCA6IGUgaW5zdGFuY2VvZiBBU1RfU2NvcGUgfHwgdm9pZCAwKTt9KSksICFuO30pLCAhdSB8fCBhbGwoYS5ib2R5LCB1KSkgaWYgKExuKGEsIGpuKGksIHIpKSkgcmV0dXJuIGEuZnVuY3Rpb25zLmVhY2goZnVuY3Rpb24gKGUsIG4pIHtyLmZ1bmN0aW9ucy5zZXQobiwgZSk7fSksIF8gPSBbXSwgYS52YXJpYWJsZXMuZWFjaChmdW5jdGlvbiAobiwgZSkge2lmICgocyB8fCAiYXJndW1lbnRzIiAhPSBlIHx8IDEgIT0gbi5vcmlnLmxlbmd0aCkgJiYgKGwuc2V0KGUsICEwKSwgci5lbmNsb3NlZC5wdXNoKG4pLCByLnZhcmlhYmxlcy5zZXQoZSwgbiksIG4uc2luZ2xlX3VzZSA9ICExLCBvKSAmJiBuLnJlZmVyZW5jZXMubGVuZ3RoICE9IG4ucmVwbGFjZWQpIHtzd2l0Y2ggKG4ub3JpZy5sZW5ndGggLSBuLmVsaW1pbmF0ZWQpIHtjYXNlIDA6cmV0dXJuO2Nhc2UgMTppZiAoYS5mdW5jdGlvbnMuaGFzKGUpKSByZXR1cm47fXZhciB0OyFhbGwobi5vcmlnLCBmdW5jdGlvbiAoZSkge3JldHVybiAhKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sQ29uc3QgfHwgKGUgaW5zdGFuY2VvZiBBU1RfU3ltYm9sRnVuYXJnID8gZS51bnVzZWQgfHwgbi5zY29wZS5yZXNvbHZlKCkgPT09IGEgOiBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbExldCkpO30pIHx8ICh0ID0gbi5vcmlnWzBdKSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xDYXRjaCB8fCAoXy5wdXNoKGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIHQsIHsgYm9keTogdXQoaSwgZnQodCkpIH0pKSwgbi5maXJzdF9kZWNsID0gbnVsbCk7fX0pLCBTID0gT2JqZWN0LmNyZWF0ZShudWxsKSwgcCA9IG5ldyBEaWN0aW9uYXJ5KCksIEEgJiYgYWxsKHQuYXJncywgZnVuY3Rpb24gKGUpIHtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX1NwcmVhZCk7fSkgPyAoZCA9IHQuYXJncy5zbGljZSgpLCBhLmFyZ25hbWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHt2YXIgbiA9IGQuc2hpZnQoKTtlLnVudXNlZCA/IG4gJiYgXy5wdXNoKGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIHQsIHsgYm9keTogbiB9KSkgOiAobiA9IGtlKEFTVF9WYXJEZWYsIHQsIHsgbmFtZTogZS5jb252ZXJ0X3N5bWJvbChBU1RfU3ltYm9sVmFyLCBUKSwgdmFsdWU6IG4gfHwga2UoQVNUX1VuZGVmaW5lZCwgdCkudHJhbnNmb3JtKGkpIH0pLCBlIGluc3RhbmNlb2YgQVNUX1N5bWJvbEZ1bmFyZyAmJiBsdChlLmRlZmluaXRpb24oKSwgbiksIF8ucHVzaChrZShBU1RfVmFyLCB0LCB7IGRlZmluaXRpb25zOiBbbl0gfSkpKTt9KSwgZC5sZW5ndGggJiYgXy5wdXNoKGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIHQsIHsgYm9keTogd2UodCwgZCkgfSkpKSA6IF8ucHVzaChrZShBU1RfVmFyLCB0LCB7IGRlZmluaXRpb25zOiBba2UoQVNUX1ZhckRlZiwgdCwgeyBuYW1lOiBrZShBU1RfRGVzdHJ1Y3R1cmVkQXJyYXksIHQsIHsgZWxlbWVudHM6IGEuYXJnbmFtZXMubWFwKGZ1bmN0aW9uIChlKSB7cmV0dXJuIGUudW51c2VkID8ga2UoQVNUX0hvbGUsIGUpIDogZS5jb252ZXJ0X3N5bWJvbChBU1RfU3ltYm9sVmFyLCBUKTt9KSwgcmVzdDogYS5yZXN0ICYmIGEucmVzdC5jb252ZXJ0X3N5bWJvbChBU1RfU3ltYm9sVmFyLCBUKSB9KSwgdmFsdWU6IGtlKEFTVF9BcnJheSwgdCwgeyBlbGVtZW50czogdC5hcmdzLnNsaWNlKCkgfSkgfSldIH0pKSwgcC5lYWNoKGZ1bmN0aW9uIChlLCBuKSB7biA9IFNbbl07W10udW5zaGlmdC5hcHBseShuLm9yaWcsIGUpLCBuLmVsaW1pbmF0ZWQgKz0gZS5sZW5ndGg7fSksIFtdLnB1c2guYXBwbHkoXywgbyA/IGEuYm9keS5maWx0ZXIoZnVuY3Rpb24gKGUpIHt2YXIgbiwgdDtyZXR1cm4gIShlIGluc3RhbmNlb2YgQVNUX0xhbWJkYURlZmluaXRpb24gJiYgKCh0ID0gKG4gPSBrZShBU1RfU3ltYm9sVmFyLCBmdChlLm5hbWUpKSkuZGVmaW5pdGlvbigpKS5maXhlZCA9ICExLCB0Lm9yaWcucHVzaChuKSwgdC5lbGltaW5hdGVkKyssIF8ucHVzaChrZShBU1RfVmFyLCBlLCB7IGRlZmluaXRpb25zOiBba2UoQVNUX1ZhckRlZiwgZSwgeyBuYW1lOiBuLCB2YWx1ZTogdm4oZSwgITApIH0pXSB9KSksIDEpKTt9KSA6IGEuYm9keSksIG4gPSBrZShBU1RfQmxvY2tTdGF0ZW1lbnQsIHQsIHsgYm9keTogXyB9KSwgZSB8fCAoYyAmJiB5bihuLCBmdW5jdGlvbiAoZSkge3ZhciBuID0gZS52YWx1ZTtDZShuKSB8fCAoZS52YWx1ZSA9IGtlKEFTVF9Bd2FpdCwgdCwgeyBleHByZXNzaW9uOiBuIH0pKTt9KSwgXy5wdXNoKGtlKEFTVF9SZXR1cm4sIHQsIHsgdmFsdWU6IEIocikgPyBrZShBU1RfVW5kZWZpbmVkLCB0KS50cmFuc2Zvcm0oaSkgOiBudWxsIH0pKSksIG47fX19fX19fWZ1bmN0aW9uIFQoZSwgbikge24gPSBuLmRlZmluaXRpb24oKTtTW24uaWRdID0gbiwgcC5hZGQobi5pZCwgZSk7fX0pLCBuKEFTVF9Db25kaXRpb25hbCwgZnVuY3Rpb24gKGUsIG4sIHQsIGksIHIpIHt2YXIgbyA9IHRoaXMsYSA9IG8uY29uc2VxdWVudC50cnlfaW5saW5lKGUsIG4sIHQsIGksIHIpLGUgPSBvLmFsdGVybmF0aXZlLnRyeV9pbmxpbmUoZSwgbiwgdCwgaSwgcik7aWYgKGEgfHwgZSkgcmV0dXJuIGtlKEFTVF9JZiwgbywgeyBjb25kaXRpb246IG8uY29uZGl0aW9uLCBib2R5OiBhIHx8IHMoby5jb25zZXF1ZW50KSwgYWx0ZXJuYXRpdmU6IGUgfHwgcyhvLmFsdGVybmF0aXZlKSB9KTtmdW5jdGlvbiBzKGUpIHtyZXR1cm4gdCA/IGtlKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGUsIHsgYm9keTogZSB9KSA6IGtlKEFTVF9SZXR1cm4sIGUsIHsgdmFsdWU6IGUgfSk7fX0pLCBuKEFTVF9Gb3IsIGZ1bmN0aW9uIChlLCBuLCB0LCBpKSB7dmFyIHIgPSB0aGlzLmJvZHkudHJ5X2lubGluZShlLCBuLCAhMCwgITApLG8gPSAociAmJiAodGhpcy5ib2R5ID0gciksIHRoaXMuaW5pdCk7cmV0dXJuIChvID0gbyAmJiBvLnRyeV9pbmxpbmUoZSwgbiwgITAsIGkpKSA/ICh0aGlzLmluaXQgPSBudWxsLCBvIGluc3RhbmNlb2YgQVNUX0Jsb2NrU3RhdGVtZW50ID8gKG8uYm9keS5wdXNoKHRoaXMpLCBvKSA6IGtlKEFTVF9CbG9ja1N0YXRlbWVudCwgbywgeyBib2R5OiBbbywgdGhpc10gfSkpIDogciAmJiB0aGlzO30pLCBuKEFTVF9Gb3JFbnVtZXJhdGlvbiwgZnVuY3Rpb24gKGUsIG4sIHQsIGkpIHt2YXIgciA9IHRoaXMuYm9keS50cnlfaW5saW5lKGUsIG4sICEwLCAhMCksbyA9IChyICYmICh0aGlzLmJvZHkgPSByKSwgdGhpcy5vYmplY3QpO2lmIChvIGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlKSB7ZSA9IF90KGUsIG4sICEwLCBpLCAhMSwgbywgMSk7aWYgKGUpIHJldHVybiB0aGlzLm9iamVjdCA9IG8udGFpbF9ub2RlKCksIGUuYm9keS5wdXNoKHRoaXMpLCBlO31yZXR1cm4gciAmJiB0aGlzO30pLCBuKEFTVF9JZiwgZnVuY3Rpb24gKGUsIG4sIHQsIGkpIHt2YXIgciA9IHRoaXMuYm9keS50cnlfaW5saW5lKGUsIG4sIHQsIGkpLG8gPSAociAmJiAodGhpcy5ib2R5ID0gciksIHRoaXMuYWx0ZXJuYXRpdmUpLHQgPSAoKG8gPSBvICYmIG8udHJ5X2lubGluZShlLCBuLCB0LCBpKSkgJiYgKHRoaXMuYWx0ZXJuYXRpdmUgPSBvKSwgdGhpcy5jb25kaXRpb24pO2lmICh0IGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlKSB7ZSA9IF90KGUsIG4sICEwLCBpLCAhMSwgdCwgMSk7aWYgKGUpIHJldHVybiB0aGlzLmNvbmRpdGlvbiA9IHQudGFpbF9ub2RlKCksIGUuYm9keS5wdXNoKHRoaXMpLCBlO31yZXR1cm4gKHIgfHwgbykgJiYgdGhpczt9KSwgbihBU1RfSXRlcmF0aW9uU3RhdGVtZW50LCBmdW5jdGlvbiAoZSwgbiwgdCwgaSkge2UgPSB0aGlzLmJvZHkudHJ5X2lubGluZShlLCBuLCAhMCwgITApO2lmIChlKSByZXR1cm4gdGhpcy5ib2R5ID0gZSwgdGhpczt9KSwgbihBU1RfTGFiZWxlZFN0YXRlbWVudCwgZnVuY3Rpb24gKGUsIG4sIHQsIGkpIHtlID0gdGhpcy5ib2R5LnRyeV9pbmxpbmUoZSwgbiwgdCwgaSk7aWYgKGUpIHJldHVybiB0aGlzLmJvZHkgaW5zdGFuY2VvZiBBU1RfSXRlcmF0aW9uU3RhdGVtZW50ICYmIGUgaW5zdGFuY2VvZiBBU1RfQmxvY2tTdGF0ZW1lbnQgPyAobiA9IGUuYm9keS5wb3AoKSwgdGhpcy5ib2R5ID0gbiwgZS5ib2R5LnB1c2godGhpcyksIGUpIDogKHRoaXMuYm9keSA9IGUsIHRoaXMpO30pLCBuKEFTVF9OZXcsIG5vb3ApLCBuKEFTVF9SZXR1cm4sIGZ1bmN0aW9uIChlLCBuLCB0LCBpKSB7dmFyIHIgPSB0aGlzLnZhbHVlO3JldHVybiByICYmIHIudHJ5X2lubGluZShlLCBuLCB2b2lkIDAsICJ0cnkiID09PSBpKTt9KSwgbihBU1RfU2VxdWVuY2UsIGZ1bmN0aW9uIChlLCBuLCB0LCBpLCByKSB7cmV0dXJuIF90KGUsIG4sIHQsIGksIHIsIHRoaXMpO30pLCBuKEFTVF9TaW1wbGVTdGF0ZW1lbnQsIGZ1bmN0aW9uIChlLCBuLCB0LCBpKSB7Zm9yICh2YXIgciA9IHRoaXMuYm9keTsgciBpbnN0YW5jZW9mIEFTVF9VbmFyeVByZWZpeDspIHt2YXIgbyA9IHIub3BlcmF0b3I7aWYgKHVuYXJ5X3NpZGVfZWZmZWN0c1tvXSkgYnJlYWs7aWYgKCJ2b2lkIiA9PSBvKSBicmVhaztyID0gci5leHByZXNzaW9uO31yZXR1cm4gKHIgPSB0IHx8IENlKHIpID8gciA6IGtlKEFTVF9VbmFyeVByZWZpeCwgdGhpcywgeyBvcGVyYXRvcjogInZvaWQiLCBleHByZXNzaW9uOiByIH0pKS50cnlfaW5saW5lKGUsIG4sIHQgfHwgITEsIGkpO30pLCBuKEFTVF9VbmFyeVByZWZpeCwgZnVuY3Rpb24gKHQsIGUsIG4sIGksIHIpIHt2YXIgbyA9IHRoaXMsYSA9IG8ub3BlcmF0b3I7aWYgKCF1bmFyeV9zaWRlX2VmZmVjdHNbYV0pIHtlID0gby5leHByZXNzaW9uLnRyeV9pbmxpbmUodCwgZSwgbiA9IG4gfHwgInZvaWQiICE9IGEgPyBuIDogITEsIGksIHIpO2lmIChlKSByZXR1cm4gbiB8fCB5bihlLCBmdW5jdGlvbiAoZSkge2UuaW5fYm9vbCA9ICExO3ZhciBuID0gZS52YWx1ZTsidm9pZCIgPT0gYSAmJiBDZShuKSB8fCAoZS52YWx1ZSA9IGtlKEFTVF9VbmFyeVByZWZpeCwgbywgeyBvcGVyYXRvcjogYSwgZXhwcmVzc2lvbjogbiB8fCBrZShBU1RfVW5kZWZpbmVkLCBlKS50cmFuc2Zvcm0odCkgfSkpO30pLCBlO319KSwgbihBU1RfV2l0aCwgZnVuY3Rpb24gKGUsIG4sIHQsIGkpIHt2YXIgdCA9IHRoaXMuYm9keS50cnlfaW5saW5lKGUsIG4sIHQsIGkpLHIgPSAodCAmJiAodGhpcy5ib2R5ID0gdCksIHRoaXMuZXhwcmVzc2lvbik7aWYgKHIgaW5zdGFuY2VvZiBBU1RfU2VxdWVuY2UpIHtlID0gX3QoZSwgbiwgITAsIGksICExLCByLCAxKTtpZiAoZSkgcmV0dXJuIHRoaXMuZXhwcmVzc2lvbiA9IHIudGFpbF9ub2RlKCksIGUuYm9keS5wdXNoKHRoaXMpLCBlO31yZXR1cm4gdCAmJiB0aGlzO30pLCBuKEFTVF9ZaWVsZCwgZnVuY3Rpb24gKGUsIG4sIHQsIGkpIHtpZiAoZS5vcHRpb24oInlpZWxkcyIpICYmIHRoaXMubmVzdGVkKSB7dmFyIHIgPSB0aGlzLmV4cHJlc3Npb247aWYgKCJDYWxsIiA9PSByLlRZUEUpIHt2YXIgbyA9IHIuZXhwcmVzc2lvbjtzd2l0Y2ggKG8uQ1RPUikge2Nhc2UgQVNUX0FzeW5jR2VuZXJhdG9yRnVuY3Rpb246byA9IGtlKEFTVF9Bc3luY0Z1bmN0aW9uLCBvKTticmVhaztjYXNlIEFTVF9HZW5lcmF0b3JGdW5jdGlvbjpvID0ga2UoQVNUX0Z1bmN0aW9uLCBvKTticmVhaztkZWZhdWx0OnJldHVybjt9cmV0dXJuIChyID0gci5jbG9uZSgpKS5leHByZXNzaW9uID0gbywgci50cnlfaW5saW5lKGUsIG4sIHQsIGkpO319fSksIGUoQVNUX1JldHVybiwgZnVuY3Rpb24gKGUsIG4pIHt2YXIgdCA9IGUudmFsdWU7cmV0dXJuIHQgJiYgbi5vcHRpb24oInNpZGVfZWZmZWN0cyIpICYmIENlKHQsIG4pICYmICFCKG4uZmluZF9wYXJlbnQoQVNUX1Njb3BlKSkgJiYgKGUudmFsdWUgPSBudWxsKSwgZTt9KTt9KGZ1bmN0aW9uIChlLCBuKSB7ZS5ERUZNRVRIT0QoIm9wdGltaXplIiwgZnVuY3Rpb24gKGUpIHtyZXR1cm4gdGhpcy5fb3B0aW1pemVkIHx8IGUuaGFzX2RpcmVjdGl2ZSgidXNlIGFzbSIpID8gdGhpcyA6ICgoZSA9IG4odGhpcywgZSkpLl9vcHRpbWl6ZWQgPSAhMCwgZSk7fSk7fSk7CgogIC8vIHByb3BtYW5nbGUuanMKICAvLyBwcmV0dGllci1pZ25vcmUKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAidXNlIHN0cmljdCI7ZnVuY3Rpb24gZ2V0X2J1aWx0aW5zKCkge3ZhciB0ID0gbmV3IERpY3Rpb25hcnkoKSxlID0gKFsiTmFOIiwgIm51bGwiLCAidHJ1ZSIsICJmYWxzZSIsICJJbmZpbml0eSIsICItSW5maW5pdHkiLCAidW5kZWZpbmVkIl0uZm9yRWFjaChuKSwgWyJlbmNvZGVVUkkiLCAiZW5jb2RlVVJJQ29tcG9uZW50IiwgImVzY2FwZSIsICJldmFsIiwgImRlY29kZVVSSSIsICJkZWNvZGVVUklDb21wb25lbnQiLCAiaXNGaW5pdGUiLCAiaXNOYU4iLCAicGFyc2VGbG9hdCIsICJwYXJzZUludCIsICJ1bmVzY2FwZSJdLmZvckVhY2gobiksIEZ1bmN0aW9uKCJyZXR1cm4gdGhpcyIpKCkpO3JldHVybiBbIkFycmF5IiwgIkFycmF5QnVmZmVyIiwgIkF0b21pY3MiLCAiQmlnSW50IiwgIkJvb2xlYW4iLCAiY29uc29sZSIsICJEYXRhVmlldyIsICJEYXRlIiwgIkVycm9yIiwgIkZ1bmN0aW9uIiwgIkludDhBcnJheSIsICJJbnRsIiwgIkpTT04iLCAiTWFwIiwgIk1hdGgiLCAiTnVtYmVyIiwgIk9iamVjdCIsICJQcm9taXNlIiwgIlByb3h5IiwgIlJlZmxlY3QiLCAiUmVnRXhwIiwgIlNldCIsICJTdHJpbmciLCAiU3ltYm9sIiwgIldlYkFzc2VtYmx5Il0uZm9yRWFjaChmdW5jdGlvbiAodCkge24odCk7dCA9IGVbdF07aWYgKHQgJiYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHQpLm1hcChuKSwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdCkpIHt0Ll9fcHJvdG9fXyAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0Ll9fcHJvdG9fXykubWFwKG4pLCB0LnByb3RvdHlwZSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0LnByb3RvdHlwZSkubWFwKG4pO3RyeSB7T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMobmV3IHQoKSkubWFwKG4pO30gY2F0Y2ggKGUpIHt0cnkge09iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHQoKSkubWFwKG4pO30gY2F0Y2ggKGUpIHt9fX19KSwgKGdldF9idWlsdGlucyA9IGZ1bmN0aW9uIGdldF9idWlsdGlucygpIHtyZXR1cm4gdC5jbG9uZSgpO30pKCk7ZnVuY3Rpb24gbihlKSB7dC5zZXQoZSwgITApO319ZnVuY3Rpb24gcmVzZXJ2ZV9xdW90ZWRfa2V5cyhlLCB0KSB7ZnVuY3Rpb24gbihlKSB7cHVzaF91bmlxKHQsIGUpO31lLndhbGsobmV3IFRyZWVXYWxrZXIoZnVuY3Rpb24gKGUpIHtlIGluc3RhbmNlb2YgQVNUX0NsYXNzUHJvcGVydHkgfHwgZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwgfHwgZSBpbnN0YW5jZW9mIEFTVF9PYmplY3RQcm9wZXJ0eSA/IGUua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgPyBhZGRTdHJpbmdzKGUua2V5LCBuKSA6IGUuc3RhcnQgJiYgZS5zdGFydC5xdW90ZSAmJiBuKGUua2V5KSA6IGUgaW5zdGFuY2VvZiBBU1RfRG90ID8gZS5xdW90ZWQgJiYgbihlLnByb3BlcnR5KSA6IGUgaW5zdGFuY2VvZiBBU1RfU3ViICYmIGFkZFN0cmluZ3MoZS5wcm9wZXJ0eSwgbik7fSkpO31mdW5jdGlvbiBhZGRTdHJpbmdzKGUsIHQpIHtlIGluc3RhbmNlb2YgQVNUX0NvbmRpdGlvbmFsID8gKGFkZFN0cmluZ3MoZS5jb25zZXF1ZW50LCB0KSwgYWRkU3RyaW5ncyhlLmFsdGVybmF0aXZlLCB0KSkgOiBlIGluc3RhbmNlb2YgQVNUX1NlcXVlbmNlID8gYWRkU3RyaW5ncyhlLnRhaWxfbm9kZSgpLCB0KSA6IGUgaW5zdGFuY2VvZiBBU1RfU3RyaW5nICYmIHQoZS52YWx1ZSk7fWZ1bmN0aW9uIG1hbmdsZV9wcm9wZXJ0aWVzKGUsIG4pIHt2YXIgcixvLHQgPSAobiA9IGRlZmF1bHRzKG4sIHsgYnVpbHRpbnM6ICExLCBjYWNoZTogbnVsbCwgZGVidWc6ICExLCBkb21wcm9wczogITEsIGtlZXBfcXVvdGVkOiAhMSwgcmVnZXg6IG51bGwsIHJlc2VydmVkOiBudWxsIH0sICEwKSkuYnVpbHRpbnMgPyBuZXcgRGljdGlvbmFyeSgpIDogZ2V0X2J1aWx0aW5zKCksYSA9IChuLmRvbXByb3BzIHx8ICJ1bmRlZmluZWQiID09IHR5cGVvZiBkb21wcm9wcyB8fCBkb21wcm9wcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7dC5zZXQoZSwgITApO30pLCBBcnJheS5pc0FycmF5KG4ucmVzZXJ2ZWQpICYmIG4ucmVzZXJ2ZWQuZm9yRWFjaChmdW5jdGlvbiAoZSkge3Quc2V0KGUsICEwKTt9KSwgLTEpLGkgPSAobi5jYWNoZSA/IChyID0gbi5jYWNoZS5wcm9wcykuZWFjaChmdW5jdGlvbiAoZSkge3Quc2V0KGUsICEwKTt9KSA6IHIgPSBuZXcgRGljdGlvbmFyeSgpLCBuLnJlZ2V4KSxzID0gITEgIT09IG4uZGVidWcsYyA9IChzICYmIChvID0gITAgPT09IG4uZGVidWcgPyAiIiA6IG4uZGVidWcpLCBuZXcgRGljdGlvbmFyeSgpKSxwID0gdC5jbG9uZSgpO2Z1bmN0aW9uIGYoZSkge3JldHVybiAhcC5oYXMoZSkgJiYgIS9eLT9bMC05XSsoXC5bMC05XSspPyhlWystXVswLTldKyk/JC8udGVzdChlKTt9ZnVuY3Rpb24gdShlKSB7aWYgKHQuaGFzKGUpKSBBU1RfTm9kZS5pbmZvKCJQcmVzZXJ2aW5nIHJlc2VydmVkIHByb3BlcnR5IHt0aGlzfSIsIGUpO2Vsc2Uge2lmICghaSB8fCBpLnRlc3QoZSkpIHJldHVybiByLmhhcyhlKSB8fCBjLmhhcyhlKTtBU1RfTm9kZS5pbmZvKCJQcmVzZXJ2aW5nIGV4Y2x1ZGVkIHByb3BlcnR5IHt0aGlzfSIsIGUpO319ZnVuY3Rpb24gZChlKSB7ZihlKSAmJiBjLnNldChlLCAhMCksIHUoZSkgfHwgcC5zZXQoZSwgITApO31mdW5jdGlvbiBsKGUpIHtpZiAoIXUoZSkpIHJldHVybiBlO3ZhciB0LG4gPSByLmdldChlKTtpZiAoIW4pIHtpZiAoIShuID0gcyAmJiBmKHQgPSAiXyQiICsgZSArICIkIiArIG8gKyAiXyIpID8gdCA6IG4pKSBmb3IgKDsgIWYobiA9IGJhc2U1NCgrK2EpKTspOy9eIy8udGVzdChlKSAmJiAobiA9ICIjIiArIG4pLCByLnNldChlLCBuKTt9cmV0dXJuIEFTVF9Ob2RlLmluZm8oIk1hcHBpbmcgcHJvcGVydHkge25hbWV9IHRvIHttYW5nbGVkfSIsIHsgbWFuZ2xlZDogbiwgbmFtZTogZSB9KSwgbjt9ZnVuY3Rpb24geShlKSB7ZSBpbnN0YW5jZW9mIEFTVF9TZXF1ZW5jZSA/IHkoZS50YWlsX25vZGUoKSkgOiBlIGluc3RhbmNlb2YgQVNUX1N0cmluZyA/IGUudmFsdWUgPSBsKGUudmFsdWUpIDogZSBpbnN0YW5jZW9mIEFTVF9Db25kaXRpb25hbCAmJiAoeShlLmNvbnNlcXVlbnQpLCB5KGUuYWx0ZXJuYXRpdmUpKTt9ZS53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7aWYgKCJDYWxsIiA9PSBlLlRZUEUpIHt2YXIgdCA9IGUuZXhwcmVzc2lvbjtpZiAodCBpbnN0YW5jZW9mIEFTVF9Eb3QpIHN3aXRjaCAodC5wcm9wZXJ0eSkge2Nhc2UgImRlZmluZVByb3BlcnR5IjpjYXNlICJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiOmUuYXJncy5sZW5ndGggPCAyIHx8ICh0ID0gdC5leHByZXNzaW9uKSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgIk9iamVjdCIgPT0gdC5uYW1lICYmIHQuZGVmaW5pdGlvbigpLnVuZGVjbGFyZWQgJiYgYWRkU3RyaW5ncyhlLmFyZ3NbMV0sIGQpO2JyZWFrO2Nhc2UgImhhc093blByb3BlcnR5IjplLmFyZ3MubGVuZ3RoIDwgMSB8fCBhZGRTdHJpbmdzKGUuYXJnc1swXSwgZCk7fX0gZWxzZSBlIGluc3RhbmNlb2YgQVNUX0NsYXNzUHJvcGVydHkgfHwgZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwgfHwgZSBpbnN0YW5jZW9mIEFTVF9PYmplY3RQcm9wZXJ0eSA/IGUua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgPyBhZGRTdHJpbmdzKGUua2V5LCBkKSA6IGQoZS5rZXkpIDogZSBpbnN0YW5jZW9mIEFTVF9Eb3QgPyBpc19saHMoZSwgdGhpcy5wYXJlbnQoKSkgJiYgZChlLnByb3BlcnR5KSA6IGUgaW5zdGFuY2VvZiBBU1RfU3ViICYmIGlzX2xocyhlLCB0aGlzLnBhcmVudCgpKSAmJiBhZGRTdHJpbmdzKGUucHJvcGVydHksIGQpO30pKSwgZS53YWxrKG5ldyBUcmVlV2Fsa2VyKGZ1bmN0aW9uIChlKSB7aWYgKGUgaW5zdGFuY2VvZiBBU1RfQmluYXJ5KSAiaW4iID09IGUub3BlcmF0b3IgJiYgeShlLmxlZnQpO2Vsc2UgaWYgKCJDYWxsIiA9PSBlLlRZUEUpIHt2YXIgdCA9IGUuZXhwcmVzc2lvbjtpZiAodCBpbnN0YW5jZW9mIEFTVF9Eb3QpIHN3aXRjaCAodC5wcm9wZXJ0eSkge2Nhc2UgImRlZmluZVByb3BlcnR5IjpjYXNlICJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiOmUuYXJncy5sZW5ndGggPCAyIHx8ICh0ID0gdC5leHByZXNzaW9uKSBpbnN0YW5jZW9mIEFTVF9TeW1ib2xSZWYgJiYgIk9iamVjdCIgPT0gdC5uYW1lICYmIHQuZGVmaW5pdGlvbigpLnVuZGVjbGFyZWQgJiYgeShlLmFyZ3NbMV0pO2JyZWFrO2Nhc2UgImhhc093blByb3BlcnR5IjplLmFyZ3MubGVuZ3RoIDwgMSB8fCB5KGUuYXJnc1swXSk7fX0gZWxzZSBlIGluc3RhbmNlb2YgQVNUX0NsYXNzUHJvcGVydHkgfHwgZSBpbnN0YW5jZW9mIEFTVF9EZXN0cnVjdHVyZWRLZXlWYWwgfHwgZSBpbnN0YW5jZW9mIEFTVF9PYmplY3RQcm9wZXJ0eSA/IGUua2V5IGluc3RhbmNlb2YgQVNUX05vZGUgPyB5KGUua2V5KSA6IGUua2V5ID0gbChlLmtleSkgOiBlIGluc3RhbmNlb2YgQVNUX0RvdCA/IGUucHJvcGVydHkgPSBsKGUucHJvcGVydHkpIDogZSBpbnN0YW5jZW9mIEFTVF9TdWIgJiYgKG4ua2VlcF9xdW90ZWQgfHwgeShlLnByb3BlcnR5KSk7fSkpO30KCiAgbWluaWZ5RXhwb3NlZCA9IG1pbmlmeTsKfSkoKTsKCnNlbGYuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGZ1bmN0aW9uIChlKSB7CiAgLy8gZ2V0dGluZyB0aGUgZGF0YSBmcm9tIHRoZSB3ZWIgd29ya2VyIG1lc3NhZ2UKICB2YXIgd29ya2VyTWVzc2FnZSA9IGUuZGF0YTsKCiAgdHJ5IHsKICAgIC8vIG1pbmlmeWluZyB0aGUgY29kZQogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCiAgICB2YXIgcmVzID0gbWluaWZ5RXhwb3NlZCh3b3JrZXJNZXNzYWdlLCB7CiAgICAgIHBhcnNlOiB7CiAgICAgICAgYmFyZV9yZXR1cm5zOiBmYWxzZSwKICAgICAgICBleHByZXNzaW9uOiBmYWxzZSwKICAgICAgICBmaWxlbmFtZTogbnVsbCwKICAgICAgICBodG1sNV9jb21tZW50czogdHJ1ZSwKICAgICAgICBtb2R1bGU6IGZhbHNlLAogICAgICAgIHNoZWJhbmc6IHRydWUsCiAgICAgICAgc3RyaWN0OiBmYWxzZSwKICAgICAgICB0b3BsZXZlbDogbnVsbAogICAgICB9LAogICAgICBjb21wcmVzczogewogICAgICAgIGFubm90YXRpb25zOiB0cnVlLAogICAgICAgIGFyZ3VtZW50czogdHJ1ZSwKICAgICAgICBhcnJvd3M6IHRydWUsCiAgICAgICAgYXNzaWdubWVudHM6IHRydWUsCiAgICAgICAgYXdhaXRzOiB0cnVlLAogICAgICAgIGJvb2xlYW5zOiB0cnVlLAogICAgICAgIGNvbGxhcHNlX3ZhcnM6IHRydWUsCiAgICAgICAgY29tcGFyaXNvbnM6IHRydWUsCiAgICAgICAgY29uZGl0aW9uYWxzOiB0cnVlLAogICAgICAgIGRlYWRfY29kZTogdHJ1ZSwKICAgICAgICBkZWZhdWx0X3ZhbHVlczogdHJ1ZSwKICAgICAgICBkaXJlY3RpdmVzOiB0cnVlLAogICAgICAgIGRyb3BfY29uc29sZTogZmFsc2UsCiAgICAgICAgZHJvcF9kZWJ1Z2dlcjogdHJ1ZSwKICAgICAgICBldmFsdWF0ZTogdHJ1ZSwKICAgICAgICBleHByZXNzaW9uOiBmYWxzZSwKICAgICAgICBmdW5jdGlvbnM6IHRydWUsCiAgICAgICAgZ2xvYmFsX2RlZnM6IGZhbHNlLAogICAgICAgIGhvaXN0X2V4cG9ydHM6IHRydWUsCiAgICAgICAgaG9pc3RfZnVuczogZmFsc2UsCiAgICAgICAgaG9pc3RfcHJvcHM6IHRydWUsCiAgICAgICAgaG9pc3RfdmFyczogZmFsc2UsCiAgICAgICAgaWU6IGZhbHNlLAogICAgICAgIGlmX3JldHVybjogdHJ1ZSwKICAgICAgICBpbXBvcnRzOiB0cnVlLAogICAgICAgIGlubGluZTogdHJ1ZSwKICAgICAgICBqb2luX3ZhcnM6IHRydWUsCiAgICAgICAga2VlcF9mYXJnczogZmFsc2UsCiAgICAgICAga2VlcF9mbmFtZXM6IGZhbHNlLAogICAgICAgIGtlZXBfaW5maW5pdHk6IGZhbHNlLAogICAgICAgIGxvb3BzOiB0cnVlLAogICAgICAgIG1lcmdlX3ZhcnM6IHRydWUsCiAgICAgICAgbW9kdWxlOiBmYWxzZSwKICAgICAgICBuZWdhdGVfaWlmZTogdHJ1ZSwKICAgICAgICBvYmplY3RzOiB0cnVlLAogICAgICAgIG9wdGlvbmFsX2NoYWluczogdHJ1ZSwKICAgICAgICBwYXNzZXM6IDEsCiAgICAgICAgcHJvcGVydGllczogdHJ1ZSwKICAgICAgICBwdXJlX2Z1bmNzOiBudWxsLAogICAgICAgIHB1cmVfZ2V0dGVyczogInN0cmljdCIsCiAgICAgICAgcmVkdWNlX2Z1bmNzOiB0cnVlLAogICAgICAgIHJlZHVjZV92YXJzOiB0cnVlLAogICAgICAgIHJlc3RzOiB0cnVlLAogICAgICAgIHNlcXVlbmNlczogdHJ1ZSwKICAgICAgICBzaWRlX2VmZmVjdHM6IHRydWUsCiAgICAgICAgc3ByZWFkczogdHJ1ZSwKICAgICAgICBzdHJpbmdzOiB0cnVlLAogICAgICAgIHN3aXRjaGVzOiB0cnVlLAogICAgICAgIHRlbXBsYXRlczogdHJ1ZSwKICAgICAgICB0b3BfcmV0YWluOiBudWxsLAogICAgICAgIHRvcGxldmVsOiBmYWxzZSwKICAgICAgICB0eXBlb2ZzOiB0cnVlLAogICAgICAgIHVuc2FmZTogZmFsc2UsCiAgICAgICAgdW5zYWZlX2NvbXBzOiBmYWxzZSwKICAgICAgICB1bnNhZmVfRnVuY3Rpb246IGZhbHNlLAogICAgICAgIHVuc2FmZV9tYXRoOiBmYWxzZSwKICAgICAgICB1bnNhZmVfcHJvdG86IGZhbHNlLAogICAgICAgIHVuc2FmZV9yZWdleHA6IGZhbHNlLAogICAgICAgIHVuc2FmZV91bmRlZmluZWQ6IGZhbHNlLAogICAgICAgIHVudXNlZDogdHJ1ZSwKICAgICAgICB2YXJpZnk6IHRydWUsCiAgICAgICAgd2Via2l0OiBmYWxzZSwKICAgICAgICB5aWVsZHM6IHRydWUKICAgICAgfSwKICAgICAgbWFuZ2xlOiB7CiAgICAgICAgZXZhbDogZmFsc2UsCiAgICAgICAgaWU6IGZhbHNlLAogICAgICAgIGtlZXBfZmFyZ3M6IGZhbHNlLAogICAgICAgIGtlZXBfZm5hbWVzOiBmYWxzZSwKICAgICAgICBwcm9wZXJ0aWVzOiBmYWxzZSwKICAgICAgICByZXNlcnZlZDogW10sCiAgICAgICAgdG9wbGV2ZWw6IGZhbHNlLAogICAgICAgIHY4OiBmYWxzZSwKICAgICAgICB3ZWJraXQ6IGZhbHNlCiAgICAgIH0sCiAgICAgIG91dHB1dDogewogICAgICAgIGFubm90YXRpb25zOiBmYWxzZSwKICAgICAgICBhc2NpaV9vbmx5OiB0cnVlLAogICAgICAgIGJlYXV0aWZ5OiBmYWxzZSwKICAgICAgICBicmFjZXM6IGZhbHNlLAogICAgICAgIGNvbW1lbnRzOiAvQGxpY2Vuc2V8QHByZXNlcnZlfF4hLywKICAgICAgICBleHRlbmRzY3JpcHQ6IGZhbHNlLAogICAgICAgIGdhbGlvOiBmYWxzZSwKICAgICAgICBpZTogZmFsc2UsCiAgICAgICAgaW5kZW50X2xldmVsOiA0LAogICAgICAgIGluZGVudF9zdGFydDogMCwKICAgICAgICBpbmxpbmVfc2NyaXB0OiB0cnVlLAogICAgICAgIGtlZXBfcXVvdGVkX3Byb3BzOiBmYWxzZSwKICAgICAgICBtYXhfbGluZV9sZW46IGZhbHNlLAogICAgICAgIHByZWFtYmxlOiBudWxsLAogICAgICAgIHByZXNlcnZlX2xpbmU6IGZhbHNlLAogICAgICAgIHF1b3RlX2tleXM6IGZhbHNlLAogICAgICAgIHF1b3RlX3N0eWxlOiAwLAogICAgICAgIHNlbWljb2xvbnM6IHRydWUsCiAgICAgICAgc2hlYmFuZzogdHJ1ZSwKICAgICAgICBzb3VyY2VfbWFwOiBudWxsLAogICAgICAgIHY4OiBmYWxzZSwKICAgICAgICB3ZWJraXQ6IGZhbHNlLAogICAgICAgIHdpZHRoOiA4MCwKICAgICAgICB3cmFwX2lpZmU6IGZhbHNlCiAgICAgIH0sCiAgICAgIHdyYXA6IGZhbHNlCiAgICB9KTsKCiAgICAvLyBjaGVja2luZyBpZiB0aGVyZSB3YXMgYW4gZXJyb3IKICAgIGlmIChyZXMuZXJyb3IpIHsKICAgICAgLy8gdGhyb3dpbmcgdGhlIGVycm9yCiAgICAgIHRocm93IHJlcy5lcnJvcjsKICAgIH0KCiAgICAvLyBzZW5kaW5nIHRoZSBtaW5pZmllZCBjb2RlCiAgICBzZWxmLnBvc3RNZXNzYWdlKHJlcy5jb2RlIHx8ICIvKiBubyBvdXRwdXQhICovIik7CiAgfSBjYXRjaCAoZXJyKSB7CiAgICAvLyBzZW5kaW5nIHRoZSBlcnJvcgogICAgc2VsZi5wb3N0TWVzc2FnZShlcnIudG9TdHJpbmcoKSk7CiAgfQp9KQ=="
      )

      myWorker.onmessage = function (e) {
        try {
          var myReceivedData = e.data

          textOut.value = myReceivedData
          textIn.disabled = false
          btnMinify.style.display = "inline-block"
          btnClear.style.display = "inline-block"
          textOut.focus()
          textOut.select()
        } catch (err) {
          //
        }

        return true
      }

      function minifyCode() {
        textIn.disabled = true
        textOut.disabled = false
        textOut.focus()
        textOut.value = t("please_wait")
        btnMinify.style.display = "none"
        btnClear.style.display = "none"
        myWorker.postMessage(textIn.value)
      }

      window.addEventListener("load", function () {
        // checking if the app is loaded properly
        var secSameDomain = false
        var secNotIframe = window.top === window.self
        var secLocalFile = window.self.location.protocol === "file:"
        try {
          secSameDomain =
            window.top !== window.self &&
            window.top.location.hostname === window.self.location.hostname
        } catch (err) {
          //
        }
        if (secNotIframe || secSameDomain || secLocalFile) {
          // hiding the loading spinner
          document.querySelector(".pleasewait").style.display = "none"

          content = document.getElementById("content")
          labelIn = document.querySelectorAll(".label")[0]
          textIn = document.querySelectorAll(".textarea")[0]
          labelOut = document.querySelectorAll(".label")[1]
          textOut = document.querySelectorAll(".textarea")[1]
          btnMinify = document.querySelector(".btnMinify")
          btnClear = document.querySelector(".btnClear")

          document.getElementsByTagName("html")[0].style.backgroundColor = "#f7fafc"
          document.getElementsByTagName("body")[0].style.backgroundColor = "#f7fafc"

          labelIn.textContent = t("input")
          labelOut.textContent = t("output")

          btnMinify.textContent = t("minify")
          btnClear.textContent = t("clear")

          textIn.value = ""
          textOut.value = ""
          textOut.disabled = true

          content.style.display = "block"

          textIn.focus()

          btnMinify.addEventListener("click", function () {
            minifyCode()
          })

          btnClear.addEventListener("click", function () {
            textIn.value = ""
            textOut.value = ""
          })

          textIn.addEventListener("paste", function (e) {
            e.preventDefault()

            var text = (e.originalEvent || e).clipboardData.getData("text/plain")
            textIn.value = text

            minifyCode()
          })
        }
      })
    </script>
  </body>
</html>
